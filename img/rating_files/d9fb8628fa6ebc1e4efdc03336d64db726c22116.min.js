var Prototype={Version:'1.6.0.3',Browser:{IE:!!(window.attachEvent&&navigator.userAgent.indexOf('Opera')===-1),Opera:navigator.userAgent.indexOf('Opera')>-1,WebKit:navigator.userAgent.indexOf('AppleWebKit/')>-1,Gecko:navigator.userAgent.indexOf('Gecko')>-1&&navigator.userAgent.indexOf('KHTML')===-1,MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)},BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:!!window.HTMLElement,SpecificElementExtensions:document.createElement('div')['__proto__']&&document.createElement('div')['__proto__']!==document.createElement('form')['__proto__']},ScriptFragment:'<script[^>]*>([\\S\\s]*?)<\/script>',JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(x){return x}};if(Prototype.Browser.MobileSafari)
Prototype.BrowserFeatures.SpecificElementExtensions=false;var Class={create:function(){var parent=null,properties=$A(arguments);if(Object.isFunction(properties[0]))
parent=properties.shift();function klass(){this.initialize.apply(this,arguments);}
Object.extend(klass,Class.Methods);klass.superclass=parent;klass.subclasses=[];if(parent){var subclass=function(){};subclass.prototype=parent.prototype;klass.prototype=new subclass;parent.subclasses.push(klass);}
for(var i=0;i<properties.length;i++)
klass.addMethods(properties[i]);if(!klass.prototype.initialize)
klass.prototype.initialize=Prototype.emptyFunction;klass.prototype.constructor=klass;return klass;}};Class.Methods={addMethods:function(source){var ancestor=this.superclass&&this.superclass.prototype;var properties=Object.keys(source);if(!Object.keys({toString:true}).length)
properties.push("toString","valueOf");for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];if(ancestor&&Object.isFunction(value)&&value.argumentNames().first()=="$super"){var method=value;value=(function(m){return function(){return ancestor[m].apply(this,arguments)};})(property).wrap(method);value.valueOf=method.valueOf.bind(method);value.toString=method.toString.bind(method);}
this.prototype[property]=value;}
return this;}};var Abstract={};Object.extend=function(destination,source){for(var property in source)
destination[property]=source[property];return destination;};Object.extend(Object,{inspect:function(object){try{if(Object.isUndefined(object))return'undefined';if(object===null)return'null';return object.inspect?object.inspect():String(object);}catch(e){if(e instanceof RangeError)return'...';throw e;}},toJSON:function(object){var type=typeof object;switch(type){case'undefined':case'function':case'unknown':return;case'boolean':return object.toString();}
if(object===null)return'null';if(object.toJSON)return object.toJSON();if(Object.isElement(object))return;var results=[];for(var property in object){var value=Object.toJSON(object[property]);if(!Object.isUndefined(value))
results.push(property.toJSON()+': '+value);}
return'{'+results.join(', ')+'}';},toQueryString:function(object){return $H(object).toQueryString();},toHTML:function(object){return object&&object.toHTML?object.toHTML():String.interpret(object);},keys:function(object){var keys=[];for(var property in object)
keys.push(property);return keys;},values:function(object){var values=[];for(var property in object)
values.push(object[property]);return values;},clone:function(object){return Object.extend({},object);},isElement:function(object){return!!(object&&object.nodeType==1);},isArray:function(object){return object!=null&&typeof object=="object"&&'splice'in object&&'join'in object;},isHash:function(object){return object instanceof Hash;},isFunction:function(object){return typeof object=="function";},isString:function(object){return typeof object=="string";},isNumber:function(object){return typeof object=="number";},isUndefined:function(object){return typeof object=="undefined";}});Object.extend(Function.prototype,{argumentNames:function(){var names=this.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1].replace(/\s+/g,'').split(',');return names.length==1&&!names[0]?[]:names;},bind:function(){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var __method=this,args=$A(arguments),object=args.shift();return function(){return __method.apply(object,args.concat($A(arguments)));}},bindAsEventListener:function(){var __method=this,args=$A(arguments),object=args.shift();return function(event){return __method.apply(object,[event||window.event].concat(args));}},curry:function(){if(!arguments.length)return this;var __method=this,args=$A(arguments);return function(){return __method.apply(this,args.concat($A(arguments)));}},delay:function(){var __method=this,args=$A(arguments),timeout=args.shift()*1000;return window.setTimeout(function(){return __method.apply(__method,args);},timeout);},defer:function(){var args=[0.01].concat($A(arguments));return this.delay.apply(this,args);},wrap:function(wrapper){var __method=this;return function(){return wrapper.apply(this,[__method.bind(this)].concat($A(arguments)));}},methodize:function(){if(this._methodized)return this._methodized;var __method=this;return this._methodized=function(){return __method.apply(null,[this].concat($A(arguments)));};}});Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+'-'+
(this.getUTCMonth()+1).toPaddedString(2)+'-'+
this.getUTCDate().toPaddedString(2)+'T'+
this.getUTCHours().toPaddedString(2)+':'+
this.getUTCMinutes().toPaddedString(2)+':'+
this.getUTCSeconds().toPaddedString(2)+'Z"';};var Try={these:function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break;}catch(e){}}
return returnValue;}};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(str){return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,'\\$1');};var PeriodicalExecuter=Class.create({initialize:function(callback,frequency){this.callback=callback;this.frequency=frequency;this.currentlyExecuting=false;this.registerCallback();},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},execute:function(){this.callback(this);},stop:function(){if(!this.timer)return;clearInterval(this.timer);this.timer=null;},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();}finally{this.currentlyExecuting=false;}}}});Object.extend(String,{interpret:function(value){return value==null?'':String(value);},specialChar:{'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','\\':'\\\\'}});Object.extend(String.prototype,{gsub:function(pattern,replacement){var result='',source=this,match;replacement=arguments.callee.prepareReplacement(replacement);while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length);}else{result+=source,source='';}}
return result;},sub:function(pattern,replacement,count){replacement=this.gsub.prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0)return match[0];return replacement(match);});},scan:function(pattern,iterator){this.gsub(pattern,iterator);return String(this);},truncate:function(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?'...':truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this);},strip:function(){return this.replace(/^\s+/,'').replace(/\s+$/,'');},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,'');},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,'img'),'');},extractScripts:function(){var matchAll=new RegExp(Prototype.ScriptFragment,'img');var matchOne=new RegExp(Prototype.ScriptFragment,'im');return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||['',''])[1];});},evalScripts:function(){return this.extractScripts().map(function(script){return eval(script)});},escapeHTML:function(){var self=arguments.callee;self.text.data=this;return self.div.innerHTML;},unescapeHTML:function(){var div=new Element('div');div.innerHTML=this.stripTags();return div.childNodes[0]?(div.childNodes.length>1?$A(div.childNodes).inject('',function(memo,node){return memo+node.nodeValue}):div.childNodes[0].nodeValue):'';},toQueryParams:function(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match)return{};return match[1].split(separator||'&').inject({},function(hash,pair){if((pair=pair.split('='))[0]){var key=decodeURIComponent(pair.shift());var value=pair.length>1?pair.join('='):pair[0];if(value!=undefined)value=decodeURIComponent(value);if(key in hash){if(!Object.isArray(hash[key]))hash[key]=[hash[key]];hash[key].push(value);}
else hash[key]=value;}
return hash;});},toArray:function(){return this.split('');},succ:function(){return this.slice(0,this.length-1)+
String.fromCharCode(this.charCodeAt(this.length-1)+1);},times:function(count){return count<1?'':new Array(count+1).join(this);},camelize:function(){var parts=this.split('-'),len=parts.length;if(len==1)return parts[0];var camelized=this.charAt(0)=='-'?parts[0].charAt(0).toUpperCase()+parts[0].substring(1):parts[0];for(var i=1;i<len;i++)
camelized+=parts[i].charAt(0).toUpperCase()+parts[i].substring(1);return camelized;},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase();},underscore:function(){return this.gsub(/::/,'/').gsub(/([A-Z]+)([A-Z][a-z])/,'#{1}_#{2}').gsub(/([a-z\d])([A-Z])/,'#{1}_#{2}').gsub(/-/,'_').toLowerCase();},dasherize:function(){return this.gsub(/_/,'-');},inspect:function(useDoubleQuotes){var escapedString=this.gsub(/[\x00-\x1f\\]/,function(match){var character=String.specialChar[match[0]];return character?character:'\\u00'+match[0].charCodeAt().toPaddedString(2,16);});if(useDoubleQuotes)return'"'+escapedString.replace(/"/g,'\\"')+'"';return"'"+escapedString.replace(/'/g,'\\\'')+"'";},toJSON:function(){return this.inspect(true);},unfilterJSON:function(filter){return this.sub(filter||Prototype.JSONFilter,'#{1}');},isJSON:function(){var str=this;if(str.blank())return false;str=this.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"/g,'');return(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str);},evalJSON:function(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON())return eval('('+json+')');}catch(e){}
throw new SyntaxError('Badly formed JSON string: '+this.inspect());},include:function(pattern){return this.indexOf(pattern)>-1;},startsWith:function(pattern){return this.indexOf(pattern)===0;},endsWith:function(pattern){var d=this.length-pattern.length;return d>=0&&this.lastIndexOf(pattern)===d;},empty:function(){return this=='';},blank:function(){return /^\s*$/.test(this);},interpolate:function(object,pattern){return new Template(this,pattern).evaluate(object);}});if(Prototype.Browser.WebKit||Prototype.Browser.IE)Object.extend(String.prototype,{escapeHTML:function(){return this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');},unescapeHTML:function(){return this.stripTags().replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>');}});String.prototype.gsub.prepareReplacement=function(replacement){if(Object.isFunction(replacement))return replacement;var template=new Template(replacement);return function(match){return template.evaluate(match)};};String.prototype.parseQuery=String.prototype.toQueryParams;Object.extend(String.prototype.escapeHTML,{div:document.createElement('div'),text:document.createTextNode('')});String.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.text);var Template=Class.create({initialize:function(template,pattern){this.template=template.toString();this.pattern=pattern||Template.Pattern;},evaluate:function(object){if(Object.isFunction(object.toTemplateReplacements))
object=object.toTemplateReplacements();return this.template.gsub(this.pattern,function(match){if(object==null)return'';var before=match[1]||'';if(before=='\\')return match[2];var ctx=object,expr=match[3];var pattern=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;match=pattern.exec(expr);if(match==null)return before;while(match!=null){var comp=match[1].startsWith('[')?match[2].gsub('\\\\]',']'):match[1];ctx=ctx[comp];if(null==ctx||''==match[3])break;expr=expr.substring('['==match[3]?match[1].length:match[0].length);match=pattern.exec(expr);}
return before+String.interpret(ctx);});}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable={each:function(iterator,context){var index=0;try{this._each(function(value){iterator.call(context,value,index++);});}catch(e){if(e!=$break)throw e;}
return this;},eachSlice:function(number,iterator,context){var index=-number,slices=[],array=this.toArray();if(number<1)return array;while((index+=number)<array.length)
slices.push(array.slice(index,index+number));return slices.collect(iterator,context);},all:function(iterator,context){iterator=iterator||Prototype.K;var result=true;this.each(function(value,index){result=result&&!!iterator.call(context,value,index);if(!result)throw $break;});return result;},any:function(iterator,context){iterator=iterator||Prototype.K;var result=false;this.each(function(value,index){if(result=!!iterator.call(context,value,index))
throw $break;});return result;},collect:function(iterator,context){iterator=iterator||Prototype.K;var results=[];this.each(function(value,index){results.push(iterator.call(context,value,index));});return results;},detect:function(iterator,context){var result;this.each(function(value,index){if(iterator.call(context,value,index)){result=value;throw $break;}});return result;},findAll:function(iterator,context){var results=[];this.each(function(value,index){if(iterator.call(context,value,index))
results.push(value);});return results;},grep:function(filter,iterator,context){iterator=iterator||Prototype.K;var results=[];if(Object.isString(filter))
filter=new RegExp(filter);this.each(function(value,index){if(filter.match(value))
results.push(iterator.call(context,value,index));});return results;},include:function(object){if(Object.isFunction(this.indexOf))
if(this.indexOf(object)!=-1)return true;var found=false;this.each(function(value){if(value==object){found=true;throw $break;}});return found;},inGroupsOf:function(number,fillWith){fillWith=Object.isUndefined(fillWith)?null:fillWith;return this.eachSlice(number,function(slice){while(slice.length<number)slice.push(fillWith);return slice;});},inject:function(memo,iterator,context){this.each(function(value,index){memo=iterator.call(context,memo,value,index);});return memo;},invoke:function(method){var args=$A(arguments).slice(1);return this.map(function(value){return value[method].apply(value,args);});},max:function(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index);if(result==null||value>=result)
result=value;});return result;},min:function(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index);if(result==null||value<result)
result=value;});return result;},partition:function(iterator,context){iterator=iterator||Prototype.K;var trues=[],falses=[];this.each(function(value,index){(iterator.call(context,value,index)?trues:falses).push(value);});return[trues,falses];},pluck:function(property){var results=[];this.each(function(value){results.push(value[property]);});return results;},reject:function(iterator,context){var results=[];this.each(function(value,index){if(!iterator.call(context,value,index))
results.push(value);});return results;},sortBy:function(iterator,context){return this.map(function(value,index){return{value:value,criteria:iterator.call(context,value,index)};}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0;}).pluck('value');},toArray:function(){return this.map();},zip:function(){var iterator=Prototype.K,args=$A(arguments);if(Object.isFunction(args.last()))
iterator=args.pop();var collections=[this].concat(args).map($A);return this.map(function(value,index){return iterator(collections.pluck(index));});},size:function(){return this.toArray().length;},inspect:function(){return'#<Enumerable:'+this.toArray().inspect()+'>';}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,filter:Enumerable.findAll,member:Enumerable.include,entries:Enumerable.toArray,every:Enumerable.all,some:Enumerable.any});function $A(iterable){if(!iterable)return[];if(iterable.toArray)return iterable.toArray();var length=iterable.length||0,results=new Array(length);while(length--)results[length]=iterable[length];return results;}
if(Prototype.Browser.WebKit){$A=function(iterable){if(!iterable)return[];if(!(typeof iterable==='function'&&typeof iterable.length==='number'&&typeof iterable.item==='function')&&iterable.toArray)
return iterable.toArray();var length=iterable.length||0,results=new Array(length);while(length--)results[length]=iterable[length];return results;};}
Array.from=$A;Object.extend(Array.prototype,Enumerable);if(!Array.prototype._reverse)Array.prototype._reverse=Array.prototype.reverse;Object.extend(Array.prototype,{_each:function(iterator){for(var i=0,length=this.length;i<length;i++)
iterator(this[i]);},clear:function(){this.length=0;return this;},first:function(){return this[0];},last:function(){return this[this.length-1];},compact:function(){return this.select(function(value){return value!=null;});},flatten:function(){return this.inject([],function(array,value){return array.concat(Object.isArray(value)?value.flatten():[value]);});},without:function(){var values=$A(arguments);return this.select(function(value){return!values.include(value);});},reverse:function(inline){return(inline!==false?this:this.toArray())._reverse();},reduce:function(){return this.length>1?this:this[0];},uniq:function(sorted){return this.inject([],function(array,value,index){if(0==index||(sorted?array.last()!=value:!array.include(value)))
array.push(value);return array;});},intersect:function(array){return this.uniq().findAll(function(item){return array.detect(function(value){return item===value});});},clone:function(){return[].concat(this);},size:function(){return this.length;},inspect:function(){return'['+this.map(Object.inspect).join(', ')+']';},toJSON:function(){var results=[];this.each(function(object){var value=Object.toJSON(object);if(!Object.isUndefined(value))results.push(value);});return'['+results.join(', ')+']';}});if(Object.isFunction(Array.prototype.forEach))
Array.prototype._each=Array.prototype.forEach;if(!Array.prototype.indexOf)Array.prototype.indexOf=function(item,i){i||(i=0);var length=this.length;if(i<0)i=length+i;for(;i<length;i++)
if(this[i]===item)return i;return-1;};if(!Array.prototype.lastIndexOf)Array.prototype.lastIndexOf=function(item,i){i=isNaN(i)?this.length:(i<0?this.length+i:i)+1;var n=this.slice(0,i).reverse().indexOf(item);return(n<0)?n:i-n-1;};Array.prototype.toArray=Array.prototype.clone;function $w(string){if(!Object.isString(string))return[];string=string.strip();return string?string.split(/\s+/):[];}
if(Prototype.Browser.Opera){Array.prototype.concat=function(){var array=[];for(var i=0,length=this.length;i<length;i++)array.push(this[i]);for(var i=0,length=arguments.length;i<length;i++){if(Object.isArray(arguments[i])){for(var j=0,arrayLength=arguments[i].length;j<arrayLength;j++)
array.push(arguments[i][j]);}else{array.push(arguments[i]);}}
return array;};}
Object.extend(Number.prototype,{toColorPart:function(){return this.toPaddedString(2,16);},succ:function(){return this+1;},times:function(iterator,context){$R(0,this,true).each(iterator,context);return this;},toPaddedString:function(length,radix){var string=this.toString(radix||10);return'0'.times(length-string.length)+string;},toJSON:function(){return isFinite(this)?this.toString():'null';}});$w('abs round ceil floor').each(function(method){Number.prototype[method]=Math[method].methodize();});function $H(object){return new Hash(object);};var Hash=Class.create(Enumerable,(function(){function toQueryPair(key,value){if(Object.isUndefined(value))return key;return key+'='+encodeURIComponent(String.interpret(value));}
return{initialize:function(object){this._object=Object.isHash(object)?object.toObject():Object.clone(object);},_each:function(iterator){for(var key in this._object){var value=this._object[key],pair=[key,value];pair.key=key;pair.value=value;iterator(pair);}},set:function(key,value){return this._object[key]=value;},get:function(key){if(this._object[key]!==Object.prototype[key])
return this._object[key];},unset:function(key){var value=this._object[key];delete this._object[key];return value;},toObject:function(){return Object.clone(this._object);},keys:function(){return this.pluck('key');},values:function(){return this.pluck('value');},index:function(value){var match=this.detect(function(pair){return pair.value===value;});return match&&match.key;},merge:function(object){return this.clone().update(object);},update:function(object){return new Hash(object).inject(this,function(result,pair){result.set(pair.key,pair.value);return result;});},toQueryString:function(){return this.inject([],function(results,pair){var key=encodeURIComponent(pair.key),values=pair.value;if(values&&typeof values=='object'){if(Object.isArray(values))
return results.concat(values.map(toQueryPair.curry(key)));}else results.push(toQueryPair(key,values));return results;}).join('&');},inspect:function(){return'#<Hash:{'+this.map(function(pair){return pair.map(Object.inspect).join(': ');}).join(', ')+'}>';},toJSON:function(){return Object.toJSON(this.toObject());},clone:function(){return new Hash(this);}}})());Hash.prototype.toTemplateReplacements=Hash.prototype.toObject;Hash.from=$H;var ObjectRange=Class.create(Enumerable,{initialize:function(start,end,exclusive){this.start=start;this.end=end;this.exclusive=exclusive;},_each:function(iterator){var value=this.start;while(this.include(value)){iterator(value);value=value.succ();}},include:function(value){if(value<this.start)
return false;if(this.exclusive)
return value<this.end;return value<=this.end;}});var $R=function(start,end,exclusive){return new ObjectRange(start,end,exclusive);};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject('Msxml2.XMLHTTP')},function(){return new ActiveXObject('Microsoft.XMLHTTP')})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(iterator){this.responders._each(iterator);},register:function(responder){if(!this.include(responder))
this.responders.push(responder);},unregister:function(responder){this.responders=this.responders.without(responder);},dispatch:function(callback,request,transport,json){this.each(function(responder){if(Object.isFunction(responder[callback])){try{responder[callback].apply(responder,[request,transport,json]);}catch(e){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(options){this.options={method:'post',asynchronous:true,contentType:'application/x-www-form-urlencoded',encoding:'UTF-8',parameters:'',evalJSON:true,evalJS:true};Object.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(Object.isString(this.options.parameters))
this.options.parameters=this.options.parameters.toQueryParams();else if(Object.isHash(this.options.parameters))
this.options.parameters=this.options.parameters.toObject();}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,url,options){$super(options);this.transport=Ajax.getTransport();this.request(url);},request:function(url){this.url=url;this.method=this.options.method;var params=Object.clone(this.options.parameters);if(!['get','post'].include(this.method)){params['_method']=this.method;this.method='post';}
this.parameters=params;if(params=Object.toQueryString(params)){if(this.method=='get')
this.url+=(this.url.include('?')?'&':'?')+params;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))
params+='&_=';}
try{var response=new Ajax.Response(this);if(this.options.onCreate)this.options.onCreate(response);Ajax.Responders.dispatch('onCreate',this,response);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous)this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=='post'?(this.options.postBody||params):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType)
this.onStateChange();}
catch(e){this.dispatchException(e);}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState>1&&!((readyState==4)&&this._complete))
this.respondToReadyState(this.transport.readyState);},setRequestHeaders:function(){var headers={'X-Requested-With':'XMLHttpRequest','X-Prototype-Version':Prototype.Version,'Accept':'text/javascript, text/html, application/xml, text/xml, */*'};if(this.method=='post'){headers['Content-type']=this.options.contentType+
(this.options.encoding?'; charset='+this.options.encoding:'');if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)
headers['Connection']='close';}
if(typeof this.options.requestHeaders=='object'){var extras=this.options.requestHeaders;if(Object.isFunction(extras.push))
for(var i=0,length=extras.length;i<length;i+=2)
headers[extras[i]]=extras[i+1];else
$H(extras).each(function(pair){headers[pair.key]=pair.value});}
for(var name in headers)
this.transport.setRequestHeader(name,headers[name]);},success:function(){var status=this.getStatus();return!status||(status>=200&&status<300);},getStatus:function(){try{return this.transport.status||0;}catch(e){return 0}},respondToReadyState:function(readyState){var state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);if(state=='Complete'){try{this._complete=true;(this.options['on'+response.status]||this.options['on'+(this.success()?'Success':'Failure')]||Prototype.emptyFunction)(response,response.headerJSON);}catch(e){this.dispatchException(e);}
var contentType=response.getHeader('Content-type');if(this.options.evalJS=='force'||(this.options.evalJS&&this.isSameOrigin()&&contentType&&contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i)))
this.evalResponse();}
try{(this.options['on'+state]||Prototype.emptyFunction)(response,response.headerJSON);Ajax.Responders.dispatch('on'+state,this,response,response.headerJSON);}catch(e){this.dispatchException(e);}
if(state=='Complete'){this.transport.onreadystatechange=Prototype.emptyFunction;}},isSameOrigin:function(){var m=this.url.match(/^\s*https?:\/\/[^\/]*/);return!m||(m[0]=='#{protocol}//#{domain}#{port}'.interpolate({protocol:location.protocol,domain:document.domain,port:location.port?':'+location.port:''}));},getHeader:function(name){try{return this.transport.getResponseHeader(name)||null;}catch(e){return null}},evalResponse:function(){try{return eval((this.transport.responseText||'').unfilterJSON());}catch(e){this.dispatchException(e);}},dispatchException:function(exception){(this.options.onException||Prototype.emptyFunction)(this,exception);Ajax.Responders.dispatch('onException',this,exception);}});Ajax.Request.Events=['Uninitialized','Loading','Loaded','Interactive','Complete'];Ajax.Response=Class.create({initialize:function(request){this.request=request;var transport=this.transport=request.transport,readyState=this.readyState=transport.readyState;if((readyState>2&&!Prototype.Browser.IE)||readyState==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(transport.responseText);this.headerJSON=this._getHeaderJSON();}
if(readyState==4){var xml=transport.responseXML;this.responseXML=Object.isUndefined(xml)?null:xml;this.responseJSON=this._getResponseJSON();}},status:0,statusText:'',getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||'';}catch(e){return''}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders();}catch(e){return null}},getResponseHeader:function(name){return this.transport.getResponseHeader(name);},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders();},_getHeaderJSON:function(){var json=this.getHeader('X-JSON');if(!json)return null;json=decodeURIComponent(escape(json));try{return json.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin());}catch(e){this.request.dispatchException(e);}},_getResponseJSON:function(){var options=this.request.options;if(!options.evalJSON||(options.evalJSON!='force'&&!(this.getHeader('Content-type')||'').include('application/json'))||this.responseText.blank())
return null;try{return this.responseText.evalJSON(options.sanitizeJSON||!this.request.isSameOrigin());}catch(e){this.request.dispatchException(e);}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,container,url,options){this.container={success:(container.success||container),failure:(container.failure||(container.success?null:container))};options=Object.clone(options);var onComplete=options.onComplete;options.onComplete=(function(response,json){this.updateContent(response.responseText);if(Object.isFunction(onComplete))onComplete(response,json);}).bind(this);$super(url,options);},updateContent:function(responseText){var receiver=this.container[this.success()?'success':'failure'],options=this.options;if(!options.evalScripts)responseText=responseText.stripScripts();if(receiver=$(receiver)){if(options.insertion){if(Object.isString(options.insertion)){var insertion={};insertion[options.insertion]=responseText;receiver.insert(insertion);}
else options.insertion(receiver,responseText);}
else receiver.update(responseText);}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,container,url,options){$super(options);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=container;this.url=url;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(response){if(this.options.decay){this.decay=(response.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=response.responseText;}
this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});function $(element){if(arguments.length>1){for(var i=0,elements=[],length=arguments.length;i<length;i++)
elements.push($(arguments[i]));return elements;}
if(Object.isString(element))
element=document.getElementById(element);return Element.extend(element);}
if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(expression,parentElement){var results=[];var query=document.evaluate(expression,$(parentElement)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0,length=query.snapshotLength;i<length;i++)
results.push(Element.extend(query.snapshotItem(i)));return results;};}
if(!window.Node)var Node={};if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});}
(function(){var element=this.Element;this.Element=function(tagName,attributes){attributes=attributes||{};tagName=tagName.toLowerCase();var cache=Element.cache;if(Prototype.Browser.IE&&attributes.name){tagName='<'+tagName+' name="'+attributes.name+'">';delete attributes.name;return Element.writeAttribute(document.createElement(tagName),attributes);}
if(!cache[tagName])cache[tagName]=Element.extend(document.createElement(tagName));return Element.writeAttribute(cache[tagName].cloneNode(false),attributes);};Object.extend(this.Element,element||{});if(element)this.Element.prototype=element.prototype;}).call(window);Element.cache={};Element.Methods={visible:function(element){return $(element).style.display!='none';},toggle:function(element){element=$(element);Element[Element.visible(element)?'hide':'show'](element);return element;},hide:function(element){element=$(element);element.style.display='none';return element;},show:function(element){element=$(element);element.style.display='';return element;},remove:function(element){element=$(element);element.parentNode.removeChild(element);return element;},update:function(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();if(Object.isElement(content))return element.update().insert(content);content=Object.toHTML(content);element.innerHTML=content.stripScripts();content.evalScripts.bind(content).defer();return element;},replace:function(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();else if(!Object.isElement(content)){content=Object.toHTML(content);var range=element.ownerDocument.createRange();range.selectNode(element);content.evalScripts.bind(content).defer();content=range.createContextualFragment(content.stripScripts());}
element.parentNode.replaceChild(content,element);return element;},insert:function(element,insertions){element=$(element);if(Object.isString(insertions)||Object.isNumber(insertions)||Object.isElement(insertions)||(insertions&&(insertions.toElement||insertions.toHTML)))
insertions={bottom:insertions};var content,insert,tagName,childNodes;for(var position in insertions){content=insertions[position];position=position.toLowerCase();insert=Element._insertionTranslations[position];if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){insert(element,content);continue;}
content=Object.toHTML(content);tagName=((position=='before'||position=='after')?element.parentNode:element).tagName.toUpperCase();childNodes=Element._getContentFromAnonymousElement(tagName,content.stripScripts());if(position=='top'||position=='after')childNodes.reverse();childNodes.each(insert.curry(element));content.evalScripts.bind(content).defer();}
return element;},wrap:function(element,wrapper,attributes){element=$(element);if(Object.isElement(wrapper))
$(wrapper).writeAttribute(attributes||{});else if(Object.isString(wrapper))wrapper=new Element(wrapper,attributes);else wrapper=new Element('div',wrapper);if(element.parentNode)
element.parentNode.replaceChild(wrapper,element);wrapper.appendChild(element);return wrapper;},inspect:function(element){element=$(element);var result='<'+element.tagName.toLowerCase();$H({'id':'id','className':'class'}).each(function(pair){var property=pair.first(),attribute=pair.last();var value=(element[property]||'').toString();if(value)result+=' '+attribute+'='+value.inspect(true);});return result+'>';},recursivelyCollect:function(element,property){element=$(element);var elements=[];while(element=element[property])
if(element.nodeType==1)
elements.push(Element.extend(element));return elements;},ancestors:function(element){return $(element).recursivelyCollect('parentNode');},descendants:function(element){return $(element).select("*");},firstDescendant:function(element){element=$(element).firstChild;while(element&&element.nodeType!=1)element=element.nextSibling;return $(element);},immediateDescendants:function(element){if(!(element=$(element).firstChild))return[];while(element&&element.nodeType!=1)element=element.nextSibling;if(element)return[element].concat($(element).nextSiblings());return[];},previousSiblings:function(element){return $(element).recursivelyCollect('previousSibling');},nextSiblings:function(element){return $(element).recursivelyCollect('nextSibling');},siblings:function(element){element=$(element);return element.previousSiblings().reverse().concat(element.nextSiblings());},match:function(element,selector){if(Object.isString(selector))
selector=new Selector(selector);return selector.match($(element));},up:function(element,expression,index){element=$(element);if(arguments.length==1)return $(element.parentNode);var ancestors=element.ancestors();return Object.isNumber(expression)?ancestors[expression]:Selector.findElement(ancestors,expression,index);},down:function(element,expression,index){element=$(element);if(arguments.length==1)return element.firstDescendant();return Object.isNumber(expression)?element.descendants()[expression]:Element.select(element,expression)[index||0];},previous:function(element,expression,index){element=$(element);if(arguments.length==1)return $(Selector.handlers.previousElementSibling(element));var previousSiblings=element.previousSiblings();return Object.isNumber(expression)?previousSiblings[expression]:Selector.findElement(previousSiblings,expression,index);},next:function(element,expression,index){element=$(element);if(arguments.length==1)return $(Selector.handlers.nextElementSibling(element));var nextSiblings=element.nextSiblings();return Object.isNumber(expression)?nextSiblings[expression]:Selector.findElement(nextSiblings,expression,index);},select:function(){var args=$A(arguments),element=$(args.shift());return Selector.findChildElements(element,args);},adjacent:function(){var args=$A(arguments),element=$(args.shift());return Selector.findChildElements(element.parentNode,args).without(element);},identify:function(element){element=$(element);var id=element.readAttribute('id'),self=arguments.callee;if(id)return id;do{id='anonymous_element_'+self.counter++}while($(id));element.writeAttribute('id',id);return id;},readAttribute:function(element,name){element=$(element);if(Prototype.Browser.IE){var t=Element._attributeTranslations.read;if(t.values[name])return t.values[name](element,name);if(t.names[name])name=t.names[name];if(name.include(':')){return(!element.attributes||!element.attributes[name])?null:element.attributes[name].value;}}
return element.getAttribute(name);},writeAttribute:function(element,name,value){element=$(element);var attributes={},t=Element._attributeTranslations.write;if(typeof name=='object')attributes=name;else attributes[name]=Object.isUndefined(value)?true:value;for(var attr in attributes){name=t.names[attr]||attr;value=attributes[attr];if(t.values[attr])name=t.values[attr](element,value);if(value===false||value===null)
element.removeAttribute(name);else if(value===true)
element.setAttribute(name,name);else element.setAttribute(name,value);}
return element;},getHeight:function(element){return $(element).getDimensions().height;},getWidth:function(element){return $(element).getDimensions().width;},classNames:function(element){return new Element.ClassNames(element);},hasClassName:function(element,className){if(!(element=$(element)))return;var elementClassName=element.className;return(elementClassName.length>0&&(elementClassName==className||new RegExp("(^|\\s)"+className+"(\\s|$)").test(elementClassName)));},addClassName:function(element,className){if(!(element=$(element)))return;if(!element.hasClassName(className))
element.className+=(element.className?' ':'')+className;return element;},removeClassName:function(element,className){if(!(element=$(element)))return;element.className=element.className.replace(new RegExp("(^|\\s+)"+className+"(\\s+|$)"),' ').strip();return element;},toggleClassName:function(element,className){if(!(element=$(element)))return;return element[element.hasClassName(className)?'removeClassName':'addClassName'](className);},cleanWhitespace:function(element){element=$(element);var node=element.firstChild;while(node){var nextNode=node.nextSibling;if(node.nodeType==3&&!/\S/.test(node.nodeValue))
element.removeChild(node);node=nextNode;}
return element;},empty:function(element){return $(element).innerHTML.blank();},descendantOf:function(element,ancestor){element=$(element),ancestor=$(ancestor);if(element.compareDocumentPosition)
return(element.compareDocumentPosition(ancestor)&8)===8;if(ancestor.contains)
return ancestor.contains(element)&&ancestor!==element;while(element=element.parentNode)
if(element==ancestor)return true;return false;},scrollTo:function(element){element=$(element);var pos=element.cumulativeOffset();window.scrollTo(pos[0],pos[1]);return element;},getStyle:function(element,style){element=$(element);style=style=='float'?'cssFloat':style.camelize();var value=element.style[style];if(!value||value=='auto'){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null;}
if(style=='opacity')return value?parseFloat(value):1.0;return value=='auto'?null:value;},getOpacity:function(element){return $(element).getStyle('opacity');},setStyle:function(element,styles){element=$(element);var elementStyle=element.style,match;if(Object.isString(styles)){element.style.cssText+=';'+styles;return styles.include('opacity')?element.setOpacity(styles.match(/opacity:\s*(\d?\.?\d*)/)[1]):element;}
for(var property in styles)
if(property=='opacity')element.setOpacity(styles[property]);else
elementStyle[(property=='float'||property=='cssFloat')?(Object.isUndefined(elementStyle.styleFloat)?'cssFloat':'styleFloat'):property]=styles[property];return element;},setOpacity:function(element,value){element=$(element);element.style.opacity=(value==1||value==='')?'':(value<0.00001)?0:value;return element;},getDimensions:function(element){element=$(element);var display=element.getStyle('display');if(display!='none'&&display!=null)
return{width:element.offsetWidth,height:element.offsetHeight};var els=element.style;var originalVisibility=els.visibility;var originalPosition=els.position;var originalDisplay=els.display;els.visibility='hidden';els.position='absolute';els.display='block';var originalWidth=element.clientWidth;var originalHeight=element.clientHeight;els.display=originalDisplay;els.position=originalPosition;els.visibility=originalVisibility;return{width:originalWidth,height:originalHeight};},makePositioned:function(element){element=$(element);var pos=Element.getStyle(element,'position');if(pos=='static'||!pos){element._madePositioned=true;element.style.position='relative';if(Prototype.Browser.Opera){element.style.top=0;element.style.left=0;}}
return element;},undoPositioned:function(element){element=$(element);if(element._madePositioned){element._madePositioned=undefined;element.style.position=element.style.top=element.style.left=element.style.bottom=element.style.right='';}
return element;},makeClipping:function(element){element=$(element);if(element._overflow)return element;element._overflow=Element.getStyle(element,'overflow')||'auto';if(element._overflow!=='hidden')
element.style.overflow='hidden';return element;},undoClipping:function(element){element=$(element);if(!element._overflow)return element;element.style.overflow=element._overflow=='auto'?'':element._overflow;element._overflow=null;return element;},cumulativeOffset:function(element){var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;}while(element);return Element._returnOffset(valueL,valueT);},positionedOffset:function(element){var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;if(element){if(element.tagName.toUpperCase()=='BODY')break;var p=Element.getStyle(element,'position');if(p!=='static')break;}}while(element);return Element._returnOffset(valueL,valueT);},absolutize:function(element){element=$(element);if(element.getStyle('position')=='absolute')return element;var offsets=element.positionedOffset();var top=offsets[1];var left=offsets[0];var width=element.clientWidth;var height=element.clientHeight;element._originalLeft=left-parseFloat(element.style.left||0);element._originalTop=top-parseFloat(element.style.top||0);element._originalWidth=element.style.width;element._originalHeight=element.style.height;element.style.position='absolute';element.style.top=top+'px';element.style.left=left+'px';element.style.width=width+'px';element.style.height=height+'px';return element;},relativize:function(element){element=$(element);if(element.getStyle('position')=='relative')return element;element.style.position='relative';var top=parseFloat(element.style.top||0)-(element._originalTop||0);var left=parseFloat(element.style.left||0)-(element._originalLeft||0);element.style.top=top+'px';element.style.left=left+'px';element.style.height=element._originalHeight;element.style.width=element._originalWidth;return element;},cumulativeScrollOffset:function(element){var valueT=0,valueL=0;do{valueT+=element.scrollTop||0;valueL+=element.scrollLeft||0;element=element.parentNode;}while(element);return Element._returnOffset(valueL,valueT);},getOffsetParent:function(element){if(element.offsetParent)return $(element.offsetParent);if(element==document.body)return $(element);if(element.tagName.toUpperCase()=='HTML')
return $(document.body);while((element=element.parentNode)&&element!=document.body)
if(Element.getStyle(element,'position')!='static')
return $(element);return $(document.body);},viewportOffset:function(forElement){var valueT=0,valueL=0;var element=forElement;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body&&Element.getStyle(element,'position')=='absolute')break;}while(element=element.offsetParent);element=forElement;do{if(!Prototype.Browser.Opera||(element.tagName&&(element.tagName.toUpperCase()=='BODY'))){valueT-=element.scrollTop||0;valueL-=element.scrollLeft||0;}}while(element=element.parentNode);return Element._returnOffset(valueL,valueT);},clonePosition:function(element,source){var options=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});source=$(source);var p=source.viewportOffset();element=$(element);var delta=[0,0];var parent=null;if(Element.getStyle(element,'position')=='absolute'){parent=element.getOffsetParent();delta=parent.viewportOffset();}
if(parent==document.body){delta[0]-=document.body.offsetLeft;delta[1]-=document.body.offsetTop;}
if(options.setLeft)element.style.left=(p[0]-delta[0]+options.offsetLeft)+'px';if(options.setTop)element.style.top=(p[1]-delta[1]+options.offsetTop)+'px';if(options.setWidth)element.style.width=source.offsetWidth+'px';if(options.setHeight)element.style.height=source.offsetHeight+'px';return element;}};Element.Methods.identify.counter=1;Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:'class',htmlFor:'for'},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(proceed,element,style){switch(style){case'left':case'top':case'right':case'bottom':if(proceed(element,'position')==='static')return null;case'height':case'width':if(!Element.visible(element))return null;var dim=parseInt(proceed(element,style),10);if(dim!==element['offset'+style.capitalize()])
return dim+'px';var properties;if(style==='height'){properties=['border-top-width','padding-top','padding-bottom','border-bottom-width'];}
else{properties=['border-left-width','padding-left','padding-right','border-right-width'];}
return properties.inject(dim,function(memo,property){var val=proceed(element,property);return val===null?memo:memo-parseInt(val,10);})+'px';default:return proceed(element,style);}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(proceed,element,attribute){if(attribute==='title')return element.title;return proceed(element,attribute);});}
else if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(proceed,element){element=$(element);try{element.offsetParent}
catch(e){return $(document.body)}
var position=element.getStyle('position');if(position!=='static')return proceed(element);element.setStyle({position:'relative'});var value=proceed(element);element.setStyle({position:position});return value;});$w('positionedOffset viewportOffset').each(function(method){Element.Methods[method]=Element.Methods[method].wrap(function(proceed,element){element=$(element);try{element.offsetParent}
catch(e){return Element._returnOffset(0,0)}
var position=element.getStyle('position');if(position!=='static')return proceed(element);var offsetParent=element.getOffsetParent();if(offsetParent&&offsetParent.getStyle('position')==='fixed')
offsetParent.setStyle({zoom:1});element.setStyle({position:'relative'});var value=proceed(element);element.setStyle({position:position});return value;});});Element.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(function(proceed,element){try{element.offsetParent}
catch(e){return Element._returnOffset(0,0)}
return proceed(element);});Element.Methods.getStyle=function(element,style){element=$(element);style=(style=='float'||style=='cssFloat')?'styleFloat':style.camelize();var value=element.style[style];if(!value&&element.currentStyle)value=element.currentStyle[style];if(style=='opacity'){if(value=(element.getStyle('filter')||'').match(/alpha\(opacity=(.*)\)/))
if(value[1])return parseFloat(value[1])/100;return 1.0;}
if(value=='auto'){if((style=='width'||style=='height')&&(element.getStyle('display')!='none'))
return element['offset'+style.capitalize()]+'px';return null;}
return value;};Element.Methods.setOpacity=function(element,value){function stripAlpha(filter){return filter.replace(/alpha\([^\)]*\)/gi,'');}
element=$(element);var currentStyle=element.currentStyle;if((currentStyle&&!currentStyle.hasLayout)||(!currentStyle&&element.style.zoom=='normal'))
element.style.zoom=1;var filter=element.getStyle('filter'),style=element.style;if(value==1||value===''){(filter=stripAlpha(filter))?style.filter=filter:style.removeAttribute('filter');return element;}else if(value<0.00001)value=0;style.filter=stripAlpha(filter)+'alpha(opacity='+(value*100)+')';return element;};Element._attributeTranslations={read:{names:{'class':'className','for':'htmlFor'},values:{_getAttr:function(element,attribute){return element.getAttribute(attribute,2);},_getAttrNode:function(element,attribute){var node=element.getAttributeNode(attribute);return node?node.value:"";},_getEv:function(element,attribute){attribute=element.getAttribute(attribute);return attribute?attribute.toString().slice(23,-2):null;},_flag:function(element,attribute){return $(element).hasAttribute(attribute)?attribute:null;},style:function(element){return element.style.cssText.toLowerCase();},title:function(element){return element.title;}}}};Element._attributeTranslations.write={names:Object.extend({cellpadding:'cellPadding',cellspacing:'cellSpacing'},Element._attributeTranslations.read.names),values:{checked:function(element,value){element.checked=!!value;},style:function(element,value){element.style.cssText=value?value:'';}}};Element._attributeTranslations.has={};$w('colSpan rowSpan vAlign dateTime accessKey tabIndex '+'encType maxLength readOnly longDesc frameBorder').each(function(attr){Element._attributeTranslations.write.names[attr.toLowerCase()]=attr;Element._attributeTranslations.has[attr.toLowerCase()]=attr;});(function(v){Object.extend(v,{href:v._getAttr,src:v._getAttr,type:v._getAttr,action:v._getAttrNode,disabled:v._flag,checked:v._flag,readonly:v._flag,multiple:v._flag,onload:v._getEv,onunload:v._getEv,onclick:v._getEv,ondblclick:v._getEv,onmousedown:v._getEv,onmouseup:v._getEv,onmouseover:v._getEv,onmousemove:v._getEv,onmouseout:v._getEv,onfocus:v._getEv,onblur:v._getEv,onkeypress:v._getEv,onkeydown:v._getEv,onkeyup:v._getEv,onsubmit:v._getEv,onreset:v._getEv,onselect:v._getEv,onchange:v._getEv});})(Element._attributeTranslations.read.values);}
else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(element,value){element=$(element);element.style.opacity=(value==1)?0.999999:(value==='')?'':(value<0.00001)?0:value;return element;};}
else if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(element,value){element=$(element);element.style.opacity=(value==1||value==='')?'':(value<0.00001)?0:value;if(value==1)
if(element.tagName.toUpperCase()=='IMG'&&element.width){element.width++;element.width--;}else try{var n=document.createTextNode(' ');element.appendChild(n);element.removeChild(n);}catch(e){}
return element;};Element.Methods.cumulativeOffset=function(element){var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body)
if(Element.getStyle(element,'position')=='absolute')break;element=element.offsetParent;}while(element);return Element._returnOffset(valueL,valueT);};}
if(Prototype.Browser.IE||Prototype.Browser.Opera){Element.Methods.update=function(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();if(Object.isElement(content))return element.update().insert(content);content=Object.toHTML(content);var tagName=element.tagName.toUpperCase();if(tagName in Element._insertionTranslations.tags){$A(element.childNodes).each(function(node){element.removeChild(node)});Element._getContentFromAnonymousElement(tagName,content.stripScripts()).each(function(node){element.appendChild(node)});}
else element.innerHTML=content.stripScripts();content.evalScripts.bind(content).defer();return element;};}
if('outerHTML'in document.createElement('div')){Element.Methods.replace=function(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){element.parentNode.replaceChild(content,element);return element;}
content=Object.toHTML(content);var parent=element.parentNode,tagName=parent.tagName.toUpperCase();if(Element._insertionTranslations.tags[tagName]){var nextSibling=element.next();var fragments=Element._getContentFromAnonymousElement(tagName,content.stripScripts());parent.removeChild(element);if(nextSibling)
fragments.each(function(node){parent.insertBefore(node,nextSibling)});else
fragments.each(function(node){parent.appendChild(node)});}
else element.outerHTML=content.stripScripts();content.evalScripts.bind(content).defer();return element;};}
Element._returnOffset=function(l,t){var result=[l,t];result.left=l;result.top=t;return result;};Element._getContentFromAnonymousElement=function(tagName,html){var div=new Element('div'),t=Element._insertionTranslations.tags[tagName];if(t){div.innerHTML=t[0]+html+t[1];t[2].times(function(){div=div.firstChild});}else div.innerHTML=html;return $A(div.childNodes);};Element._insertionTranslations={before:function(element,node){element.parentNode.insertBefore(node,element);},top:function(element,node){element.insertBefore(node,element.firstChild);},bottom:function(element,node){element.appendChild(node);},after:function(element,node){element.parentNode.insertBefore(node,element.nextSibling);},tags:{TABLE:['<table>','</table>',1],TBODY:['<table><tbody>','</tbody></table>',2],TR:['<table><tbody><tr>','</tr></tbody></table>',3],TD:['<table><tbody><tr><td>','</td></tr></tbody></table>',4],SELECT:['<select>','</select>',1]}};(function(){Object.extend(this.tags,{THEAD:this.tags.TBODY,TFOOT:this.tags.TBODY,TH:this.tags.TD});}).call(Element._insertionTranslations);Element.Methods.Simulated={hasAttribute:function(element,attribute){attribute=Element._attributeTranslations.has[attribute]||attribute;var node=$(element).getAttributeNode(attribute);return!!(node&&node.specified);}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);if(!Prototype.BrowserFeatures.ElementExtensions&&document.createElement('div')['__proto__']){window.HTMLElement={};window.HTMLElement.prototype=document.createElement('div')['__proto__'];Prototype.BrowserFeatures.ElementExtensions=true;}
Element.extend=(function(){if(Prototype.BrowserFeatures.SpecificElementExtensions)
return Prototype.K;var Methods={},ByTag=Element.Methods.ByTag;var extend=Object.extend(function(element){if(!element||element._extendedByPrototype||element.nodeType!=1||element==window)return element;var methods=Object.clone(Methods),tagName=element.tagName.toUpperCase(),property,value;if(ByTag[tagName])Object.extend(methods,ByTag[tagName]);for(property in methods){value=methods[property];if(Object.isFunction(value)&&!(property in element))
element[property]=value.methodize();}
element._extendedByPrototype=Prototype.emptyFunction;return element;},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(Methods,Element.Methods);Object.extend(Methods,Element.Methods.Simulated);}}});extend.refresh();return extend;})();Element.hasAttribute=function(element,attribute){if(element.hasAttribute)return element.hasAttribute(attribute);return Element.Methods.Simulated.hasAttribute(element,attribute);};Element.addMethods=function(methods){var F=Prototype.BrowserFeatures,T=Element.Methods.ByTag;if(!methods){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{"FORM":Object.clone(Form.Methods),"INPUT":Object.clone(Form.Element.Methods),"SELECT":Object.clone(Form.Element.Methods),"TEXTAREA":Object.clone(Form.Element.Methods)});}
if(arguments.length==2){var tagName=methods;methods=arguments[1];}
if(!tagName)Object.extend(Element.Methods,methods||{});else{if(Object.isArray(tagName))tagName.each(extend);else extend(tagName);}
function extend(tagName){tagName=tagName.toUpperCase();if(!Element.Methods.ByTag[tagName])
Element.Methods.ByTag[tagName]={};Object.extend(Element.Methods.ByTag[tagName],methods);}
function copy(methods,destination,onlyIfAbsent){onlyIfAbsent=onlyIfAbsent||false;for(var property in methods){var value=methods[property];if(!Object.isFunction(value))continue;if(!onlyIfAbsent||!(property in destination))
destination[property]=value.methodize();}}
function findDOMClass(tagName){var klass;var trans={"OPTGROUP":"OptGroup","TEXTAREA":"TextArea","P":"Paragraph","FIELDSET":"FieldSet","UL":"UList","OL":"OList","DL":"DList","DIR":"Directory","H1":"Heading","H2":"Heading","H3":"Heading","H4":"Heading","H5":"Heading","H6":"Heading","Q":"Quote","INS":"Mod","DEL":"Mod","A":"Anchor","IMG":"Image","CAPTION":"TableCaption","COL":"TableCol","COLGROUP":"TableCol","THEAD":"TableSection","TFOOT":"TableSection","TBODY":"TableSection","TR":"TableRow","TH":"TableCell","TD":"TableCell","FRAMESET":"FrameSet","IFRAME":"IFrame"};if(trans[tagName])klass='HTML'+trans[tagName]+'Element';if(window[klass])return window[klass];klass='HTML'+tagName+'Element';if(window[klass])return window[klass];klass='HTML'+tagName.capitalize()+'Element';if(window[klass])return window[klass];window[klass]={};window[klass].prototype=document.createElement(tagName)['__proto__'];return window[klass];}
if(F.ElementExtensions){copy(Element.Methods,HTMLElement.prototype);copy(Element.Methods.Simulated,HTMLElement.prototype,true);}
if(F.SpecificElementExtensions){for(var tag in Element.Methods.ByTag){var klass=findDOMClass(tag);if(Object.isUndefined(klass))continue;copy(T[tag],klass.prototype);}}
Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh)Element.extend.refresh();Element.cache={};};document.viewport={getDimensions:function(){var dimensions={},B=Prototype.Browser;$w('width height').each(function(d){var D=d.capitalize();if(B.WebKit&&!document.evaluate){dimensions[d]=self['inner'+D];}else if(B.Opera&&parseFloat(window.opera.version())<9.5){dimensions[d]=document.body['client'+D]}else{dimensions[d]=document.documentElement['client'+D];}});return dimensions;},getWidth:function(){return this.getDimensions().width;},getHeight:function(){return this.getDimensions().height;},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);}};var Selector=Class.create({initialize:function(expression){this.expression=expression.strip();if(this.shouldUseSelectorsAPI()){this.mode='selectorsAPI';}else if(this.shouldUseXPath()){this.mode='xpath';this.compileXPathMatcher();}else{this.mode="normal";this.compileMatcher();}},shouldUseXPath:function(){if(!Prototype.BrowserFeatures.XPath)return false;var e=this.expression;if(Prototype.Browser.WebKit&&(e.include("-of-type")||e.include(":empty")))
return false;if((/(\[[\w-]*?:|:checked)/).test(e))
return false;return true;},shouldUseSelectorsAPI:function(){if(!Prototype.BrowserFeatures.SelectorsAPI)return false;if(!Selector._div)Selector._div=new Element('div');try{Selector._div.querySelector(this.expression);}catch(e){return false;}
return true;},compileMatcher:function(){var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m;if(Selector._cache[e]){this.matcher=Selector._cache[e];return;}
this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i in ps){p=ps[i];if(m=e.match(p)){this.matcher.push(Object.isFunction(c[i])?c[i](m):new Template(c[i]).evaluate(m));e=e.replace(m[0],'');break;}}}
this.matcher.push("return h.unique(n);\n}");eval(this.matcher.join('\n'));Selector._cache[this.expression]=this.matcher;},compileXPathMatcher:function(){var e=this.expression,ps=Selector.patterns,x=Selector.xpath,le,m;if(Selector._cache[e]){this.xpath=Selector._cache[e];return;}
this.matcher=['.//*'];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i in ps){if(m=e.match(ps[i])){this.matcher.push(Object.isFunction(x[i])?x[i](m):new Template(x[i]).evaluate(m));e=e.replace(m[0],'');break;}}}
this.xpath=this.matcher.join('');Selector._cache[this.expression]=this.xpath;},findElements:function(root){root=root||document;var e=this.expression,results;switch(this.mode){case'selectorsAPI':if(root!==document){var oldId=root.id,id=$(root).identify();e="#"+id+" "+e;}
results=$A(root.querySelectorAll(e)).map(Element.extend);root.id=oldId;return results;case'xpath':return document._getElementsByXPath(this.xpath,root);default:return this.matcher(root);}},match:function(element){this.tokens=[];var e=this.expression,ps=Selector.patterns,as=Selector.assertions;var le,p,m;while(e&&le!==e&&(/\S/).test(e)){le=e;for(var i in ps){p=ps[i];if(m=e.match(p)){if(as[i]){this.tokens.push([i,Object.clone(m)]);e=e.replace(m[0],'');}else{return this.findElements(document).include(element);}}}}
var match=true,name,matches;for(var i=0,token;token=this.tokens[i];i++){name=token[0],matches=token[1];if(!Selector.assertions[name](element,matches)){match=false;break;}}
return match;},toString:function(){return this.expression;},inspect:function(){return"#<Selector:"+this.expression.inspect()+">";}});Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:'/following-sibling::*',tagName:function(m){if(m[1]=='*')return'';return"[local-name()='"+m[1].toLowerCase()+"' or local-name()='"+m[1].toUpperCase()+"']";},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:function(m){m[1]=m[1].toLowerCase();return new Template("[@#{1}]").evaluate(m);},attr:function(m){m[1]=m[1].toLowerCase();m[3]=m[5]||m[6];return new Template(Selector.xpath.operators[m[2]]).evaluate(m);},pseudo:function(m){var h=Selector.xpath.pseudos[m[1]];if(!h)return'';if(Object.isFunction(h))return h(m);return new Template(Selector.xpath.pseudos[m[1]]).evaluate(m);},operators:{'=':"[@#{1}='#{3}']",'!=':"[@#{1}!='#{3}']",'^=':"[starts-with(@#{1}, '#{3}')]",'$=':"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']",'*=':"[contains(@#{1}, '#{3}')]",'~=':"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]",'|=':"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{'first-child':'[not(preceding-sibling::*)]','last-child':'[not(following-sibling::*)]','only-child':'[not(preceding-sibling::* or following-sibling::*)]','empty':"[count(*) = 0 and (count(text()) = 0)]",'checked':"[@checked]",'disabled':"[(@disabled) and (@type!='hidden')]",'enabled':"[not(@disabled) and (@type!='hidden')]",'not':function(m){var e=m[6],p=Selector.patterns,x=Selector.xpath,le,v;var exclusion=[];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i in p){if(m=e.match(p[i])){v=Object.isFunction(x[i])?x[i](m):new Template(x[i]).evaluate(m);exclusion.push("("+v.substring(1,v.length-1)+")");e=e.replace(m[0],'');break;}}}
return"[not("+exclusion.join(" and ")+")]";},'nth-child':function(m){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",m);},'nth-last-child':function(m){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",m);},'nth-of-type':function(m){return Selector.xpath.pseudos.nth("position() ",m);},'nth-last-of-type':function(m){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",m);},'first-of-type':function(m){m[6]="1";return Selector.xpath.pseudos['nth-of-type'](m);},'last-of-type':function(m){m[6]="1";return Selector.xpath.pseudos['nth-last-of-type'](m);},'only-of-type':function(m){var p=Selector.xpath.pseudos;return p['first-of-type'](m)+p['last-of-type'](m);},nth:function(fragment,m){var mm,formula=m[6],predicate;if(formula=='even')formula='2n+0';if(formula=='odd')formula='2n+1';if(mm=formula.match(/^(\d+)$/))
return'['+fragment+"= "+mm[1]+']';if(mm=formula.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(mm[1]=="-")mm[1]=-1;var a=mm[1]?Number(mm[1]):1;var b=mm[2]?Number(mm[2]):0;predicate="[((#{fragment} - #{b}) mod #{a} = 0) and "+"((#{fragment} - #{b}) div #{a} >= 0)]";return new Template(predicate).evaluate({fragment:fragment,a:a,b:b});}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);      c = false;',className:'n = h.className(n, r, "#{1}", c);    c = false;',id:'n = h.id(n, r, "#{1}", c);           c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}", c); c = false;',attr:function(m){m[3]=(m[5]||m[6]);return new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;').evaluate(m);},pseudo:function(m){if(m[6])m[6]=m[6].replace(/"/g,'\\"');return new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;').evaluate(m);},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:{laterSibling:/^\s*~\s*/,child:/^\s*>\s*/,adjacent:/^\s*\+\s*/,descendant:/^\s/,tagName:/^\s*(\*|[\w\-]+)(\b|$)?/,id:/^#([\w\-\*]+)(\b|$)/,className:/^\.([\w\-\*]+)(\b|$)/,pseudo:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/,attrPresence:/^\[((?:[\w]+:)?[\w]+)\]/,attr:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/},assertions:{tagName:function(element,matches){return matches[1].toUpperCase()==element.tagName.toUpperCase();},className:function(element,matches){return Element.hasClassName(element,matches[1]);},id:function(element,matches){return element.id===matches[1];},attrPresence:function(element,matches){return Element.hasAttribute(element,matches[1]);},attr:function(element,matches){var nodeValue=Element.readAttribute(element,matches[1]);return nodeValue&&Selector.operators[matches[2]](nodeValue,matches[5]||matches[6]);}},handlers:{concat:function(a,b){for(var i=0,node;node=b[i];i++)
a.push(node);return a;},mark:function(nodes){var _true=Prototype.emptyFunction;for(var i=0,node;node=nodes[i];i++)
node._countedByPrototype=_true;return nodes;},unmark:function(nodes){for(var i=0,node;node=nodes[i];i++)
node._countedByPrototype=undefined;return nodes;},index:function(parentNode,reverse,ofType){parentNode._countedByPrototype=Prototype.emptyFunction;if(reverse){for(var nodes=parentNode.childNodes,i=nodes.length-1,j=1;i>=0;i--){var node=nodes[i];if(node.nodeType==1&&(!ofType||node._countedByPrototype))node.nodeIndex=j++;}}else{for(var i=0,j=1,nodes=parentNode.childNodes;node=nodes[i];i++)
if(node.nodeType==1&&(!ofType||node._countedByPrototype))node.nodeIndex=j++;}},unique:function(nodes){if(nodes.length==0)return nodes;var results=[],n;for(var i=0,l=nodes.length;i<l;i++)
if(!(n=nodes[i])._countedByPrototype){n._countedByPrototype=Prototype.emptyFunction;results.push(Element.extend(n));}
return Selector.handlers.unmark(results);},descendant:function(nodes){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++)
h.concat(results,node.getElementsByTagName('*'));return results;},child:function(nodes){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++){for(var j=0,child;child=node.childNodes[j];j++)
if(child.nodeType==1&&child.tagName!='!')results.push(child);}
return results;},adjacent:function(nodes){for(var i=0,results=[],node;node=nodes[i];i++){var next=this.nextElementSibling(node);if(next)results.push(next);}
return results;},laterSibling:function(nodes){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++)
h.concat(results,Element.nextSiblings(node));return results;},nextElementSibling:function(node){while(node=node.nextSibling)
if(node.nodeType==1)return node;return null;},previousElementSibling:function(node){while(node=node.previousSibling)
if(node.nodeType==1)return node;return null;},tagName:function(nodes,root,tagName,combinator){var uTagName=tagName.toUpperCase();var results=[],h=Selector.handlers;if(nodes){if(combinator){if(combinator=="descendant"){for(var i=0,node;node=nodes[i];i++)
h.concat(results,node.getElementsByTagName(tagName));return results;}else nodes=this[combinator](nodes);if(tagName=="*")return nodes;}
for(var i=0,node;node=nodes[i];i++)
if(node.tagName.toUpperCase()===uTagName)results.push(node);return results;}else return root.getElementsByTagName(tagName);},id:function(nodes,root,id,combinator){var targetNode=$(id),h=Selector.handlers;if(!targetNode)return[];if(!nodes&&root==document)return[targetNode];if(nodes){if(combinator){if(combinator=='child'){for(var i=0,node;node=nodes[i];i++)
if(targetNode.parentNode==node)return[targetNode];}else if(combinator=='descendant'){for(var i=0,node;node=nodes[i];i++)
if(Element.descendantOf(targetNode,node))return[targetNode];}else if(combinator=='adjacent'){for(var i=0,node;node=nodes[i];i++)
if(Selector.handlers.previousElementSibling(targetNode)==node)
return[targetNode];}else nodes=h[combinator](nodes);}
for(var i=0,node;node=nodes[i];i++)
if(node==targetNode)return[targetNode];return[];}
return(targetNode&&Element.descendantOf(targetNode,root))?[targetNode]:[];},className:function(nodes,root,className,combinator){if(nodes&&combinator)nodes=this[combinator](nodes);return Selector.handlers.byClassName(nodes,root,className);},byClassName:function(nodes,root,className){if(!nodes)nodes=Selector.handlers.descendant([root]);var needle=' '+className+' ';for(var i=0,results=[],node,nodeClassName;node=nodes[i];i++){nodeClassName=node.className;if(nodeClassName.length==0)continue;if(nodeClassName==className||(' '+nodeClassName+' ').include(needle))
results.push(node);}
return results;},attrPresence:function(nodes,root,attr,combinator){if(!nodes)nodes=root.getElementsByTagName("*");if(nodes&&combinator)nodes=this[combinator](nodes);var results=[];for(var i=0,node;node=nodes[i];i++)
if(Element.hasAttribute(node,attr))results.push(node);return results;},attr:function(nodes,root,attr,value,operator,combinator){if(!nodes)nodes=root.getElementsByTagName("*");if(nodes&&combinator)nodes=this[combinator](nodes);var handler=Selector.operators[operator],results=[];for(var i=0,node;node=nodes[i];i++){var nodeValue=Element.readAttribute(node,attr);if(nodeValue===null)continue;if(handler(nodeValue,value))results.push(node);}
return results;},pseudo:function(nodes,name,value,root,combinator){if(nodes&&combinator)nodes=this[combinator](nodes);if(!nodes)nodes=root.getElementsByTagName("*");return Selector.pseudos[name](nodes,value,root);}},pseudos:{'first-child':function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(Selector.handlers.previousElementSibling(node))continue;results.push(node);}
return results;},'last-child':function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(Selector.handlers.nextElementSibling(node))continue;results.push(node);}
return results;},'only-child':function(nodes,value,root){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++)
if(!h.previousElementSibling(node)&&!h.nextElementSibling(node))
results.push(node);return results;},'nth-child':function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root);},'nth-last-child':function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root,true);},'nth-of-type':function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root,false,true);},'nth-last-of-type':function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root,true,true);},'first-of-type':function(nodes,formula,root){return Selector.pseudos.nth(nodes,"1",root,false,true);},'last-of-type':function(nodes,formula,root){return Selector.pseudos.nth(nodes,"1",root,true,true);},'only-of-type':function(nodes,formula,root){var p=Selector.pseudos;return p['last-of-type'](p['first-of-type'](nodes,formula,root),formula,root);},getIndices:function(a,b,total){if(a==0)return b>0?[b]:[];return $R(1,total).inject([],function(memo,i){if(0==(i-b)%a&&(i-b)/a>=0)memo.push(i);return memo;});},nth:function(nodes,formula,root,reverse,ofType){if(nodes.length==0)return[];if(formula=='even')formula='2n+0';if(formula=='odd')formula='2n+1';var h=Selector.handlers,results=[],indexed=[],m;h.mark(nodes);for(var i=0,node;node=nodes[i];i++){if(!node.parentNode._countedByPrototype){h.index(node.parentNode,reverse,ofType);indexed.push(node.parentNode);}}
if(formula.match(/^\d+$/)){formula=Number(formula);for(var i=0,node;node=nodes[i];i++)
if(node.nodeIndex==formula)results.push(node);}else if(m=formula.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(m[1]=="-")m[1]=-1;var a=m[1]?Number(m[1]):1;var b=m[2]?Number(m[2]):0;var indices=Selector.pseudos.getIndices(a,b,nodes.length);for(var i=0,node,l=indices.length;node=nodes[i];i++){for(var j=0;j<l;j++)
if(node.nodeIndex==indices[j])results.push(node);}}
h.unmark(nodes);h.unmark(indexed);return results;},'empty':function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(node.tagName=='!'||node.firstChild)continue;results.push(node);}
return results;},'not':function(nodes,selector,root){var h=Selector.handlers,selectorType,m;var exclusions=new Selector(selector).findElements(root);h.mark(exclusions);for(var i=0,results=[],node;node=nodes[i];i++)
if(!node._countedByPrototype)results.push(node);h.unmark(exclusions);return results;},'enabled':function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++)
if(!node.disabled&&(!node.type||node.type!=='hidden'))
results.push(node);return results;},'disabled':function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++)
if(node.disabled)results.push(node);return results;},'checked':function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++)
if(node.checked)results.push(node);return results;}},operators:{'=':function(nv,v){return nv==v;},'!=':function(nv,v){return nv!=v;},'^=':function(nv,v){return nv==v||nv&&nv.startsWith(v);},'$=':function(nv,v){return nv==v||nv&&nv.endsWith(v);},'*=':function(nv,v){return nv==v||nv&&nv.include(v);},'$=':function(nv,v){return nv.endsWith(v);},'*=':function(nv,v){return nv.include(v);},'~=':function(nv,v){return(' '+nv+' ').include(' '+v+' ');},'|=':function(nv,v){return('-'+(nv||"").toUpperCase()+'-').include('-'+(v||"").toUpperCase()+'-');}},split:function(expression){var expressions=[];expression.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(m){expressions.push(m[1].strip());});return expressions;},matchElements:function(elements,expression){var matches=$$(expression),h=Selector.handlers;h.mark(matches);for(var i=0,results=[],element;element=elements[i];i++)
if(element._countedByPrototype)results.push(element);h.unmark(matches);return results;},findElement:function(elements,expression,index){if(Object.isNumber(expression)){index=expression;expression=false;}
return Selector.matchElements(elements,expression||'*')[index||0];},findChildElements:function(element,expressions){expressions=Selector.split(expressions.join(','));var results=[],h=Selector.handlers;for(var i=0,l=expressions.length,selector;i<l;i++){selector=new Selector(expressions[i].strip());h.concat(results,selector.findElements(element));}
return(l>1)?h.unique(results):results;}});if(Prototype.Browser.IE){Object.extend(Selector.handlers,{concat:function(a,b){for(var i=0,node;node=b[i];i++)
if(node.tagName!=="!")a.push(node);return a;},unmark:function(nodes){for(var i=0,node;node=nodes[i];i++)
node.removeAttribute('_countedByPrototype');return nodes;}});}
function $$(){return Selector.findChildElements(document,$A(arguments));}
var Form={reset:function(form){$(form).reset();return form;},serializeElements:function(elements,options){if(typeof options!='object')options={hash:!!options};else if(Object.isUndefined(options.hash))options.hash=true;var key,value,submitted=false,submit=options.submit;var data=elements.inject({},function(result,element){if(!element.disabled&&element.name){key=element.name;value=$(element).getValue();if(value!=null&&element.type!='file'&&(element.type!='submit'||(!submitted&&submit!==false&&(!submit||key==submit)&&(submitted=true)))){if(key in result){if(!Object.isArray(result[key]))result[key]=[result[key]];result[key].push(value);}
else result[key]=value;}}
return result;});return options.hash?data:Object.toQueryString(data);}};Form.Methods={serialize:function(form,options){return Form.serializeElements(Form.getElements(form),options);},getElements:function(form){return $A($(form).getElementsByTagName('*')).inject([],function(elements,child){if(Form.Element.Serializers[child.tagName.toLowerCase()])
elements.push(Element.extend(child));return elements;});},getInputs:function(form,typeName,name){form=$(form);var inputs=form.getElementsByTagName('input');if(!typeName&&!name)return $A(inputs).map(Element.extend);for(var i=0,matchingInputs=[],length=inputs.length;i<length;i++){var input=inputs[i];if((typeName&&input.type!=typeName)||(name&&input.name!=name))
continue;matchingInputs.push(Element.extend(input));}
return matchingInputs;},disable:function(form){form=$(form);Form.getElements(form).invoke('disable');return form;},enable:function(form){form=$(form);Form.getElements(form).invoke('enable');return form;},findFirstElement:function(form){var elements=$(form).getElements().findAll(function(element){return'hidden'!=element.type&&!element.disabled;});var firstByIndex=elements.findAll(function(element){return element.hasAttribute('tabIndex')&&element.tabIndex>=0;}).sortBy(function(element){return element.tabIndex}).first();return firstByIndex?firstByIndex:elements.find(function(element){return['input','select','textarea'].include(element.tagName.toLowerCase());});},focusFirstElement:function(form){form=$(form);form.findFirstElement().activate();return form;},request:function(form,options){form=$(form),options=Object.clone(options||{});var params=options.parameters,action=form.readAttribute('action')||'';if(action.blank())action=window.location.href;options.parameters=form.serialize(true);if(params){if(Object.isString(params))params=params.toQueryParams();Object.extend(options.parameters,params);}
if(form.hasAttribute('method')&&!options.method)
options.method=form.method;return new Ajax.Request(action,options);}};Form.Element={focus:function(element){$(element).focus();return element;},select:function(element){$(element).select();return element;}};Form.Element.Methods={serialize:function(element){element=$(element);if(!element.disabled&&element.name){var value=element.getValue();if(value!=undefined){var pair={};pair[element.name]=value;return Object.toQueryString(pair);}}
return'';},getValue:function(element){element=$(element);var method=element.tagName.toLowerCase();return Form.Element.Serializers[method](element);},setValue:function(element,value){element=$(element);var method=element.tagName.toLowerCase();Form.Element.Serializers[method](element,value);return element;},clear:function(element){$(element).value='';return element;},present:function(element){return $(element).value!='';},activate:function(element){element=$(element);try{element.focus();if(element.select&&(element.tagName.toLowerCase()!='input'||!['button','reset','submit'].include(element.type)))
element.select();}catch(e){}
return element;},disable:function(element){element=$(element);element.disabled=true;return element;},enable:function(element){element=$(element);element.disabled=false;return element;}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers={input:function(element,value){switch(element.type.toLowerCase()){case'checkbox':case'radio':return Form.Element.Serializers.inputSelector(element,value);default:return Form.Element.Serializers.textarea(element,value);}},inputSelector:function(element,value){if(Object.isUndefined(value))return element.checked?element.value:null;else element.checked=!!value;},textarea:function(element,value){if(Object.isUndefined(value))return element.value;else element.value=value;},select:function(element,value){if(Object.isUndefined(value))
return this[element.type=='select-one'?'selectOne':'selectMany'](element);else{var opt,currentValue,single=!Object.isArray(value);for(var i=0,length=element.length;i<length;i++){opt=element.options[i];currentValue=this.optionValue(opt);if(single){if(currentValue==value){opt.selected=true;return;}}
else opt.selected=value.include(currentValue);}}},selectOne:function(element){var index=element.selectedIndex;return index>=0?this.optionValue(element.options[index]):null;},selectMany:function(element){var values,length=element.length;if(!length)return null;for(var i=0,values=[];i<length;i++){var opt=element.options[i];if(opt.selected)values.push(this.optionValue(opt));}
return values;},optionValue:function(opt){return Element.extend(opt).hasAttribute('value')?opt.value:opt.text;}};Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,element,frequency,callback){$super(callback,frequency);this.element=$(element);this.lastValue=this.getValue();},execute:function(){var value=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(value)?this.lastValue!=value:String(this.lastValue)!=String(value)){this.callback(this.element,value);this.lastValue=value;}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element);}});Abstract.EventObserver=Class.create({initialize:function(element,callback){this.element=$(element);this.callback=callback;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=='form')
this.registerFormCallbacks();else
this.registerCallback(this.element);},onElementEvent:function(){var value=this.getValue();if(this.lastValue!=value){this.callback(this.element,value);this.lastValue=value;}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this);},registerCallback:function(element){if(element.type){switch(element.type.toLowerCase()){case'checkbox':case'radio':Event.observe(element,'click',this.onElementEvent.bind(this));break;default:Event.observe(element,'change',this.onElementEvent.bind(this));break;}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element);}});if(!window.Event)var Event={};Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{},relatedTarget:function(event){var element;switch(event.type){case'mouseover':element=event.fromElement;break;case'mouseout':element=event.toElement;break;default:return null;}
return Element.extend(element);}});Event.Methods=(function(){var isButton;if(Prototype.Browser.IE){var buttonMap={0:1,1:4,2:2};isButton=function(event,code){return event.button==buttonMap[code];};}else if(Prototype.Browser.WebKit){isButton=function(event,code){switch(code){case 0:return event.which==1&&!event.metaKey;case 1:return event.which==1&&event.metaKey;default:return false;}};}else{isButton=function(event,code){return event.which?(event.which===code+1):(event.button===code);};}
return{isLeftClick:function(event){return isButton(event,0)},isMiddleClick:function(event){return isButton(event,1)},isRightClick:function(event){return isButton(event,2)},element:function(event){event=Event.extend(event);var node=event.target,type=event.type,currentTarget=event.currentTarget;if(currentTarget&&currentTarget.tagName){if(type==='load'||type==='error'||(type==='click'&&currentTarget.tagName.toLowerCase()==='input'&&currentTarget.type==='radio'))
node=currentTarget;}
if(node){if(node.nodeType==Node.TEXT_NODE)node=node.parentNode;return Element.extend(node);}else return false;},findElement:function(event,expression){var element=Event.element(event);if(!expression)return element;var elements=[element].concat(element.ancestors());return Selector.findElement(elements,expression,0);},pointer:function(event){var docElement=document.documentElement,body=document.body||{scrollLeft:0,scrollTop:0};return{x:event.pageX||(event.clientX+
(docElement.scrollLeft||body.scrollLeft)-
(docElement.clientLeft||0)),y:event.pageY||(event.clientY+
(docElement.scrollTop||body.scrollTop)-
(docElement.clientTop||0))};},pointerX:function(event){return Event.pointer(event).x},pointerY:function(event){return Event.pointer(event).y},stop:function(event){Event.extend(event);event.preventDefault();event.stopPropagation();event.stopped=true;}};})();Event.extend=(function(){var methods=Object.keys(Event.Methods).inject({},function(m,name){m[name]=Event.Methods[name].methodize();return m;});if(Prototype.Browser.IE){Object.extend(methods,{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});return function(event){if(!event)return false;if(event._extendedByPrototype)return event;event._extendedByPrototype=Prototype.emptyFunction;var pointer=Event.pointer(event);Object.extend(event,{target:event.srcElement,relatedTarget:Event.relatedTarget(event),pageX:pointer.x,pageY:pointer.y});return Object.extend(event,methods);};}else{Event.prototype=Event.prototype||document.createEvent("HTMLEvents")['__proto__'];Object.extend(Event.prototype,methods);return Prototype.K;}})();Object.extend(Event,(function(){var cache=Event.cache;function getEventID(element){try{if(element._prototypeEventID)return element._prototypeEventID[0];arguments.callee.id=arguments.callee.id||1;return element._prototypeEventID=[++arguments.callee.id];}catch(error){return false;}}
function getDOMEventName(eventName){if(eventName&&eventName.include(':'))return"dataavailable";return eventName;}
function getCacheForID(id){return cache[id]=cache[id]||{};}
function getWrappersForEventName(id,eventName){var c=getCacheForID(id);return c[eventName]=c[eventName]||[];}
function createWrapper(element,eventName,handler){var id=getEventID(element);var c=getWrappersForEventName(id,eventName);if(c.pluck("handler").include(handler))return false;var wrapper=function(event){if(!Event||!Event.extend||(event.eventName&&event.eventName!=eventName))
return false;Event.extend(event);handler.call(element,event);};wrapper.handler=handler;c.push(wrapper);return wrapper;}
function findWrapper(id,eventName,handler){var c=getWrappersForEventName(id,eventName);return c.find(function(wrapper){return wrapper.handler==handler});}
function destroyWrapper(id,eventName,handler){var c=getCacheForID(id);if(!c[eventName])return false;c[eventName]=c[eventName].without(findWrapper(id,eventName,handler));}
function destroyCache(){for(var id in cache)
for(var eventName in cache[id])
cache[id][eventName]=null;}
if(window.attachEvent){window.attachEvent("onunload",destroyCache);}
if(Prototype.Browser.WebKit){window.addEventListener('unload',Prototype.emptyFunction,false);}
return{observe:function(element,eventName,handler){element=$(element);var name=getDOMEventName(eventName);var wrapper=createWrapper(element,eventName,handler);if(!wrapper)return element;if(element.addEventListener){element.addEventListener(name,wrapper,false);}else{element.attachEvent("on"+name,wrapper);}
return element;},stopObserving:function(element,eventName,handler){element=$(element);var id=getEventID(element),name=getDOMEventName(eventName);if(!handler&&eventName){getWrappersForEventName(id,eventName).each(function(wrapper){element.stopObserving(eventName,wrapper.handler);});return element;}else if(!eventName){Object.keys(getCacheForID(id)).each(function(eventName){element.stopObserving(eventName);});return element;}
var wrapper=findWrapper(id,eventName,handler);if(!wrapper)return element;if(element.removeEventListener){element.removeEventListener(name,wrapper,false);}else{element.detachEvent("on"+name,wrapper);}
destroyWrapper(id,eventName,handler);return element;},fire:function(element,eventName,memo){element=$(element);if(element==document&&document.createEvent&&!element.dispatchEvent)
element=document.documentElement;var event;if(document.createEvent){event=document.createEvent("HTMLEvents");event.initEvent("dataavailable",true,true);}else{event=document.createEventObject();event.eventType="ondataavailable";}
event.eventName=eventName;event.memo=memo||{};if(document.createEvent){element.dispatchEvent(event);}else{element.fireEvent(event.eventType,event);}
return Event.extend(event);}};})());Object.extend(Event,Event.Methods);Element.addMethods({fire:Event.fire,observe:Event.observe,stopObserving:Event.stopObserving});Object.extend(document,{fire:Element.Methods.fire.methodize(),observe:Element.Methods.observe.methodize(),stopObserving:Element.Methods.stopObserving.methodize(),loaded:false});(function(){var timer;function fireContentLoadedEvent(){if(document.loaded)return;if(timer)window.clearInterval(timer);document.fire("dom:loaded");document.loaded=true;}
if(document.addEventListener){if(Prototype.Browser.WebKit){timer=window.setInterval(function(){if(/loaded|complete/.test(document.readyState))
fireContentLoadedEvent();},0);Event.observe(window,"load",fireContentLoadedEvent);}else{document.addEventListener("DOMContentLoaded",fireContentLoadedEvent,false);}}else{document.write("<script id=__onDOMContentLoaded defer src=//:><\/script>");$("__onDOMContentLoaded").onreadystatechange=function(){if(this.readyState=="complete"){this.onreadystatechange=null;fireContentLoadedEvent();}};}})();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(element,content){return Element.insert(element,{before:content});},Top:function(element,content){return Element.insert(element,{top:content});},Bottom:function(element,content){return Element.insert(element,{bottom:content});},After:function(element,content){return Element.insert(element,{after:content});}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;},within:function(element,x,y){if(this.includeScrollOffsets)
return this.withinIncludingScrolloffsets(element,x,y);this.xcomp=x;this.ycomp=y;this.offset=Element.cumulativeOffset(element);return(y>=this.offset[1]&&y<this.offset[1]+element.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+element.offsetWidth);},withinIncludingScrolloffsets:function(element,x,y){var offsetcache=Element.cumulativeScrollOffset(element);this.xcomp=x+offsetcache[0]-this.deltaX;this.ycomp=y+offsetcache[1]-this.deltaY;this.offset=Element.cumulativeOffset(element);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+element.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+element.offsetWidth);},overlap:function(mode,element){if(!mode)return 0;if(mode=='vertical')
return((this.offset[1]+element.offsetHeight)-this.ycomp)/element.offsetHeight;if(mode=='horizontal')
return((this.offset[0]+element.offsetWidth)-this.xcomp)/element.offsetWidth;},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(element){Position.prepare();return Element.absolutize(element);},relativize:function(element){Position.prepare();return Element.relativize(element);},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(source,target,options){options=options||{};return Element.clonePosition(target,source,options);}};if(!document.getElementsByClassName)document.getElementsByClassName=function(instanceMethods){function iter(name){return name.blank()?null:"[contains(concat(' ', @class, ' '), ' "+name+" ')]";}
instanceMethods.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(element,className){className=className.toString().strip();var cond=/\s/.test(className)?$w(className).map(iter).join(''):iter(className);return cond?document._getElementsByXPath('.//*'+cond,element):[];}:function(element,className){className=className.toString().strip();var elements=[],classNames=(/\s/.test(className)?$w(className):null);if(!classNames&&!className)return elements;var nodes=$(element).getElementsByTagName('*');className=' '+className+' ';for(var i=0,child,cn;child=nodes[i];i++){if(child.className&&(cn=' '+child.className+' ')&&(cn.include(className)||(classNames&&classNames.all(function(name){return!name.toString().blank()&&cn.include(' '+name+' ');}))))
elements.push(Element.extend(child));}
return elements;};return function(className,parentElement){return $(parentElement||document.body).getElementsByClassName(className);};}(Element.Methods);Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(element){this.element=$(element);},_each:function(iterator){this.element.className.split(/\s+/).select(function(name){return name.length>0;})._each(iterator);},set:function(className){this.element.className=className;},add:function(classNameToAdd){if(this.include(classNameToAdd))return;this.set($A(this).concat(classNameToAdd).join(' '));},remove:function(classNameToRemove){if(!this.include(classNameToRemove))return;this.set($A(this).without(classNameToRemove).join(' '));},toString:function(){return $A(this).join(' ');}};Object.extend(Element.ClassNames.prototype,Enumerable);Element.addMethods();;(function(){var rsplit=function(string,regex){var result=regex.exec(string),retArr=new Array(),first_idx,last_idx,first_bit;while(result!=null)
{first_idx=result.index;last_idx=regex.lastIndex;if((first_idx)!=0)
{first_bit=string.substring(0,first_idx);retArr.push(string.substring(0,first_idx));string=string.slice(first_idx);}
retArr.push(result[0]);string=string.slice(result[0].length);result=regex.exec(string);}
if(!string=='')
{retArr.push(string);}
return retArr;},chop=function(string){return string.substr(0,string.length-1);},extend=function(d,s){for(var n in s){if(s.hasOwnProperty(n))d[n]=s[n]}}
EJS=function(options){options=typeof options=="string"?{view:options}:options
this.set_options(options);if(options.precompiled){this.template={};this.template.process=options.precompiled;EJS.update(this.name,this);return;}
if(options.view){this.text=options.view;}
var template=new EJS.Compiler(this.text,this.type);template.compile(options,this.name);EJS.update(this.name,this);this.template=template;};EJS.prototype={render:function(object,extra_helpers){object=object||{};this._extra_helpers=extra_helpers;var v=new EJS.Helpers(object,extra_helpers||{});return this.template.process.call(object,object,v);},update:function(element,options){if(typeof element=='string'){element=document.getElementById(element)}
if(options==null){_template=this;return function(object){EJS.prototype.update.call(_template,element,object)}}
if(typeof options=='string'){params={}
params.url=options
_template=this;params.onComplete=function(request){var object=eval(request.responseText)
EJS.prototype.update.call(_template,element,object)}
EJS.ajax_request(params)}else
{element.innerHTML=this.render(options)}},out:function(){return this.template.out;},set_options:function(options){this.type=options.type||EJS.type;this.cache=options.cache!=null?options.cache:EJS.cache;this.text=options.text||null;this.name=options.name||null;this.ext=options.ext||EJS.ext;this.extMatch=new RegExp(this.ext.replace(/\./,'\.'));}};EJS.endExt=function(path,match){if(!path)return null;match.lastIndex=0
return path+(match.test(path)?'':this.ext)}
EJS.Scanner=function(source,left,right){extend(this,{left_delimiter:left+'%',right_delimiter:'%'+right,double_left:left+'%%',double_right:'%%'+right,left_equal:left+'%=',left_comment:left+'%#'})
this.SplitRegexp=left=='['?/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/:new RegExp('('+this.double_left+')|(%%'+this.double_right+')|('+this.left_equal+')|('+this.left_comment+')|('+this.left_delimiter+')|('+this.right_delimiter+'\n)|('+this.right_delimiter+')|(\n)');this.source=source;this.stag=null;this.lines=0;};EJS.Scanner.to_text=function(input){if(input==null||input===undefined)
return'';if(input instanceof Date)
return input.toDateString();if(input.toString)
return input.toString();return'';};EJS.Scanner.prototype={scan:function(block){scanline=this.scanline;regex=this.SplitRegexp;if(!this.source=='')
{var source_split=rsplit(this.source,/\n/);for(var i=0;i<source_split.length;i++){var item=source_split[i];this.scanline(item,regex,block);}}},scanline:function(line,regex,block){this.lines++;var line_split=rsplit(line,regex);for(var i=0;i<line_split.length;i++){var token=line_split[i];if(token!=null){try{block(token,this);}catch(e){throw{type:'EJS.Scanner',line:this.lines};}}}}};EJS.Buffer=function(pre_cmd,post_cmd){this.line=new Array();this.script="";this.pre_cmd=pre_cmd;this.post_cmd=post_cmd;for(var i=0;i<this.pre_cmd.length;i++)
{this.push(pre_cmd[i]);}};EJS.Buffer.prototype={push:function(cmd){this.line.push(cmd);},cr:function(){this.script=this.script+this.line.join('; ');this.line=new Array();this.script=this.script+"\n";},close:function(){if(this.line.length>0)
{for(var i=0;i<this.post_cmd.length;i++){this.push(pre_cmd[i]);}
this.script=this.script+this.line.join('; ');line=null;}}};EJS.Compiler=function(source,left){this.pre_cmd=['var ___ViewO = [];'];this.post_cmd=new Array();this.source=' ';if(source!=null)
{if(typeof source=='string')
{source=source.replace(/\r\n/g,"\n");source=source.replace(/\r/g,"\n");this.source=source;}else if(source.innerHTML){this.source=source.innerHTML;}
if(typeof this.source!='string'){this.source="";}}
left=left||'<';var right='>';switch(left){case'[':right=']';break;case'<':break;default:throw left+' is not a supported deliminator';break;}
this.scanner=new EJS.Scanner(this.source,left,right);this.out='';};EJS.Compiler.prototype={compile:function(options,name){options=options||{};this.out='';var put_cmd="___ViewO.push(";var insert_cmd=put_cmd;var buff=new EJS.Buffer(this.pre_cmd,this.post_cmd);var content='';var clean=function(content)
{content=content.replace(/\\/g,'\\\\');content=content.replace(/\n/g,'\\n');content=content.replace(/"/g,'\\"');return content;};this.scanner.scan(function(token,scanner){if(scanner.stag==null)
{switch(token){case'\n':content=content+"\n";buff.push(put_cmd+'"'+clean(content)+'");');buff.cr();content='';break;case scanner.left_delimiter:case scanner.left_equal:case scanner.left_comment:scanner.stag=token;if(content.length>0)
{buff.push(put_cmd+'"'+clean(content)+'")');}
content='';break;case scanner.double_left:content=content+scanner.left_delimiter;break;default:content=content+token;break;}}
else{switch(token){case scanner.right_delimiter:switch(scanner.stag){case scanner.left_delimiter:if(content[content.length-1]=='\n')
{content=chop(content);buff.push(content);buff.cr();}
else{buff.push(content);}
break;case scanner.left_equal:buff.push(insert_cmd+"(EJS.Scanner.to_text("+content+")))");break;}
scanner.stag=null;content='';break;case scanner.double_right:content=content+scanner.right_delimiter;break;default:content=content+token;break;}}});if(content.length>0)
{buff.push(put_cmd+'"'+clean(content)+'")');}
buff.close();this.out=buff.script+";";var to_be_evaled='/*'+name+'*/this.process = function(_CONTEXT,_VIEW) { try { with(_VIEW) { with (_CONTEXT) {'+this.out+" return ___ViewO.join('');}}}catch(e){e.lineNumber=null;throw e;}};";try{eval(to_be_evaled);}catch(e){if(typeof JSLINT!='undefined'){JSLINT(this.out);for(var i=0;i<JSLINT.errors.length;i++){var error=JSLINT.errors[i];if(error.reason!="Unnecessary semicolon."){error.line++;var e=new Error();e.lineNumber=error.line;e.message=error.reason;if(options.view)
e.fileName=options.view;throw e;}}}else{throw e;}}}};EJS.config=function(options){EJS.cache=options.cache!=null?options.cache:EJS.cache;EJS.type=options.type!=null?options.type:EJS.type;EJS.ext=options.ext!=null?options.ext:EJS.ext;var templates_directory=EJS.templates_directory||{};EJS.templates_directory=templates_directory;EJS.get=function(path,cache){if(cache==false)return null;if(templates_directory[path])return templates_directory[path];return null;};EJS.update=function(path,template){if(path==null)return;templates_directory[path]=template;};EJS.INVALID_PATH=-1;};EJS.config({cache:true,type:'<',ext:'.ejs'});EJS.Helpers=function(data,extras){this._data=data;this._extras=extras;extend(this,extras);};EJS.Helpers.prototype={view:function(options,data,helpers){if(!helpers)helpers=this._extras
if(!data)data=this._data;return new EJS(options).render(data,helpers);},to_text:function(input,null_text){if(input==null||input===undefined)return null_text||'';if(input instanceof Date)return input.toDateString();if(input.toString)return input.toString().replace(/\n/g,'<br />').replace(/''/g,"'");return'';}};EJS.newRequest=function(){var factories=[function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Microsoft.XMLHTTP");}];for(var i=0;i<factories.length;i++){try{var request=factories[i]();if(request!=null)return request;}
catch(e){continue;}}}
EJS.ajax_request=function(params){params.method=(params.method?params.method:'GET')
var request=new EJS.newRequest();request.onreadystatechange=function(){if(request.readyState==4){if(request.status==200){params.onComplete(request)}else
{params.onComplete(request)}}}
request.open(params.method,params.url)
request.send(null)}})();;(function(){var eventMatchers={'HTMLEvents':/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,'MouseEvents':/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/}
var defaultOptions={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true}
Event.simulate=function(element,eventName){var options=Object.extend(Object.clone(defaultOptions),arguments[2]||{});var oEvent,eventType=null;element=$(element);for(var name in eventMatchers){if(eventMatchers[name].test(eventName)){eventType=name;break;}}
if(!eventType)
throw new SyntaxError('Only HTMLEvents and MouseEvents interfaces are supported');if(document.createEvent){oEvent=document.createEvent(eventType);if(eventType=='HTMLEvents'){oEvent.initEvent(eventName,options.bubbles,options.cancelable);}
else{oEvent.initMouseEvent(eventName,options.bubbles,options.cancelable,document.defaultView,options.button,options.pointerX,options.pointerY,options.pointerX,options.pointerY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,element);}
element.dispatchEvent(oEvent);}
else{options.clientX=options.pointerX;options.clientY=options.pointerY;oEvent=Object.extend(document.createEventObject(),options);element.fireEvent('on'+eventName,oEvent);}
return element;}
Element.addMethods({simulate:Event.simulate});})();;function validateCreditCard(s){var v="0123456789";var w="";for(i=0;i<s.length;i++){x=s.charAt(i);if(v.indexOf(x,0)!=-1)
w+=x;}
j=w.length/2;k=Math.floor(j);m=Math.ceil(j)-k;c=0;for(i=0;i<k;i++){a=w.charAt(i*2+m)*2;c+=a>9?Math.floor(a/10+a%10):a;}
for(i=0;i<k+m;i++)c+=w.charAt(i*2+1-m)*1;return(c%10==0);};var Validator=Class.create();Validator.prototype={initialize:function(className,error,test,options){if(typeof test=='function'){this.options=$H(options);this._test=test;}else{this.options=$H(test);this._test=function(){return true};}
this.error=error||'Validation failed.';this.className=className;},test:function(v,elm){return(this._test(v,elm)&&this.options.all(function(p){return Validator.methods[p.key]?Validator.methods[p.key](v,elm,p.value):true;}));}}
Validator.methods={pattern:function(v,elm,opt){return Validation.get('IsEmpty').test(v)||opt.test(v)},minLength:function(v,elm,opt){return v.length>=opt},maxLength:function(v,elm,opt){return v.length<=opt},min:function(v,elm,opt){return v>=parseFloat(opt)},max:function(v,elm,opt){return v<=parseFloat(opt)},notOneOf:function(v,elm,opt){return $A(opt).all(function(value){return v!=value;})},oneOf:function(v,elm,opt){return $A(opt).any(function(value){return v==value;})},is:function(v,elm,opt){return v==opt},isNot:function(v,elm,opt){return v!=opt},equalToField:function(v,elm,opt){return v==$F(opt)},notEqualToField:function(v,elm,opt){return v!=$F(opt)},include:function(v,elm,opt){return $A(opt).all(function(value){return Validation.get(value).test(v,elm);})}}
var Validation=Class.create();Validation.defaultOptions={onSubmit:true,stopOnFirst:false,immediate:false,focusOnError:true,useTitles:false,addClassNameToContainer:false,containerClassName:'.input-box',onFormValidate:function(result,form){},onElementValidate:function(result,elm){if(!result){if(elm.hasAttribute('track-handler')){var message=elm.next().innerHTML;var title=elm.getAttribute('title');if(title==null){var title=elm.up().previous().textContent;}
window.checkoutTracker.trackError(title,message);}}}};Validation.prototype={initialize:function(form,options){this.form=$(form);if(!this.form){return;}
this.options=Object.extend({onSubmit:Validation.defaultOptions.onSubmit,stopOnFirst:Validation.defaultOptions.stopOnFirst,immediate:Validation.defaultOptions.immediate,focusOnError:Validation.defaultOptions.focusOnError,useTitles:Validation.defaultOptions.useTitles,onFormValidate:Validation.defaultOptions.onFormValidate,onElementValidate:Validation.defaultOptions.onElementValidate},options||{});if(this.options.onSubmit)Event.observe(this.form,'submit',this.onSubmit.bind(this),false);if(this.options.immediate){Form.getElements(this.form).each(function(input){if(input.tagName.toLowerCase()=='select'){Event.observe(input,'blur',this.onChange.bindAsEventListener(this));}
if(input.type.toLowerCase()=='radio'||input.type.toLowerCase()=='checkbox'){Event.observe(input,'click',this.onChange.bindAsEventListener(this));}else{Event.observe(input,'change',this.onChange.bindAsEventListener(this));}},this);}},onChange:function(ev){Validation.isOnChange=true;Validation.validate(Event.element(ev),{useTitle:this.options.useTitles,onElementValidate:this.options.onElementValidate});Validation.isOnChange=false;},onSubmit:function(ev){if(!this.validate())Event.stop(ev);},validate:function(){var result=false;var useTitles=this.options.useTitles;var callback=this.options.onElementValidate;try{if(this.options.stopOnFirst){result=Form.getElements(this.form).all(function(elm){if(elm.hasClassName('local-validation')&&!this.isElementInForm(elm,this.form)){return true;}
return Validation.validate(elm,{useTitle:useTitles,onElementValidate:callback});},this);}else{result=Form.getElements(this.form).collect(function(elm){if(elm.hasClassName('local-validation')&&!this.isElementInForm(elm,this.form)){return true;}
return Validation.validate(elm,{useTitle:useTitles,onElementValidate:callback});},this).all();}}catch(e){}
if(!result&&this.options.focusOnError){try{Form.getElements(this.form).findAll(function(elm){return $(elm).hasClassName('validation-failed')}).first().focus()}
catch(e){}}
this.options.onFormValidate(result,this.form);return result;},reset:function(){Form.getElements(this.form).each(Validation.reset);},isElementInForm:function(elm,form){var domForm=elm.up('form');if(domForm==form){return true;}
return false;}}
Object.extend(Validation,{validate:function(elm,options){options=Object.extend({useTitle:false,onElementValidate:function(result,elm){}},options||{});elm=$(elm);var cn=$w(elm.className);return result=cn.all(function(value){var test=Validation.test(value,elm,options.useTitle);options.onElementValidate(test,elm);return test;});},insertAdvice:function(elm,advice){var container=$(elm).up('.field-row');var reg=/(field-row)/;var regTd=/(value)/;if(container&&reg.test(container.getAttribute('class'))){Element.insert(container,{after:advice});}else if(elm.up('td.value')&&(regTd.test(elm.up('td.value').getAttribute('class')&&elm.up('td.value').tagName.toUpperCase()=='TD'))){elm.up('td.value').insert({bottom:advice});}else if(elm.advaiceContainer&&$(elm.advaiceContainer)){$(elm.advaiceContainer).update(advice);}
else{switch(elm.type.toLowerCase()){case'checkbox':case'radio':var p=elm.parentNode;if(p){Element.insert(p,{'bottom':advice});}else{Element.insert(elm,{'after':advice});}
break;default:Element.insert(elm,{'after':advice});}}},showAdvice:function(elm,advice,adviceName){if(!elm.advices){elm.advices=new Hash();}
else{elm.advices.each(function(pair){if(!advice||pair.value.id!=advice.id){this.hideAdvice(elm,pair.value);}}.bind(this));}
elm.advices.set(adviceName,advice);if(typeof Effect=='undefined'){advice.style.display='block';}else{if(!advice._adviceAbsolutize){new Effect.Appear(advice,{duration:1});}else{Position.absolutize(advice);advice.show();advice.setStyle({'top':advice._adviceTop,'left':advice._adviceLeft,'width':advice._adviceWidth,'z-index':1000});advice.addClassName('advice-absolute');}}},hideAdvice:function(elm,advice){if(advice!=null){new Effect.Fade(advice,{duration:1,afterFinishInternal:function(){advice.hide();}});}},updateCallback:function(elm,status){if(typeof elm.callbackFunction!='undefined'){eval(elm.callbackFunction+'(\''+elm.id+'\',\''+status+'\')');}},ajaxError:function(elm,errorMsg){var name='validate-ajax';var advice=Validation.getAdvice(name,elm);if(advice==null){advice=this.createAdvice(name,elm,false,errorMsg);}
this.showAdvice(elm,advice,'validate-ajax');this.updateCallback(elm,'failed');elm.addClassName('validation-failed');elm.addClassName('validate-ajax');if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=''){var container=elm.up(Validation.defaultOptions.containerClassName);if(container&&this.allowContainerClassName(elm)){container.removeClassName('validation-passed');container.addClassName('validation-error');}}},allowContainerClassName:function(elm){if(elm.type=='radio'||elm.type=='checkbox'){return elm.hasClassName('change-container-classname');}
return true;},test:function(name,elm,useTitle){var v=Validation.get(name);var prop='__advice'+name.camelize();try{if(Validation.isVisible(elm)&&!v.test($F(elm),elm)){var advice=Validation.getAdvice(name,elm);if(advice==null){advice=this.createAdvice(name,elm,useTitle);}
this.showAdvice(elm,advice,name);this.updateCallback(elm,'failed');elm[prop]=1;if(!elm.advaiceContainer){elm.removeClassName('validation-passed');elm.addClassName('validation-failed');}
if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=''){var container=elm.up(Validation.defaultOptions.containerClassName);if(container&&this.allowContainerClassName(elm)){container.removeClassName('validation-passed');container.addClassName('validation-error');}}
return false;}else{var advice=Validation.getAdvice(name,elm);this.hideAdvice(elm,advice);this.updateCallback(elm,'passed');elm[prop]='';elm.removeClassName('validation-failed');elm.addClassName('validation-passed');if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=''){var container=elm.up(Validation.defaultOptions.containerClassName);if(container&&!container.down('.validation-failed')&&this.allowContainerClassName(elm)){if(!Validation.get('IsEmpty').test(elm.value)||!this.isVisible(elm)){container.addClassName('validation-passed');}else{container.removeClassName('validation-passed');}
container.removeClassName('validation-error');}}
return true;}}catch(e){throw(e)}},isVisible:function(elm){while(elm.tagName!='BODY'){if(!$(elm).visible())return false;elm=elm.parentNode;}
return true;},getAdvice:function(name,elm){try{advice=jQuery(elm).closest('form').find('#advice-'+name+'-'+Validation.getElmID(elm)).first()||jQuery(elm).closest('form').find('#advice-'+Validation.getElmID(elm)).first();return(advice.length)?advice[0]:null;}catch(e){return $('advice-'+name+'-'+Validation.getElmID(elm))||$('advice-'+Validation.getElmID(elm));}},createAdvice:function(name,elm,useTitle,customError){var v=Validation.get(name);var errorMsg=useTitle?((elm&&elm.title)?elm.title:v.error):v.error;if(customError){errorMsg=customError;}
try{if(Translator){errorMsg=Translator.translate(errorMsg);}}
catch(e){}
advice='<div class="validation-advice" id="advice-'+name+'-'+Validation.getElmID(elm)+'" style="display:none">'+errorMsg+'</div>'
Validation.insertAdvice(elm,advice);advice=Validation.getAdvice(name,elm);if($(elm).hasClassName('absolute-advice')){var dimensions=$(elm).getDimensions();var originalPosition=Position.cumulativeOffset(elm);advice._adviceTop=(originalPosition[1]+dimensions.height)+'px';advice._adviceLeft=(originalPosition[0])+'px';advice._adviceWidth=(dimensions.width)+'px';advice._adviceAbsolutize=true;}
return advice;},getElmID:function(elm){return elm.id?elm.id:elm.name;},reset:function(elm){elm=$(elm);var cn=$w(elm.className);cn.each(function(value){var prop='__advice'+value.camelize();if(elm[prop]){var advice=Validation.getAdvice(value,elm);if(advice){advice.hide();}
elm[prop]='';}
elm.removeClassName('validation-failed');elm.removeClassName('validation-passed');if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=''){var container=elm.up(Validation.defaultOptions.containerClassName);if(container){container.removeClassName('validation-passed');container.removeClassName('validation-error');}}});},add:function(className,error,test,options){var nv={};nv[className]=new Validator(className,error,test,options);Object.extend(Validation.methods,nv);},addAllThese:function(validators){var nv={};$A(validators).each(function(value){nv[value[0]]=new Validator(value[0],value[1],value[2],(value.length>3?value[3]:{}));});Object.extend(Validation.methods,nv);},get:function(name){return Validation.methods[name]?Validation.methods[name]:Validation.methods['_LikeNoIDIEverSaw_'];},methods:{'_LikeNoIDIEverSaw_':new Validator('_LikeNoIDIEverSaw_','',{})}});Validation.add('IsEmpty','',function(v){return(v==''||(v==null)||(v.length==0)||/^\s+$/.test(v));});Validation.addAllThese([['validate-select','Please select an option.',function(v){return((v!="none")&&(v!=null)&&(v.length!=0));}],['required-entry','This is a required field.',function(v){return!Validation.get('IsEmpty').test(v);}],['validate-number','Please enter a valid number in this field.',function(v){return Validation.get('IsEmpty').test(v)||(!isNaN(parseNumber(v))&&!/^\s+$/.test(parseNumber(v)));}],['validate-digits','Please use numbers only in this field. Please avoid spaces or other characters such as dots or commas.',function(v){return Validation.get('IsEmpty').test(v)||!/[^\d]/.test(v);}],['validate-digits-range','The value is not within the specified range.',function(v,elm){var result=Validation.get('IsEmpty').test(v)||!/[^\d]/.test(v);var reRange=new RegExp(/^digits-range-[0-9]+-[0-9]+$/);$w(elm.className).each(function(name,index){if(name.match(reRange)&&result){var min=parseInt(name.split('-')[2],10);var max=parseInt(name.split('-')[3],10);var val=parseInt(v,10);result=(v>=min)&&(v<=max);}});return result;}],['validate-alpha','Please use letters only (a-z or A-Z) in this field.',function(v){return Validation.get('IsEmpty').test(v)||/^[a-zA-Z]+$/.test(v)}],['validate-code','Please use only letters (a-z), numbers (0-9) or underscore(_) in this field, first character should be a letter.',function(v){return Validation.get('IsEmpty').test(v)||/^[a-z]+[a-z0-9_]+$/.test(v)}],['validate-alphanum','Please use only letters (a-z or A-Z) or numbers (0-9) only in this field. No spaces or other characters are allowed.',function(v){return Validation.get('IsEmpty').test(v)||/^[a-zA-Z0-9]+$/.test(v)

}],['validate-street','Please use only letters (a-z or A-Z) or numbers (0-9) or spaces and # only in this field.',function(v){return Validation.get('IsEmpty').test(v)||/^[ \w]{3,}([A-Za-z]\.)?([ \w]*\#\d+)?(\r\n| )[ \w]{3,}/.test(v)}],['validate-phoneStrict','Please enter a valid phone number. For example (123) 456-7890 or 123-456-7890.',function(v){return Validation.get('IsEmpty').test(v)||/^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/.test(v);}],['validate-phoneLax','Please enter a valid phone number. For example (123) 456-7890 or 123-456-7890.',function(v){return Validation.get('IsEmpty').test(v)||/^((\d[-. ]?)?((\(\d{3}\))|\d{3}))?[-. ]?\d{3}[-. ]?\d{4}$/.test(v);}],['validate-fax','Please enter a valid fax number. For example (123) 456-7890 or 123-456-7890.',function(v){return Validation.get('IsEmpty').test(v)||/^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/.test(v);}],['validate-date','Please enter a valid date.',function(v){var test=new Date(v);return Validation.get('IsEmpty').test(v)||!isNaN(test);}],['validate-email','Please enter a valid email address. For example johndoe@domain.com.',function(v){return Validation.get('IsEmpty').test(v)||/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i.test(v)}],['validate-emailSender','Please use only visible characters and spaces.',function(v){return Validation.get('IsEmpty').test(v)||/^[\S ]+$/.test(v)}],['validate-password','Please enter 6 or more characters. Leading or trailing spaces will be ignored.',function(v){var pass=v.strip();return!(pass.length>0&&pass.length<6);}],['validate-admin-password','Please enter 7 or more characters. Password should contain both numeric and alphabetic characters.',function(v){var pass=v.strip();if(0==pass.length){return true;}
if(!(/[a-z]/i.test(v))||!(/[0-9]/.test(v))){return false;}
return!(pass.length<7);}],['validate-cpassword','Please make sure your passwords match.',function(v){var conf=$('confirmation')?$('confirmation'):$$('.validate-cpassword')[0];var pass=false;if($('password')){pass=$('password');}
var passwordElements=$$('.validate-password');var confGroup=false;conf.classNames().each(function(item){if(item.substr(0,4)=='vpg-'){confGroup=item;}})
for(var i=0;i<passwordElements.size();i++){var passwordElement=passwordElements[i];if(confGroup&&passwordElement.hasClassName(confGroup)){pass=passwordElement;}
else if(!confGroup&&passwordElement.up('form').id==conf.up('form').id){pass=passwordElement;}}
if($$('.validate-admin-password').size()){pass=$$('.validate-admin-password')[0];}
return(pass.value==conf.value);}],['validate-url','Please enter a valid URL. Protocol is required (http://, https:// or ftp://)',function(v){return Validation.get('IsEmpty').test(v)||/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(v)}],['validate-clean-url','Please enter a valid URL. For example http://www.example.com or www.example.com',function(v){return Validation.get('IsEmpty').test(v)||/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+.(com|org|net|dk|at|us|tv|info|uk|co.uk|biz|se)$)(:(\d+))?\/?/i.test(v)||/^(www)((\.[A-Z0-9][A-Z0-9_-]*)+.(com|org|net|dk|at|us|tv|info|uk|co.uk|biz|se)$)(:(\d+))?\/?/i.test(v)}],['validate-identifier','Please enter a valid URL Key. For example "example-page", "example-page.html" or "anotherlevel/example-page".',function(v){return Validation.get('IsEmpty').test(v)||/^[a-z0-9][a-z0-9_\/-]+(\.[a-z0-9_-]+)?$/.test(v)}],['validate-xml-identifier','Please enter a valid XML-identifier. For example something_1, block5, id-4.',function(v){return Validation.get('IsEmpty').test(v)||/^[A-Z][A-Z0-9_\/-]*$/i.test(v)}],['validate-ssn','Please enter a valid social security number. For example 123-45-6789.',function(v){return Validation.get('IsEmpty').test(v)||/^\d{3}-?\d{2}-?\d{4}$/.test(v);}],['validate-zip','Please enter a valid zip code. For example 90602 or 90602-1234.',function(v){return Validation.get('IsEmpty').test(v)||/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(v);}],['validate-zip-international','Please enter a valid zip code.',function(v){return true;}],['validate-date-au','Please use this date format: dd/mm/yyyy. For example 17/03/2006 for the 17th of March, 2006.',function(v){if(Validation.get('IsEmpty').test(v))return true;var regex=/^(\d{2})\/(\d{2})\/(\d{4})$/;if(!regex.test(v))return false;var d=new Date(v.replace(regex,'$2/$1/$3'));return(parseInt(RegExp.$2,10)==(1+d.getMonth()))&&(parseInt(RegExp.$1,10)==d.getDate())&&(parseInt(RegExp.$3,10)==d.getFullYear());}],['validate-currency-dollar','Please enter a valid $ amount. For example $100.00.',function(v){return Validation.get('IsEmpty').test(v)||/^\$?\-?([1-9]{1}[0-9]{0,2}(\,[0-9]{3})*(\.[0-9]{0,2})?|[1-9]{1}\d*(\.[0-9]{0,2})?|0(\.[0-9]{0,2})?|(\.[0-9]{1,2})?)$/.test(v)}],['validate-one-required','Please select one of the above options.',function(v,elm){var p=elm.parentNode;var options=p.getElementsByTagName('INPUT');return $A(options).any(function(elm){return $F(elm);});}],['validate-one-required-by-name','Please select one of the options.',function(v,elm){var inputs=$$('input[name="'+elm.name.replace(/([\\"])/g,'\\$1')+'"]');var error=1;for(var i=0;i<inputs.length;i++){if((inputs[i].type=='checkbox'||inputs[i].type=='radio')&&inputs[i].checked==true){error=0;}
if(Validation.isOnChange&&(inputs[i].type=='checkbox'||inputs[i].type=='radio')){Validation.reset(inputs[i]);}}
if(error==0){return true;}else{return false;}}],['validate-not-negative-number','Please enter a valid number in this field.',function(v){v=parseNumber(v);return(!isNaN(v)&&v>=0);}],['validate-state','Please select State/Province.',function(v){return(v!=0||v=='');}],['validate-new-password','Please enter 6 or more characters. Leading or trailing spaces will be ignored.',function(v){if(!Validation.get('validate-password').test(v))return false;if(Validation.get('IsEmpty').test(v)&&v!='')return false;return true;}],['validate-greater-than-zero','Please enter a number greater than 0 in this field.',function(v){if(v.length)
return parseFloat(v)>0;else
return true;}],['validate-zero-or-greater','Please enter a number 0 or greater in this field.',function(v){if(v.length)
return parseFloat(v)>=0;else
return true;}],['validate-cc-number','Please enter a valid credit card number.',function(v,elm){var ccTypeContainer=$(elm.id.substr(0,elm.id.indexOf('_cc_number'))+'_cc_type');if(ccTypeContainer&&typeof Validation.creditCartTypes.get(ccTypeContainer.value)!='undefined'&&Validation.creditCartTypes.get(ccTypeContainer.value)[2]==false){if(!Validation.get('IsEmpty').test(v)&&Validation.get('validate-digits').test(v)){return true;}else{return false;}}
return validateCreditCard(v);}],['validate-cc-type','Credit card number does not match credit card type.',function(v,elm){elm.value=removeDelimiters(elm.value);v=removeDelimiters(v);var ccTypeContainer=$(elm.id.substr(0,elm.id.indexOf('_cc_number'))+'_cc_type');if(!ccTypeContainer){return true;}
var ccType=ccTypeContainer.value;if(typeof Validation.creditCartTypes.get(ccType)=='undefined'){return false;}
if(Validation.creditCartTypes.get(ccType)[0]==false){return true;}
var ccMatchedType='';Validation.creditCartTypes.each(function(pair){if(pair.value[0]&&v.match(pair.value[0])){ccMatchedType=pair.key;throw $break;}});if(ccMatchedType!=ccType){return false;}
if(ccTypeContainer.hasClassName('validation-failed')&&Validation.isOnChange){Validation.validate(ccTypeContainer);}
return true;}],['validate-cc-type-select','Card type does not match credit card number.',function(v,elm){var ccNumberContainer=$(elm.id.substr(0,elm.id.indexOf('_cc_type'))+'_cc_number');if(Validation.isOnChange&&Validation.get('IsEmpty').test(ccNumberContainer.value)){return true;}
if(Validation.get('validate-cc-type').test(ccNumberContainer.value,ccNumberContainer)){Validation.validate(ccNumberContainer);}
return Validation.get('validate-cc-type').test(ccNumberContainer.value,ccNumberContainer);}],['validate-cc-exp','Incorrect credit card expiration date.',function(v,elm){var ccExpMonth=v;var ccExpYear=$(elm.id.substr(0,elm.id.indexOf('_expiration'))+'_expiration_yr').value;var currentTime=new Date();var currentMonth=currentTime.getMonth()+1;var currentYear=currentTime.getFullYear();if(ccExpMonth<currentMonth&&ccExpYear==currentYear){return false;}
return true;}],['validate-cc-cvn','Please enter a valid credit card verification number.',function(v,elm){var ccTypeContainer=$(elm.id.substr(0,elm.id.indexOf('_cc_cid'))+'_cc_type');if(!ccTypeContainer){return true;}
var ccType=ccTypeContainer.value;if(typeof Validation.creditCartTypes.get(ccType)=='undefined'){return false;}
var re=Validation.creditCartTypes.get(ccType)[1];if(v.match(re)){return true;}
return false;}],['validate-ajax','',function(v,elm){return true;}],['validate-data','Please use only letters (a-z or A-Z), numbers (0-9) or underscore(_) in this field, first character should be a letter.',function(v){if(v!=''&&v){return /^[A-Za-z]+[A-Za-z0-9_]+$/.test(v);}
return true;}],['validate-css-length','Please input a valid CSS-length. For example 100px or 77pt or 20em or .5ex or 50%.',function(v){if(v!=''&&v){return /^[0-9\.]+(px|pt|em|ex|%)?$/.test(v)&&(!(/\..*\./.test(v)))&&!(/\.$/.test(v));}
return true;}],['validate-length','Text length does not satisfy specified text range.',function(v,elm){var reMax=new RegExp(/^maximum-length-[0-9]+$/);var reMin=new RegExp(/^minimum-length-[0-9]+$/);var result=true;$w(elm.className).each(function(name,index){if(name.match(reMax)&&result){var length=name.split('-')[2];result=(v.length<=length);}
if(name.match(reMin)&&result&&!Validation.get('IsEmpty').test(v)){var length=name.split('-')[2];result=(v.length>=length);}});return result;}],['validate-percents','Please enter a number lower than 100.',{max:100}],['required-file',' ',function(v,elm){var result=!Validation.get('IsEmpty').test(v);if(result===false){ovId=elm.id+'_value';if($(ovId)){result=!Validation.get('IsEmpty').test($(ovId).value);}}
return result;}],['validate-cc-ukss','Please enter issue number or start date for switch/solo card type.',function(v,elm){var endposition;if(elm.id.match(/(.)+_cc_issue$/)){endposition=elm.id.indexOf('_cc_issue');}else if(elm.id.match(/(.)+_start_month$/)){endposition=elm.id.indexOf('_start_month');}else{endposition=elm.id.indexOf('_start_year');}
var prefix=elm.id.substr(0,endposition);var ccTypeContainer=$(prefix+'_cc_type');if(!ccTypeContainer){return true;}
var ccType=ccTypeContainer.value;if(['SS','SM','SO'].indexOf(ccType)==-1){return true;}
$(prefix+'_cc_issue').advaiceContainer=$(prefix+'_start_month').advaiceContainer=$(prefix+'_start_year').advaiceContainer=$(prefix+'_cc_type_ss_div').down('ul li.adv-container');var ccIssue=$(prefix+'_cc_issue').value;var ccSMonth=$(prefix+'_start_month').value;var ccSYear=$(prefix+'_start_year').value;var ccStartDatePresent=(ccSMonth&&ccSYear)?true:false;if(!ccStartDatePresent&&!ccIssue){return false;}
return true;}],['required-unique','Value this field must by unique.',function(v,elm){var elements=$$('.required-unique');for(var i in elements){if(elements[i].id!=elm.id){var ev=elements[i].value;if(typeof(ev)=='undefined'){continue;}
ev=ev.trim();v=v.trim();if(ev.toLowerCase()==v.toLowerCase()){return false;}}}
return true;}]]);function removeDelimiters(v){v=v.replace(/\s/g,'');v=v.replace(/\-/g,'');return v;}
function parseNumber(v)
{if(typeof v!='string'){return parseFloat(v);}
var isDot=v.indexOf('.');var isComa=v.indexOf(',');if(isDot!=-1&&isComa!=-1){if(isComa>isDot){v=v.replace('.','').replace(',','.');}
else{v=v.replace(',','');}}
else if(isComa!=-1){v=v.replace(',','.');}
return parseFloat(v);}
Validation.creditCartTypes=$H({'SO':[new RegExp('^(6334[5-9]([0-9]{11}|[0-9]{13,14}))|(6767([0-9]{12}|[0-9]{14,15}))$'),new RegExp('^([0-9]{3}|[0-9]{4})?$'),true],'SM':[new RegExp('(^(5[0678])[0-9]{11,18}$)|(^(6[^05])[0-9]{11,18}$)|(^(601)[^1][0-9]{9,16}$)|(^(6011)[0-9]{9,11}$)|(^(6011)[0-9]{13,16}$)|(^(65)[0-9]{11,13}$)|(^(65)[0-9]{15,18}$)|(^(49030)[2-9]([0-9]{10}$|[0-9]{12,13}$))|(^(49033)[5-9]([0-9]{10}$|[0-9]{12,13}$))|(^(49110)[1-2]([0-9]{10}$|[0-9]{12,13}$))|(^(49117)[4-9]([0-9]{10}$|[0-9]{12,13}$))|(^(49118)[0-2]([0-9]{10}$|[0-9]{12,13}$))|(^(4936)([0-9]{12}$|[0-9]{14,15}$))'),new RegExp('^([0-9]{3}|[0-9]{4})?$'),true],'VI':[new RegExp('^4[0-9]{12}([0-9]{3})?$'),new RegExp('^[0-9]{3}$'),true],'MC':[new RegExp('^5[1-5][0-9]{14}$'),new RegExp('^[0-9]{3}$'),true],'AE':[new RegExp('^3[47][0-9]{13}$'),new RegExp('^[0-9]{4}$'),true],'DI':[new RegExp('^6011[0-9]{12}$'),new RegExp('^[0-9]{3}$'),true],'JCB':[new RegExp('^(3[0-9]{15}|(2131|1800)[0-9]{11})$'),new RegExp('^[0-9]{4}$'),true],'OT':[false,new RegExp('^([0-9]{3}|[0-9]{4})?$'),false]});;var Builder={NODEMAP:{AREA:'map',CAPTION:'table',COL:'table',COLGROUP:'table',LEGEND:'fieldset',OPTGROUP:'select',OPTION:'select',PARAM:'object',TBODY:'table',TD:'table',TFOOT:'table',TH:'table',THEAD:'table',TR:'table'},node:function(elementName){elementName=elementName.toUpperCase();var parentTag=this.NODEMAP[elementName]||'div';var parentElement=document.createElement(parentTag);try{parentElement.innerHTML="<"+elementName+"></"+elementName+">";}catch(e){}
var element=parentElement.firstChild||null;if(element&&(element.tagName.toUpperCase()!=elementName))
element=element.getElementsByTagName(elementName)[0];if(!element)element=document.createElement(elementName);if(!element)return;if(arguments[1])
if(this._isStringOrNumber(arguments[1])||(arguments[1]instanceof Array)||arguments[1].tagName){this._children(element,arguments[1]);}else{var attrs=this._attributes(arguments[1]);if(attrs.length){try{parentElement.innerHTML="<"+elementName+" "+
attrs+"></"+elementName+">";}catch(e){}
element=parentElement.firstChild||null;if(!element){element=document.createElement(elementName);for(attr in arguments[1])
element[attr=='class'?'className':attr]=arguments[1][attr];}
if(element.tagName.toUpperCase()!=elementName)
element=parentElement.getElementsByTagName(elementName)[0];}}
if(arguments[2])
this._children(element,arguments[2]);return $(element);},_text:function(text){return document.createTextNode(text);},ATTR_MAP:{'className':'class','htmlFor':'for'},_attributes:function(attributes){var attrs=[];for(attribute in attributes)
attrs.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+attributes[attribute].toString().escapeHTML().gsub(/"/,'&quot;')+'"');return attrs.join(" ");},_children:function(element,children){if(children.tagName){element.appendChild(children);return;}
if(typeof children=='object'){children.flatten().each(function(e){if(typeof e=='object')
element.appendChild(e);else
if(Builder._isStringOrNumber(e))
element.appendChild(Builder._text(e));});}else
if(Builder._isStringOrNumber(children))
element.appendChild(Builder._text(children));},_isStringOrNumber:function(param){return(typeof param=='string'||typeof param=='number');},build:function(html){var element=this.node('div');$(element).update(html.strip());return element.down();},dump:function(scope){if(typeof scope!='object'&&typeof scope!='function')scope=window;var tags=("A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY "+"BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET "+"FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX "+"KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P "+"PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD "+"TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR").split(/\s+/);tags.each(function(tag){scope[tag]=function(){return Builder.node.apply(Builder,[tag].concat($A(arguments)));};});}};;String.prototype.parseColor=function(){var color='#';if(this.slice(0,4)=='rgb('){var cols=this.slice(4,this.length-1).split(',');var i=0;do{color+=parseInt(cols[i]).toColorPart()}while(++i<3);}else{if(this.slice(0,1)=='#'){if(this.length==4)for(var i=1;i<4;i++)color+=(this.charAt(i)+this.charAt(i)).toLowerCase();if(this.length==7)color=this.toLowerCase();}}
return(color.length==7?color:(arguments[0]||this));};Element.collectTextNodes=function(element){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:(node.hasChildNodes()?Element.collectTextNodes(node):''));}).flatten().join('');};Element.collectTextNodesIgnoreClass=function(element,className){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:((node.hasChildNodes()&&!Element.hasClassName(node,className))?Element.collectTextNodesIgnoreClass(node,className):''));}).flatten().join('');};Element.setContentZoom=function(element,percent){element=$(element);element.setStyle({fontSize:(percent/100)+'em'});if(Prototype.Browser.WebKit)window.scrollBy(0,0);return element;};Element.getInlineOpacity=function(element){return $(element).style.opacity||'';};Element.forceRerendering=function(element){try{element=$(element);var n=document.createTextNode(' ');element.appendChild(n);element.removeChild(n);}catch(e){}};var Effect={_elementDoesNotExistError:{name:'ElementDoesNotExistError',message:'The specified DOM element does not exist, but is required for this effect to operate'},Transitions:{linear:Prototype.K,sinoidal:function(pos){return(-Math.cos(pos*Math.PI)/2)+.5;},reverse:function(pos){return 1-pos;},flicker:function(pos){var pos=((-Math.cos(pos*Math.PI)/4)+.75)+Math.random()/4;return pos>1?1:pos;},wobble:function(pos){return(-Math.cos(pos*Math.PI*(9*pos))/2)+.5;},pulse:function(pos,pulses){return(-Math.cos((pos*((pulses||5)-.5)*2)*Math.PI)/2)+.5;},spring:function(pos){return 1-(Math.cos(pos*4.5*Math.PI)*Math.exp(-pos*6));},none:function(pos){return 0;},full:function(pos){return 1;}},DefaultOptions:{duration:1.0,fps:100,sync:false,from:0.0,to:1.0,delay:0.0,queue:'parallel'},tagifyText:function(element){var tagifyStyle='position:relative';if(Prototype.Browser.IE)tagifyStyle+=';zoom:1';element=$(element);$A(element.childNodes).each(function(child){if(child.nodeType==3){child.nodeValue.toArray().each(function(character){element.insertBefore(new Element('span',{style:tagifyStyle}).update(character==' '?String.fromCharCode(160):character),child);});Element.remove(child);}});},multiple:function(element,effect){var elements;if(((typeof element=='object')||Object.isFunction(element))&&(element.length))
elements=element;else
elements=$(element).childNodes;var options=Object.extend({speed:0.1,delay:0.0},arguments[2]||{});var masterDelay=options.delay;$A(elements).each(function(element,index){new effect(element,Object.extend(options,{delay:index*options.speed+masterDelay}));});},PAIRS:{'slide':['SlideDown','SlideUp'],'blind':['BlindDown','BlindUp'],'appear':['Appear','Fade']},toggle:function(element,effect){element=$(element);effect=(effect||'appear').toLowerCase();var options=Object.extend({queue:{position:'end',scope:(element.id||'global'),limit:1}},arguments[2]||{});Effect[element.visible()?Effect.PAIRS[effect][1]:Effect.PAIRS[effect][0]](element,options);}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null;},_each:function(iterator){this.effects._each(iterator);},add:function(effect){var timestamp=new Date().getTime();var position=Object.isString(effect.options.queue)?effect.options.queue:effect.options.queue.position;switch(position){case'front':this.effects.findAll(function(e){return e.state=='idle'}).each(function(e){e.startOn+=effect.finishOn;e.finishOn+=effect.finishOn;});break;case'with-last':timestamp=this.effects.pluck('startOn').max()||timestamp;break;case'end':timestamp=this.effects.pluck('finishOn').max()||timestamp;break;}
effect.startOn+=timestamp;effect.finishOn+=timestamp;if(!effect.options.queue.limit||(this.effects.length<effect.options.queue.limit))
this.effects.push(effect);if(!this.interval)
this.interval=setInterval(this.loop.bind(this),15);},remove:function(effect){this.effects=this.effects.reject(function(e){return e==effect});if(this.effects.length==0){clearInterval(this.interval);this.interval=null;}},loop:function(){var timePos=new Date().getTime();for(var i=0,len=this.effects.length;i<len;i++)
this.effects[i]&&this.effects[i].loop(timePos);}});Effect.Queues={instances:$H(),get:function(queueName){if(!Object.isString(queueName))return queueName;return this.instances.get(queueName)||this.instances.set(queueName,new Effect.ScopedQueue());}};Effect.Queue=Effect.Queues.get('global');Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+'Internal']?'this.options.'+eventName+'Internal(this);':'')+
(options[eventName]?'this.options.'+eventName+'(this);':''));}
if(options&&options.transition===false)options.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state='idle';this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function dispatch(effect,eventName){if(effect.options[eventName+'Internal'])
effect.options[eventName+'Internal'](effect);if(effect.options[eventName])
effect.options[eventName](effect);}
return function(pos){if(this.state==="idle"){this.state="running";dispatch(this,'beforeSetup');if(this.setup)this.setup();dispatch(this,'afterSetup');}
if(this.state==="running"){pos=(this.options.transition(pos)*this.fromToDelta)+this.options.from;this.position=pos;dispatch(this,'beforeUpdate');if(this.update)this.update(pos);dispatch(this,'afterUpdate');}};})();this.event('beforeStart');if(!this.options.sync)
Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).add(this);},loop:function(timePos){if(timePos>=this.startOn){if(timePos>=this.finishOn){this.render(1.0);this.cancel();this.event('beforeFinish');if(this.finish)this.finish();this.event('afterFinish');return;}
var pos=(timePos-this.startOn)/this.totalTime,frame=(pos*this.totalFrames).round();if(frame>this.currentFrame){this.render(pos);this.currentFrame=frame;}}},cancel:function(){if(!this.options.sync)
Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).remove(this);this.state='finished';},event:function(eventName){if(this.options[eventName+'Internal'])this.options[eventName+'Internal'](this);if(this.options[eventName])this.options[eventName](this);},inspect:function(){var data=$H();for(property in this)
if(!Object.isFunction(this[property]))data.set(property,this[property]);return'#<Effect:'+data.inspect()+',options:'+$H(this.options).inspect()+'>';}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(effects){this.effects=effects||[];this.start(arguments[1]);},update:function(position){this.effects.invoke('render',position);},finish:function(position){this.effects.each(function(effect){effect.render(1.0);effect.cancel();effect.event('beforeFinish');if(effect.finish)effect.finish(position);effect.event('afterFinish');});}});Effect.Tween=Class.create(Effect.Base,{initialize:function(object,from,to){object=Object.isString(object)?$(object):object;var args=$A(arguments),method=args.last(),options=args.length==5?args[3]:null;this.method=Object.isFunction(method)?method.bind(object):Object.isFunction(object[method])?object[method].bind(object):function(value){object[method]=value};this.start(Object.extend({from:from,to:to},options||{}));},update:function(position){this.method(position);}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}));},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))
this.element.setStyle({zoom:1});var options=Object.extend({from:this.element.getOpacity()||0.0,to:1.0},arguments[1]||{});this.start(options);},update:function(position){this.element.setOpacity(position);}});Effect.Move=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({x:0,y:0,mode:'relative'},arguments[1]||{});this.start(options);},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle('left')||'0');this.originalTop=parseFloat(this.element.getStyle('top')||'0');if(this.options.mode=='absolute'){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop;}},update:function(position){this.element.setStyle({left:(this.options.x*position+this.originalLeft).round()+'px',top:(this.options.y*position+this.originalTop).round()+'px'});}});Effect.MoveBy=function(element,toTop,toLeft){return new Effect.Move(element,Object.extend({x:toLeft,y:toTop},arguments[3]||{}));};Effect.Scale=Class.create(Effect.Base,{initialize:function(element,percent){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100.0,scaleTo:percent},arguments[2]||{});this.start(options);},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle('position');this.originalStyle={};['top','left','width','height','fontSize'].each(function(k){this.originalStyle[k]=this.element.style[k];}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var fontSize=this.element.getStyle('font-size')||'100%';['em','px','%','pt'].each(function(fontSizeType){if(fontSize.indexOf(fontSizeType)>0){this.fontSize=parseFloat(fontSize);this.fontSizeType=fontSizeType;}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=='box')
this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))
this.dims=[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)
this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];},update:function(position){var currentScale=(this.options.scaleFrom/100.0)+(this.factor*position);if(this.options.scaleContent&&this.fontSize)
this.element.setStyle({fontSize:this.fontSize*currentScale+this.fontSizeType});this.setDimensions(this.dims[0]*currentScale,this.dims[1]*currentScale);},finish:function(position){if(this.restoreAfterFinish)this.element.setStyle(this.originalStyle);},setDimensions:function(height,width){var d={};if(this.options.scaleX)d.width=width.round()+'px';if(this.options.scaleY)d.height=height.round()+'px';if(this.options.scaleFromCenter){var topd=(height-this.dims[0])/2;var leftd=(width-this.dims[1])/2;if(this.elementPositioning=='absolute'){if(this.options.scaleY)d.top=this.originalTop-topd+'px';if(this.options.scaleX)d.left=this.originalLeft-leftd+'px';}else{if(this.options.scaleY)d.top=-topd+'px';if(this.options.scaleX)d.left=-leftd+'px';}}
this.element.setStyle(d);}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({startcolor:'#ffff99'},arguments[1]||{});this.start(options);},setup:function(){if(this.element.getStyle('display')=='none'){this.cancel();return;}
this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle('background-image');this.element.setStyle({backgroundImage:'none'});}
if(!this.options.endcolor)
this.options.endcolor=this.element.getStyle('background-color').parseColor('#ffffff');if(!this.options.restorecolor)
this.options.restorecolor=this.element.getStyle('background-color');this._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i]}.bind(this));},update:function(position){this.element.setStyle({backgroundColor:$R(0,2).inject('#',function(m,v,i){return m+((this._base[i]+(this._delta[i]*position)).round().toColorPart());}.bind(this))});},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}));}});Effect.ScrollTo=function(element){var options=arguments[1]||{},scrollOffsets=document.viewport.getScrollOffsets(),elementOffsets=$(element).cumulativeOffset();if(options.offset)elementOffsets[1]+=options.offset;return new Effect.Tween(null,scrollOffsets.top,elementOffsets[1],options,function(p){scrollTo(scrollOffsets.left,p.round());});};Effect.Fade=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();var options=Object.extend({from:element.getOpacity()||1.0,to:0.0,afterFinishInternal:function(effect){if(effect.options.to!=0)return;effect.element.hide().setStyle({opacity:oldOpacity});}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Appear=function(element){element=$(element);var options=Object.extend({from:(element.getStyle('display')=='none'?0.0:element.getOpacity()||0.0),to:1.0,afterFinishInternal:function(effect){effect.element.forceRerendering();},beforeSetup:function(effect){effect.element.setOpacity(effect.options.from).show();}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Puff=function(element){element=$(element);var oldStyle={opacity:element.getInlineOpacity(),position:element.getStyle('position'),top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};return new Effect.Parallel([new Effect.Scale(element,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(element,{sync:true,to:0.0})],Object.extend({duration:1.0,beforeSetupInternal:function(effect){Position.absolutize(effect.effects[0].element);},afterFinishInternal:function(effect){effect.effects[0].element.hide().setStyle(oldStyle);}},arguments[1]||{}));};Effect.BlindUp=function(element){element=$(element);element.makeClipping();return new Effect.Scale(element,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(effect){effect.element.hide().undoClipping();}},arguments[1]||{}));};Effect.BlindDown=function(element){element=$(element);var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makeClipping().setStyle({height:'0px'}).show();},afterFinishInternal:function(effect){effect.element.undoClipping();}},arguments[1]||{}));};Effect.SwitchOff=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();return new Effect.Appear(element,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(effect){new Effect.Scale(effect.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makePositioned().makeClipping();},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned().setStyle({opacity:oldOpacity});}});}},arguments[1]||{}));};Effect.DropOut=function(element){element=$(element);var oldStyle={top:element.getStyle('top'),left:element.getStyle('left'),opacity:element.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(element,{x:0,y:100,sync:true}),new Effect.Opacity(element,{sync:true,to:0.0})],Object.extend({duration:0.5,beforeSetup:function(effect){effect.effects[0].element.makePositioned();},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoPositioned().setStyle(oldStyle);}},arguments[1]||{}));};Effect.Shake=function(element){element=$(element);var options=Object.extend({distance:20,duration:0.5},arguments[1]||{});var distance=parseFloat(options.distance);var split=parseFloat(options.duration)/10.0;var oldStyle={top:element.getStyle('top'),left:element.getStyle('left')};return new Effect.Move(element,{x:distance,y:0,duration:split,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance,y:0,duration:split,afterFinishInternal:function(effect){effect.element.undoPositioned().setStyle(oldStyle);}});}});}});}});}});}});};Effect.SlideDown=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle('bottom');var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera)effect.element.setStyle({top:''});effect.element.makeClipping().setStyle({height:'0px'}).show();},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+'px'});},afterFinishInternal:function(effect){effect.element.undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}},arguments[1]||{}));};Effect.SlideUp=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle('bottom');var elementDimensions=element.getDimensions();return new Effect.Scale(element,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:'box',scaleFrom:100,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera)effect.element.setStyle({top:''});effect.element.makeClipping().show();},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+'px'});},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}},arguments[1]||{}));};Effect.Squish=function(element){return new Effect.Scale(element,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makeClipping();},afterFinishInternal:function(effect){effect.element.hide().undoClipping();}});};Effect.Grow=function(element){element=$(element);var options=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var initialMoveX,initialMoveY;var moveX,moveY;switch(options.direction){case'top-left':initialMoveX=initialMoveY=moveX=moveY=0;break;case'top-right':initialMoveX=dims.width;initialMoveY=moveY=0;moveX=-dims.width;break;case'bottom-left':initialMoveX=moveX=0;initialMoveY=dims.height;moveY=-dims.height;break;case'bottom-right':initialMoveX=dims.width;initialMoveY=dims.height;moveX=-dims.width;moveY=-dims.height;break;case'center':initialMoveX=dims.width/2;initialMoveY=dims.height/2;moveX=-dims.width/2;moveY=-dims.height/2;break;}
return new Effect.Move(element,{x:initialMoveX,y:initialMoveY,duration:0.01,beforeSetup:function(effect){effect.element.hide().makeClipping().makePositioned();},afterFinishInternal:function(effect){new Effect.Parallel([new Effect.Opacity(effect.element,{sync:true,to:1.0,from:0.0,transition:options.opacityTransition}),new Effect.Move(effect.element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition}),new Effect.Scale(effect.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:true,scaleFrom:window.opera?1:0,transition:options.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(effect){effect.effects[0].element.setStyle({height:'0px'}).show();},afterFinishInternal:function(effect){effect.effects[0].element.undoClipping().undoPositioned().setStyle(oldStyle);}},options));}});};Effect.Shrink=function(element){element=$(element);var options=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var moveX,moveY;switch(options.direction){case'top-left':moveX=moveY=0;break;case'top-right':moveX=dims.width;moveY=0;break;case'bottom-left':moveX=0;moveY=dims.height;break;case'bottom-right':moveX=dims.width;moveY=dims.height;break;case'center':moveX=dims.width/2;moveY=dims.height/2;break;}
return new Effect.Parallel([new Effect.Opacity(element,{sync:true,to:0.0,from:1.0,transition:options.opacityTransition}),new Effect.Scale(element,window.opera?1:0,{sync:true,transition:options.scaleTransition,restoreAfterFinish:true}),new Effect.Move(element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition})],Object.extend({beforeStartInternal:function(effect){effect.effects[0].element.makePositioned().makeClipping();},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoClipping().undoPositioned().setStyle(oldStyle);}},options));};Effect.Pulsate=function(element){element=$(element);var options=arguments[1]||{},oldOpacity=element.getInlineOpacity(),transition=options.transition||Effect.Transitions.linear,reverser=function(pos){return 1-transition((-Math.cos((pos*(options.pulses||5)*2)*Math.PI)/2)+.5);};return new Effect.Opacity(element,Object.extend(Object.extend({duration:2.0,from:0,afterFinishInternal:function(effect){effect.element.setStyle({opacity:oldOpacity});}},options),{transition:reverser}));};Effect.Fold=function(element){element=$(element);var oldStyle={top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};element.makeClipping();return new Effect.Scale(element,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(effect){new Effect.Scale(element,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(effect){effect.element.hide().undoClipping().setStyle(oldStyle);}});}},arguments[1]||{}));};Effect.Morph=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(options.style))this.style=$H(options.style);else{if(options.style.include(':'))
this.style=options.style.parseStyle();else{this.element.addClassName(options.style);this.style=$H(this.element.getStyles());this.element.removeClassName(options.style);var css=this.element.getStyles();this.style=this.style.reject(function(style){return style.value==css[style.key];});options.afterFinishInternal=function(effect){effect.element.addClassName(effect.options.style);effect.transforms.each(function(transform){effect.element.style[transform.style]='';});};}}
this.start(options);},setup:function(){function parseColor(color){if(!color||['rgba(0, 0, 0, 0)','transparent'].include(color))color='#ffffff';color=color.parseColor();return $R(0,2).map(function(i){return parseInt(color.slice(i*2+1,i*2+3),16);});}
this.transforms=this.style.map(function(pair){var property=pair[0],value=pair[1],unit=null;if(value.parseColor('#zzzzzz')!='#zzzzzz'){value=value.parseColor();unit='color';}else if(property=='opacity'){value=parseFloat(value);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))
this.element.setStyle({zoom:1});}else if(Element.CSS_LENGTH.test(value)){var components=value.match(/^([\+\-]?[0-9\.]+)(.*)$/);value=parseFloat(components[1]);unit=(components.length==3)?components[2]:null;}
var originalValue=this.element.getStyle(property);return{style:property.camelize(),originalValue:unit=='color'?parseColor(originalValue):parseFloat(originalValue||0),targetValue:unit=='color'?parseColor(value):value,unit:unit};}.bind(this)).reject(function(transform){return((transform.originalValue==transform.targetValue)||(transform.unit!='color'&&(isNaN(transform.originalValue)||isNaN(transform.targetValue))));});},update:function(position){var style={},transform,i=this.transforms.length;while(i--)
style[(transform=this.transforms[i]).style]=transform.unit=='color'?'#'+
(Math.round(transform.originalValue[0]+
(transform.targetValue[0]-transform.originalValue[0])*position)).toColorPart()+
(Math.round(transform.originalValue[1]+
(transform.targetValue[1]-transform.originalValue[1])*position)).toColorPart()+
(Math.round(transform.originalValue[2]+
(transform.targetValue[2]-transform.originalValue[2])*position)).toColorPart():(transform.originalValue+
(transform.targetValue-transform.originalValue)*position).toFixed(3)+
(transform.unit===null?'':transform.unit);this.element.setStyle(style,true);}});Effect.Transform=Class.create({initialize:function(tracks){this.tracks=[];this.options=arguments[1]||{};this.addTracks(tracks);},addTracks:function(tracks){tracks.each(function(track){track=$H(track);var data=track.values().first();this.tracks.push($H({ids:track.keys().first(),effect:Effect.Morph,options:{style:data}}));}.bind(this));return this;},play:function(){return new Effect.Parallel(this.tracks.map(function(track){var ids=track.get('ids'),effect=track.get('effect'),options=track.get('options');var elements=[$(ids)||$$(ids)].flatten();return elements.map(function(e){return new effect(e,Object.extend({sync:true},options))});}).flatten(),this.options);}});Element.CSS_PROPERTIES=$w('backgroundColor backgroundPosition borderBottomColor borderBottomStyle '+'borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth '+'borderRightColor borderRightStyle borderRightWidth borderSpacing '+'borderTopColor borderTopStyle borderTopWidth bottom clip color '+'fontSize fontWeight height left letterSpacing lineHeight '+'marginBottom marginLeft marginRight marginTop markerOffset maxHeight '+'maxWidth minHeight minWidth opacity outlineColor outlineOffset '+'outlineWidth paddingBottom paddingLeft paddingRight paddingTop '+'right textIndent top width wordSpacing zIndex');Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement('div');String.prototype.parseStyle=function(){var style,styleRules=$H();if(Prototype.Browser.WebKit)
style=new Element('div',{style:this}).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';style=String.__parseStyleElement.childNodes[0].style;}
Element.CSS_PROPERTIES.each(function(property){if(style[property])styleRules.set(property,style[property]);});if(Prototype.Browser.IE&&this.include('opacity'))
styleRules.set('opacity',this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return styleRules;};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(element){var css=document.defaultView.getComputedStyle($(element),null);return Element.CSS_PROPERTIES.inject({},function(styles,property){styles[property]=css[property];return styles;});};}else{Element.getStyles=function(element){element=$(element);var css=element.currentStyle,styles;styles=Element.CSS_PROPERTIES.inject({},function(results,property){results[property]=css[property];return results;});if(!styles.opacity)styles.opacity=element.getOpacity();return styles;};}
Effect.Methods={morph:function(element,style){element=$(element);new Effect.Morph(element,Object.extend({style:style},arguments[2]||{}));return element;},visualEffect:function(element,effect,options){element=$(element);var s=effect.dasherize().camelize(),klass=s.charAt(0).toUpperCase()+s.substring(1);new Effect[klass](element,options);return element;},highlight:function(element,options){element=$(element);new Effect.Highlight(element,options);return element;}};$w('fade appear grow shrink fold blindUp blindDown slideUp slideDown '+'pulsate shake puff squish switchOff dropOut').each(function(effect){Effect.Methods[effect]=function(element,options){element=$(element);Effect[effect.charAt(0).toUpperCase()+effect.substring(1)](element,options);return element;};});$w('getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles').each(function(f){Effect.Methods[f]=Element[f];});Element.addMethods(Effect.Methods);;if(Object.isUndefined(Effect))
throw("dragdrop.js requires including script.aculo.us' effects.js library");var Droppables={drops:[],remove:function(element){this.drops=this.drops.reject(function(d){return d.element==$(element)});},add:function(element){element=$(element);var options=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(options.containment){options._containers=[];var containment=options.containment;if(Object.isArray(containment)){containment.each(function(c){options._containers.push($(c))});}else{options._containers.push($(containment));}}
if(options.accept)options.accept=[options.accept].flatten();Element.makePositioned(element);options.element=element;this.drops.push(options);},findDeepestChild:function(drops){deepest=drops[0];for(i=1;i<drops.length;++i)
if(Element.isParent(drops[i].element,deepest.element))
deepest=drops[i];return deepest;},isContained:function(element,drop){var containmentNode;if(drop.tree){containmentNode=element.treeNode;}else{containmentNode=element.parentNode;}
return drop._containers.detect(function(c){return containmentNode==c});},isAffected:function(point,element,drop){return((drop.element!=element)&&((!drop._containers)||this.isContained(element,drop))&&((!drop.accept)||(Element.classNames(element).detect(function(v){return drop.accept.include(v)})))&&Position.within(drop.element,point[0],point[1]));},deactivate:function(drop){if(drop.hoverclass)
Element.removeClassName(drop.element,drop.hoverclass);this.last_active=null;},activate:function(drop){if(drop.hoverclass)
Element.addClassName(drop.element,drop.hoverclass);this.last_active=drop;},show:function(point,element){if(!this.drops.length)return;var drop,affected=[];this.drops.each(function(drop){if(Droppables.isAffected(point,element,drop))
affected.push(drop);});if(affected.length>0)
drop=Droppables.findDeepestChild(affected);if(this.last_active&&this.last_active!=drop)this.deactivate(this.last_active);if(drop){Position.within(drop.element,point[0],point[1]);if(drop.onHover)
drop.onHover(element,drop.element,Position.overlap(drop.overlap,drop.element));if(drop!=this.last_active)Droppables.activate(drop);}},fire:function(event,element){if(!this.last_active)return;Position.prepare();if(this.isAffected([Event.pointerX(event),Event.pointerY(event)],element,this.last_active))
if(this.last_active.onDrop){this.last_active.onDrop(element,this.last_active.element,event);return true;}},reset:function(){if(this.last_active)
this.deactivate(this.last_active);}};var Draggables={drags:[],observers:[],register:function(draggable){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(draggable.element,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress);}
this.drags.push(draggable);},unregister:function(draggable){this.drags=this.drags.reject(function(d){return d==draggable});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(draggable.element,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress);}},activate:function(draggable){if(draggable.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=draggable;}.bind(this),draggable.options.delay);}else{window.focus();this.activeDraggable=draggable;}},deactivate:function(){this.activeDraggable=null;},updateDrag:function(event){if(!this.activeDraggable)return;var pointer=[Event.pointerX(event),Event.pointerY(event)];if(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect()))return;this._lastPointer=pointer;this.activeDraggable.updateDrag(event,pointer);},endDrag:function(event){if(this._timeout){clearTimeout(this._timeout);this._timeout=null;}
if(!this.activeDraggable)return;this._lastPointer=null;this.activeDraggable.endDrag(event);this.activeDraggable=null;},keyPress:function(event){if(this.activeDraggable)
this.activeDraggable.keyPress(event);},addObserver:function(observer){this.observers.push(observer);this._cacheObserverCallbacks();},removeObserver:function(element){this.observers=this.observers.reject(function(o){return o.element==element});this._cacheObserverCallbacks();},notify:function(eventName,draggable,event){if(this[eventName+'Count']>0)
this.observers.each(function(o){if(o[eventName])o[eventName](eventName,draggable,event);});if(draggable.options[eventName])draggable.options[eventName](draggable,event);},_cacheObserverCallbacks:function(){['onStart','onEnd','onDrag'].each(function(eventName){Draggables[eventName+'Count']=Draggables.observers.select(function(o){return o[eventName];}).length;});}};var Draggable=Class.create({initialize:function(element){var defaults={handle:false,reverteffect:function(element,top_offset,left_offset){var dur=Math.sqrt(Math.abs(top_offset^2)+Math.abs(left_offset^2))*0.02;new Effect.Move(element,{x:-left_offset,y:-top_offset,duration:dur,queue:{scope:'_draggable',position:'end'}});},endeffect:function(element){var toOpacity=Object.isNumber(element._opacity)?element._opacity:1.0;new Effect.Opacity(element,{duration:0.2,from:0.7,to:toOpacity,queue:{scope:'_draggable',position:'end'},afterFinish:function(){Draggable._dragging[element]=false}});},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect))
Object.extend(defaults,{starteffect:function(element){element._opacity=Element.getOpacity(element);Draggable._dragging[element]=true;new Effect.Opacity(element,{duration:0.2,from:element._opacity,to:0.7});}});var options=Object.extend(defaults,arguments[1]||{});this.element=$(element);if(options.handle&&Object.isString(options.handle))
this.handle=this.element.down('.'+options.handle,0);if(!this.handle)this.handle=$(options.handle);if(!this.handle)this.handle=this.element;if(options.scroll&&!options.scroll.scrollTo&&!options.scroll.outerHTML){options.scroll=$(options.scroll);this._isScrollChild=Element.childOf(this.element,options.scroll);}
Element.makePositioned(this.element);this.options=options;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this);},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this);},currentDelta:function(){return([parseInt(Element.getStyle(this.element,'left')||'0'),parseInt(Element.getStyle(this.element,'top')||'0')]);},initDrag:function(event){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element])return;if(Event.isLeftClick(event)){var src=Event.element(event);if((tag_name=src.tagName.toUpperCase())&&(tag_name=='INPUT'||tag_name=='SELECT'||tag_name=='OPTION'||tag_name=='BUTTON'||tag_name=='TEXTAREA'))return;var pointer=[Event.pointerX(event),Event.pointerY(event)];var pos=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(i){return(pointer[i]-pos[i])});Draggables.activate(this);Event.stop(event);}},startDrag:function(event){this.dragging=true;if(!this.delta)
this.delta=this.currentDelta();if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,'z-index')||0);this.element.style.zIndex=this.options.zindex;}
if(this.options.ghosting){this._clone=this.element.cloneNode(true);this._originallyAbsolute=(this.element.getStyle('position')=='absolute');if(!this._originallyAbsolute)
Position.absolutize(this.element);this.element.parentNode.insertBefore(this._clone,this.element);}
if(this.options.scroll){if(this.options.scroll==window){var where=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=where.left;this.originalScrollTop=where.top;}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop;}}
Draggables.notify('onStart',this,event);if(this.options.starteffect)this.options.starteffect(this.element);},updateDrag:function(event,pointer){if(!this.dragging)this.startDrag(event);if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element);}
Draggables.notify('onDrag',this,event);this.draw(pointer);if(this.options.change)this.options.change(this);if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height];}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight);}
var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity))speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity);if(pointer[1]<(p[1]+this.options.scrollSensitivity))speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity);if(pointer[0]>(p[2]-this.options.scrollSensitivity))speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity);if(pointer[1]>(p[3]-this.options.scrollSensitivity))speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity);this.startScrolling(speed);}
if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);},finishDrag:function(event,success){this.dragging=false;if(this.options.quiet){Position.prepare();var pointer=[Event.pointerX(event),Event.pointerY(event)];Droppables.show(pointer,this.element);}
if(this.options.ghosting){if(!this._originallyAbsolute)
Position.relativize(this.element);delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null;}
var dropped=false;if(success){dropped=Droppables.fire(event,this.element);if(!dropped)dropped=false;}
if(dropped&&this.options.onDropped)this.options.onDropped(this.element);Draggables.notify('onEnd',this,event);var revert=this.options.revert;if(revert&&Object.isFunction(revert))revert=revert(this.element);var d=this.currentDelta();if(revert&&this.options.reverteffect){if(dropped==0||revert!='failure')
this.options.reverteffect(this.element,d[1]-this.delta[1],d[0]-this.delta[0]);}else{this.delta=d;}
if(this.options.zindex)
this.element.style.zIndex=this.originalZ;if(this.options.endeffect)
this.options.endeffect(this.element);Draggables.deactivate(this);Droppables.reset();},keyPress:function(event){if(event.keyCode!=Event.KEY_ESC)return;this.finishDrag(event,false);Event.stop(event);},endDrag:function(event){if(!this.dragging)return;this.stopScrolling();this.finishDrag(event,true);Event.stop(event);},draw:function(point){var pos=Position.cumulativeOffset(this.element);if(this.options.ghosting){var r=Position.realOffset(this.element);pos[0]+=r[0]-Position.deltaX;pos[1]+=r[1]-Position.deltaY;}
var d=this.currentDelta();pos[0]-=d[0];pos[1]-=d[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){pos[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;pos[1]-=this.options.scroll.scrollTop-this.originalScrollTop;}
var p=[0,1].map(function(i){return(point[i]-pos[i]-this.offset[i])}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){p=this.options.snap(p[0],p[1],this);}else{if(Object.isArray(this.options.snap)){p=p.map(function(v,i){return(v/this.options.snap[i]).round()*this.options.snap[i]}.bind(this));}else{p=p.map(function(v){return(v/this.options.snap).round()*this.options.snap}.bind(this));}}}
var style=this.element.style;if((!this.options.constraint)||(this.options.constraint=='horizontal'))
style.left=p[0]+"px";if((!this.options.constraint)||(this.options.constraint=='vertical'))
style.top=p[1]+"px";if(style.visibility=="hidden")style.visibility="";},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null;}},startScrolling:function(speed){if(!(speed[0]||speed[1]))return;this.scrollSpeed=[speed[0]*this.options.scrollSpeed,speed[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10);},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1]);}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000;}
Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify('onDrag',this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0)
Draggables._lastScrollPointer[0]=0;if(Draggables._lastScrollPointer[1]<0)
Draggables._lastScrollPointer[1]=0;this.draw(Draggables._lastScrollPointer);}
if(this.options.change)this.options.change(this);},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft;}else if(w.document.body){T=body.scrollTop;L=body.scrollLeft;}
if(w.innerWidth){W=w.innerWidth;H=w.innerHeight;}else if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight;}else{W=body.offsetWidth;H=body.offsetHeight;}}
return{top:T,left:L,width:W,height:H};}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(element,observer){this.element=$(element);this.observer=observer;this.lastValue=Sortable.serialize(this.element);},onStart:function(){this.lastValue=Sortable.serialize(this.element);},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element))
this.observer(this.element)}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(element){while(element.tagName.toUpperCase()!="BODY"){if(element.id&&Sortable.sortables[element.id])return element;element=element.parentNode;}},options:function(element){element=Sortable._findRootElement($(element));if(!element)return;return Sortable.sortables[element.id];},destroy:function(element){element=$(element);var s=Sortable.sortables[element.id];if(s){Draggables.removeObserver(s.element);s.droppables.each(function(d){Droppables.remove(d)});s.draggables.invoke('destroy');delete Sortable.sortables[s.element.id];}},create:function(element){element=$(element);var options=Object.extend({element:element,tag:'li',dropOnEmpty:false,tree:false,treeTag:'ul',overlap:'vertical',constraint:'vertical',containment:element,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(element);var options_for_draggable={revert:true,quiet:options.quiet,scroll:options.scroll,scrollSpeed:options.scrollSpeed,scrollSensitivity:options.scrollSensitivity,delay:options.delay,ghosting:options.ghosting,constraint:options.constraint,handle:options.handle};if(options.starteffect)
options_for_draggable.starteffect=options.starteffect;if(options.reverteffect)
options_for_draggable.reverteffect=options.reverteffect;else
if(options.ghosting)options_for_draggable.reverteffect=function(element){element.style.top=0;element.style.left=0;};if(options.endeffect)
options_for_draggable.endeffect=options.endeffect;if(options.zindex)
options_for_draggable.zindex=options.zindex;var options_for_droppable={overlap:options.overlap,containment:options.containment,tree:options.tree,hoverclass:options.hoverclass,onHover:Sortable.onHover};var options_for_tree={onHover:Sortable.onEmptyHover,overlap:options.overlap,containment:options.containment,hoverclass:options.hoverclass};Element.cleanWhitespace(element);options.draggables=[];options.droppables=[];if(options.dropOnEmpty||options.tree){Droppables.add(element,options_for_tree);options.droppables.push(element);}
(options.elements||this.findElements(element,options)||[]).each(function(e,i){var handle=options.handles?$(options.handles[i]):(options.handle?$(e).select('.'+options.handle)[0]:e);options.draggables.push(new Draggable(e,Object.extend(options_for_draggable,{handle:handle})));Droppables.add(e,options_for_droppable);if(options.tree)e.treeNode=element;options.droppables.push(e);});if(options.tree){(Sortable.findTreeElements(element,options)||[]).each(function(e){Droppables.add(e,options_for_tree);e.treeNode=element;options.droppables.push(e);});}
this.sortables[element.id]=options;Draggables.addObserver(new SortableObserver(element,options.onUpdate));},findElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.tag);},findTreeElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.treeTag);},onHover:function(element,dropon,overlap){if(Element.isParent(dropon,element))return;if(overlap>.33&&overlap<.66&&Sortable.options(dropon).tree){return;}else if(overlap>0.5){Sortable.mark(dropon,'before');if(dropon.previousSibling!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,dropon);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}else{Sortable.mark(dropon,'after');var nextElement=dropon.nextSibling||null;if(nextElement!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,nextElement);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}},onEmptyHover:function(element,dropon,overlap){var oldParentNode=element.parentNode;var droponOptions=Sortable.options(dropon);if(!Element.isParent(dropon,element)){var index;var children=Sortable.findElements(dropon,{tag:droponOptions.tag,only:droponOptions.only});var child=null;if(children){var offset=Element.offsetSize(dropon,droponOptions.overlap)*(1.0-overlap);for(index=0;index<children.length;index+=1){if(offset-Element.offsetSize(children[index],droponOptions.overlap)>=0){offset-=Element.offsetSize(children[index],droponOptions.overlap);}else if(offset-(Element.offsetSize(children[index],droponOptions.overlap)/2)>=0){child=index+1<children.length?children[index+1]:null;break;}else{child=children[index];break;}}}
dropon.insertBefore(element,child);Sortable.options(oldParentNode).onChange(element);droponOptions.onChange(element);}},unmark:function(){if(Sortable._marker)Sortable._marker.hide();},mark:function(dropon,position){var sortable=Sortable.options(dropon.parentNode);if(sortable&&!sortable.ghosting)return;if(!Sortable._marker){Sortable._marker=($('dropmarker')||Element.extend(document.createElement('DIV'))).hide().addClassName('dropmarker').setStyle({position:'absolute'});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker);}
var offsets=Position.cumulativeOffset(dropon);Sortable._marker.setStyle({left:offsets[0]+'px',top:offsets[1]+'px'});if(position=='after')
if(sortable.overlap=='horizontal')
Sortable._marker.setStyle({left:(offsets[0]+dropon.clientWidth)+'px'});else
Sortable._marker.setStyle({top:(offsets[1]+dropon.clientHeight)+'px'});Sortable._marker.show();},_tree:function(element,options,parent){var children=Sortable.findElements(element,options)||[];for(var i=0;i<children.length;++i){var match=children[i].id.match(options.format);if(!match)continue;var child={id:encodeURIComponent(match?match[1]:null),element:element,parent:parent,children:[],position:parent.children.length,container:$(children[i]).down(options.treeTag)};if(child.container)
this._tree(child.container,options,child);parent.children.push(child);}
return parent;},tree:function(element){element=$(element);var sortableOptions=this.options(element);var options=Object.extend({tag:sortableOptions.tag,treeTag:sortableOptions.treeTag,only:sortableOptions.only,name:element.id,format:sortableOptions.format},arguments[1]||{});var root={id:null,parent:null,children:[],container:element,position:0};return Sortable._tree(element,options,root);},_constructIndex:function(node){var index='';do{if(node.id)index='['+node.position+']'+index;}while((node=node.parent)!=null);return index;},sequence:function(element){element=$(element);var options=Object.extend(this.options(element),arguments[1]||{});return $(this.findElements(element,options)||[]).map(function(item){return item.id.match(options.format)?item.id.match(options.format)[1]:'';});},setSequence:function(element,new_sequence){element=$(element);var options=Object.extend(this.options(element),arguments[2]||{});var nodeMap={};this.findElements(element,options).each(function(n){if(n.id.match(options.format))
nodeMap[n.id.match(options.format)[1]]=[n,n.parentNode];n.parentNode.removeChild(n);});new_sequence.each(function(ident){var n=nodeMap[ident];if(n){n[1].appendChild(n[0]);delete nodeMap[ident];}});},serialize:function(element){element=$(element);var options=Object.extend(Sortable.options(element),arguments[1]||{});var name=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:element.id);if(options.tree){return Sortable.tree(element,arguments[1]).children.map(function(item){return[name+Sortable._constructIndex(item)+"[id]="+
encodeURIComponent(item.id)].concat(item.children.map(arguments.callee));}).flatten().join('&');}else{return Sortable.sequence(element,arguments[1]).map(function(item){return name+"[]="+encodeURIComponent(item);}).join('&');}}};Element.isParent=function(child,element){if(!child.parentNode||child==element)return false;if(child.parentNode==element)return true;return Element.isParent(child.parentNode,element);};Element.findChildren=function(element,only,recursive,tagName){if(!element.hasChildNodes())return null;tagName=tagName.toUpperCase();if(only)only=[only].flatten();var elements=[];$A(element.childNodes).each(function(e){if(e.tagName&&e.tagName.toUpperCase()==tagName&&(!only||(Element.classNames(e).detect(function(v){return only.include(v)}))))
elements.push(e);if(recursive){var grandchildren=Element.findChildren(e,only,recursive,tagName);if(grandchildren)elements.push(grandchildren);}});return(elements.length>0?elements.flatten():[]);};Element.offsetSize=function(element,type){return element['offset'+((type=='vertical'||type=='height')?'Height':'Width')];};;if(typeof Effect=='undefined')
throw("controls.js requires including script.aculo.us' effects.js library");var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(element,update,options){element=$(element);this.element=element;this.update=$(update);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions)
this.setOptions(options);else
this.options=options||{};this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(element,update){if(!update.style.position||update.style.position=='absolute'){update.style.position='absolute';Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight});}
Effect.Appear(update,{duration:0.15});update.style.left='0px';update.style.top=element.offsetHeight+'px';};this.options.onHide=this.options.onHide||function(element,update){new Effect.Fade(update,{duration:0.15})};if(typeof(this.options.tokens)=='string')
this.options.tokens=new Array(this.options.tokens);if(!this.options.tokens.include('\n'))
this.options.tokens.push('\n');this.observer=null;this.element.setAttribute('autocomplete','off');Element.hide(this.update);Event.observe(this.element,'blur',this.onBlur.bindAsEventListener(this));Event.observe(this.element,'keydown',this.onKeyPress.bindAsEventListener(this));Event.observe(this.element,'input',this.onInputChange.bindAsEventListener(this));},show:function(){if(Element.getStyle(this.update,'display')=='none')this.options.onShow(this.element,this.update);if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,'position')=='absolute')){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" '+'style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" '+'src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+'_iefix');}
if(this.iefix)setTimeout(this.fixIEOverlapping.bind(this),50);},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix);},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,'display')!='none')this.options.onHide(this.element,this.update);if(this.iefix)Element.hide(this.iefix);},startIndicator:function(){if(this.options.indicator)Element.show(this.options.indicator);},stopIndicator:function(){if(this.options.indicator)Element.hide(this.options.indicator);},onInputChange:function(event){if(this.active){return;}
this.changed=true;this.hasFocus=true;if(this.observer)clearTimeout(this.observer);this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);},onKeyPress:function(event){if(this.active){switch(event.keyCode){case Event.KEY_RETURN:this.selectEntry();Event.stop(event);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(event);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(event);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(event);return;}}
this.active=false;},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices();},onHover:function(event){var element=Event.findElement(event,'LI');if(this.index!=element.autocompleteIndex)
{this.index=element.autocompleteIndex;this.render();}
Event.stop(event);},onClick:function(event){var element=Event.findElement(event,'LI');this.index=element.autocompleteIndex;this.selectEntry();this.hide();},onBlur:function(event){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false;},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++)
this.index==i?Element.addClassName(this.getEntry(i),"selected"):Element.removeClassName(this.getEntry(i),"selected");if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},markPrevious:function(){if(this.index>0){this.index--;var prev_index=-1;for(var i=this.index;i>0;i--){if(this.getEntry(i).visible()){prev_index=i;break;}}
this.index=(prev_index!=-1)?prev_index:this.entryCount-1;}
else this.index=this.entryCount-1;},markNext:function(){if(this.index<this.entryCount-1)this.index++;else{this.index=0;for(var i=0;i<this.entryCount;i++){if(this.getEntry(i).visible()){this.index=i;break;}}}
this.getEntry(this.index).scrollIntoView(false);},getEntry:function(index){return this.update.firstChild.childNodes[index];},getCurrentEntry:function(){return this.getEntry(this.index);},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry());},updateElement:function(selectedElement){if(this.options.updateElement){if(this.getCurrentEntry().innerHTML)
this.options.updateElement(selectedElement);return;}
var value='';if(this.options.select){var nodes=$(selectedElement).select('.'+this.options.select)||[];if(nodes.length>0)value=Element.collectTextNodes(nodes[0],this.options.select);}else
value=Element.collectTextNodesIgnoreClass(selectedElement,'informal');var bounds=this.getTokenBounds();if(bounds[0]!=-1){var newValue=this.element.value.substr(0,bounds[0]);var whitespace=this.element.value.substr(bounds[0]).match(/^\s+/);if(whitespace)
newValue+=whitespace[0];this.element.value=newValue+value+this.element.value.substr(bounds[1]);}else{this.element.value=value;}
this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement)
this.options.afterUpdateElement(this.element,selectedElement);},updateChoices:function(choices){if(!this.changed&&this.hasFocus){this.update.innerHTML=choices;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.autocompleteIndex=i;this.addObservers(entry);}}else{this.entryCount=0;}
this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},addObservers:function(element){Event.observe(element,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(element,"click",this.onClick.bindAsEventListener(this));},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices();}else{this.active=false;this.hide();}
this.oldElementValue=this.element.value;},getToken:function(){var bounds=this.getTokenBounds();return this.element.value.substring(bounds[0],bounds[1]).strip();},getTokenBounds:function(){if(null!=this.tokenBounds)return this.tokenBounds;var value=this.element.value;if(value.strip().empty())return[-1,0];var diff=arguments.callee.getFirstDifferencePos(value,this.oldElementValue);var offset=(diff==this.oldElementValue.length?1:0);var prevTokenPos=-1,nextTokenPos=value.length;var tp;for(var index=0,l=this.options.tokens.length;index<l;++index){tp=value.lastIndexOf(this.options.tokens[index],diff+offset-1);if(tp>prevTokenPos)prevTokenPos=tp;tp=value.indexOf(this.options.tokens[index],diff+offset);if(-1!=tp&&tp<nextTokenPos)nextTokenPos=tp;}
return(this.tokenBounds=[prevTokenPos+1,nextTokenPos]);}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(newS,oldS){var boundary=Math.min(newS.length,oldS.length);for(var index=0;index<boundary;++index)
if(newS[index]!=oldS[index])
return index;return boundary;};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(element,update,url,options){this.baseInitialize(element,update,options);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url;},getUpdatedChoices:function(){this.startIndicator();var entry=encodeURIComponent(this.options.paramName)+'='+
encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams)
this.options.parameters+='&'+this.options.defaultParams;if($('payment_method_select')){this.options.parameters+='&payment='+$('payment_method_select').value;}
if(this.options.admin==true){if($('city_id')){this.options.parameters+='&city_id='+$('city_id').value;}
if($('order-shipping_address_city_id')){this.options.parameters+='&city_id='+$('order-shipping_address_city_id').value;}
if(typeof(this.options.table)!='undefined'){this.options.parameters+='&table='+this.options.table;}
if(typeof(this.options.shippingMethod)!='undefined'&&this.options.shippingMethod!='other'){this.options.parameters+='&method='+this.options.shippingMethod;}}
new Ajax.Request(this.url,this.options);},onComplete:function(request){this.updateChoices(request.responseText);}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(element,update,array,options){this.baseInitialize(element,update,options);this.options.array=array;},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this));},setOptions:function(options){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(instance){var ret=[];var partial=[];var entry=instance.getToken();var count=0;for(var i=0;i<instance.options.array.length&&ret.length<instance.options.choices;i++){var elem=instance.options.array[i];var foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase()):elem.indexOf(entry);while(foundPos!=-1){if(foundPos==0&&elem.length!=entry.length){ret.push("<li><strong>"+elem.substr(0,entry.length)+"</strong>"+
elem.substr(entry.length)+"</li>");break;}else if(entry.length>=instance.options.partialChars&&instance.options.partialSearch&&foundPos!=-1){if(instance.options.fullSearch||/\s/.test(elem.substr(foundPos-1,1))){partial.push("<li>"+elem.substr(0,foundPos)+"<strong>"+
elem.substr(foundPos,entry.length)+"</strong>"+elem.substr(foundPos+entry.length)+"</li>");break;}}
foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase(),foundPos+1):elem.indexOf(entry,foundPos+1);}}
if(partial.length)
ret=ret.concat(partial.slice(0,instance.options.choices-ret.length));return"<ul>"+ret.join('')+"</ul>";}},options||{});}});Field.scrollFreeActivate=function(field){setTimeout(function(){Field.activate(field);},1);};Ajax.InPlaceEditor=Class.create({initialize:function(element,url,options){this.url=url;this.element=element=$(element);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(options);Object.extend(this.options,options||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+'-inplaceeditor';if($(this.options.formId))
this.options.formId='';}
if(this.options.externalControl)
this.options.externalControl=$(this.options.externalControl);if(!this.options.externalControl)
this.options.externalControlOnly=false;this._originalBackground=this.element.getStyle('background-color')||'transparent';this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners();},checkForEscapeOrReturn:function(e){if(!this._editing||e.ctrlKey||e.altKey||e.shiftKey)return;if(Event.KEY_ESC==e.keyCode)
this.handleFormCancellation(e);else if(Event.KEY_RETURN==e.keyCode)
this.handleFormSubmission(e);},createControl:function(mode,handler,extraClasses){var control=this.options[mode+'Control'];var text=this.options[mode+'Text'];if('button'==control){var btn=document.createElement('input');btn.type='submit';btn.value=text;btn.className='editor_'+mode+'_button';if('cancel'==mode)
btn.onclick=this._boundCancelHandler;this._form.appendChild(btn);this._controls[mode]=btn;}else if('link'==control){var link=document.createElement('a');link.href='#';link.appendChild(document.createTextNode(text));link.onclick='cancel'==mode?this._boundCancelHandler:this._boundSubmitHandler;link.className='editor_'+mode+'_link';if(extraClasses)
link.className+=' '+extraClasses;this._form.appendChild(link);this._controls[mode]=link;}},createEditField:function(){var text=(this.options.loadTextURL?this.options.loadingText:this.getText());var fld;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){fld=document.createElement('input');fld.type='text';var size=this.options.size||this.options.cols||0;if(0<size)fld.size=size;}else{fld=document.createElement('textarea');fld.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);fld.cols=this.options.cols||40;}
fld.name=this.options.paramName;fld.value=text;fld.className='editor_field';if(this.options.submitOnBlur)
fld.onblur=this._boundSubmitHandler;this._controls.editor=fld;if(this.options.loadTextURL)
this.loadExternalText();this._form.appendChild(this._controls.editor);},createForm:function(){var ipe=this;function addText(mode,condition){var text=ipe.options['text'+mode+'Controls'];if(!text||condition===false)return;ipe._form.appendChild(document.createTextNode(text));};this._form=$(document.createElement('form'));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();if('textarea'==this._controls.editor.tagName.toLowerCase())
this._form.appendChild(document.createElement('br'));if(this.options.onFormCustomization)
this.options.onFormCustomization(this,this._form);addText('Before',this.options.okControl||this.options.cancelControl);this.createControl('ok',this._boundSubmitHandler);addText('Between',this.options.okControl&&this.options.cancelControl);this.createControl('cancel',this._boundCancelHandler,'editor_cancel');addText('After',this.options.okControl||this.options.cancelControl);},destroy:function(){if(this._oldInnerHTML)
this.element.innerHTML=this._oldInnerHTML;this.leaveEditMode();this.unregisterListeners();},enterEditMode:function(e){if(this._saving||this._editing)return;this._editing=true;this.triggerCallback('onEnterEditMode');if(this.options.externalControl)
this.options.externalControl.hide();this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);if(!this.options.loadTextURL)
this.postProcessEditField();if(e)Event.stop(e);},enterHover:function(e){if(this.options.hoverClassName)
this.element.addClassName(this.options.hoverClassName);if(this._saving)return;this.triggerCallback('onEnterHover');},getText:function(){return this.element.innerHTML.unescapeHTML();},handleAJAXFailure:function(transport){this.triggerCallback('onFailure',transport);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null;}},handleFormCancellation:function(e){this.wrapUp();if(e)Event.stop(e);},handleFormSubmission:function(e){var form=this._form;var value=$F(this._controls.editor);this.prepareSubmission();var params=this.options.callback(form,value)||'';if(Object.isString(params))
params=params.toQueryParams();params.editorId=this.element.id;if(this.options.htmlResponse){var options=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Updater({success:this.element},this.url,options);}else{var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,options);}
if(e)Event.stop(e);},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();if(this.options.externalControl)
this.options.externalControl.show();this._saving=false;this._editing=false;this._oldInnerHTML=null;this.triggerCallback('onLeaveEditMode');},leaveHover:function(e){if(this.options.hoverClassName)
this.element.removeClassName(this.options.hoverClassName);if(this._saving)return;this.triggerCallback('onLeaveHover');},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._form.removeClassName(this.options.loadingClassName);var text=transport.responseText;if(this.options.stripLoadedTextTags)
text=text.stripTags();this._controls.editor.value=text;this._controls.editor.disabled=false;this.postProcessEditField();}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,options);},postProcessEditField:function(){var fpc=this.options.fieldPostCreation;if(fpc)
$(this._controls.editor)['focus'==fpc?'focus':'activate']();},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(defs){Object.extend(this.options,defs);}.bind(this));},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving();},registerListeners:function(){this._listeners={};var listener;$H(Ajax.InPlaceEditor.Listeners).each(function(pair){listener=this[pair.value].bind(this);this._listeners[pair.key]=listener;if(!this.options.externalControlOnly)
this.element.observe(pair.key,listener);if(this.options.externalControl)
this.options.externalControl.observe(pair.key,listener);}.bind(this));},removeForm:function(){if(!this._form)return;this._form.remove();this._form=null;this._controls={};},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show();},triggerCallback:function(cbName,arg){if('function'==typeof this.options[cbName]){this.options[cbName](this,arg);}},unregisterListeners:function(){$H(this._listeners).each(function(pair){if(!this.options.externalControlOnly)
this.element.stopObserving(pair.key,pair.value);if(this.options.externalControl)
this.options.externalControl.stopObserving(pair.key,pair.value);}.bind(this));},wrapUp:function(transport){this.leaveEditMode();this._boundComplete(transport,this.element);}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,element,url,options){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(element,url,options);},createEditField:function(){var list=document.createElement('select');list.name=this.options.paramName;list.size=1;this._controls.editor=list;this._collection=this.options.collection||[];if(this.options.loadCollectionURL)
this.loadCollection();else
this.checkForExternalText();this._form.appendChild(this._controls.editor);},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js))
throw('Server returned an invalid collection representation.');this._collection=eval(js);this.checkForExternalText();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,options);},showLoadingText:function(text){this._controls.editor.disabled=true;var tempOption=this._controls.editor.firstChild;if(!tempOption){tempOption=document.createElement('option');tempOption.value='';this._controls.editor.appendChild(tempOption);tempOption.selected=true;}
tempOption.update((text||'').stripScripts().stripTags());},checkForExternalText:function(){this._text=this.getText();if(this.options.loadTextURL)
this.loadExternalText();else
this.buildOptionList();},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._text=transport.responseText.strip();this.buildOptionList();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,options);},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(entry){return 2===entry.length?entry:[entry,entry].flatten();});var marker=('value'in this.options)?this.options.value:this._text;var textFound=this._collection.any(function(entry){return entry[0]==marker;}.bind(this));this._controls.editor.update('');var option;this._collection.each(function(entry,index){option=document.createElement('option');option.value=entry[0];option.selected=textFound?entry[0]==marker:0==index;option.appendChild(document.createTextNode(entry[1]));this._controls.editor.appendChild(option);}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor);}});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(options){if(!options)return;function fallback(name,expr){if(name in options||expr===undefined)return;options[name]=expr;};fallback('cancelControl',(options.cancelLink?'link':(options.cancelButton?'button':options.cancelLink==options.cancelButton==false?false:undefined)));fallback('okControl',(options.okLink?'link':(options.okButton?'button':options.okLink==options.okButton==false?false:undefined)));fallback('highlightColor',options.highlightcolor);fallback('highlightEndColor',options.highlightendcolor);};Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:'link',cancelText:'cancel',clickToEditText:'Click to edit',externalControl:null,externalControlOnly:false,fieldPostCreation:'activate',formClassName:'inplaceeditor-form',formId:null,highlightColor:'#ffff99',highlightEndColor:'#ffffff',hoverClassName:'',htmlResponse:true,loadingClassName:'inplaceeditor-loading',loadingText:'Loading...',okControl:'button',okText:'ok',paramName:'value',rows:1,savingClassName:'inplaceeditor-saving',savingText:'Saving...',size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:'',textBeforeControls:'',textBetweenControls:''},DefaultCallbacks:{callback:function(form){return Form.serialize(form);},onComplete:function(transport,element){new Effect.Highlight(element,{startcolor:this.options.highlightColor,keepBackgroundImage:true});},onEnterEditMode:null,onEnterHover:function(ipe){ipe.element.style.backgroundColor=ipe.options.highlightColor;if(ipe._effect)
ipe._effect.cancel();},onFailure:function(transport,ipe){alert('Error communication with the server: '+transport.responseText.stripTags());},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(ipe){ipe._effect=new Effect.Highlight(ipe.element,{startcolor:ipe.options.highlightColor,endcolor:ipe.options.highlightEndColor,restorecolor:ipe._originalBackground,keepBackgroundImage:true});}},Listeners:{click:'enterEditMode',keydown:'checkForEscapeOrReturn',mouseover:'enterHover',mouseout:'leaveHover'}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:'Loading options...'};Form.Element.DelayedObserver=Class.create({initialize:function(element,delay,callback){this.delay=delay||0.5;this.element=$(element);this.callback=callback;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,'keyup',this.delayedListener.bindAsEventListener(this));},delayedListener:function(event){if(this.lastValue==$F(this.element))return;if(this.timer)clearTimeout(this.timer);this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element);},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element));}});;if(!Control)var Control={};Control.Slider=Class.create({initialize:function(handle,track,options){var slider=this;if(Object.isArray(handle)){this.handles=handle.collect(function(e){return $(e)});}else{this.handles=[$(handle)];}
this.track=$(track);this.options=options||{};this.axis=this.options.axis||'horizontal';this.increment=this.options.increment||1;this.step=parseInt(this.options.step||'1');this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0});this.spans=this.options.spans?this.options.spans.map(function(s){return $(s)}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||'0');this.alignY=parseInt(this.options.alignY||'0');this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!=0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!=0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled)this.setDisabled();this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max();}
this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((Object.isArray(slider.options.sliderValue)?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);h.makePositioned().observe("mousedown",slider.eventMouseDown);});this.track.observe("mousedown",this.eventMouseDown);document.observe("mouseup",this.eventMouseUp);$(this.track.parentNode.parentNode).observe("mousemove",this.eventMouseMove);this.initialized=true;},dispose:function(){var slider=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(this.track.parentNode.parentNode,"mousemove",this.eventMouseMove);this.handles.each(function(h){Event.stopObserving(h,"mousedown",slider.eventMouseDown);});},setDisabled:function(){this.disabled=true;this.track.parentNode.className=this.track.parentNode.className+' disabled';},setEnabled:function(){this.disabled=false;},getNearestValue:function(value){if(this.allowedValues){if(value>=this.allowedValues.max())return(this.allowedValues.max());if(value<=this.allowedValues.min())return(this.allowedValues.min());var offset=Math.abs(this.allowedValues[0]-value);var newValue=this.allowedValues[0];this.allowedValues.each(function(v){var currentOffset=Math.abs(v-value);if(currentOffset<=offset){newValue=v;offset=currentOffset;}});return newValue;}
if(value>this.range.end)return this.range.end;if(value<this.range.start)return this.range.start;return value;},setValue:function(sliderValue,handleIdx){if(!this.active){this.activeHandleIdx=handleIdx||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles();}
handleIdx=handleIdx||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((handleIdx>0)&&(sliderValue<this.values[handleIdx-1]))
sliderValue=this.values[handleIdx-1];if((handleIdx<(this.handles.length-1))&&(sliderValue>this.values[handleIdx+1]))
sliderValue=this.values[handleIdx+1];}
sliderValue=this.getNearestValue(sliderValue);this.values[handleIdx]=sliderValue;this.value=this.values[0];this.handles[handleIdx].style[this.isVertical()?'top':'left']=this.translateToPx(sliderValue);this.drawSpans();if(!this.dragging||!this.event)this.updateFinished();},setValueBy:function(delta,handleIdx){this.setValue(this.values[handleIdx||this.activeHandleIdx||0]+delta,handleIdx||this.activeHandleIdx||0);},translateToPx:function(value){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(value-this.range.start))+"px";},translateToValue:function(offset){return((offset/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);},getRange:function(range){var v=this.values.sortBy(Prototype.K);range=range||0;return $R(v[range],v[range+1]);},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!=0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!=0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX);},isVertical:function(){return(this.axis=='vertical');},drawSpans:function(){var slider=this;if(this.spans)
$R(0,this.spans.length-1).each(function(r){slider.setSpan(slider.spans[r],slider.getRange(r))});if(this.options.startSpan)
this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value));if(this.options.endSpan)
this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum));},setSpan:function(span,range){if(this.isVertical()){span.style.top=this.translateToPx(range.start);span.style.height=this.translateToPx(range.end-range.start+this.range.start);}else{span.style.left=this.translateToPx(range.start);span.style.width=this.translateToPx(range.end-range.start+this.range.start);}},updateStyles:function(){this.handles.each(function(h){Element.removeClassName(h,'selected')});Element.addClassName(this.activeHandle,'selected');},startDrag:function(event){if(Event.isLeftClick(event)){if(!this.disabled){this.active=true;var handle=Event.element(event);var pointer=[Event.pointerX(event),Event.pointerY(event)];var track=handle;if(track==this.track){var offsets=Position.cumulativeOffset(this.track);this.event=event;this.setValue(this.translateToValue((this.isVertical()?pointer[1]-offsets[1]:pointer[0]-offsets[0])-(this.handleLength/2)));var offsets=Position.cumulativeOffset(this.activeHandle);this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}else{while((this.handles.indexOf(handle)==-1)&&handle.parentNode)
handle=handle.parentNode;if(this.handles.indexOf(handle)!=-1){this.activeHandle=handle;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var offsets=Position.cumulativeOffset(this.activeHandle);this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}}}
Event.stop(event);}},update:function(event){if(this.active){if(!this.dragging)this.dragging=true;this.draw(event);if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);}},draw:function(event){var pointer=[Event.pointerX(event),Event.pointerY(event)];var offsets=Position.cumulativeOffset(this.track);pointer[0]-=this.offsetX+offsets[0];pointer[1]-=this.offsetY+offsets[1];this.event=event;this.setValue(this.translateToValue(this.isVertical()?pointer[1]:pointer[0]));if(this.initialized&&this.options.onSlide)
this.options.onSlide(this.values.length>1?this.values:this.value,this);},endDrag:function(event){if(this.active&&this.dragging){this.finishDrag(event,true);Event.stop(event);}
this.active=false;this.dragging=false;},finishDrag:function(event,success){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange)
this.options.onChange(this.values.length>1?this.values:this.value,this);this.event=null;}});;function popWin(url,win,para){var win=window.open(url,win,para);win.focus();}
function setLocation(url){window.location.href=url;}
function setPLocation(url,setFocus){if(setFocus){window.opener.focus();}
window.opener.location.href=url;}
function setLanguageCode(code,fromCode){var href=window.location.href;var after='',dash;if(dash=href.match(/\#(.*)$/)){href=href.replace(/\#(.*)$/,'');after=dash[0];}
if(href.match(/[?]/)){var re=/([?&]store=)[a-z0-9_]*/;if(href.match(re)){href=href.replace(re,'$1'+code);}else{href+='&store='+code;}
var re=/([?&]from_store=)[a-z0-9_]*/;if(href.match(re)){href=href.replace(re,'');}}else{href+='?store='+code;}
if(typeof(fromCode)!='undefined'){href+='&from_store='+fromCode;}
href+=after;setLocation(href);}
function decorateGeneric(elements,decorateParams)
{var allSupportedParams=['odd','even','first','last'];var _decorateParams={};var total=elements.length;if(total){if(typeof(decorateParams)=='undefined'){decorateParams=allSupportedParams;}
if(!decorateParams.length){return;}
for(var k in allSupportedParams){_decorateParams[allSupportedParams[k]]=false;}
for(var k in decorateParams){_decorateParams[decorateParams[k]]=true;}
if(_decorateParams.first){Element.addClassName(elements[0],'first');}
if(_decorateParams.last){Element.addClassName(elements[total-1],'last');}
for(var i=0;i<total;i++){if((i+1)%2==0){if(_decorateParams.even){Element.addClassName(elements[i],'even');}}
else{if(_decorateParams.odd){Element.addClassName(elements[i],'odd');}}}}}
function decorateTable(table,options){var table=$(table);if(table){var _options={'tbody':false,'tbody tr':['odd','even','first','last'],'thead tr':['first','last'],'tfoot tr':['first','last'],'tr td':['last']};if(typeof(options)!='undefined'){for(var k in options){_options[k]=options[k];}}
if(_options['tbody']){decorateGeneric(table.select('tbody'),_options['tbody']);}
if(_options['tbody tr']){decorateGeneric(table.select('tbody tr'),_options['tbody tr']);}
if(_options['thead tr']){decorateGeneric(table.select('thead tr'),_options['thead tr']);}
if(_options['tfoot tr']){decorateGeneric(table.select('tfoot tr'),_options['tfoot tr']);}
if(_options['tr td']){var allRows=table.select('tr');if(allRows.length){for(var i=0;i<allRows.length;i++){decorateGeneric(allRows[i].getElementsByTagName('TD'),_options['tr td']);}}}}}
function decorateList(list,nonRecursive){if($(list)){if(typeof(nonRecursive)=='undefined'){var items=$(list).select('li')}
else{var items=$(list).childElements();}
decorateGeneric(items,['odd','even','last']);}}
function decorateDataList(list){list=$(list);if(list){decorateGeneric(list.select('dt'),['odd','even','last']);decorateGeneric(list.select('dd'),['odd','even','last']);}}
function parseSidUrl(baseUrl,urlExt){sidPos=baseUrl.indexOf('/?SID=');sid='';urlExt=(urlExt!=undefined)?urlExt:'';if(sidPos>-1){sid='?'+baseUrl.substring(sidPos+2);baseUrl=baseUrl.substring(0,sidPos+1);}
return baseUrl+urlExt+sid;}
function formatCurrency(price,format,showPlus){precision=isNaN(format.precision=Math.abs(format.precision))?2:format.precision;requiredPrecision=isNaN(format.requiredPrecision=Math.abs(format.requiredPrecision))?2:format.requiredPrecision;precision=requiredPrecision;integerRequired=isNaN(format.integerRequired=Math.abs(format.integerRequired))?1:format.integerRequired;decimalSymbol=format.decimalSymbol==undefined?",":format.decimalSymbol;groupSymbol=format.groupSymbol==undefined?".":format.groupSymbol;groupLength=format.groupLength==undefined?3:format.groupLength;if(showPlus==undefined||showPlus==true){s=price<0?"-":(showPlus?"+":"");}else if(showPlus==false){s='';}
i=parseInt(price=Math.abs(+price||0).toFixed(precision))+"";pad=(i.length<integerRequired)?(integerRequired-i.length):0;while(pad){i='0'+i;pad--;}
j=(j=i.length)>groupLength?j%groupLength:0;re=new RegExp("(\\d{"+groupLength+"})(?=\\d)","g");r=(j?i.substr(0,j)+groupSymbol:"")+i.substr(j).replace(re,"$1"+groupSymbol)+(precision?decimalSymbol+Math.abs(price-i).toFixed(precision).replace(/-/,0).slice(2):"")
if(format.pattern.indexOf('{sign}')==-1){pattern=s+format.pattern;}else{pattern=format.pattern.replace('{sign}',s);}
return pattern.replace('%s',r).replace(/^\s\s*/,'').replace(/\s\s*$/,'');};function expandDetails(el,childClass){if(Element.hasClassName(el,'show-details')){$$(childClass).each(function(item){item.hide()});Element.removeClassName(el,'show-details');}
else{$$(childClass).each(function(item){item.show()});Element.addClassName(el,'show-details');}}
var isIE=navigator.appVersion.match(/MSIE/)=="MSIE";if(!window.Varien)
var Varien=new Object();Varien.showLoading=function(){Element.show('loading-process');}
Varien.hideLoading=function(){Element.hide('loading-process');}
Varien.GlobalHandlers={onCreate:function(){Varien.showLoading();},onComplete:function(){if(Ajax.activeRequestCount==0){Varien.hideLoading();}}};Ajax.Responders.register(Varien.GlobalHandlers);Varien.searchForm=Class.create();Varien.searchForm.prototype={initialize:function(form,field,emptyText){this.form=$(form);this.field=$(field);this.emptyText=emptyText;Event.observe(this.form,'submit',this.submit.bind(this));Event.observe(this.field,'focus',this.focus.bind(this));Event.observe(this.field,'blur',this.blur.bind(this));this.blur();},submit:function(event){if(this.field.value==this.emptyText||this.field.value==''){Event.stop(event);return false;}
return true;},focus:function(event){if(this.field.value==this.emptyText){this.field.value='';}},blur:function(event){if(this.field.value==''){this.field.value=this.emptyText;}},initAutocomplete:function(url,destinationElement){new Ajax.Autocompleter(this.field,destinationElement,url,{paramName:this.field.name,method:'get',minChars:2,frequency:1,updateElement:this._selectAutocompleteItem.bind(this),onShow:function(element,update){if(!update.style.position||update.style.position=='absolute'){update.style.position='absolute';Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight});}
Effect.Appear(update,{duration:0});}});},_selectAutocompleteItem:function(element){if(element.title){this.field.value=element.title;}
this.form.submit();}}
Varien.Tabs=Class.create();Varien.Tabs.prototype={initialize:function(selector){var self=this;$$(selector+' a').each(this.initTab.bind(this));},initTab:function(el){el.href='javascript:void(0)';if($(el.parentNode).hasClassName('active')){this.showContent(el);}
el.observe('click',this.showContent.bind(this,el));},showContent:function(a){var li=$(a.parentNode);var ul=$(li.parentNode);ul.getElementsBySelector('ol').each(function(el){var contents=$(el.id+'_contents');if(el==li){el.addClassName('active');contents.show();}else{el.removeClassName('active');contents.hide();}});ul.getElementsBySelector('li').each(function(el){var contents=$(el.id+'_contents');if(el==li){el.addClassName('active');contents.show();}else{el.removeClassName('active');contents.hide();}});}}
Varien.DateElement=Class.create();Varien.DateElement.prototype={initialize:function(type,content,required,format){this.content=content;this.type=type;if(type=='id'){this.day=$(content+'day');this.month=$(content+'month');this.year=$(content+'year');this.full=$(content+'full');this.advice=$(content+'advice');}else if(type=='container'){this.day=content.day;this.month=content.month;this.year=content.year;this.full=content.full;this.advice=content.advice;}else{return;}
this.required=required;this.format=format;this.day.addClassName('validate-custom');this.day.validate=this.validate.bind(this);this.month.addClassName('validate-custom');this.month.validate=this.validate.bind(this);this.year.addClassName('validate-custom');this.year.validate=this.validate.bind(this);this.year.setAttribute('autocomplete','off');this.advice.hide();},validate:function(){var error=false,day=parseInt(this.day.value,10)||0,month=parseInt(this.month.value,10)||0,year=parseInt(this.year.value,10)||0;if(!day&&!month&&!year){if(this.required){error=Translator.translate('Enter the correct date');}else{this.full.value='';}}else if(!day||!month||!year){if(this.required){error=Translator.translate('Enter the correct date');;}else{this.full.value='';}}else{var date=new Date,curyear=date.getFullYear(),countDaysInMonth=0,errorType=null;date.setYear(year);date.setMonth(month-1);date.setDate(32);countDaysInMonth=32-date.getDate();if(!countDaysInMonth||countDaysInMonth>31)countDaysInMonth=31;if(day<1||day>countDaysInMonth){errorType='day';error=Translator.translate('the wrong day')+'(1-%d).';}else if(month<1||month>12){errorType='month';error=Translator.translate('Invalid month');}else if(year<1900||year>curyear){errorType='year';error=Translator.translate('Invalid year')+'(1900-%d).';}else{if(day%10==day)this.day.value='0'+day;if(month%10==month)this.month.value='0'+month;this.full.value=this.format.replace(/%[mb]/i,this.month.value).replace(/%[de]/i,this.day.value).replace(/%y/i,this.year.value);var testFull=this.month.value+'/'+this.day.value+'/'+this.year.value;var test=new Date(testFull);if(isNaN(test)){error=window.errorMessageDate;}}}
if(error!==false){this.advice.innerHTML=error.replace('%d',errorType=='day'?countDaysInMonth:curyear);this.advice.show();return false;}
this.day.removeClassName('validation-failed');this.month.removeClassName('validation-failed');this.year.removeClassName('validation-failed');this.advice.hide();return true;}};Varien.DOB=Class.create();Varien.DOB.prototype={initialize:function(selector,required,format){var el=$$(selector)[0];var container={};container.day=Element.select(el,'.dob-day input')[0];container.month=Element.select(el,'.dob-month input')[0];container.year=Element.select(el,'.dob-year input')[0];container.full=Element.select(el,'.dob-full input')[0];container.advice=Element.select(el,'.validation-advice')[0];new Varien.DateElement('container',container,required,format);}};Varien.FileElement=Class.create();Varien.FileElement.prototype={initialize:function(id){this.fileElement=$(id);this.hiddenElement=$(id+'_value');this.fileElement.observe('change',this.selectFile.bind(this));},selectFile:function(event){this.hiddenElement.value=this.fileElement.getValue();}};Validation.addAllThese([['validate-custom',' ',function(v,elm){return elm.validate();}]]);function truncateOptions(){$$('.truncated').each(function(element){Event.observe(element,'mouseover',function(){if(element.down('div.truncated_full_value')){element.down('div.truncated_full_value').addClassName('show')}});Event.observe(element,'mouseout',function(){if(element.down('div.truncated_full_value')){element.down('div.truncated_full_value').removeClassName('show')}});});}
Event.observe(window,'load',function(){truncateOptions();});Element.addMethods({getInnerText:function(element)
{element=$(element);if(element.innerText&&!Prototype.Browser.Opera){return element.innerText}
return element.innerHTML.stripScripts().unescapeHTML().replace(/[\n\r\s]+/g,' ').strip();}});function fireEvent(element,event){if(document.createEventObject){var evt=document.createEventObject();return element.fireEvent('on'+event,evt)}
else{var evt=document.createEvent("HTMLEvents");evt.initEvent(event,true,true);return!element.dispatchEvent(evt);}};Varien.searchMiniForm=Class.create();Varien.searchMiniForm.prototype={initialize:function(form,field,emptyText){this.form=$(form);this.field=$(field);this.emptyText=emptyText;Event.observe(this.form,'submit',this.submit.bind(this));Event.observe(this.field,'focus',this.focus.bind(this));Event.observe(this.field,'blur',this.blur.bind(this));this.blur();},submit:function(event){if(this.field.value==this.emptyText||this.field.value==''){Event.stop(event);return false;}
return true;},focus:function(event){if(this.field.value==this.emptyText){this.field.value='';}},blur:function(event){if(this.field.value==''){this.field.value=this.emptyText;}},initAutocomplete:function(url,destinationElement){new Ajax.MiniAutocompleter(this.field,destinationElement,url,{paramName:this.field.name,method:'get',minChars:2,frequency:1,updateElement:this._selectAutocompleteItem.bind(this),onShow:function(element,update){if(!update.style.position||update.style.position=='absolute'){update.style.position='absolute';Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight});}
Effect.Appear(update,{duration:0});}});},_selectAutocompleteItem:function(element){if(element.title){this.field.value=element.title;}
this.form.submit();}}
Ajax.MiniAutocompleter=Class.create(Autocompleter.Base,{initialize:function(element,update,url,options){this.baseInitialize(element,update,options);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.onKeyPress=this.onKeyPress.bind(this);this.options.render=this.render.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url;},getUpdatedChoices:function(){this.startIndicator();var entry=encodeURIComponent(this.options.paramName)+'='+
encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams)
this.options.parameters+='&'+this.options.defaultParams;if($('payment_method_select')){this.options.parameters+='&payment='+$('payment_method_select').value;}
if(this.options.admin==true){if($('city_id')){this.options.parameters+='&city_id='+$('city_id').value;}
if($('order-shipping_address_city_id')){this.options.parameters+='&city_id='+$('order-shipping_address_city_id').value;}
if(typeof(this.options.table)!='undefined'){this.options.parameters+='&table='+this.options.table;}
if(typeof(this.options.shippingMethod)!='undefined'&&this.options.shippingMethod!='other'){this.options.parameters+='&method='+this.options.shippingMethod;}}
new Ajax.Request(this.url,this.options);},onComplete:function(request){this.updateChoices(request.responseText);},onKeyPress:function(event){var searchAutocomplete=this.update;if(searchAutocomplete.getStyle('display')=='block'){var resultListElements=searchAutocomplete.select('.search-result>li');var seeAll=searchAutocomplete.select('.see-all');resultListElements=resultListElements.concat(seeAll);var length=resultListElements.length-1
var selectedIndex=null;var currentElement=null;var nextElement=null;var nextIndex=0;switch(event.keyCode){case Event.KEY_RETURN:selectedIndex=this.getIndexSelection(resultListElements);if(selectedIndex==null){searchAutocomplete.hide();$('search_mini_form').submit();Event.stop(event);return;}
currentElement=resultListElements[selectedIndex];var link=currentElement.select('a');if(currentElement.hasClassName('see-all')){searchAutocomplete.hide();$('search_mini_form').submit();Event.stop(event);}else{location.href=link[0].href;searchAutocomplete.hide();this.onBlur(event);event.preventDefault();}
return;case Event.KEY_ESC:this.hide();this.active=false;Event.stop(event);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:selectedIndex=this.getIndexSelection(resultListElements);if(selectedIndex!=null){currentElement=resultListElements[selectedIndex];nextIndex=(0==selectedIndex)?length:selectedIndex-1;currentElement.removeClassName('selected');nextElement=resultListElements[nextIndex];}else{nextElement=resultListElements[length];}
nextElement.addClassName('selected');var search=$('search')
search.focus();search.selectionStart=search.value.length;event.preventDefault();return;case Event.KEY_DOWN:selectedIndex=this.getIndexSelection(resultListElements);if(selectedIndex!=null){currentElement=resultListElements[selectedIndex];nextIndex=(length==selectedIndex)?0:selectedIndex+1;currentElement.removeClassName('selected');nextElement=resultListElements[nextIndex];}else{nextElement=resultListElements[0];}
nextElement.addClassName('selected');return;}}
this.active=false;},getIndexSelection:function(resultListElements){var result=null;var length=resultListElements.length
for(var i=0;i<=length-1;i++){var current=resultListElements[i];if(current.hasClassName('selected')){result=i;break;}}
return result;},render:function(){if(this.entryCount>0){if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},});;VarienForm=Class.create();VarienForm.prototype={initialize:function(formId,firstFieldFocus){this.form=$(formId);if(!this.form){return;}
this.cache=$A();this.currLoader=false;this.currDataIndex=false;this.validator=new Validation(this.form);this.elementFocus=this.elementOnFocus.bindAsEventListener(this);this.elementBlur=this.elementOnBlur.bindAsEventListener(this);this.childLoader=this.onChangeChildLoad.bindAsEventListener(this);this.highlightClass='highlight';this.extraChildParams='';this.firstFieldFocus=firstFieldFocus||false;this.bindElements();if(this.firstFieldFocus){try{Form.Element.focus(Form.findFirstElement(this.form))}
catch(e){}}},submit:function(url){if(this.validator&&this.validator.validate()){this.form.submit();}
return false;},bindElements:function(){var elements=Form.getElements(this.form);for(var row in elements){if(elements[row].id){Event.observe(elements[row],'focus',this.elementFocus);Event.observe(elements[row],'blur',this.elementBlur);}}},elementOnFocus:function(event){var element=Event.findElement(event,'fieldset');if(element){Element.addClassName(element,this.highlightClass);}},elementOnBlur:function(event){var element=Event.findElement(event,'fieldset');if(element){Element.removeClassName(element,this.highlightClass);}},setElementsRelation:function(parent,child,dataUrl,first){if(parent=$(parent)){if(!this.cache[parent.id]){this.cache[parent.id]=$A();this.cache[parent.id]['child']=child;this.cache[parent.id]['dataUrl']=dataUrl;this.cache[parent.id]['data']=$A();this.cache[parent.id]['first']=first||false;}
Event.observe(parent,'change',this.childLoader);}},onChangeChildLoad:function(event){element=Event.element(event);this.elementChildLoad(element);},elementChildLoad:function(element,callback){this.callback=callback||false;if(element.value){this.currLoader=element.id;this.currDataIndex=element.value;if(this.cache[element.id]['data'][element.value]){this.setDataToChild(this.cache[element.id]['data'][element.value]);}
else{new Ajax.Request(this.cache[this.currLoader]['dataUrl'],{method:'post',parameters:{"parent":element.value},onComplete:this.reloadChildren.bind(this)});}}},reloadChildren:function(transport){var data=eval('('+transport.responseText+')');this.cache[this.currLoader]['data'][this.currDataIndex]=data;this.setDataToChild(data);},setDataToChild:function(data){if(data.length){var child=$(this.cache[this.currLoader]['child']);if(child){var html='<select name="'+child.name+'" id="'+child.id+'" class="'+child.className+'" title="'+child.title+'" '+this.extraChildParams+'>';if(this.cache[this.currLoader]['first']){html+='<option value="">'+this.cache[this.currLoader]['first']+'</option>';}
for(var i in data){if(data[i].value){html+='<option value="'+data[i].value+'"';if(child.value&&(child.value==data[i].value||child.value==data[i].label)){html+=' selected';}
html+='>'+data[i].label+'</option>';}}
html+='</select>';Element.insert(child,{before:html});Element.remove(child);}}
else{var child=$(this.cache[this.currLoader]['child']);if(child){var html='<input type="text" name="'+child.name+'" id="'+child.id+'" class="'+child.className+'" title="'+child.title+'" '+this.extraChildParams+'>';Element.insert(child,{before:html});Element.remove(child);}}
this.bindElements();if(this.callback){this.callback();}}}
RegionUpdater=Class.create();RegionUpdater.prototype={initialize:function(countryEl,regionTextEl,regionSelectEl,regions,disableAction,zipEl)
{this.countryEl=$(countryEl);this.regionTextEl=$(regionTextEl);this.regionSelectEl=$(regionSelectEl);this.zipEl=$(zipEl);this.regions=regions;this.disableAction=(typeof disableAction=='undefined')?'hide':disableAction;this.zipOptions=(typeof zipOptions=='undefined')?false:zipOptions;if(this.regionSelectEl.options.length<=1){this.update();}
Event.observe(this.countryEl,'change',this.update.bind(this));},update:function()
{if(this.regions[this.countryEl.value]){var i,option,region,def;if(this.regionTextEl){def=this.regionTextEl.value.toLowerCase();this.regionTextEl.value='';}
if(!def){def=this.regionSelectEl.getAttribute('defaultValue');}
this.regionSelectEl.options.length=1;for(regionId in this.regions[this.countryEl.value]){region=this.regions[this.countryEl.value][regionId];option=document.createElement('OPTION');option.value=regionId;option.text=region.name;if(this.regionSelectEl.options.add){this.regionSelectEl.options.add(option);}else{this.regionSelectEl.appendChild(option);}
if(regionId==def||region.name.toLowerCase()==def||region.code.toLowerCase()==def){this.regionSelectEl.value=regionId;}}
if(this.disableAction=='hide'){if(this.regionTextEl){this.regionTextEl.style.display='none';}
this.regionSelectEl.style.display='';}else if(this.disableAction=='disable'){if(this.regionTextEl){this.regionTextEl.disabled=true;}
this.regionSelectEl.disabled=false;}
this.setMarkDisplay(this.regionSelectEl,true);}else{if(this.disableAction=='hide'){if(this.regionTextEl){this.regionTextEl.style.display='';}
this.regionSelectEl.style.display='none';Validation.reset(this.regionSelectEl);}else if(this.disableAction=='disable'){if(this.regionTextEl){this.regionTextEl.disabled=false;}
this.regionSelectEl.disabled=true;}else if(this.disableAction=='nullify'){this.regionSelectEl.options.length=1;this.regionSelectEl.value='';this.regionSelectEl.selectedIndex=0;this.lastCountryId='';}
this.setMarkDisplay(this.regionSelectEl,false);}
var zipUpdater=new ZipUpdater(this.countryEl.value,this.zipEl);zipUpdater.update();},setMarkDisplay:function(elem,display){elem=$(elem);var labelElement=elem.up(0).down('label > span.required')||elem.up(1).down('label > span.required')||elem.up(0).down('label.required > em')||elem.up(1).down('label.required > em');if(labelElement){inputElement=labelElement.up().next('input');if(display){labelElement.show();if(inputElement){inputElement.addClassName('required-entry');}}else{labelElement.hide();if(inputElement){inputElement.removeClassName('required-entry');}}}}}
ZipUpdater=Class.create();ZipUpdater.prototype={initialize:function(country,zipElement)
{this.country=country;this.zipElement=$(zipElement);},update:function()
{if(typeof optionalZipCountries=='undefined'){return false;}
if(this.zipElement!=undefined){this._setPostcodeOptional();}else{Event.observe(window,"load",this._setPostcodeOptional.bind(this));}},_setPostcodeOptional:function()
{this.zipElement=$(this.zipElement);if(this.zipElement==undefined){return false;}
var label=$$('label[for="'+this.zipElement.id+'"]')[0];if(label!=undefined){var wildCard=label.down('em')||label.down('span.required');}
if(optionalZipCountries.indexOf(this.country)!=-1){while(this.zipElement.hasClassName('required-entry')){this.zipElement.removeClassName('required-entry');}
if(wildCard!=undefined){wildCard.hide();}}else{this.zipElement.addClassName('required-entry');if(wildCard!=undefined){wildCard.show();}}}};var Translate=Class.create();Translate.prototype={initialize:function(data){this.data=$H(data);},translate:function(){var args=arguments;var text=arguments[0];if(this.data.get(text)){return this.data.get(text);}
return text;},add:function(){if(arguments.length>1){this.data.set(arguments[0],arguments[1]);}else if(typeof arguments[0]=='object'){$H(arguments[0]).each(function(pair){this.data.set(pair.key,pair.value);}.bind(this));}}};var Translate=Class.create(Translate,{translate:function(){var args=arguments;var text=arguments[0];var url=window.location.href;if(this.data.get(text)){if(url.indexOf('show_translate')!==-1){return text;}else{return this.data.get(text);}}
return text;}});;if(!window.Mage)var Mage={};Mage.Cookies={};Mage.Cookies.expires=null;Mage.Cookies.path='/';Mage.Cookies.domain=null;Mage.Cookies.secure=false;Mage.Cookies.set=function(name,value){var argv=arguments;var argc=arguments.length;var expires=(argc>2)?argv[2]:Mage.Cookies.expires;var path=(argc>3)?argv[3]:Mage.Cookies.path;var domain=(argc>4)?argv[4]:Mage.Cookies.domain;var secure=(argc>5)?argv[5]:Mage.Cookies.secure;document.cookie=name+"="+escape(value)+
((expires==null)?"":("; expires="+expires.toGMTString()))+
((path==null)?"":("; path="+path))+
((domain==null)?"":("; domain="+domain))+
((secure==true)?"; secure":"");};Mage.Cookies.get=function(name){var arg=name+"=";var alen=arg.length;var clen=document.cookie.length;var i=0;var j=0;while(i<clen){j=i+alen;if(document.cookie.substring(i,j)==arg)
return Mage.Cookies.getCookieVal(j);i=document.cookie.indexOf(" ",i)+1;if(i==0)
break;}
return null;};Mage.Cookies.clear=function(name){if(Mage.Cookies.get(name)){document.cookie=name+"="+"; expires=Thu, 01-Jan-70 00:00:01 GMT";}};Mage.Cookies.getCookieVal=function(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1){endstr=document.cookie.length;}
return unescape(document.cookie.substring(offset,endstr));};;var merge=function(a,b,m){"use strict";var aa;for(aa in b){if(m){if(b.hasOwnProperty(aa)&&!a.hasOwnProperty(aa)){a[aa]=b[aa];}}else{if(b.hasOwnProperty(aa)&&a.hasOwnProperty(aa)){a[aa]=b[aa];}}}
return a;};var linkDropDown=function(select,options){var h={},dO={linkClass:'ajax-link dropdown-link',animOptions:{duration:0.13}},html,ahtml,dia,anc,ul,lis,ddiv;h.select=$(select);if(!h.select||(h.select.tagName.toUpperCase()!=='SELECT')){return;}
if(h.select.fireselected){return;}
h.select.fireselected=true;h.op=options||{};h.op=merge(h.op,dO,true);h.select.setStyle({position:'absolute',top:'-150000px'});var currentValueText='';if(!h.select.value){if(typeof h.op.defaultVal!='undefined'&&h.op.defaultVal){h.select.value=h.op.defaultVal;}else{if(typeof h.op.defaultEmpty=='undefined'||!h.op.defaultEmpty){if(h.select.options.length){h.select.value=h.select.options[0].val;currentValueText=h.select.options[0].text;}}else{if(typeof h.op.placeholder!=='undefined'){currentValueText=h.op.placeholder;}}}}
if(!currentValueText){for(dia=0;dia<h.select.options.length;dia++){if(h.select.options[dia].value==h.select.value){currentValueText=h.select.options[dia].text;break;}}}
html='<div class="fireselect-container">';html=html+'<a href="javascript:;" class="'+h.op.linkClass+'"><span class="label">'+currentValueText+'</span><span class="icon"></span></a>';html=html+'<ul id="'+select.id+'-list" style="display:none;">';for(dia=0;dia<h.select.options.length;dia++){if(h.select.options[dia].value==h.select.value){ahtml='class="current"';}else{ahtml='';}
insertAddressString=h.select[dia].innerText.trim();while(insertAddressString.indexOf('"')>-1){insertAddressString=insertAddressString.replace('"','&Prime;');}
while(insertAddressString.indexOf('\'')>-1){insertAddressString=insertAddressString.replace('\'','&prime;');}
if(h.select[dia].value=='promocredit'){var textPromo="* 0,<span style=\'font-size:8px\'>01</span>%";var textPromotitle="* 0,01%";html+='<li style="color:green;font-weight: bold" '+ahtml+' onclick="return [\''+h.select[dia].value+'\', \''+textPromotitle+'\', '+dia+'];">'+textPromo+'</li>'}else{html=html+'<li '+ahtml+' onclick="return [\''+h.select[dia].value+'\', \''+insertAddressString+'\', '+dia+'];">'+h.select[dia].innerHTML+'</li>'}}
html=html+'</ul></div>';var t=h.select.insert({before:html});ddiv=h.select.previous();h.ac=ddiv.select('a')[0];h.anc=ddiv.select('a span.label')[0];ul=ddiv.select('ul')[0];lis=ddiv.select('ul li');ddiv.setStyle({position:'relative',zIndex:0});ul.setStyle({position:'absolute'});h.sc=function(m){lis.invoke('removeClassName','current');m.addClassName('current');};h.sp=function(){}
h.sh=function(){h.sp();var ulId=ul.getAttribute('id');Effect.Appear(ul,h.op.animOptions);ddiv.style.zIndex=1000;ul.showing=true;}
h.hd=function(){if(ul.showing){Effect.Fade(ul,h.op.animOptions);ddiv.style.zIndex=0;ul.showing=false;Validation.validate(h.select);}}
h.tg=function(e){if(ul.style.display!=='none'){h.hd();}else{h.sh();}
e.stop();}
h.se=function(e){var b=e.target.onclick();h.sc(e.target);h.anc.innerHTML=b[1];h.select.value=b[0];h.select.simulate('change');h.hd();}
h.smes=function(){};h.ac.observe('click',h.tg);lis.each(function(li){li.observe('click',h.se);li.observe('mouseover',function(e){e.target.addClassName('over');});li.observe('mouseout',function(e){e.target.removeClassName('over');});});document.observe('click',h.hd);}
var linkCheckoutDropDown=function(select,options){var h={},dO={linkClass:'ajax-link dropdown-link',animOptions:{duration:0.13}},html,ahtml,dia,anc,ul,lis,ddiv;h.select=$(select);if(!h.select||(h.select.tagName.toUpperCase()!=='SELECT')){return;}
if(h.select.fireselected){return;}
h.select.fireselected=true;h.op=options||{};h.op=merge(h.op,dO,true);h.select.setStyle({position:'absolute',top:'-150000px'});html='<div class="fireselect-container">';html=html+'<a href="javascript:;" class="'+h.op.linkClass+'"><div class="label">'+h.select[h.select.selectedIndex].innerHTML+'</div><span class="icon"></span></a>';html=html+'<div class="'+select.id+'_div">';html=html+'<div class="'+select.id+'_new_div">';html=html+'<ul id="'+select.id+'-list" style="display:none;">';for(dia=0;dia<h.select.options.length;dia++){if(dia==h.select.selectedIndex){ahtml='class="current"';}else{ahtml='';}
insertAddressString=h.select[dia].innerHTML;while(insertAddressString.indexOf('"')>-1){insertAddressString=insertAddressString.replace('"','&Prime;');}
while(insertAddressString.indexOf('\'')>-1){insertAddressString=insertAddressString.replace('\'','&prime;');}
insertAddressString=insertAddressString.replace('\n','');if(h.select[dia].value=='promocredit'){var textPromo="* 0,<span style=\'font-size:8px\'>01</span>%";var textPromotitle="* 0,01%";html+='<li style="color:green;font-weight: bold" '+ahtml+' onclick="return [\''+h.select[dia].value+'\', \''+textPromotitle+'\', '+dia+'];">'+textPromo+'</li>'}else{html=html+'<li '+ahtml+'data-id="'+h.select[dia].value+'" onclick="return [\''+h.select[dia].value+'\', \''+insertAddressString+'\', '+dia+'];">'+h.select[dia].innerHTML+'</li>'}}
html=html+'</ul></div></div></div>';var t=h.select.insert({after:html});ddiv=h.select.next();h.ac=ddiv.select('a')[0];h.anc=ddiv.select('a div.label')[0];ul=ddiv.select('ul')[0];var liClass='div.'+select.id+'_div ul li';lis=ddiv.select(liClass);var divClass='div.'+select.id+'_div';var divShow=ddiv.select(divClass)[0];divShow.hide();ddiv.setStyle({position:'relative',zIndex:0})
ul.setStyle({position:'relative'});h.sc=function(m){lis.invoke('removeClassName','current');m.addClassName('current');};h.sp=function(){var t=[];ul.setStyle({top:'-15000px',display:'block'})
t['obj']=ul.select('.current')[0];t['y']=t['obj'].positionedOffset()[1];t['h']=t['obj'].getHeight();t['p']=parseInt(t['obj'].getStyle('padding-top'),10);t['lp']=parseInt(t['obj'].getStyle('padding-left'),10)+1;ul.setStyle({display:'none',left:'-'+t['lp']+'px',top:'-'+t['h']+'px'});}
h.sh=function(){h.sp();divShow.show();var ulId=ul.getAttribute('id');CheckoutEffect.Appear(ul,h.op.animOptions);ddiv.style.zIndex=1000;ul.showing=true;}
h.hd=function(){if(ul.showing){divShow.hide();Effect.Fade(ul,h.op.animOptions);ddiv.style.zIndex=0;ul.showing=false;}}
h.tg=function(e){if(ul.style.display!=='none'){h.hd();}else{h.sh();}
e.stop();}
h.se=function(e){var b=e.target.onclick();h.sc(e.target);h.anc.innerHTML=b[1];h.select.selectedIndex=b[2];allo.storesMap.selectedStoreId=b[0];h.select.simulate('change');h.hd();}
h.ac.observe('click',h.tg);lis.each(function(li){li.observe('click',h.se);li.observe('mouseover',function(e){e.target.addClassName('over');});li.observe('mouseout',function(e){e.target.removeClassName('over');});});document.observe('click',h.hd)};if(!Date.now){Date.now=function(){return new Date().getTime();}}
Array.prototype.contains=function(obj){var i=this.length;while(i--){if(this[i]===obj){return true;}}
return false;};allo=new function(){this.viewMode='';this.comparison={};};allo.tools=new function(){this.uniqid=function(){var idstr=String.fromCharCode(Math.floor((Math.random()*25)+65));do{var ascicode=Math.floor((Math.random()*42)+48);if(ascicode<58||ascicode>64){idstr+=String.fromCharCode(ascicode);}}while(idstr.length<32);return(idstr);};};allo.storage=new function(){var _this=this;var _isLocalStorage=function(){if(typeof localStorage!='object'){console.error('noStorage');return false;}
return true;};this.set=function(key,value){var value=value.toJSON();if(_isLocalStorage()){localStorage.setItem(key,value);}};this.get=function(key){var value=null;if(_isLocalStorage()){value=localStorage.getItem(key);}
if(value!=null){value=value.evalJSON();}
return value;};};allo.cookies=new function(){this.set=function(key,value,expires){if(!expires){expires=new Date();expires.setTime(expires.getTime()+1000*60*60*24*365)}
document.cookie=key+'='+escape(value)+'; expires='+expires+'; path=/';}
this.get=function(key){var cookie=" "+document.cookie;var search=" "+key+"=";var value=null;var offset=0;var end=0;if(cookie.length>0){offset=cookie.indexOf(search);if(offset!=-1){offset+=search.length;end=cookie.indexOf(";",offset);if(end==-1){end=cookie.length;}
value=unescape(cookie.substring(offset,end));value=value.evalJSON();}}
return value;};};allo.data=new function(){var _data=new Object();var _this=this;this.setSerialized=function(key,serialized){data=serialized.evalJSON();_this.set(key,data);return _this;};this.set=function(key,data){_data[key]=data;return _this;};this.get=function(key){return _data[key];};};allo.format=new function(){this.price=function(price){var stringPrice=price.toString();var point=stringPrice.indexOf('.');var morePrice=stringPrice;var lessPrice='00';if(point!=-1){morePrice=stringPrice.substring(0,point);lessPrice=stringPrice.substring(point+1);}
if(lessPrice.length>2){lessPrice=lessPrice.substring(0,2);}
else if(lessPrice.length==1){lessPrice='0'+lessPrice;}
else{lessPrice='00';}
if(morePrice.length>6){morePrice=morePrice.substring(0,morePrice.length-6)+' '+morePrice.substring(morePrice.length-6);morePrice=morePrice.substring(0,morePrice.length-3)+' '+morePrice.substring(morePrice.length-3);}
else if(morePrice.length>3){morePrice=morePrice.substring(0,morePrice.length-3)+' '+morePrice.substring(morePrice.length-3);}
if(lessPrice=='00'){stringPrice=morePrice;}
else{stringPrice=morePrice+'.'+lessPrice;}
return stringPrice;};};function countObj(obj){var count=0;for(k in obj){if(obj.hasOwnProperty(k)){++count;}}
return count;}
allo.templates=new function(){this.tpl=Array();};allo.GA=new function(){this.buttonsParams=Array();};allo.sendSC=function(data){if(!_sc)return;var statusCart={};statusCart['StatusCart']=[];if(data.customer&&data.customer.customer){if(data.customer.customer.name&&data.customer.customer.email){statusCart['user']={firstName:data.customer.customer.name,email:data.customer.customer.email}}}
if(data.cart&&data.cart.items){for(var item in data.cart.items){if(data.cart.items[item].sku&&data.cart.items[item].simplePrice&&data.cart.items[item].q){statusCart['StatusCart'].push({productKey:data.cart.items[item].sku,price:data.cart.items[item].simplePrice,quantity:data.cart.items[item].q});}}}
_sc.sendEvent("StatusCart",statusCart);};allo.sendSCThankYouPage=function(orderNumbers){if(!_sc&&!orderNumbers)return;orderNumbers.each(function(i,e){_sc.sendEvent('PurchasedItems',{"OrderNumber":e});});};allo.addSuserPanel=function(data){var html,emailHtml;suser=data.result.customer.customer.suser;if(suser!==undefined){var email=suser.suser_email,url=suser.suser_history_url;emailHtml=(url===false)?'<span class="left" style="color: #f9f9f9;">'+email+'</span>':'<a href="'+url+'" class="left" style="color: #f9f9f9;" >'+email+'</a>';html='<div class="suser-panel"> <div class="header-content">'
+'<div class="suser-panel"> <div class="header-content">'
+emailHtml
+'<a href="#" class="right" style="color: #f9f9f9;" onclick="allo.deleteCookieSuser()">'+suser.log_out_button+'</a>'
+'</div></div>'+'<div class="clearer"></div>';$$('.footer-container')[0].insert({bottom:html});}}
allo.session=new function(){this.getData=function(){var url=window.getSessionUrl||(CURRENT_BASE_URL+'ajax/block/getSession');url+=(/\?/.test(url)?'&':'?')+'ts='+Date.now();new Ajax.Request(url,{onSuccess:function(transport){var suser;data=transport.responseText.evalJSON();allo.session.data=data.result;allo.addSuserPanel(data);allo.blocks.viewedProducts.update();}});};};document.observe('viewedProducts:updated',function(){allo.session.data.recent=allo.blocks.viewedProducts.get();allo.session.loaded=true;document.fire('session:loaded');});document.observe('viewedProducts:loaded',function(){var viewedCarousel=new UI.Carousel('recentCarousel');trackRewindCarousel(viewedCarousel,$$('#recentCarousel .next_button')[0],$$('#recentCarousel .previous_button')[0],'Recent Goods','','rewind-recent');});if(allo.session.data===undefined){allo.session.getData();}
allo.blocks=new function(){var _collection=new Array();var _this=this;var _initialized=false;var _ajaxObservers=new Array();var _ajaxRequest=function(){var url=CURRENT_BASE_URL+'/ajax/block/get';params={'collection':_collection.toJSON()};new Ajax.Request(url,{parameters:params,onSuccess:_ajaxRequested});};var _ajaxRequested=function(transport){data=transport.responseText.evalJSON();_collection.each(function(_item){if(_item.type!='html'&&_item.type!='block'){return;}
$(_item.conteinerId).outerHTML=data.result[_item.conteinerId];});_ajaxObservers.each(function(_item){if(typeof data.result[_item.id]===undefined){return;}
_item.observer(data.result[_item.id]);});Enterprise.TopCart.initialize('topCartContent');window.cartController.options={topTitle:$('topCartTitle'),innerWrapper:$('innerWrapper')};};this.forceGet=function(type,request,data,observer){var collection=new Array({conteinerId:'forceGet',type:type,request:request,data:data});var params={'collection':collection.toJSON()};var url=CURRENT_BASE_URL+'ajax/block/get';new Ajax.Request(url,{method:'GET',parameters:params,onSuccess:function(transport){responseData=transport.responseText.evalJSON();forceGetData=responseData.result.forceGet;observer(forceGetData);}});};this.getAjax=function(request,data,observer){identify='ajax_allo_blocks_getAjax_'+Math.floor(Math.random()*0x10000).toString(16);var blockObject={conteinerId:identify,type:'ajax',request:request,data:data};var observerObject={id:identify,observer:observer};_ajaxObservers.push(observerObject);_collection.push(blockObject);};this.initialize=function(){if(_initialized){return;}
_initialized=true;Event.observe(window,'load',_ajaxRequest);};this.updateBlock=function(params,additional){if(allo.session.loaded){allo.blocks._processBlock(params,additional);}else{document.observe('session:loaded',function(){allo.blocks._processBlock(params,additional);});}};this._processBlock=function(params,additional){var block=$(params.id);var tplName=params.type+'_'+params.templateName;var data=allo.session.data[params.type];if(typeof(data)=='undefined'){return;}
if(data.item){delete data.item;}
var html='';if(allo.templates.tpl[tplName]){var tpl=new EJS(allo.templates.tpl[tplName]);data.itemId=params.elementId?params.elementId:'';data.id=params.id?params.id:'';if(additional){data.additional=additional;allo.GA.buttonsParams[params.id]=additional;}
if(params.type=='customer'||params.type=='cart')
{data.AllVars=params.AllVars;}
html=tpl.render(data);if(html.length>1&&block&&block.up()){block.up().update(html);}
allo.blocks._afterProcessBlock(params);}};this._afterProcessBlock=function(params)
{if(params.observer){var observer=params.observer;observer();return;}
if(params.type=='cart'){var selector='[name=buy-button_'+params.elementId+']';if(typeof(cartController)!="undefined"){cartController.observeLinks($$(selector));}}};this.getBlock=function(block,blockId){var blockDefined=false;_this.initialize();if(!blockId){blockId='ajax_allo_blocks_getBlock_'+Math.floor(Math.random()*0x10000).toString(16);}
else{blockDefined=true;}
var blockObject={conteinerId:blockId,type:'block',blockId:block};if(!blockDefined){document.write('<span class="hidden" id="'+blockObject.conteinerId+'"></span>');}
_collection.push(blockObject);};this.convertHtml=function(html,blockId){var blockDefined=false;_this.initialize();if(!blockId){blockId='ajax_allo_blocks_convertHtml_'+Math.floor(Math.random()*0x10000).toString(16);}
else{blockDefined=true;}
var blockObject={conteinerId:blockId,type:'html',encodedHtml:html};if(!blockDefined){document.write('<span class="hidden" id="'+blockObject.conteinerId+'"></span>');}
_collection.push(blockObject);};};allo.blocks.viewedProducts=new function(){var _this=this;this.add=function(product){var viewedProducts=allo.storage.get('viewedProducts');var counter=0;if(viewedProducts==null||typeof viewedProducts!='object'){viewedProducts=new Array();}
rebuildedProducts=new Array();viewedProducts.each(function(item){if(item.entryId&&item.entryId!=product.entryId&&counter<=25){item.isProduct=true;rebuildedProducts.push(item);}
counter++;});if(product.entryId){rebuildedProducts.unshift(product);}
allo.storage.set('viewedProducts',rebuildedProducts);};this.get=function(){var viewedProducts=allo.storage.get('viewedProducts');var data=new Object();if(viewedProducts==null||typeof viewedProducts!='object'){return;}
var products=new Array();viewedProducts.each(function(item){item.isProduct=true;var currentTime=Math.round(new Date().getTime()/1000);var specialFrom=(currentTime>item.specialFrom);if(!(item.specialPrice&&specialFrom)){item.specialPrice=0;}
if(item.price>0){item.price=allo.format.price(item.price);}
else{item.price=0;}
if(item.specialPrice){item.specialPrice=allo.format.price(item.specialPrice);}
products.push(item);});data.products=products;return data;};this.update=function(){var viewedProducts=allo.storage.get('viewedProducts');var viewedFromSession=allo.session.data.viewed;var products=[];var productIdsFromDb=[];var productsDiff=[];var allProducts=[];var i=0;var updateFlag=false;var isDifferents=false;var wrongProductUrl=false;var wrongMediaUrl=false;var productCondPassed=[];var mediaCondPassed=[];if((viewedFromSession==null||typeof viewedFromSession!='object')&&(viewedProducts==null||typeof viewedProducts!='object')){document.fire('viewedProducts:updated');return;}
if(viewedProducts!=null){viewedProducts.each(function(item){products.push(item.entryId);});}
if(viewedFromSession&&typeof viewedFromSession=='object'){jQuery.each(viewedFromSession,function(index,value){productIdsFromDb.push(value.product_id);if(products.indexOf(value.product_id)<0){isDifferents=true;}});if(isDifferents){var arrayLength=products.length;for(var a=0;a<arrayLength;a++){if(productIdsFromDb.indexOf(products[a])<0){productsDiff.push(products[a]);}}
allProducts=productsDiff.concat(productIdsFromDb);}}
if(viewedProducts!=null){viewedProducts.each(function(item){if(item.language!=CURRENT_STORE_LOCALE){updateFlag=true;}
for(var key in item){if(item.hasOwnProperty(key)&&typeof item[key]==='string'){productCondPassed=/https?:\/\/allo.ua/i.exec(item[key]);if(productCondPassed instanceof Array&&productCondPassed.length>0){wrongProductUrl=true;break;}
mediaCondPassed=/(http:\/\/im?g?.allo.ua|[^:]\/\/im?g?.allo.ua|^\/\/im?g?.allo.ua|https:\/\/img.allo.ua)/i.exec(item[key]);if(mediaCondPassed instanceof Array&&mediaCondPassed.length>0){wrongMediaUrl=true;break;}}}});}
if(!isDifferents&&!updateFlag&&!wrongProductUrl&&!wrongMediaUrl){document.fire('viewedProducts:updated');return;}
var url=BASE_URL+'tsg_catalog/catalog/updateViewedProducts';jQuery.ajax({url:url,type:'GET',data:{products:products,allProducts:allProducts},dataType:"json",success:function(data){if(data){allo.storage.set('viewedProducts','');data.reverse();for(var product in data){var obj=data[product];_this.add(obj);}}
document.fire('viewedProducts:updated');}});};};allo.getNewsletterData=function(){var url=CURRENT_BASE_URL+'/newsletter/subscriber/new/';new Ajax.Request(url,{method:'POST',parameters:$('newsletter').serialize(true),onSuccess:function(transport){var data=transport.responseText.evalJSON();if(data['status']==='success'){$('newsletter-form').hide();$('newsletter-success').show();$('newsletter-success').innerHTML=data['result']['massage'];}}})
return false;};allo.getLoginData=function(action){$('messages').hide();isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(!$('email').value||!$('pass').value||($('pass').value.length<6)||!isValidEmail.test($('email').value))
{errMessage=Translator.translate('This field is required.');validationFormIfEmpty(['email','pass'],errMessage);return false;}
$('advanced-navigation-overlay').show();new Ajax.Request(BASE_URL+'customer/account/loginPost/',{method:'POST',parameters:$('login-form').serialize(true),onSuccess:function(transport){$('advanced-navigation-overlay').hide();var data=transport.responseText.evalJSON();if(data['status']==='success'){if(data['result']['is_login']===true&&data['result']['login_url'])
{_gaq.push(['_trackEvent','authorization',action,'login']);document.location.href=data['result']['login_url'];}else if(data['result']['message']){$('messages').show();$('error-message-login').innerHTML=data['result']['message'];}}}})
return false;};allo.getLoginPopupData=function(action){$('messages-popup').hide();isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(!$('email-popup').value||!$('pass-popup').value||($('pass-popup').value.length<6)||!isValidEmail.test($('email-popup').value))
{errMessage=Translator.translate('This field is required.');validationFormIfEmpty(['email-popup','pass-popup'],errMessage);return false;}
$('advanced-navigation-overlay-popup').show();new Ajax.Request(BASE_URL+'customer/account/loginPost/',{method:'POST',parameters:$('login-form-popup').serialize(true),onSuccess:function(transport){$('advanced-navigation-overlay-popup').hide();var data=transport.responseText.evalJSON();if(data['status']==='success'){if(data['result']['is_login']===true&&data['result']['login_url'])
{_gaq.push(['_trackEvent','authorization',action,'login']);document.location.href=data['result']['login_url'];}else if(data['result']['message']){$('messages-popup').show();$('error-message-login-popup').innerHTML=data['result']['message'];}}}})
return false;};allo.getRegisterData=function(){if($('form-validate').canSubmit===false){return false;}
$('messages').hide();isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(!$('firstname').value||!$('email_address').value||!$('password').value||($('password').value.length<6)||!isValidEmail.test($('email_address').value))
{errMessage=Translator.translate('This field is required.');validationFormIfEmpty(['firstname','email_address','password'],errMessage);document.getElementById('advice-validate-ajax-email_address').innerHTML=errMessage;return false;}
$('advanced-navigation-overlay').show();var url=CURRENT_BASE_URL+'/customer/account/createpost/';new Ajax.Request(url,{method:'POST',parameters:$('form-validate').serialize(true),onSuccess:function(transport){$('advanced-navigation-overlay').hide();var data=transport.responseText.evalJSON();if(data['status']==='success'){result=data['result'];if(result['is_registered']===true&&result['success_url'])
{_gaq.push(['_trackEvent','authorization','registration','login']);document.location.href=result['success_url'];}else if(result['message']){$('messages').show();$('list-of-messages').innerHTML='<li><span>'+result['message']+'</span></li>';}else if(result['email_invalid_message']){validationFormIfEmailNoValid('email_address',result['email_invalid_message']);}}}})
return false;};allo.getLoginSuserData=function(){new Ajax.Request(CURRENT_BASE_URL+'suser/account/loginPostSuperUser/',{method:'POST',parameters:$('suser-login-form').serialize(true),onSuccess:function(transport){var result;var data=transport.responseText.evalJSON();const success='success';if(success===data['status']){result=data['result'];if(result['is_login']){if(result['redirect_url']){document.location.href=result['redirect_url'];}}}}});return false;};allo.deleteCookieSuser=function(redirect){if(redirect===undefined){redirect=true;}
new Ajax.Request(CURRENT_BASE_URL+'suser/account/loginDeleteSuperUser/',{method:'POST',parameters:null,onSuccess:function(transport){var data=transport.responseText.evalJSON();const success='success';if(data['status']===success){if($$('.suser-panel')[0]){$$('.suser-panel')[0].remove();}
if(redirect&&data['result']['redirect']){document.location.href=data['result']['logout_url'];}}}});};validationFormIfEmpty=function(arrayIds,errMessage){for(i=0;i<arrayIds.length;i++)
{if(!($(arrayIds[i]).value)){Validation.ajaxError($(arrayIds[i]),errMessage);}}}
validationFormIfEmailNoValid=function(elementId,errMessage){name='validate-ajax';advice=Validation.getAdvice(name,$(elementId));if(!advice){advice=Validation.createAdvice(name,$(elementId),false,errMessage);}
Validation.showAdvice($(elementId),advice,name);Validation.updateCallback($(elementId),'failed');$(elementId).addClassName('validation-failed');$(elementId).addClassName(name);document.getElementById('advice-validate-ajax-email_address').innerHTML=errMessage;}
createAndDispatchEvent=function(eventName){var mergedJsLoadedEvent=document.createEvent('Event');mergedJsLoadedEvent.initEvent(eventName,true,true);document.dispatchEvent(mergedJsLoadedEvent);};allo.cities=function(element,elementLoaded,imageElementLoad){var _this=this;var _isMobile=false;var _element=null;var _elementLoaded=null;var _changeInputCityTimeout=null;var _onSameCity=null;var _emptyCity=null;var _region="";_this._region="";var _onKeyDown=function(e){_region="";_this._region="";switch(e.keyCode){case Event.KEY_DOWN:case Event.KEY_UP:case 13:{var cities=_elementLoaded.select("li[rel!='']");if(cities.length>0){current_city=_elementLoaded.select("li[rel!=''][selected='selected']");current_city=(current_city.length>0)?current_city[0]:null;switch(e.keyCode){case Event.KEY_DOWN:{next_city=(current_city)?current_city.next("li[rel!='']"):cities[0];next_city=(next_city)?next_city:cities[0];if(current_city){current_city.removeAttribute('selected');}
next_city.setAttribute('selected','selected');Event.stop(e);}
break;case Event.KEY_UP:{next_city=(current_city)?current_city.previous("li[rel!='']"):cities[cities.length-1];next_city=(next_city)?next_city:cities[cities.length-1];if(current_city){current_city.removeAttribute('selected');}
next_city.setAttribute('selected','selected');Event.stop(e);}
break;case 13:{Event.stop(e);_onSelectFunction(current_city);_elementLoaded.hide();}
break;}}}
break;}}
var _changeInputCityInterval=function(e){switch(e.keyCode){case Event.KEY_DOWN:case Event.KEY_UP:case Event.KEY_LEFT:case Event.KEY_RIGHT:case 13:{}
break;default:{if(_onChangingCity)
_onChangingCity();window.clearTimeout(_changeInputCityTimeout);_changeInputCityTimeout=window.setTimeout(_changeInputCity,900);}}};var _onFocus=function(e)
{if(element.value.indexOf(",")!=-1)
{_this._region=element.value.substr(element.value.indexOf(","));_region=element.value.substr(element.value.indexOf(","));element.value=element.value.substr(0,element.value.indexOf(","));}}
var _onBlur=function(e){setTimeout(function()
{if(!jQuery('.scroll-auto-complete-scroll').hasClass('ui-draggable-dragging')){if(_elementLoaded){_elementLoaded.hide();if(element.value)
element.value=element.value+_this._region;}
if(_onLeaveInput){_onLeaveInput();}}else{element.focus();}},350);};var _onSelect=function(){_onSelectFunction();};element.onkeypress=function(e){var keycode=(window.event)?event.keyCode:e.keyCode;if(keycode==13){return false;}};var _changeInputCity=function(){if(_emptyCity){_emptyCity(element);}
if(element.value.length<2){_elementLoaded.hide();return;}
if(imageElementLoad){imageElementLoad.show();}
url=CURRENT_BASE_URL+'directory/autocomplete/city/?name='+encodeURI(_element.value);new Ajax.Request(url,{onSuccess:function(transport){_elementLoaded.innerHTML=transport.responseText;var scrollContent=jQuery('.scroll-width-auto-complete');var cityList=scrollContent.find('ul').find('li');if(cityList.length<2){imageElementLoad.hide();scrollContent.hide();return false;}
_elementLoaded.show();_element.focus();if(imageElementLoad){imageElementLoad.hide();}
if(_onSameCity){_onSameCity(_elementLoaded,_onSelectFunction);}
allo.autoCompleteScroll.createScroll('scroll-width-auto-complete','scroll-auto-complete-scroll','scroll-auto-complete-scroll-bar','scroll-width-auto-complete-new',_isMobile);var lists=_elementLoaded.getElementsBySelector('ul li');lists.each(function(element){Event.observe(element,'click',_onSelectDispatcher);});if(lists[1].firstElementChild.nextElementSibling.innerHTML==''&&lists.length<=2){lists[1].click();}}});};this.dispatch=function(){element.observe('keyup',_changeInputCityInterval);element.observe('keydown',_onKeyDown);element.observe('blur',_onBlur);element.observe('focus',_onFocus);};this.undispatch=function(){element.stopObserving('keydown',_onKeyDown);element.stopObserving('keyup',_changeInputCityInterval);element.stopObserving('blur',_onBlur);element.stopObserving('focus',_onFocus);};this.isMobile=function(isMobile){_isMobile=isMobile;return this;};var _onSelectDispatcher=function(event){var element=Event.element(event);if(element.nodeName.toLowerCase()=='span')
element=element.parentNode;_onSelectFunction(element);_elementLoaded.hide();};var _onChangingCity=null;this.onChangingCity=function(func){_onChangingCity=func;return _this;};var _onLeaveInput=null;this.onLeaveInput=function(func){_onLeaveInput=func;return this;};var _onSelectFunction=null;this.onSelect=function(func){_onSelectFunction=func;return _this;};var onMouseUpFunction=null;this.onMouseUp=function(func){onMouseUpFunction=func;return _this;};this.onSameCity=function(func){_onSameCity=func;return _this;}
this.emptyCity=function(func){_emptyCity=func;return _this;}
{_element=element;_elementLoaded=elementLoaded;}};allo.autoCompleteScroll=new function(){this.createScroll=function(contentClass,scrollClass,scrollBarClass,newBlockClass,isMobile){allo.scroll._scrollInit=false;allo.scroll.initScroll(contentClass,scrollClass,scrollBarClass,newBlockClass);allo.scroll.scrollSetup(scrollClass,scrollBarClass,newBlockClass,contentClass);var headWidth=jQuery('.main-block-head').outerWidth(true);var mobileWidth=300;if(headWidth>770){mobileWidth=headWidth;}
var width=isMobile?mobileWidth:250;allo.scroll.setupScrollWheel(contentClass,width,170);allo.scroll.activeWheelBlock={blockClass:contentClass,stepScrollWheel:null};var step=isMobile?12:20;allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep(step);};};allo.storesMap=new function(){this.selectedCheckoutStore=null;this.initMap=function(data){var stores=[];if(data.ajax===true&&!Array.isArray(data.ids)&&!Array.isArray(data.map)&&!Array.isArray(data.stores)){data.ids=data.ids.evalJSON();data.map=data.map.evalJSON();data.stores=data.stores.evalJSON();}
if(data.map_data!=undefined){data.ids=data.map_data.ids.evalJSON();data.map=data.map_data.map.evalJSON();data.stores=data.map_data.stores.evalJSON();}
var i=0;for(i;i<=data.map.length-1;i++){stores[data.map[i].store]=data.map[i].description;}
var storeIds=[];storeIds=data.ids;var scale_for_map=[];scale_for_map['dif_cities']=false;var latitude=Number(data.map[0].description.latitude);var longtitude=Number(data.map[0].description.longtitude);var mapOptions={center:{lat:latitude,lng:longtitude},zoom:15};if(!scale_for_map['dif_cities']&&storeIds.ids&&storeIds.ids.length>0){var key='store'+storeIds['ids'][0];var store=stores[key];mapOptions.center={lat:latitude,lng:longtitude};mapOptions.zoom=15;}
window.map=new google.maps.Map(document.getElementById("YMapsID"),mapOptions);window.marks={};var bounds=new google.maps.LatLngBounds();for(var i=0;i<storeIds.length;i++){var key='store'+storeIds[i];var store=stores[key];var marker=null;if(!store){continue;}
if(store.store_id==allo.storesMap.selectedStoreId){marker=addMarker(store,true);}else{marker=addMarker(store);}
window.marks[storeIds[i]]=marker;bounds.extend(marker.getPosition());}
if(storeIds.length>1&&conditionNotCheckout()){window.map.fitBounds(bounds);}
if(data.page!='checkout'){this.selectedStoreId=null;}};var addMarker=function(data,current){if(conditionNotCheckout()){var marker=new google.maps.Marker({position:new google.maps.LatLng(data.latitude,data.longtitude),map:window.map,title:getMarkerTitle(data),data:data});}else{var image=(current)?data.marker_icon_large:data.marker_icon;var marker=new google.maps.Marker({position:new google.maps.LatLng(data.latitude,data.longtitude),map:window.map,icon:image,title:getMarkerTitle(data),data:data});}
google.maps.event.addListener(marker,'click',function(){var oldMarker=window.marks[allo.storesMap.selectedCheckoutStore];if(oldMarker){oldMarker.setIcon(oldMarker.data.marker_icon);}
marker.setIcon(marker.data.marker_icon_large);allo.storesMap.goToMarker(marker.data.store_id);allo.scroll.goTo('body-content-stores');jQuery('.gm-style-iw').children().css('overflow','hidden');});return marker;};var infoWindow;var showInfoWindow=function(marker){if(typeof infoWindow!='undefined')infoWindow.close();infoWindow=new google.maps.InfoWindow({content:getMarkerContent(marker.data),maxWidth:251,buttons:{close:{visible:false}}});infoWindow.open(window.map,marker);if(conditionNotCheckout()){var selElement=jQuery('.selected-store');if(selElement.attr('block-id')!=undefined){allo.scroll.coordinateConfig['body-content-stores']['from']=1;allo.scroll.coordinateConfig['body-content-stores'].topNow=0;}
allo.storesMap.selectStore(marker.data.store_id);}else{allo.storesMap.selectedCheckoutStore=marker.data.id;}
setTimeout(function(){initPopupClose();},600);};var getMarkerTitle=function(content){return content.address;};var getMarkerContent=function(content){if(conditionNotCheckout()){var res="<ul class='marker-content'>";res+="<li class='store-address'>"+content.address.replace(/\\/g,"")+"</li>";res+="<li class='work-time'>";if(content.date_delivery.is_date==0){if(content.date_delivery.popup_data){for(key in content.date_delivery.popup_data){var value=content.date_delivery.popup_data[key];res+="\<div class=\"string-time\"><div class=\"days\">"+key+":</div>";res+="\<div class=\"work-time\">"+value+"</div></div>\n";}}}else{res+="\<div class=\"work-time-text\">"+content.date_delivery.popup_data+"</div></div>\n";}
res+="</li>";res+="<li class='button-buy'>";res+="<div class='button' style='display: inline !important;'>"+"</div>"+"<button class='map-popup-buy-product' :hover"+" onclick='allo.productInStores.clickBuyButton("+content.id+");'>"+content.deliver+
content.date_delivery.button
+"</button>"+"</div>";res+="</li>";res+="</ul>";}else{var res="\
            <div class=\"ballon-content\">\n\
            <div class=\"shop_address\">"+content.address+"</div>";res+="\<table class=\"time_way\" ><tr><td class=\"time\">";for(key in content.work_time){var value=content.work_time[key];res+="\<div class=\"string-time\"><div class=\"days\">"+key+":</div>";res+="\<div class=\"work-time\">"+value+"</div></div>\n";}
res+="</td></tr></table>";res+="\<div class=\"delivery_text\">"+content.delivery_text+"</div>";res+="</div>";}
return res;};this.openCartAndNavigateToMarker=function(storeId){allo.productInStores._getMap();this.goToMarker(storeId);allo.scroll.goTo('body-content-stores');};this.goToMarker=function(storeId){var marker=window.marks[storeId];if(marker){marker.setIcon(marker.data.marker_icon_large);var lat=marker.position.lat();var lng=marker.position.lng();if(jQuery('.gm-style')&&jQuery('.gm-style').size()<1){lat=lat-5}
window.map.panTo({lat:lat,lng:lng});window.map.setZoom(15);if(conditionNotCheckout()){var selElement=jQuery('.selected-store');if(selElement.attr('block-id')!=undefined){allo.scroll.coordinateConfig['body-content-stores']['from']=1;allo.scroll.coordinateConfig['body-content-stores'].topNow=0;}
this.selectStore(storeId);}else{allo.storesMap.selectedCheckoutStore=marker.data.id;}
setTimeout(function(){showInfoWindow(marker);},300);setTimeout(function(){initPopupClose();},600);}};var conditionNotCheckout=function(){return(typeof(allo.checkoutPage.storeMap)=='undefined'||allo.checkoutPage.storeMap==null);};var initPopupClose=function(){var popup=jQuery('.gm-style-iw');var parentElement=popup.parent();if(parentElement.find('span.close-store-popup').length==0){parentElement.find('img').remove();parentElement.append('<span class="close-store-popup"></span>');jQuery('.close-store-popup').bind('click',function(){parentElement.hide();});}};this.selectedStoreId=null;this.selectStore=function(storeId){var addToElement=jQuery('#store'+storeId);if(this.selectedStoreId==null){this.selectedStoreId=storeId;allo.scroll.coordinateConfig['body-content-stores']['to']=Number(addToElement.attr('block-id'));}else{var selectedElem=jQuery('#store'+this.selectedStoreId);selectedElem[0].className='store';this.selectedStoreId=storeId;if(Number(addToElement.attr('block-id'))!=allo.scroll.coordinateConfig['body-content-stores']['to']){allo.scroll.coordinateConfig['body-content-stores']['from']=1;allo.scroll.coordinateConfig['body-content-stores'].topNow=0;allo.scroll.coordinateConfig['body-content-stores']['to']=Number(addToElement.attr('block-id'));}}
addToElement[0].className='store selected-store';allo.productInStores.selectedStoreId=storeId;};};allo.scroll=new function(){this._scrollInit=false;this.coordinateConfig={};this.activeWheelBlock={};this.initScroll=function(contentClass,scrollClass,scrollBarClass,newBlockClass){if(this._scrollInit===false){jQuery('document').ready(function(){createBlock(contentClass,scrollClass,scrollBarClass,newBlockClass);addCssToContentBlock(contentClass,newBlockClass);dragScroll(scrollClass,newBlockClass);initScrollForMobile(scrollClass,newBlockClass);this._scrollInit=true;});}};this.scrollSetup=function(scrollClass,scrollBarClass,newBlockClass,contentClass){var scroll=jQuery('.'+scrollClass);var scrollBar=jQuery('.'+scrollBarClass);var newBlock=jQuery('.'+newBlockClass);var contentBlock=jQuery('.'+contentClass);var newBlockHeight=Number(newBlock.css('height').replace("px",""));var scrollBarHeight=Number(scrollBar.css('height').replace("px",""));var scrollHeight=Number(scroll.css('height').replace("px",""));var contentBlockHeight=Number(contentBlock.css('height').replace("px",""));var scrollMarginTop=Number(scroll.css('margin-top').replace("px",""));var scrollMarginBottom=Number(scroll.css('margin-bottom').replace("px",""));var scrollPaddingTop=Number(scroll.css('padding-top').replace("px",""));var scrollPaddingBottom=Number(scroll.css('padding-bottom').replace("px",""));var contentTopBorder=Number(contentBlock.css('border-top').split('px')[0]);var contentBottomBorder=Number(contentBlock.css('border-bottom').split('px')[0]);contentBlockHeight+=contentTopBorder+contentBottomBorder;var maxTop=scrollBarHeight-(scrollHeight+scrollMarginTop
+scrollMarginBottom+scrollPaddingTop+scrollPaddingBottom);allo.scroll.coordinateConfig[contentClass]={maxtopscroll:maxTop,newblockheight:newBlockHeight,scrollstep:maxTop/newBlock.children().length,contentBlockHeight:contentBlockHeight,scroll:scroll,scrollBar:scrollBar,newBlock:newBlock,contentBlock:contentBlock,wheelSetup:false};if(newBlockHeight-scrollBarHeight>0&&newBlockHeight>contentBlockHeight){calculateAndSetStep(newBlockHeight,contentBlockHeight,maxTop,scroll);}else if(newBlockHeight-scrollBarHeight<0&&newBlockHeight-contentBlockHeight>0){calculateAndSetStep(newBlockHeight,contentBlockHeight,maxTop,scroll);}else{scrollBar.css('display','none');}};this.setupScrollWheel=function(contentClass,addToRight,addToBottom){var config=allo.scroll.coordinateConfig[contentClass];if(config){jQuery(document).mousemove(function(e){var elem=config.contentBlock;var elemOffset=elem.offset();var X=elemOffset.left;var Y=elemOffset.top;var maxRight=X+addToRight;var maxBottom=Y+addToBottom;if(e.pageX>X&&e.pageY>Y&&e.pageX<maxRight&&e.pageY<maxBottom){hookEvent(elem[0],'mousewheel',mouseWheel);}else{unhookEvent(elem[0],'mousewheel',mouseWheel);}});}};this.getWheelStep=function(type){var activeWheel=allo.scroll.activeWheelBlock;var config=allo.scroll.coordinateConfig[activeWheel.blockClass];if(config){var scrollBarStep=Number(config.scroll.data('step'));if(activeWheel){if(type=='auto'&&activeWheel.stepScrollWheel==null){var child=config.newBlock.children();return(config.maxtopscroll*scrollBarStep)/child.length;}else if(type=='auto'&&activeWheel.stepScrollWheel!=null){return activeWheel.stepScrollWheel;}else if(type!='auto'){return type;}}}};this.setupCoordinateForDrag=function(newBlockClass,contentClass){var content=jQuery('.'+newBlockClass);var config=allo.scroll.coordinateConfig[contentClass];var children=content.children();var countChildren=children.length;var block_id=1;var allSumPerBlock=0;var positionByHeight=0;for(var key in children){if(key<=countChildren){var jqElem=jQuery('#'+children[key].id);positionByHeight+=Number(jqElem.outerHeight(true));if(key==0){jqElem.attr('element-height',Number(jqElem.outerHeight(true)));jqElem.attr('block-id',Number(block_id));allSumPerBlock+=Number(jqElem.outerHeight(true));}else{allSumPerBlock+=Number(jqElem.outerHeight(true));if(allSumPerBlock<=config.contentBlockHeight){jqElem.attr('element-height',Number(jqElem.outerHeight(true)));jqElem.attr('block-id',Number(block_id));}else{block_id++;allSumPerBlock=Number(jqElem.outerHeight(true));jqElem.attr('element-height',Number(jqElem.outerHeight(true)));jqElem.attr('block-id',Number(block_id));}}
jqElem.attr('block-position',Number(positionByHeight));jqElem.attr('max-top-scroll',config.maxtopscroll);}else{break;}}
allo.scroll.coordinateConfig[contentClass]['lastBlockId']=block_id;allo.scroll.coordinateConfig[contentClass]['from']=1;allo.scroll.coordinateConfig[contentClass]['topNow']=0;};this.goTo=function(contentClass){var config=allo.scroll.coordinateConfig[contentClass];if(config){var fromElement=getLastElementByGroupId(config.from,config.newBlock);var toElement=getLastElementByGroupId(config.to,config.newBlock);var fromElementConfig={maxTopScroll:Number(fromElement.attr('max-top-scroll')),blockPosition:Number(fromElement.attr('block-position')),blockId:Number(fromElement.attr('block-id')),elementHeight:Number(fromElement.attr('element-height'))};var toElementConfig={maxTopScroll:Number(toElement.attr('max-top-scroll')),blockPosition:Number(toElement.attr('block-position')),blockId:Number(toElement.attr('block-id')),elementHeight:Number(toElement.attr('element-height'))};var scrollTopNow=config.topNow;if(config.from==config.to){config.newBlock.css('top',config.topNow+'px');}
if(config.to==1){config.newBlock.css('top','-'+(0)+'px');}else if(config.to==config.lastBlockId){config.newBlock.css('top','-'+(config.maxtopscroll*Number(config.scroll.data('step')))+'px');}else if(config.from==1&&config.to>1){var sum=config.contentBlockHeight-fromElementConfig.blockPosition;config.newBlock.css('top','-'+(toElementConfig.blockPosition
-fromElementConfig.blockPosition-sum)+'px');}else if(config.from>config.to){config.newBlock.css('top','-'+(Math.abs(fromElementConfig.blockPosition
-toElementConfig.blockPosition+scrollTopNow))+'px');}else if(config.from<config.to){config.newBlock.css('top','-'+(Math.abs(toElementConfig.blockPosition
-fromElementConfig.blockPosition-scrollTopNow))+'px');}
config.topNow=Number(config.newBlock.css('top').replace('px',''));config.scroll.css('top',Math.abs(config.topNow)/Number(config.scroll.data('step'))+'px');}};var initScrollForMobile=function(scrollClass,newBlockClass){var startPos;var scrollBlock=jQuery('.'+newBlockClass);var scroll=jQuery('.'+scrollClass);scrollBlock.bind('touchstart',function(event){var e=event.originalEvent;startPos=e.touches[0].pageY;});scrollBlock.on('touchmove',function(e){var ev=e.originalEvent;var movePos=ev.touches[0].pageY;var direction='';if(movePos>startPos){direction='down';}else{direction='up';}
dragScrollWheel(direction);startPos=movePos;return stopEvent(e);});scroll.on('touchmove',function(e){var ev=e.originalEvent;var movePos=ev.touches[0].pageY;var direction='';if(movePos>startPos){direction='up';}else{direction='down';}
dragScrollWheel(direction);startPos=movePos;return stopEvent(e);});};var stopEvent=function(e){e=e?e:window.event;if(e.stopPropagation){e.stopPropagation();}
if(e.preventDefault){e.preventDefault();}
e.cancelBubble=true;e.cancel=true;e.returnValue=false;return false;};var getLastElementByGroupId=function(groupId,newBlock){var groupElement=newBlock.find('[block-id ='+groupId+']');return groupElement.last();};var calculateAndSetStep=function(newBlockHeight,contentBlockHeight,maxTop,scroll){var height=newBlockHeight-contentBlockHeight;var step=height/maxTop;scroll.data('step',step);};var createBlock=function(contentClass,scrollClass,scrollBarClass,newBlockClass){var contentElement=jQuery('.'+contentClass);if(contentClass!='shipping_address_select_div'&&contentClass!='shipping_method_select_div'&&contentClass!='payment_method_select_div')
{contentElement[0].innerHTML='<div class="'+newBlockClass+'">'+contentElement[0].innerHTML+'</div>';}
contentElement.append('<div class="'+scrollBarClass+'"></div>');jQuery('.'+scrollBarClass).append('<div class="'+scrollClass+'"></div>');contentElement.trigger('scroll.block.created');};var addCssToContentBlock=function(contentClass,newBlockClass){jQuery('.'+contentClass).css('overflow','hidden');jQuery('.'+newBlockClass).css({overflow:'hidden',position:'relative',top:'0px'});};var dragScroll=function(scrollClass,newBlockClass){var scroll=jQuery('.'+scrollClass);var scrollingElement=jQuery('.'+newBlockClass);var step=0;var position=0;scroll.draggable({containment:'parent',axis:'y',drag:function(event,ui){step=scroll.data('step');position=ui.position.top*step;scrollingElement.css("top","-"+position+"px");}});};var mouseWheel=function(e){e=e?e:window.event;var wheelData=e.detail?e.detail*-1:e.wheelDelta/40;if(Math.abs(wheelData)>100){wheelData=Math.round(wheelData/100);}
var direction='';if(wheelData<0){direction='up';}else{direction='down';}
dragScrollWheel(direction);return cancelEvent(e);};var hookEvent=function(hElem,eventName,callback){if(typeof(hElem)=='string'){hElem=document.getElementById(hElem);}
if(!hElem){return false;}
if(hElem.addEventListener){if(eventName=='mousewheel'){hElem.addEventListener('DOMMouseScroll',callback,false);}
hElem.addEventListener(eventName,callback,false);}
else if(hElem.attachEvent){hElem.attachEvent('on'+eventName,callback);}else{return false;}
return true;};var unhookEvent=function(hElem,eventName,callback){if(typeof(hElem)=='string'){hElem=document.getElementById(hElem);}
if(!hElem){return false;}
if(hElem.removeEventListener){if(eventName=='mousewheel'){hElem.removeEventListener('DOMMouseScroll',callback,false);}
hElem.removeEventListener(eventName,callback,false);}
else if(hElem.detachEvent){hElem.detachEvent('on'+eventName,callback);}
else{return false;}
return true;};var cancelEvent=function(e){e=e?e:window.event;if(e.stopPropagation){e.stopPropagation();}
if(e.preventDefault){e.preventDefault();}
e.cancelBubble=true;e.cancel=true;e.returnValue=false;return false;};var dragScrollWheel=function(direction){var whConf=allo.scroll.activeWheelBlock;var config=allo.scroll.coordinateConfig[whConf.blockClass];var maxTopScrollBar=config.maxtopscroll;var scrollBarStep=Number(config.scroll.data('step'));var maxTopNewBlock=maxTopScrollBar*scrollBarStep*(-1);var contentTopNow=Number(config.newBlock.css('top').replace("px",""));var contentBlockTop=0;var scrollTop=0;var calculateTop=0;if(direction=='up'){if(contentTopNow==maxTopNewBlock||contentTopNow<maxTopNewBlock){return;}
calculateTop=contentTopNow-whConf.stepScrollWheel;if(calculateTop<=maxTopNewBlock){contentBlockTop=maxTopScrollBar*scrollBarStep*(-1);scrollTop=maxTopScrollBar;}
if(calculateTop>=maxTopNewBlock){contentBlockTop=calculateTop;scrollTop=contentBlockTop/scrollBarStep*(-1);}}
if(direction=='down'){if(contentTopNow==0||contentTopNow>0){return;}
calculateTop=contentTopNow+whConf.stepScrollWheel;if(calculateTop>0){contentBlockTop=0;scrollTop=0;}
if(calculateTop<0){contentBlockTop=calculateTop;scrollTop=calculateTop/scrollBarStep*(-1);}}
allo.scroll.coordinateConfig[whConf.blockClass]['from']=1;allo.scroll.coordinateConfig[whConf.blockClass].topNow=0;config.newBlock.css('top',contentBlockTop);config.scroll.css('top',scrollTop);};};allo.productInStores=new function(){this.jsonData=null;var _this=this;var _cities=undefined;this._optionSelectCity=undefined;var _selectWindowBox=null;var _map=null;this.mapInitialized=false;this.newSelectedCityId=null;this.newSelectedCityName=null;this.closeAutocomplete=function(el){jQuery('.autocomplete_popup_tt').css('display','none');};var _getCities=function(){$('citiesCityShippingLoadedStores').hide();_selectWindowBox.open();};this.initChangeCityInPopup=function(){if(this._optionSelectCity){this._optionSelectCity.undispatch();}
var optionSelectCity=new allo.cities($('searchCityPopup'),$('searchCityPopupLoadedStores'));optionSelectCity.onSelect(_reloadPopupSelectCity).dispatch();this._optionSelectCity=optionSelectCity;};this.closeMenuSelectCity=function(){var menu=jQuery('.select-options');menu.hide();};this.autoComplite=function(){this.initChangeCityInPopup();var elem=jQuery('#searchCityPopup');addCursorInInput('searchCityPopup');elem.attr('change-other-city',1);elem.blur(function(){elem.attr('change-other-city',0);allo.scroll.setupScrollWheel('body-content-stores',681,189);allo.scroll.activeWheelBlock={blockClass:'body-content-stores',stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep('auto');});elem.click(function(){var autocomplite=jQuery('.autocomplete_popup_tt');if(autocomplite[0].visible()){return;}else{undispatchSelectEnotherCity();}});}
this.openMenuSelectCity=function(){if(typeof(this._optionSelectCity)!='undefined')
this._optionSelectCity._region="";var menu=jQuery('.select-options');jQuery('.select-city-error').text('');menu.show();var elem=jQuery('#searchCityPopup');elem.keypress(function(){menu.hide();});this.autoComplite();};var undispatchSelectEnotherCity=function(){if(this._optionSelectCity){this._optionSelectCity.undispatch();}};this.selectMenuEnterOtherCity=function(){var elem=jQuery('#searchCityPopup');if(elem.attr('change-other-city')==0){elem[0].value='';this.closeMenuSelectCity();this.autoComplite();}};this.selectMenuUseDefaultCity=function(element){allo.cities._region="";if(element.hasClassName('text')==true){return;}
_reloadPopupSelectCity(element);};this.clickBuyButton=function(id){var productId=jQuery('input#searchCityPopup').attr('product_id');params={tt:id,id:productId};var url=CURRENT_BASE_URL+'productinstores/stores/buyinstore';new Ajax.Request(url,{method:'POST',parameters:params,ajax:true,onSuccess:function(transport){var response=transport.responseText.evalJSON();var url=response.url;if(url!=undefined){jQuery(location).attr('href',url);}}});};this.popupInit=function(data,mergeToBlockId,create){var element=jQuery('#'+mergeToBlockId);var template=new EJS(allo.templates.tpl.shipping_product_in_stores_popup);if(data.map_data!=undefined){if(data.map_data==0){return null;}}
try{element[0].innerHTML=template.render(data);}catch(e){console.log(e);return;}
if(create===true){if(data.count_stores>0){mergeEjsToBlock(data,'store-map-content','shipping_stores_map');mergeEjsToBlock(data,'store-tt-content','shipping_stores_content');changeBlockHeight(element[0].id,595);_map=new Lightbox($(mergeToBlockId));allo.scroll.initScroll('body-content-stores','scroll-stores','scrollbar-stores','scroll');hoverMapElem();}else{mergeEjsToBlock(data,'store-tt-content','shipping_stores_content');changeBlockHeight('map-stores-popup',147);_map=new Lightbox($(mergeToBlockId));}}
var event=new Event('map_init_after');document.dispatchEvent(event);};this.selectedStoreId=null;this._getMap=function(){if(_map&&_map!=null){_map.open();}
var jsonData=allo.productInStores.jsonData;if(jsonData&&jsonData!=null){var data=jsonData.evalJSON();var countStores=0;if(data.map_data!=undefined){countStores=data.map_data.count_stores;}else{countStores=data.count_stores;}
if(countStores>0){allo.scroll.scrollSetup('scroll-stores','scrollbar-stores','scroll','body-content-stores');allo.scroll.setupCoordinateForDrag('scroll','body-content-stores');allo.scroll.setupScrollWheel('body-content-stores',681,189);allo.scroll.activeWheelBlock={blockClass:'body-content-stores',stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep('auto');allo.storesMap.initMap(data);if(allo.storesMap.selectedStoreId!=null){allo.storesMap.goToMarker(allo.storesMap.selectedStoreId);}
if(this.selectedStoreId!=null){allo.storesMap.goToMarker(this.selectedStoreId);}}else{if(jQuery('#store-map-content').length>0){allo.productInStores.removeBlockHTML('store-map-content');allo.productInStores.removeBlockHTML('store-tt-content');changeBlockHeight('map-stores-popup',147);if(data.map_data){mergeEjsToBlock(data.map_data,'change-city-error','shipping_stores_content');}else{mergeEjsToBlock(data,'change-city-error','shipping_stores_content');}}}}};this.removeBlockHTML=function(mapBlockId){var block=jQuery('#'+mapBlockId);block[0].innerHTML='';};this.renderProductBlockData=function(productId,data){_productId=productId;allo.productInStores.jsonData=data;_getProductBlock(data.evalJSON());};var addCursorInInput=function(inputElemId){element=document.getElementById(inputElemId);element.focus();};var _reloadPopupSelectCity=function(element){_this.currentShippingUpdated=true;var cityId=element.readAttribute('rel');var selectedElement=jQuery('.selected-city-in-popup');if(selectedElement){var selectedCityId=selectedElement.attr('rel');if(selectedCityId==cityId){allo.productInStores.closeMenuSelectCity();return;}}
var cookie=new CookieProvider();cookie.createCookie(allo.glob.city_id_cookie_name,cityId);var input=jQuery('#searchCityPopup');var productId=input.attr('product_id');undispatchSelectEnotherCity();allo.productData.dataReceived=false;allo.productData.getProductInStoresAndDeliveryData(cityId,productId,function(){allo.productInStores.jsonData=allo.productData.jsonData;var data=allo.productData.data;var mapData=data.map_data;var needUpdateScrollWheel=false;if(mapData.count_stores>0){changeBlockHeight('map-stores-popup',595);allo.productInStores.removeBlockHTML('change-city-error');mergeEjsToBlock(mapData,'store-map-content','shipping_stores_map');mergeEjsToBlock(mapData,'store-tt-content','shipping_stores_content');allo.storesMap.initMap(mapData);allo.scroll.initScroll('body-content-stores','scroll-stores','scrollbar-stores','scroll');allo.scroll.scrollSetup('scroll-stores','scrollbar-stores','scroll','body-content-stores');allo.scroll.setupCoordinateForDrag('scroll','body-content-stores');needUpdateScrollWheel=true;changeSelectCity(cityId,mapData.city_name,'searchCityPopup','select-options');hoverMapElem();}else{allo.productInStores.removeBlockHTML('store-map-content');allo.productInStores.removeBlockHTML('store-tt-content');changeBlockHeight('map-stores-popup',147);mergeEjsToBlock(mapData,'change-city-error','shipping_stores_content');changeSelectCity(cityId,mapData.city_name,'searchCityPopup','select-options');allo.productInStores.closeMenuSelectCity();}
allo.force_render_tt_popup=true;allo.shipping.reloadProductBlockDelivery(data);var blockProductIsOutOfStock=jQuery('#shippingMethodsBlockStores');if(blockProductIsOutOfStock&&blockProductIsOutOfStock.length>0){data['language']={selectCity:Translator.translate('Please select city'),entercity:Translator.translate('Or enter other city')};_getProductBlock(data,false);}
input[0].defaultValue=mapData.city_name;if(needUpdateScrollWheel){allo.scroll.setupScrollWheel('body-content-stores',681,189);allo.scroll.activeWheelBlock={blockClass:'body-content-stores',stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep('auto');}});};var changeSelectCity=function(cityId,cityName,inputId,optionListClass){var input=jQuery('#'+inputId);allo.productInStores.newSelectedCityId=cityId;allo.productInStores.newSelectedCityName=cityName;if(input){input[0].value=allo.productInStores.newSelectedCityName;}
var selectList=jQuery('.'+optionListClass);selectList.children().each(function(index,item){if(item.className!='enter_enother_city'){if(item.getAttribute('rel')!=allo.productInStores.newSelectedCityId){item.className='city_name_popup';}else{item.className='city_name_popup changed selected-city-in-popup';}}});allo.productInStores.closeMenuSelectCity();};var changeBlockHeight=function(blockId,identifier){var popupBlock=jQuery('#'+blockId);if(!identifier){identifier=0}
popupBlock.css('height',identifier+'px');};var mergeEjsToBlock=function(data,mergeToBlockId,ejsName){var element=jQuery('#'+mergeToBlockId);var template=new EJS(allo.templates.tpl[ejsName]);if(template){element[0].innerHTML=template.render(data);}else{console.log('  EJS template.  : '+ejsName);}};var _getProductBlock=function(data,deletePopup){if(deletePopup!=false){jQuery('.map-stores').remove();allo.scroll._scrollInit=false;}
var template=new EJS(allo.templates.tpl.shipping_product_in_stores);data.language={selectCity:Translator.translate('Please select city'),entercity:Translator.translate('Or enter other city')};_this.currentShippingData=data;$('shippingMethodsBlockStores').innerHTML=template.render(data);if(!_selectWindowBox){_selectWindowBox=new Lightbox($('selectShippingCityWindowStores'));}
if(_cities)
_cities.undispatch();var cities=new allo.cities($('searchCityShippingStores'),$('citiesCityShippingLoadedStores'));cities.onSelect(_reloadProductBlock).dispatch();_cities=cities;$$('#selectShippingCityWindowStores .citiesDefaultListStores').each(function(item){item.observe('click',_selectCityShippingObserver);});$('selectCityShippingStores').observe('click',_getCities);if(deletePopup!=false){allo.productInStores.popupInit(data,'map-stores-popup',true);hoverMapElem();}};var hoverMapElem=function(){jQuery('document').ready(function(){var storeElements=jQuery('.store');var childrenStoreElements=storeElements.children();storeElements.mouseover(function(e){elementMouseOver(this);});childrenStoreElements.mouseover(function(){elementMouseOver(this);});storeElements.mouseleave(function(e){elementMouseLeave(this);});childrenStoreElements.mouseleave(function(){elementMouseLeave(this);});var event=new Event('init_map_event');document.dispatchEvent(event);});};var elementMouseOver=function(elem){if(elem&&elem.hasClassName('store')){var children=elem.children;var index=0;for(index;index<=children.length-1;index++){if(children[index].hasClassName('hovering-elem')){children[index].addClassName('hoverelement');}}}};var elementMouseLeave=function(elem){if(elem&&elem.hasClassName('store')){var children=elem.children;var index=0;for(index;index<=children.length-1;index++){if(children[index].hasClassName('hoverelement')){children[index].removeClassName('hoverelement');}}}};var _selectCityShippingObserver=function(event){var element=Event.element(event);_reloadProductBlock(element);};var _forceGet=function(type,request,data,observer){var collection=new Array({conteinerId:'forceGet',type:type,request:request,data:data});var params={'collection':collection.toJSON()};var url=CURRENT_BASE_URL+'productinstores/stores/get';new Ajax.Request(url,{method:'POST',parameters:params,onSuccess:function(transport){responseData=transport.responseText.evalJSON();allo.productInStores.jsonData=JSON.stringify(responseData.result);allo.storesMap.selectedStoreId=null;observer(responseData.result);}});};var _reloadProductBlock=function(element){_this.currentShippingUpdated=true;var cityId=element.readAttribute('rel');var productId=_productId;var data={productId:productId,cityId:cityId};$('searchCityShippingStores').value='';_selectWindowBox.close();_forceGet('ajax','oggetto_cshipping/shipping/data',data,_getProductBlock);var cookie=new CookieProvider();cookie.createCookie(allo.glob.city_id_cookie_name,data.city_id);};};allo.delivery=new function(){var _deliveryPopup=null;var _optionSelectCity;this.newSelectedCityId=null;this.newSelectedCityName=null;this.scrollSetuped=false;this.closeAutocomplete=function(el){jQuery('.autocomplete_delivery_popup').css('display','none');};this.openPopup=function(){if(_deliveryPopup!=null&&_deliveryPopup){_deliveryPopup.open();}
createScroll();};this.closePopup=function(){_deliveryPopup.bgFade.click();};this.initPopup=function(data,elementId){var element=jQuery('#'+elementId);data.map_data['delivery_popup_content']=data.delivery_popup_content;element[0].innerHTML=getEjsContent(data.map_data,'shipping_delivery_delivery');if(_deliveryPopup==null||!_deliveryPopup){_deliveryPopup=new Lightbox($(elementId));}
mergeTable(data,'delivery-popup-table');};this.reInitScrollForce=function(){createScroll();};var createScroll=function(){if(allo.delivery.scrollSetuped==false){var contentClass='delivery-main-content';var scrollClass='scroll-stores-delivery';var scrollBarClass='scrollbar-stores-delivery';var newBlockClass='scroll-delivery';allo.scroll.initScroll(contentClass,scrollClass,scrollBarClass,newBlockClass);allo.scroll.scrollSetup(scrollClass,scrollBarClass,newBlockClass,contentClass);allo.scroll.setupScrollWheel('delivery-main-content',667,349);allo.scroll.activeWheelBlock={blockClass:'delivery-main-content',stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep(20);allo.delivery.scrollSetuped=true;}else{allo.scroll.setupScrollWheel('delivery-main-content',667,349);allo.scroll.activeWheelBlock={blockClass:'delivery-main-content',stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep(20);}};this.initChangeCityInPopup=function(){if(_optionSelectCity){_optionSelectCity.undispatch();}
var optionSelectCity=new allo.cities($('searchCityPopupDelivery'),$('searchCityPopupDeliveryLoadedCity'));optionSelectCity.onSelect(_reloadPopupSelectCity).dispatch();_optionSelectCity=optionSelectCity;};this.closeMenuSelectCity=function(){var menu=jQuery('.select-options-delivery');menu.hide();};this.openMenuSelectCity=function(){var menu=jQuery('.select-options-delivery');jQuery('.select-city-error-delivery').text('');menu.show();};this.selectMenuEnterOtherCity=function(){var elem=jQuery('#searchCityPopupDelivery');if(elem.attr('change-other-city')==0){elem[0].value='';this.initChangeCityInPopup();this.closeMenuSelectCity();addCursorInInput('searchCityPopupDelivery');elem.attr('change-other-city',1);elem.blur(function(){elem.attr('change-other-city',0);elem[0].value=elem[0].defaultValue;allo.scroll.setupScrollWheel('delivery-main-content',667,349);allo.scroll.activeWheelBlock={blockClass:'delivery-main-content',stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep(20);allo.delivery.scrollSetuped=true;});elem.click(function(){var autocomplite=jQuery('.autocomplete_delivery_popup');if(autocomplite[0].visible()){return;}else{undispatchSelectEnotherCity();elem[0].value=elem[0].defaultValue;}});}};var undispatchSelectEnotherCity=function(){if(_optionSelectCity){_optionSelectCity.undispatch();}};this.selectMenuUseDefaultCity=function(element){if(element.hasClassName('text')==true){return;}
_reloadPopupSelectCity(element);this.closeMenuSelectCity();};this.getDeliveryDataArray=function(deliveryData,parnerDeliveryDate){var result={allo_courier:{delivery_text:'-',delivery_priority:null},allo_pickup:{delivery_text:'-',delivery_priority:null},allo_pochta:{delivery_text:'-',delivery_priority:null},np_courier:{delivery_text:'-',delivery_priority:null},np_pickup:{delivery_text:'-',delivery_priority:null},np_pochta:{delivery_text:'-',delivery_priority:null},me_courier:{delivery_text:'-',delivery_priority:null},me_pickup:{delivery_text:'-',delivery_priority:null},me_pochta:{delivery_text:'-',delivery_priority:null},fast_courier:{delivery_text:'-',delivery_priority:null},fast_pickup:{delivery_text:'-',delivery_priority:null},fast_pochta:{delivery_text:'-',delivery_priority:null}};var counter=0;if(deliveryData.length>0){for(var key in deliveryData){counter++;if(counter<=deliveryData.length){var method=deliveryData[key];if(method.method_code=='cshipping_courier'){result.allo_courier.rule_id=method.rule_id;if(result.allo_courier.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.allo_courier.delivery_text=method.price;}else{result.allo_courier.delivery_text=method.price+', '+method.delivery_period_text;}
result.allo_courier.delivery_priority=method.method_priority;}else if(result.allo_courier.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.allo_courier.delivery_text=method.price;}else{result.allo_courier.delivery_text=method.price+', '+method.delivery_period_text;}
result.allo_courier.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_pickup'||method.method_code=='cshipping_pickupim'||method.method_code=='cshipping_pickuptt'){result.allo_pickup.rule_id=method.rule_id;if(result.allo_pickup.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.allo_pickup.delivery_text=method.price;}else{result.allo_pickup.delivery_text=method.price+', '+method.delivery_period_text;}
result.allo_pickup.delivery_priority=method.method_priority;}else if(result.allo_pickup.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.allo_pickup.delivery_text=method.price;}else{result.allo_pickup.delivery_text=method.price+', '+method.delivery_period_text;}
result.allo_pickup.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_target'){result.np_courier.rule_id=method.rule_id;if(result.np_courier.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.np_courier.delivery_text=method.price;}else{result.np_courier.delivery_text=method.price+', '+method.delivery_period_text;}
result.np_courier.delivery_priority=method.method_priority;}else if(result.np_courier.delivery_priority<method.method_priority&&(method.delivery_period_text!='')){if(method.delivery_period_text==''){result.np_courier.delivery_text=method.price;}else{result.np_courier.delivery_text=method.price+', '+method.delivery_period_text;}
result.np_courier.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_warehouse'){result.np_pickup.rule_id=method.rule_id;if(result.np_pickup.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.np_pickup.delivery_text=method.price;}else{result.np_pickup.delivery_text=method.price+', '+method.delivery_period_text;}
result.np_pickup.delivery_priority=method.method_priority;}else if(result.np_pickup.delivery_priority<method.method_priority&&(method.delivery_period_text!='')){if(method.delivery_period_text==''){result.np_pickup.delivery_text=method.price;}else{result.np_pickup.delivery_text=method.price+', '+method.delivery_period_text;}
result.np_pickup.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_npprivat'){result.np_pochta.rule_id=method.rule_id;if(result.np_pochta.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.np_pochta.delivery_text=method.price;}else{result.np_pochta.delivery_text=method.price+', '+method.delivery_period_text;}
result.np_pochta.delivery_priority=method.method_priority;}else if(result.np_pochta.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.np_pochta.delivery_text=method.price;}else{result.np_pochta.delivery_text=method.price+', '+method.delivery_period_text;}
result.np_pochta.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_misttarget'){result.me_courier.rule_id=method.rule_id;if(result.me_courier.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.me_courier.delivery_text=method.price;}else{result.me_courier.delivery_text=method.price+', '+method.delivery_period_text;}
result.me_courier.delivery_priority=method.method_priority;}else if(result.me_courier.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.me_courier.delivery_text=method.price;}else{result.me_courier.delivery_text=method.price+', '+method.delivery_period_text;}
result.me_courier.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_mistwarehouse'){result.me_pickup.rule_id=method.rule_id;if(result.me_pickup.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.me_pickup.delivery_text=method.price;}else{result.me_pickup.delivery_text=method.price+', '+method.delivery_period_text;}
result.me_pickup.delivery_priority=method.method_priority;}else if(result.me_pickup.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.me_pickup.delivery_text=method.price;}else{result.me_pickup.delivery_text=method.price+', '+method.delivery_period_text;}
result.me_pickup.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_mistprivat'){result.me_pochta.rule_id=method.rule_id;if(result.me_pochta.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.me_pochta.delivery_text=method.price;}else{result.me_pochta.delivery_text=method.price+', '+method.delivery_period_text;}
result.me_pochta.delivery_priority=method.method_priority;}else if(result.me_pochta.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.me_pochta.delivery_text=method.price;}else{result.me_pochta.delivery_text=method.price+', '+method.delivery_period_text;}
result.me_pochta.delivery_priority=method.method_priority;}}
if(method.method_code=='cshipping_targetfast'){result.fast_courier.rule_id=method.rule_id;if(result.fast_courier.delivery_text=='-'&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.fast_courier.delivery_text=method.price;}else{result.fast_courier.delivery_text=method.price;}
result.fast_courier.delivery_priority=method.method_priority;}else if(result.fast_courier.delivery_priority<method.method_priority&&(method.delivery_period_text!=''||method.price!='')){if(method.delivery_period_text==''){result.fast_courier.delivery_text=method.price;}else{result.fast_courier.delivery_text=method.price;}
if(parnerDeliveryDate){result.allo_pickup.delivery_text=method.price+', '+parnerDeliveryDate;}
result.fast_courier.delivery_priority=method.method_priority;}}}else{break;}}
return result;}else{return null;}};var mergeTable=function(data,classNameBlock){var block=jQuery('.'+classNameBlock);block[0].innerHTML=getEjsContent(data,'shipping_delivery_delivery_table');};var getEjsContent=function(data,templateName){var content;try{var template=new EJS(allo.templates.tpl[templateName]);content=template.render(data);}catch(e){content='';console.log(e);}
return content;};var addCursorInInput=function(inputElemId){element=document.getElementById(inputElemId);element.focus();};var _reloadPopupSelectCity=function(element){var cityId=element.readAttribute('rel');var selectedElement=jQuery('.selected-city-in-popup-delivery');if(selectedElement){var selectedCityId=selectedElement.attr('rel');if(selectedCityId==cityId){allo.delivery.closeMenuSelectCity();return;}}
var cookie=new CookieProvider();cookie.createCookie(allo.glob.city_id_cookie_name,cityId);var input=jQuery('#searchCityPopupDelivery');var productId=input.attr('product_id');undispatchSelectEnotherCity();allo.productData.dataReceived=false;allo.productData.getProductInStoresAndDeliveryData(cityId,productId,function(){var data=allo.productData.data;mergeTable(data,'delivery-popup-table');changeSelectCity(cityId,data.city.name,'searchCityPopupDelivery','select-options-delivery');allo.shipping.reloadProductBlockDelivery(data);input[0].defaultValue=data.city.name;});};var changeSelectCity=function(cityId,cityName,inputId,optionListClass){var input=jQuery('#'+inputId);allo.delivery.newSelectedCityId=cityId;allo.delivery.newSelectedCityName=cityName;if(input){input[0].value=allo.delivery.newSelectedCityName;}
var selectList=jQuery('.'+optionListClass);selectList.children().each(function(index,item,cityId){if(item.className!='enter_enother_city'){if(item.getAttribute('rel')!=allo.delivery.newSelectedCityId){item.className='city_name_popup';}else{item.className='city_name_popup changed selected-city-in-popup';}}});};};allo.courierFast=new function(){var _courierFastPopup=null;var _popupInited=false;this.initPopup=function(data,elementId){var elContent=jQuery('#'+elementId);if(_popupInited==false){var content=getEjsContent(data,'shipping_courier_popup');if(!content){console.log('  popup  ');}
try{elContent[0].innerHTML=content;if(!_courierFastPopup){_courierFastPopup=new Lightbox($(elementId));}
mergeCmsContent('courier-fast-cms-content',data['courier_fast_cms']);_popupInited=true;}catch(e){console.log(e);}}};this.bindOpenPopup=function(linkElementId){var elOpen=jQuery('#'+linkElementId);if(elOpen){elOpen.bind('click',function(){allo.courierFast.openPopup();});}};this.openPopup=function(){if(_courierFastPopup){_courierFastPopup.open();}};this.closePopup=function(){_courierFastPopup.bgFade.click();};var getEjsContent=function(data,templateName){var content;try{var template=new EJS(allo.templates.tpl[templateName]);content=template.render(data);}catch(e){content='';console.log(e);}
return content;};var mergeCmsContent=function(elId,data){var elPopup=jQuery('#'+elId);try{elPopup[0].innerHTML=getEjsContent(data,'shipping_courier_fast_cms');}catch(e){console.log(e);}};};allo.shipping=new function(){var _this=this;var _cities=undefined;var _selectWindowBox=null;var DEFAULT_CITY_ID=4;var _getCities=function(){$('citiesCityShippingLoaded').hide();_selectWindowBox.open();};this.needReloadPopup=true;this.needInitPopup=true;var _getProductBlock=function(data){var isNeedShippingIcon=false;var template=new EJS(allo.templates.tpl.shipping_product);data.language={selectCity:Translator.translate('Please select city'),payment:Translator.translate('Payment order'),shipping:Translator.translate('In the preparation of'),delivery:Translator.translate('Delivery'),nodelivery:Translator.translate('Unfortunately, for this product are not available delivery methods in the selected city.'),payment:Translator.translate('Payment'),cash:Translator.translate('cash on delivery commodity'),nocash:Translator.translate('cashless payment'),VISA_card:Translator.translate('VISA card'),entercity:Translator.translate('Or enter other city')};_this.currentShippingData=data;var needReloadPopup=allo.shipping.needReloadPopup;if(!needFollowRenderBlock(data)){return false;}
$('shippingMethodsBlock').innerHTML=template.render(data);if(!_selectWindowBox){_selectWindowBox=new Lightbox($('selectShippingCityWindow'));}
if(_cities)
_cities.undispatch();var cities=new allo.cities($('searchCityShipping'),$('citiesCityShippingLoaded'));cities.onSelect(_reloadProductBlock).dispatch();_cities=cities;$$('#selectShippingCityWindow .citiesDefaultList').each(function(item){item.observe('click',_selectCityShippingObserver);});if($('selectCityShipping')){$('selectCityShipping').observe('click',_getCities);}
if(needReloadPopup===true||needReloadPopup===undefined){allo.productInStores.popupInit(data.map_data,'map-stores-popup',true);allo.productInStores.jsonData=JSON.stringify(data);jQuery('.right_block_shipping_get_map_button').attr('onclick','allo.productInStores._getMap()');allo.delivery.scrollSetuped=false;allo.delivery.initPopup(data,'delivery-popup-content');jQuery('.all_delivery_methods').attr('onclick','allo.delivery.openPopup()');allo.courierFast.initPopup(data,'fast_courier-popup-content');allo.courierFast.bindOpenPopup('name-two_hour');allo.shipping.needInitPopup=false;}};var needFollowRenderBlock=function(data){var result=true;if(typeof data.hide_shipping!=='undefined'){result=false;}
if(typeof data.paymentsmethods==='undefined'||data.paymentsmethods.size()==0){result=false;}
return result;};var _getProductBlockDelivery=function(data){var template=new EJS(allo.templates.tpl.shipping_product);data.language={selectCity:Translator.translate('Please select city'),payment:Translator.translate('Payment order'),shipping:Translator.translate('In the preparation of'),delivery:Translator.translate('Delivery'),nodelivery:Translator.translate('Unfortunately, for this product are not available delivery methods in the selected city.'),payment:Translator.translate('Payment'),cash:Translator.translate('cash on delivery commodity'),nocash:Translator.translate('cashless payment'),VISA_card:Translator.translate('VISA card'),entercity:Translator.translate('Or enter other city')};_this.currentShippingData=data;$('shippingMethodsBlock').innerHTML=template.render(data);if(!_selectWindowBox){_selectWindowBox=new Lightbox($('selectShippingCityWindow'));}
if(_cities)
_cities.undispatch();var cities=new allo.cities($('searchCityShipping'),$('citiesCityShippingLoaded'));cities.onSelect(_reloadProductBlock).dispatch();_cities=cities;$$('#selectShippingCityWindow .citiesDefaultList').each(function(item){item.observe('click',_selectCityShippingObserver);});$('selectCityShipping').observe('click',_getCities);if(!allo.force_render_tt_popup||allo.force_render_tt_popup==false){allo.productInStores.popupInit(data.map_data,'map-stores-popup',true);allo.productInStores.jsonData=JSON.stringify(data);}
allo.force_render_tt_popup=false;allo.delivery.scrollSetuped=false;allo.delivery.initPopup(data,'delivery-popup-content');allo.delivery.reInitScrollForce();jQuery('.all_delivery_methods').attr('onclick','allo.delivery.openPopup()');jQuery('.right_block_shipping_get_map_button').attr('onclick','allo.productInStores._getMap()');allo.courierFast.bindOpenPopup('name-two_hour');};var _productId=null;var _selectCityShippingObserver=function(event){var element=Event.element(event);_reloadProductBlock(element);};var _reloadProductBlock=function(element){_this.currentShippingUpdated=true;var cityId=element.readAttribute('rel');var productId=_productId;$('searchCityShipping').value='';_selectWindowBox.close();allo.productData.dataReceived=false;allo.productData.getProductInStoresAndDeliveryData(cityId,productId,function(){allo.shipping.needReloadPopup=true;_getProductBlock(allo.productData.data);});var cookie=new CookieProvider();cookie.createCookie(allo.glob.city_id_cookie_name,cityId);};this.currentShippingUpdated=false;this.currentShippingData=null;this.renderProductBlockForce=function(blockId,productId,cityId){var data={productId:productId,cityId:cityId};_productId=productId;allo.blocks.forceGet('ajax','oggetto_cshipping/shipping/data',data,_getProductBlock);};this.updateProductBlockForce=function(cityId,reloadPopup){this.needReloadPopup=true;if(reloadPopup===false&&allo.shipping.needInitPopup==false){this.needReloadPopup=false;}
var data={productId:_productId,cityId:cityId};allo.blocks.forceGet('ajax','oggetto_cshipping/shipping/data',data,_getProductBlock);};this.updateProductBlockForceDelivery=function(cityId){var data={productId:_productId,cityId:cityId};allo.blocks.forceGet('ajax','oggetto_cshipping/shipping/data',data,_getProductBlockDelivery);};this.renderProductBlockData=function(productId,data){_productId=productId;this.needReloadPopup=false;_getProductBlock(data.evalJSON());};this.renderProductBlock=function(blockId,productId,cityId){var data={productId:productId,cityId:cityId};_productId=productId;allo.blocks.getAjax('oggetto_cshipping/shipping/data',data,_getProductBlock);};this.getDataForDeliveryBlock=function(methods_show){var result={pickup:{pickup:null,me:null,np:null},courier:{two_hour:null,pickup:null,me:null,np:null},pochtomat:{me:null,np:null},is_enable:{pickup:false,courier:false,pochtomat:false}};var counter=0;var methods={};if(typeof(methods_show)!=undefined){var y=0;for(y;y<=methods_show.length-1;y++){if(methods_show[y].methods!=undefined){var showMethods=methods_show[y].methods;var z=0;for(z;z<=showMethods.length-1;z++){methods[counter]=showMethods[z];counter++;}}}}
var methodsLength=Object.keys(methods).length;if(methodsLength>0){var i=0;for(i;i<=methodsLength-1;i++){var method=methods[i];var methodPriority=method.method_priority;var deliveryPrice=method.price.toLowerCase();var deliveryRenderOnlyType=method.show_only_type;var deliveryPeriodText=method.delivery_period_text;var methodType=method.method_type;var parnerDeliveryDate=method.parner_delivery_date;var methodCode=method.method_code;var deliveryName=method.method_name;var rule_id=method.rule_id;var code=method.code;if(methodType=='pickup'){if(methodCode=='cshipping_pickup'||methodCode=='cshipping_pickupim'||methodCode=='cshipping_pickuptt'){if(result.pickup.pickup==null||result.pickup.pickup.priority<methodPriority){result.pickup.pickup={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
if(methodCode=='cshipping_mistwarehouse'){if(result.pickup.me==null||result.pickup.me.priority<methodPriority){result.pickup.me={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
if(methodCode=='cshipping_warehouse'){if(result.pickup.np==null||result.pickup.np.priority<methodPriority){result.pickup.np={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
result.is_enable.pickup=true;continue;}
if(methodType=='courier'){if(methodCode=='cshipping_targetfast'){if(result.courier.two_hour==null||result.courier.two_hour.priority<methodPriority){result.courier.two_hour={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
if(methodCode=='cshipping_courier'){if(result.courier.pickup==null||result.courier.pickup.priority<methodPriority){result.courier.pickup={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
if(methodCode=='cshipping_misttarget'){if(result.courier.me==null||result.courier.me.priority<methodPriority){result.courier.me={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
if(methodCode=='cshipping_target'){if(result.courier.np==null||result.courier.np.priority<methodPriority){result.courier.np={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
result.is_enable.courier=true;continue;}
if(methodType=='pochtomat'){if(methodCode=='cshipping_mistprivat'){if(result.pochtomat.me==null||result.pochtomat.me.priority<methodPriority){result.pochtomat.me={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
if(methodCode=='cshipping_npprivat'){if(result.pochtomat.np==null||result.pochtomat.np.priority<methodPriority){result.pochtomat.np={priority:methodPriority,delivery_price:deliveryPrice,delivery_period:deliveryPeriodText,delivery_name:deliveryName,show_only_type:deliveryRenderOnlyType,rule_id:rule_id,code:code};}}
result.is_enable.pochtomat=true;continue;}}}
return result;};this.reloadProductBlockDelivery=function(data){_getProductBlockDelivery(data);}};allo.street=function(element,elementLoaded,imageElementLoad){var _changeInputStreet=function(){if($('address_city_value'))
var cityId=$('address_city_value').value;var autocomplete_url=CURRENT_BASE_URL+'directory/autocomplete/street/';new Ajax.Autocompleter($('address_street'),$('address_street_suggest'),autocomplete_url,{paramName:'name',method:'get',minChars:2,cityId:cityId,onSuccess:function(resp){elementLoaded.innerHTML=resp.responseText;var lists=elementLoaded.getElementsBySelector('ul li');elementLoaded.show();element.focus();if(imageElementLoad){imageElementLoad.hide();}},updateElement:function(element){var value='';for(var i=0;i<element.childElements().length;i++){value=value+element.childElements()[i].textContent;}
$('address_street').value=value;$('address_street_value').value=element.readAttribute('rel');$('wrong-street-validation').hide();},indicator:$('address_street_loader')});};var _changeInputStreetTimeout=window.setTimeout(_changeInputStreet,300);var typeInputStreet=function(){$('address_street_value').value='';_changeInputStreetTimeout;}
this.dispatch=function(){element.observe('keyup',typeInputStreet);};};allo.productData=new function(){this.jsonData=null;this.data=null;this.dataReceived=false;this.getProductInStoresAndDeliveryData=function(cityId,productId,callback){if(allo.productData.dataReceived){callback();return;}
var data={productId:productId,cityId:cityId};allo.blocks.forceGet('ajax','oggetto_cshipping/shipping/data',data,function(responseData){allo.productData.jsonData=JSON.stringify(responseData);allo.productData.data=responseData;allo.productData.dataReceived=true;callback();});};};;var Translator=new Translate({"Value this field must by unique.":"\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u044D\u0442\u043E\u0433\u043E \u043F\u043E\u043B\u044F \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u044B\u043C.","Please select an option.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0432\u0430\u0440\u0438\u0430\u043d\u0442.","This is a required field.":"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.","Please enter a valid number in this field.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0432 \u044d\u0442\u043e \u043f\u043e\u043b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e.","Please use letters only (a-z) in this field.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b (a-z).","Please use only letters (a-z), numbers (0-9) or underscore(_) in this field, first character should be a letter.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b (a-z), \u0446\u0438\u0444\u0440\u044b (0-9) \u0438\u043b\u0438 \u043f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u044f(_). \u041f\u0435\u0440\u0432\u044b\u0439 \u0441\u0438\u043c\u0432\u043e\u043b \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u0443\u043a\u0432\u043e\u0439.","Please use only letters (a-z) or numbers (0-9) only in this field. No spaces or other characters are allowed.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b (a-z) \u0438\u043b\u0438 \u0446\u0438\u0444\u0440\u044b (0-9). \u041f\u0440\u043e\u0431\u0435\u043b\u044b \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u044b.","Please use only letters (a-z) or numbers (0-9) or spaces and # only in this field.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b (a-z), \u0446\u0438\u0444\u0440\u044b (0-9), \u043f\u0440\u043e\u0431\u0435\u043b\u044b \u0438\u043b\u0438 #.","Please enter a valid phone number. For example (123) 456-7890 or 123-456-7890.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 (123) 456-7890 \u0438\u043b\u0438 123-456-7890.","Please enter a valid date.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0434\u0430\u0442\u0443.","Please enter a valid email address. For example johndoe@domain.com.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 johndoe@domain.com.","Please enter 6 or more characters.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 6 \u0438\u043b\u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432.","Please make sure your passwords match.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0432\u0430\u0448\u0438 \u043f\u0430\u0440\u043e\u043b\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442.","Please enter a valid URL. For example http:\/\/www.example.com or www.example.com":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 URL. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, http:\/\/www.example.com \u0438\u043b\u0438 www.example.com","Please enter a valid social security number. For example 123-45-6789.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u0430\u043d\u0438\u044f. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 123-45-6789.","Please enter a valid zip code. For example 90602 or 90602-1234.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0438\u043d\u0434\u0435\u043a\u0441. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 9060 \u0438\u043b\u0438 90602-1234.","Please enter a valid zip code.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0438\u043d\u0434\u0435\u043a\u0441.","Please use this date format: dd\/mm\/yyyy. For example 17\/03\/2006 for the 17th of March, 2006.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0434\u043b\u044f \u0434\u0430\u0442\u044b \u0444\u043e\u0440\u043c\u0430\u0442: dd\/mm\/yyyy. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 17\/03\/2006 \u0434\u043b\u044f 17-\u0433\u043e \u043c\u0430\u0440\u0442\u0430 2006 \u0433\u043e\u0434\u0430.","Please enter a valid $ amount. For example $100.00.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, $100.00.","Please select one of the above options.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u0432\u044b\u0448\u0435\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432.","Please select one of the options.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432.","Please select State\/Province.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0448\u0442\u0430\u0442\/\u043f\u0440\u043e\u0432\u0438\u043d\u0446\u0438\u044e.","Please enter valid password.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c.","Please enter 6 or more characters. Leading or trailing spaces will be ignored.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 6 \u0438\u043b\u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432. \u041f\u0440\u043e\u0431\u0435\u043b\u044b \u043f\u0435\u0440\u0435\u0434 \u0438 \u043f\u043e\u0441\u043b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b.","Please use letters only (a-z or A-Z) in this field.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b (a-z \u0438\u043b\u0438 A-Z).","Please enter a number greater than 0 in this field.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0432 \u044d\u0442\u043e \u043f\u043e\u043b\u0435 \u0447\u0438\u0441\u043b\u043e \u0431\u043e\u043b\u044c\u0448\u0435 0.","Please enter a valid credit card number.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043a\u0440\u0435\u0434\u0438\u0442\u043d\u043e\u0439 \u043a\u0430\u0440\u0442\u044b.","Please wait, loading...":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u0438\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430...","Please choose to register or to checkout as a guest":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0441\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u0432\u044b\u0431\u043e\u0440: \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0438\u043b\u0438 \u043e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437 \u0431\u0435\u0437 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435","Error: Passwords do not match":"\u041e\u0448\u0438\u0431\u043a\u0430: \u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442","Please specify shipping method.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043c\u0435\u0442\u043e\u0434 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438.","Please specify payment method.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043c\u0435\u0442\u043e\u0434 \u043e\u043f\u043b\u0430\u0442\u044b.","Please use only letters (a-z or A-Z), numbers (0-9) or underscore(_) in this field, first character should be a letter.":"Please use only letters (a-z or A-Z), numbers (0-9) or underscores (_) in this field, first character must be a letter.","Your session has been expired, you will be relogged in now.":"\u0421\u0440\u043e\u043a \u0432\u0430\u0448\u0435\u0433\u043e \u0441\u0435\u0430\u043d\u0441\u0430 \u0438\u0441\u0442\u0451\u043a. \u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043d\u0430 \u0444\u043e\u0440\u043c\u0443 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438.","Please select city":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434","Payment order":"\u041e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u0430","In the preparation of":"\u041f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438","Delivery":"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430","Unfortunately, for this product are not available delivery methods in the selected city.":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u043e\u0432\u0430\u0440\u0430 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0441\u043f\u043e\u0441\u043e\u0431\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0432 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u0433\u043e\u0440\u043e\u0434\u0435.","Payment":"\u041e\u043f\u043b\u0430\u0442\u0430","cash on delivery commodity":"\u043d\u0430\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u0430","cashless payment":"\u0431\u0435\u0437\u043d\u0430\u043b\u0438\u0447\u043d\u0430\u044f \u043e\u043f\u043b\u0430\u0442\u0430","VISA card":"\u043a\u0430\u0440\u0442\u043e\u0439 VISA","If you specify to use merchant alternative, the alternative merchant and password must be specified":"\u0415\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u043c\u0435\u0440\u0447\u0430\u043d\u0442\u0430, \u0442\u043e \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 \u043c\u0435\u0440\u0447\u0430\u043d\u0442 \u0438 \u043f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u044b","All manufacturers":"\u0412\u0441\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0438","City":"\u0413\u043e\u0440\u043e\u0434","Enter the correct date":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0443\u044e \u0434\u0430\u0442\u0443","Age of the borrower should be more than 21 and not more than 65 years":"\u0412\u043e\u0437\u0440\u0430\u0441\u0442 \u0437\u0430\u0435\u043c\u0449\u0438\u043a\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 21-\u0433\u043e \u0438 \u043d\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 65 \u043b\u0435\u0442","the wrong day":"\u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0434\u0435\u043d\u044c","Invalid month":"\u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043c\u0435\u0441\u044f\u0446","Invalid year":"\u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0433\u043e\u0434","Choose the file":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b","This field is required.":"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f","Vkontakte":"\u0412\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0435","Odnoklasniki":"\u041e\u0434\u043d\u043e\u043a\u043b\u0430\u0441\u0441\u043d\u0438\u043a\u0438","Compare":"\u0421\u0440\u0430\u0432\u043d\u0438\u0442\u044c","Added to compare":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u043a \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e","Remove This Item":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u0437\u0438\u0446\u0438\u044e","Are you sure you would like to remove this item from the compare products?":"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0442\u043e\u0432\u0430\u0440 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u043b\u044f \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f?","Are you sure you would like to remove all products from your comparison?":"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043b\u044f \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f?","Reset":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c","You logged as":"\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a","To login, please enter your e-mail address (email)":"\u0414\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b (email)","Enter your e-mail":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0412\u0430\u0448 e-mail","User with this email already registered. If this is you - enter the password.":"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c email \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0412\u044b - \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c.","User address":"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0430\u0434\u0440\u0435\u0441\u043e\u043c","is already registered and has an associated account":"\u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u0438 \u0438\u043c\u0435\u0435\u0442 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442","Please enter a valid email.":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email.","Password":"\u041f\u0430\u0440\u043e\u043b\u044c","The password has been entered is not correct.":"\u041f\u0430\u0440\u043e\u043b\u044c \u0431\u044b\u043b \u0432\u0432\u0435\u0434\u0435\u043d \u043d\u0435 \u0432\u0435\u0440\u043d\u043e.","Forgot your password?":"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?","Login":"\u0412\u043e\u0439\u0442\u0438","Cancel":"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c","Now you can log in to the site as a user Allo":"\u0422\u0435\u043f\u0435\u0440\u044c \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u0445\u043e\u0434\u0438\u0442\u044c \u043d\u0430 \u0441\u0430\u0439\u0442 \u0410\u043b\u043b\u043e \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c","In your e-mail we send the account password Allo":"\u041d\u0430 \u0412\u0430\u0448\u0443 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443 \u043c\u044b \u0432\u044b\u0441\u043b\u0430\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0410\u043b\u043b\u043e.","Close":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","Buy":"\u041a\u0443\u043f\u0438\u0442\u044c","Or enter other city":"\u0418\u043b\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u0433\u043e\u0440\u043e\u0434","The request failed":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430","Mistake  ":"\u041e\u0448\u0438\u0431\u043a\u0430:  ","Your cart":"\u0412\u0430\u0448\u0430 \u043a\u043e\u0440\u0437\u0438\u043d\u0430","proceed to Checkout":"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437","Your cart empty":"\u0412\u0430\u0448\u0430 \u043a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430","Access permission error.":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430.","Text length does not satisfy specified text range.":"\u0414\u043b\u0438\u043d\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c","Please use numbers only in this field. Please avoid spaces or other characters such as dots or commas.":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0438\u0444\u0440\u044b \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0437\u0431\u0435\u0433\u0430\u0439\u0442\u0435 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u0432 \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432, \u0442\u0430\u043a\u0438\u0445 \u043a\u0430\u043a \u0442\u043e\u0447\u043a\u0438 \u0438\u043b\u0438 \u0437\u0430\u043f\u044f\u0442\u044b\u0435.","Please enter a valid url without HTTP protocol. For example //test.com, //test.test.com/test.html":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u0440\u043e\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0441\u0441\u044b\u043b\u043a\u0438 \u0431\u0435\u0437 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430. \u041a \u043f\u0440\u0438\u043c\u0435\u0440\u0443 \/\/test.com, \/\/test.test.com\/test.html"});;(function($,window,document,undefined){var $window=$(window);$.fn.lazyload=function(options){var elements=this;var $container;var settings={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:false,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAACDCAQAAABxGdxOAAAAv0lEQVR42u3RQQEAAAQEMJdcdGJ42Cos08WhCBAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECBAgQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAhAgAAECECAAAQIQIAABAp5bktXD/odcYIAAAAAASUVORK5CYII="};function update(){var counter=0;elements.each(function(){var $this=$(this);if(settings.skip_invisible&&!$this.is(":visible")){return;}
if($.abovethetop(this,settings)||$.leftofbegin(this,settings)){}else if(!$.belowthefold(this,settings)&&!$.rightoffold(this,settings)){$this.trigger("appear");counter=0;}else{if(++counter>settings.failure_limit){return false;}}});}
if(options){if(undefined!==options.failurelimit){options.failure_limit=options.failurelimit;delete options.failurelimit;}
if(undefined!==options.effectspeed){options.effect_speed=options.effectspeed;delete options.effectspeed;}
$.extend(settings,options);}
$container=(settings.container===undefined||settings.container===window)?$window:$(settings.container);if(0===settings.event.indexOf("scroll")){$container.bind(settings.event,function(){return update();});}
this.each(function(){var self=this;var $self=$(self);self.loaded=false;if($self.attr("src")===undefined||$self.attr("src")===false){if($self.is("img")){$self.attr("src",settings.placeholder);}}
$self.one("appear",function(){if(!this.loaded){if(settings.appear){var elements_left=elements.length;settings.appear.call(self,elements_left,settings);}
$("<img />").bind("load",function(){var original=$self.attr("data-"+settings.data_attribute);$self.hide();if($self.is("img")){$self.attr("src",original);}else{$self.css("background-image","url('"+original+"')");}
$self[settings.effect](settings.effect_speed);self.loaded=true;var temp=$.grep(elements,function(element){return!element.loaded;});elements=$(temp);if(settings.load){var elements_left=elements.length;settings.load.call(self,elements_left,settings);}}).attr("src",$self.attr("data-"+settings.data_attribute));}});if(0!==settings.event.indexOf("scroll")){$self.bind(settings.event,function(){if(!self.loaded){$self.trigger("appear");}});}});$window.bind("resize",function(){update();});if((/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion)){$window.bind("pageshow",function(event){if(event.originalEvent&&event.originalEvent.persisted){elements.each(function(){$(this).trigger("appear");});}});}
$(document).ready(function(){update();});$(document).on('scroll:ended',function(){update();});return this;};$.belowthefold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=(window.innerHeight?window.innerHeight:$window.height())+$window.scrollTop();}else{fold=$(settings.container).offset().top+$(settings.container).height();}
return fold<=$(element).offset().top-settings.threshold;};$.rightoffold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.width()+$window.scrollLeft();}else{fold=$(settings.container).offset().left+$(settings.container).width();}
return fold<=$(element).offset().left-settings.threshold;};$.abovethetop=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollTop();}else{fold=$(settings.container).offset().top;}
return fold>=$(element).offset().top+settings.threshold+$(element).height();};$.leftofbegin=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollLeft();}else{fold=$(settings.container).offset().left;}
return fold>=$(element).offset().left+settings.threshold+$(element).width();};$.inviewport=function(element,settings){return!$.rightoffold(element,settings)&&!$.leftofbegin(element,settings)&&!$.belowthefold(element,settings)&&!$.abovethetop(element,settings);};$.extend($.expr[":"],{"below-the-fold":function(a){return $.belowthefold(a,{threshold:0});},"above-the-top":function(a){return!$.belowthefold(a,{threshold:0});},"right-of-screen":function(a){return $.rightoffold(a,{threshold:0});},"left-of-screen":function(a){return!$.rightoffold(a,{threshold:0});},"in-viewport":function(a){return $.inviewport(a,{threshold:0});},"above-the-fold":function(a){return!$.belowthefold(a,{threshold:0});},"right-of-fold":function(a){return $.rightoffold(a,{threshold:0});},"left-of-fold":function(a){return!$.rightoffold(a,{threshold:0});}});})(jQuery,window,document);;

;(function(){window.visibly={q:document,p:undefined,prefixes:['webkit','ms','o','moz','khtml'],props:['VisibilityState','visibilitychange','Hidden'],m:['focus','blur'],visibleCallbacks:[],hiddenCallbacks:[],genericCallbacks:[],_callbacks:[],cachedPrefix:"",fn:null,onVisible:function(_callback){if(typeof _callback=='function'){this.visibleCallbacks.push(_callback);}},onHidden:function(_callback){if(typeof _callback=='function'){this.hiddenCallbacks.push(_callback);}},getPrefix:function(){if(!this.cachedPrefix){for(var l=0,b;b=this.prefixes[l++];){if(b+this.props[2]in this.q){this.cachedPrefix=b;return this.cachedPrefix;}}}},visibilityState:function(){return this._getProp(0);},hidden:function(){return this._getProp(2);},visibilitychange:function(fn){if(typeof fn=='function'){this.genericCallbacks.push(fn);}
var n=this.genericCallbacks.length;if(n){if(this.cachedPrefix){while(n--){this.genericCallbacks[n].call(this,this.visibilityState());}}else{while(n--){this.genericCallbacks[n].call(this,arguments[0]);}}}},isSupported:function(index){return((this._getPropName(2))in this.q);},_getPropName:function(index){return(this.cachedPrefix==""?this.props[index].substring(0,1).toLowerCase()+this.props[index].substring(1):this.cachedPrefix+this.props[index]);},_getProp:function(index){return this.q[this._getPropName(index)];},_execute:function(index){if(index){this._callbacks=(index==1)?this.visibleCallbacks:this.hiddenCallbacks;var n=this._callbacks.length;while(n--){this._callbacks[n]();}}},_visible:function(){window.visibly._execute(1);window.visibly.visibilitychange.call(window.visibly,'visible');},_hidden:function(){window.visibly._execute(2);window.visibly.visibilitychange.call(window.visibly,'hidden');},_nativeSwitch:function(){this[this._getProp(2)?'_hidden':'_visible']();},_listen:function(){try{if(!(this.isSupported())){if(this.q.addEventListener){window.addEventListener(this.m[0],this._visible,1);window.addEventListener(this.m[1],this._hidden,1);}else{if(this.q.attachEvent){this.q.attachEvent('onfocusin',this._visible);this.q.attachEvent('onfocusout',this._hidden);}}}else{this.q.addEventListener(this._getPropName(1),function(){window.visibly._nativeSwitch.apply(window.visibly,arguments);},1);}}catch(e){}},init:function(){this.getPrefix();this._listen();}};this.visibly.init();})();;allo.social=new function(){var _this=this;var _adapters=new Object();var _currentWindow=null;var _lightBox=null;var _socialClose=[];var _socialAction='';var _socialName='';var _socialLogin='';var _userData={name:null,email:null};var _loadAjax=function(params,response){var url=CURRENT_BASE_URL+'customer/social/ajax';new Ajax.Request(url,{parameters:params,onSuccess:response});};this.widget=new function(){};this.registerAdapter=function(name,adapter){_adapters[name]=adapter;};this.getAdapter=function(name){return _adapters[name];};this.loginWindow=function(socialName,pathName){var adapter=_adapters[socialName];var link=adapter.getLink();var winName=adapter.getName();var width=adapter.getWindowWidth();var height=adapter.getWindowHeight();var params="menubar=no,location=no,resizable=no,scrollbars=yes,status=no, width="+width+",height="+height;if(_currentWindow){_currentWindow.close();}
_currentWindow=window.open(link,winName,params);_socialName=socialName;_socialClose.push(socialName);switch(pathName){case('/checkout/onepage/'):_socialAction='social-checkout';break;case('/customer/account/login/'):_socialAction='social-login';break;case('/customer/account/create/'):_socialAction='social-registration';break;default:_socialAction='social-account';break;}
_gaq.push(['_trackEvent','authorization',_socialAction,socialName+'-open']);return false;};this.afterLogin=function(type,userData){_currentWindow.close();if(type=='STATUS_LOGGED'||type=='STATUS_CREATED'||type=='STATUS_CREATED_UNGROUP'||type=='STATUS_ATTACHED'||type=='STATUS_ATTACHED_UNGROUP'||type=='STATUS_ALREADY_CONNECTED')
{_socialLogin=_socialName;_gaq.push(['_trackEvent','authorization',_socialAction,_socialLogin+'-login']);_socialName='';}
switch(type){case('STATUS_LOGGED'):window.location.href=userData.redirectUriAfterLogin;break;case('STATUS_EMAIL_REQUIRED'):_this.showEmailRequiredWindow(userData);break;case('STATUS_CREATED'):_this.showCreatedWindow(userData.social,userData);break;case('STATUS_CREATED_UNGROUP'):_this.showCreatedUngroupWindow(userData.social,userData);break;case('STATUS_ATTACHED'):_this.showAttachedWindow(userData.social,userData);break;case('STATUS_ATTACHED_UNGROUP'):_this.showAttachedUngroupWindow(userData.social,userData);break;case('STATUS_ALREADY_CONNECTED'):_this.showAlreadyConnectedWindow(userData);break;case('STATUS_PASSWORD_REQUIRED'):_this.showEmailPassowordRequiredWindow(userData);break;case('STATUS_FAILED'):_this.showEmailPassowordRequiredWindow(userData);break;default:console.info('Status is : '+type);break;}};this.showEmailPassowordRequiredWindow=function(userData){var stageData={status:'PASSWORD_REQUIRED',email:userData.email};_this.showEmailRequiredWindow(userData,stageData);};this.showAlreadyConnectedWindow=function(userData){var stageData={status:'ALREADY_CONNECTED',email:userData.email};_this.showEmailRequiredWindow(userData,stageData);};this.unsubscribe=function(type){var url=CURRENT_BASE_URL+'/customer/social/unsubscribe';new Ajax.Request(url,{parameters:{"type":type},onSuccess:function(resp){window.location.reload(false);}});};this.showEmailRequiredWindow=function(userData,stageData){_userData.name=userData.name;_userData.email=userData.email;templateData={page:'email',user:_userData,langvars:{loggedas:Translator.translate('You logged as'),enteremail:Translator.translate('To login, please enter your e-mail address (email)'),entereouremail:Translator.translate('Enter your e-mail'),existuser:Translator.translate('User with this email already registered. If this is you - enter the password.'),useradres:Translator.translate('User address'),useradresreg:Translator.translate('is already registered and has an associated account'),rightemail:Translator.translate('Please enter a valid email.'),pass:Translator.translate('Password'),passwrong:Translator.translate('The password has been entered is not correct.'),forgotpass:Translator.translate('Forgot your password?'),Login:Translator.translate('Login'),Cancel:Translator.translate('Cancel')}};$('socialWindow').innerHTML=new EJS(allo.templates.tpl.customer_social).render(templateData);_lightBox=new Lightbox($('socialWindow'));_lightBox.open();$('socialWindow').setStyle({top:'198px'});$('socialWindow').setStyle({left:'478px'});var emailElement=$$('#socialWindow .socialEmail').first();var passwordElement=$$('#socialWindow .socialPassword').first();emailElement.value='';passwordElement.value='';var declineElement=$$('#socialWindow .socialDecline').first();var sendElement=$$('#socialWindow .socialSend').first();var inputFields=$$('#socialWindow .socialInput');var socialForgotPassword=$$('#socialWindow .socialForgotPassword').first();if(stageData){_loginEmailRequired(stageData);}
socialForgotPassword.observe('click',function(){_lightBox.close();window.setTimeout(function(){window.forgotPasswordLightbox.open();},1000);});declineElement.observe('click',function(){_lightBox.close();});inputFields.each(function(elem){elem.observe('keypress',function(event){var key=event.which||event.keyCode;if(key==Event.KEY_RETURN){fireEvent(sendElement,'click');}});});sendElement.observe('click',function(){var params={'action':'LOGIN_EMAIL_REQUIRED','email':emailElement.value,'password':passwordElement.value};$$('.socialControl .loadStatus').first().show();_loadAjax(params,_loginEmailRequired_ajax);});};var _closeCreatedWindow=function(){_this.redirect('account');};this.showCreatedWindow=function(social,user){var socialAdapter=allo.social.getAdapter(social);templateData={page:'created',social:{label:socialAdapter.getSettings('name'),name:social},user:user,langvars:{loggedas:Translator.translate('You logged as'),loggedasuser:Translator.translate('Now you can log in to the site as a user Allo'),sendemail:Translator.translate('In your e-mail we send the account password Allo'),close:Translator.translate('Close')}};$('socialWindow365').innerHTML=new EJS(allo.templates.tpl.customer_social).render(templateData);_lightBox=new Lightbox($('socialWindow365'));_lightBox.open();$('socialWindow365').setStyle({top:'198px'});$('socialWindow365').setStyle({left:'450px'});_lightBox.closeObserver=_closeCreatedWindow;var declineElement=$$('#socialWindow365 .socialDecline').first();declineElement.observe('click',function(){_lightBox.close();});};this.showCreatedUngroupWindow=function(social,user){var socialAdapter=allo.social.getAdapter(social);templateData={page:'created_ungroup',social:{label:socialAdapter.getSettings('name'),name:social,groupUrl:socialAdapter.getSettings('groupUrl'),clientId:socialAdapter.getSettings('clientId')},user:user,langvars:{loggedas:Translator.translate('You logged as'),loggedasuser:Translator.translate('Now you can log in to the site as a user Allo'),sendemail:Translator.translate('In your e-mail we send the account password Allo'),close:Translator.translate('Close')}};$('socialWindow365').innerHTML=new EJS(allo.templates.tpl.customer_social).render(templateData);_lightBox=new Lightbox($('socialWindow365'));_lightBox.closeObserver=_closeCreatedWindow;_lightBox.open();$('socialWindow365').setStyle({top:'198px'});$('socialWindow365').setStyle({left:'450px'});switch(social){case('vkontakte'):allo.social.widget.vkontakteGroup("vk_groups",{mode:1,width:"240",height:"150",color1:'FFFFFF',color2:'2B587A',color3:'5B7FA6'},socialAdapter.getSettings('groupId'));break;case('facebook'):allo.social.widget.facebookGroup(document,'script','facebook-jssdk',socialAdapter.getSettings('clientId'));break;case('odnoklassniki'):allo.social.widget.odnoklassnikiGroup(document,"ok_group_widget",socialAdapter.getSettings('groupId'),"{width:258,height:132}");break;}
var declineElement=$$('#socialWindow365 .socialDecline').first();declineElement.observe('click',function(){_lightBox.close();});};this.showAttachedWindow=function(social,user){var socialAdapter=allo.social.getAdapter(social);templateData={page:'attached',social:{label:socialAdapter.getSettings('name'),name:social},user:user,langvars:{loggedas:Translator.translate('You logged as'),loggedasuser:Translator.translate('Now you can log in to the site as a user Allo'),close:Translator.translate('Close')}};$('socialWindow365').innerHTML=new EJS(allo.templates.tpl.customer_social).render(templateData);_lightBox=new Lightbox($('socialWindow365'));_lightBox.closeObserver=_closeCreatedWindow;_lightBox.open();$('socialWindow365').setStyle({top:'198px'});$('socialWindow365').setStyle({left:'450px'});var declineElement=$$('#socialWindow365 .socialDecline').first();declineElement.observe('click',function(){_lightBox.close();_this.redirect('account');});};this.showAttachedUngroupWindow=function(social,user){var socialAdapter=allo.social.getAdapter(social);templateData={page:'attached_ungroup',social:{label:socialAdapter.getSettings('name'),name:social,groupUrl:socialAdapter.getSettings('groupUrl'),clientId:socialAdapter.getSettings('clientId')},user:user,langvars:{loggedas:Translator.translate('You logged as'),loggedasuser:Translator.translate('Now you can log in to the site as a user Allo'),close:Translator.translate('Close')}};$('socialWindow365').innerHTML=new EJS(allo.templates.tpl.customer_social).render(templateData);_lightBox=new Lightbox($('socialWindow365'));_lightBox.closeObserver=_closeCreatedWindow;_lightBox.open();$('socialWindow365').setStyle({top:'198px'});$('socialWindow365').setStyle({left:'450px'});switch(social){case('vkontakte'):allo.social.widget.vkontakteGroup("vk_groups",{mode:1,width:"240",height:"150",color1:'FFFFFF',color2:'2B587A',color3:'5B7FA6'},socialAdapter.getSettings('groupId'));break;case('facebook'):allo.social.widget.facebookGroup(document,'script','facebook-jssdk',socialAdapter.getSettings('clientId'));break;case('odnoklassniki'):allo.social.widget.odnoklassnikiGroup(document,"ok_group_widget",socialAdapter.getSettings('groupId'),"{width:305,height:160}");break;}
var declineElement=$$('#socialWindow365 .socialDecline').first();declineElement.observe('click',function(){_lightBox.close();});};var _loginEmailRequired_ajax=function(transport){var data=transport.responseText.evalJSON();$$('.socialControl .loadStatus').first().hide();_loginEmailRequired(data);};var _loginEmailRequired=function(data){var status=data.status;var social=data.social;var email=data.email;var emailElement=$$('#socialWindow .socialEmail').first();var emailMessage_userNeedPassword=$$('#socialWindow .socialEmailMessage_userNeedPassword').first();var emailMessage_alreadyConnected=$$('#socialWindow .socialEmailMessage_alreadyConnected').first();var emailMessage_emailWrong=$$('#socialWindow .socialEmailMessage_wrongEmail').first();var passwordBlock=$$('#socialWindow .socialPasswordBlock').first();var passwordMessagePasswordWrong=$$('#socialWindow .socialEmailMessage_wrongPassword').first();var passwordElement=$$('#socialWindow .socialPassword').first();emailMessage_emailWrong.hide();emailMessage_userNeedPassword.hide();emailMessage_alreadyConnected.hide();passwordBlock.hide();if(status=='ATTACHED'||status=='ATTACHED_UNGROUP'||status=='CREATED'||status=='CREATED_UNGROUP'||status=='LOGGED'||status=='ALREADY_CONNECTED')
{_socialLogin=social;_socialName=social;_gaq.push(['_trackEvent','authorization',_socialAction,_socialLogin+'-login']);}
switch(status){case('FAILED'):window.alert('Failed '+social);break;case('ATTACHED'):_lightBox.close();window.setTimeout(function(){_this.showAttachedWindow(social,_userData);},1000);break;case('ATTACHED_UNGROUP'):_lightBox.close();window.setTimeout(function(){_this.showAttachedUngroupWindow(social,_userData);},1000);break;case('CREATED'):_lightBox.close();window.setTimeout(function(){_this.showCreatedWindow(social,_userData);},1000);break;case('CREATED_UNGROUP'):_lightBox.close();window.setTimeout(function(){_this.showCreatedUngroupWindow(social,_userData);},1000);break;case('EMAIL_WRONG'):emailMessage_emailWrong.show();break;case('PASSWORD_REQUIRED'):if(email){emailElement.value=email;}
if(passwordElement.value){passwordMessagePasswordWrong.show();}
passwordElement.value='';passwordBlock.show();emailMessage_userNeedPassword.show();break;case('ALREADY_CONNECTED'):if(email){emailElement.value=email;}
emailString=$$('#socialWindow .socialEmailMessage_alreadyConnected .emailString').first();emailString.innerHTML=emailElement.value;emailMessage_alreadyConnected.show();break;case('LOGGED'):_lightBox.close();_this.redirect('account');break;}};window.onbeforeunload=function(){flag=false;for(i=0;i<_socialClose.length;i++){if(flag===false&&_socialLogin&&_socialClose[i]===_socialLogin){flag=true;continue;}
_gaq.push(['_trackEvent','authorization',_socialAction,_socialClose[i]+'-close']);}
_socialClose=[];};this.redirect=function(page){switch(page){case('account'):window.location.reload('/customer/account/');break;}
window.location.reload(false);};};var socialAdapter=Class.create({_settings:{},setSettings:function(name,value){this._settings[name]=value;},getSettings:function(name){return this._settings[name];},getName:function(){return this._settings.name;},getLink:function(){var redirectUri=encodeURIComponent(this._settings.redirectUri);var link='http://www.facebook.com/dialog/oauth/?client_id='+this._settings.clientId+'&redirect_uri='+redirectUri+'&display=popup&scope='+this._settings.scope;return link;},getWindowWidth:function(){return'500';},getWindowHeight:function(){return'600';}});var socialFacebookAdapter=Class.create(socialAdapter,{_settings:{'redirectUri':CURRENT_BASE_URL+'customer/social/login/type/facebook','name':'Facebook'},getRedirectUri:function(){var result,currentProtocol=location.protocol,url=this._settings.redirectUri;if(url.indexOf("https:")!=-1){result=url.replace("https:",currentProtocol);}else if(url.indexOf("http:")!=-1){result=url.replace("http:",currentProtocol);}else{result=url.replace("//",currentProtocol+"//");}
return encodeURIComponent(result);},getLink:function(){var redirectUri=this.getRedirectUri();return'https://graph.facebook.com/oauth/authorize?client_id='+this._settings.clientId+'&redirect_uri='+redirectUri;},getWindowWidth:function(){return'500';},getWindowHeight:function(){return'250';}});socialFacebook=new socialFacebookAdapter;allo.social.registerAdapter('facebook',socialFacebook);var socialVkontakteAdapter=Class.create(socialAdapter,{_settings:{'redirectUri':CURRENT_BASE_URL+'customer/social/login/type/vkontakte','scope':'groups','name':''},getLink:function(){var redirectUri=encodeURIComponent(this._settings.redirectUri);var link='https://oauth.vk.com/authorize?client_id='+this._settings.clientId+'&redirect_uri='+redirectUri+'&display=popup&v=5.0';return link;},getWindowWidth:function(){return'700';},getWindowHeight:function(){return'400';}});socialVkontakte=new socialVkontakteAdapter;allo.social.registerAdapter('vkontakte',socialVkontakte);var socialOdnoklassnikiAdapter=Class.create(socialAdapter,{_settings:{'redirectUri':CURRENT_BASE_URL+'customer/social/login/type/odnoklassniki','scope':'VALUABLE ACCESS','name':''},getLink:function(){var redirectUri=encodeURIComponent(this._settings.redirectUri);var link='http://www.odnoklassniki.ru/oauth/authorize?client_id='+this._settings.clientId+'&scope='+this._settings.scope+'&response_type=code&redirect_uri='+redirectUri;return link;},getWindowWidth:function(){return'720';},getWindowHeight:function(){return'400';}});socialOdnoklassniki=new socialOdnoklassnikiAdapter;allo.social.registerAdapter('odnoklassniki',socialOdnoklassniki);allo.social.widget.odnoklassnikiGroup=function(d,id,did,st){var js=d.createElement("script");js.src="http://connect.ok.ru/connect.js";js.onload=js.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){if(!this.executed){this.executed=true;setTimeout(function(){OK.CONNECT.insertGroupWidget(id,did,st);},0);}}};d.documentElement.appendChild(js);};allo.social.widget.vkontakteGroup=function(vk_groups,config,id){VK.Widgets.Group(vk_groups,config,id);};allo.social.widget.facebookGroup=function(d,s,id,appId){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/ru_RU/all.js#xfbml=1&appId="+appId;fjs.parentNode.insertBefore(js,fjs);};;navigationOpenFilters={};navigation_eval_js=null;document.observe("dom:loaded",function(){ganLoadForPlain();});document.onreadystatechange=ganLoadForPlain;function ganLoadForPlain(){}
function showNavigationNote(id,control){var arr=$(control).cumulativeOffset();$(id).style.left=arr[0]+'px';$(id).style.top=arr[1]+'px';$(id).style.display='block';}
function hideNavigationNote(){$$('.filter-note-content').each(function(e){e.style.display='none';});}
function navigationOpenFilter(request_var,target){var id='advancednavigation-filter-content-'+request_var;if($(id).style.display=='none'){$(id).style.display='block';if(navigation_eval_js)eval(navigation_eval_js);navigationOpenFilters[request_var+'_is_open']=true;if(target){$(target).addClassName('opened');}}else{$(id).style.display='none';navigationOpenFilters[request_var+'_is_open']=false;if(target){$(target).removeClassName('opened');}}}
function navigationMobileOpenFilter(request_var,target){var id='advancednavigation-filter-content-'+request_var;if($(id).style.display=='none'){$(id).style.display='block';if(navigation_eval_js)eval(navigation_eval_js);navigationOpenFilters[request_var+'_is_open']=true;if(target){$(target).removeClassName('closed');}
if(target){$(target).addClassName('opened');}}else{$(id).style.display='none';navigationOpenFilters[request_var+'_is_open']=false;if(target){$(target).removeClassName('opened');}
if(target){$(target).addClassName('closed');}}}
function navigationMobileFilterBlock(){var id='narrow-by-list';if($(id).style.display=='block'){$(id).style.display='none';}else{$(id).style.display='block';}};var Autocomplete=Autocomplete||{};Autocomplete.Extend=Autocomplete.Extend||{};Autocomplete.Extend.Autocompleter=Class.create(Ajax.Autocompleter,{baseInitialize:function(element,update,options){element=$(element);this.element=element;this.update=$(update);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;this.isMobile=false;if(this.setOptions)
this.setOptions(options);else
this.options=options||{};this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.isMobile=this.options.isMobile||false;var $this=this;this.options.onShow=this.options.onShow||function(element,update){if(!update.style.position||update.style.position=='absolute'){update.style.position='absolute';Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight});}
Effect.Appear(update,{duration:0.15,afterFinish:function(){allo.autoCompleteScroll.createScroll('scroll-width-auto-complete','scroll-auto-complete-scroll','scroll-auto-complete-scroll-bar','scroll-width-auto-complete-new',$this.isMobile);var liElements=jQuery('.scroll-width-auto-complete').find('ul li');jQuery.each(liElements,function(i){liElements.eq(i)[0].autocompleteIndex=i;$this.addObservers(liElements.eq(i)[0]);});}});update.style.left='0px';update.style.top=element.offsetHeight+'px';};this.options.onHide=this.options.onHide||function(element,update){new Effect.Fade(update,{duration:0.15})};if(typeof(this.options.tokens)=='string')
this.options.tokens=new Array(this.options.tokens);if(!this.options.tokens.include('\n'))
this.options.tokens.push('\n');this.observer=null;this.element.setAttribute('autocomplete','off');Element.hide(this.update);Event.observe(this.element,'blur',this.onBlur.bindAsEventListener(this));Event.observe(this.element,'keydown',this.onBlur.bindAsEventListener(this));Event.observe(this.element,'input',this.onInputChange.bindAsEventListener(this));},updateChoices:function(choices){if(!this.changed&&this.hasFocus){this.update.innerHTML=choices;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down().down());var ulElem=this.update.firstChild.down();if(ulElem&&ulElem.childNodes){this.entryCount=ulElem.childNodes.length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.autocompleteIndex=i;this.addObservers(entry);}}else{this.entryCount=0;}
this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},getEntry:function(index){var first=this.update.firstChild.down();if(first.className=='scroll-width-auto-complete-new'){return first.down().childNodes[index];}else{return first.childNodes[index];}},onBlur:function(event){setTimeout(this.hide.bind(this),350);if(!jQuery('.scroll-auto-complete-scroll').hasClass('ui-draggable-dragging')){this.hasFocus=false;this.active=false;}},hide:function(){if(!jQuery('.scroll-auto-complete-scroll').hasClass('ui-draggable-dragging')){this.stopIndicator();if(Element.getStyle(this.update,'display')!='none')this.options.onHide(this.element,this.update);if(this.iefix)Element.hide(this.iefix);}else{this.element.focus();}}});;var widget=widget||new function(){};document.observe('dom:loaded',function(){widget.imei.init();});widget.imei=new function(){var self=this;var processCheck=false;var messageBlock=undefined;this.init=function(){focusInput();jQuery(document).on('keyup',clickEnterAction);};var clickEnterAction=function(event){if(event.keyCode===13){widget.imei.sendImei.apply(self,jQuery('#imei-button-send'));}};var focusInput=function(){var input=jQuery('.imei-widget-block').find('#input-imei');if(input){input.focus();}};this.sendImei=function(clickedButton){var controlBlock=jQuery(clickedButton).parent('.control-block');var imeiInput=controlBlock.find('#input-imei');if(imeiInput&&!processCheck){var imeiValue=imeiInput.val();if(imeiValue){processCheck=true;messageBlock=controlBlock.parent('.imei-widget-block').find('#response-message');_processCheck(imeiValue,messageBlock);}}};var _processCheck=function(value,messageBlock){var url=BASE_URL+'imei/check';jQuery.ajax(url,{type:'GET',data:{imei:value,ts:Date.now()},success:function(response){try{var objResp=response.evalJSON();var mainWidgetBlock=messageBlock.parent('.imei-widget-block');var text='';if(objResp['check']){text=_appendNameToText(mainWidgetBlock.data('successful'),objResp['product_name']);}else{text=mainWidgetBlock.data('badly');}
messageBlock.text(text);processCheck=false;focusInput();}catch(e){console.log(e);processCheck=false;}}});};var _appendNameToText=function(text,productName){var replaceTo='';if(productName){replaceTo=productName;}
return text.replace(/{name}/g,replaceTo);};};;allo.payments=new function(){var _self=this;var _methods=new Object();this.register=new Object();this.vars=new Object();var _initialized=false;var _fieldSelectId='payment_method_select';var _paymentsCount=0;var _paymentsLoaded=0;var _initialize=function(){fieldSelectLink=$(_fieldSelectId);if(_self.selectedCode){fieldSelectLink.value=_self.selectedCode;}
var optionsLink=$$('#'+_fieldSelectId+' option');var options=new Object();var i;for(i=0;i<optionsLink.length;i++){options[optionsLink[i].value]=true;}
for(code in _methods){_methods[code].fieldSelectLink=fieldSelectLink;_methods[code].initialize();if(options[code]===undefined){inner=fieldSelectLink.innerHTML;fieldSelectLink.innerHTML=inner+'<option value="'+code+'">'+_methods[code].label+"</option>";}}
$(_fieldSelectId).observe('change',_self.change);if(_self.eventInitialized){_self.eventInitialized();}
$(_fieldSelectId).observe('change',_self.changeObserver);if(!_initialized||true){_self.change($(_fieldSelectId));_initialized=true;}
if(fieldSelectLink&&fieldSelectLink.options&&fieldSelectLink.options.length){linkCheckoutDropDown(fieldSelectLink);allo.checkoutPage.paymentScroll=false;var labelPayment=fieldSelectLink.up().select('div.fireselect-container .dropdown-link .label')[0];labelPayment.wrap('div');labelPayment.up('div').addClassName('selected_payment_method');$('payment_method_select-list').style.position='relative';}};this.selectedCode=null;this.eventInitialized=null;this.clear=function(){_paymentsCount=0;_paymentsLoaded=0;_methods=Object();}
this.clear=function(){for(unactivateMethodCode in _methods){_methods[unactivateMethodCode].unactivate();}
_methods=new Object();return _self;}
this.add=function(code,model){if(model==''){model='default';}else if(model=='default'){model='default_credit';}
var constructor=_self.register[model];if(typeof constructor=='undefined'){console.info('Attantion! Registered object not found "'+model+'" for method "'+code+'"');return;}
_methods[code]=new constructor();_methods[code].setCode(code);return _methods[code];};this.get=function(code){return _methods[code];};this.initialize=function(fieldId){if(fieldId){fieldSelectId=fieldId;}
if(_paymentsLoaded>=_paymentsCount){_initialize();}};this.changeObserver=function(event){var element=Event.element(event);_self.change(element);};this.change=function(element){var selected=element.value;for(unactivateMethodCode in _methods){_methods[unactivateMethodCode].unactivate();}
if(_methods[selected]!==undefined){_methods[selected].activate();}
_currentMethod=selected;};};;allo.payments.register['default']=function(){var _this=this;this.code=null;this.initialize=function(){};this.setCode=function(code){_this.code=code;return _this;};this.showAttributesArray=['passport_number','inn','dob','gender'];this.activate=function(){$$('.payment_'+_this.code+'_conteiner').each(function(item){item.show();});var gender=$('gender');if(gender){gender.addClassName('required-entry');}
$$('div.payment_'+_this.code+'_conteiner ul.form-list>li').each(function(item){var key=(item.id+'').replace('credit-','');if(this.showAttributesArray.indexOf(key)!=-1)
item.show();else
item.hide();},this);};this.unactivate=function(){$$('.payment_'+_this.code+'_conteiner').each(function(item){item.hide();});};};;allo.payments.register['ukrsib']=function(){var _this=this;var _clickLabel=function(event){checkbox=$('payment_credit_checkbox');if(checkbox.checked==true){checkbox.checked=false;}
else{checkbox.checked=true;}};this.code=null;this.initialize=function(){};this.setCode=function(code){_this.code=code;return _this;};this.initialize=function(){if(!allo.payments.vars.ukrsib){allo.payments.vars.ukrsib=new Object();}
if(!allo.payments.vars.ukrsib.initialized){$('payment_credit_appruval').observe('click',_clickLabel);allo.payments.vars.ukrsib.initialized=true;}};this.showAttributesArray=['passport_number','inn','dob','gender'];this.activate=function(){$$('.payment_credit_conteiner').each(function(item){item.show();var paymentMethod=$('payment_method_select')[$('payment_method_select').selectedIndex].value;var link=item.select('[id=credit_user_agreement]');if(link&&link.length>0&&credits_cfg[paymentMethod]==false){link[0].addClassName('not-a-credit-link');}});var gender=$('gender');if(gender){gender.addClassName('required-entry');}
$$('div.payment_credit_conteiner ul.form-list>li').each(function(item){var key=(item.id+'').replace('credit-','');if(this.showAttributesArray.indexOf(key)!=-1)
item.show();else
item.hide();},this);};this.unactivate=function(){$$('.payment_credit_conteiner').each(function(item){item.hide();link=item.select('[id=credit_user_agreement]');if(link&&link.length>0){link[0].removeClassName('not-a-credit-link');}});$('wrong-city-advice').hide();window.isCityValid=true;};};var bankCalculator=function(data,orderAmount,period){var _this=this;this.orderTotal=0;this.initialFee=0;this.defaultInitialFee=0;this.defaultInitialFee=0;this.minInitialFee=0;this.minInitialFee=0;this.processingFee=0;this.creditTime=0;this.defaultCreditTime=0;this.yearlyPercent=0;this.description='';this.minCreditTime=0;this.maxCreditTime=0;this.bankCode='ukrsibbank';this.bankModel='default';this.name=null;this.processing_fee_show=null;this.show_calculator=null;this.show_terms=null;this.calculator_editable=null;this.lending_terms=null;this.lockCheckout=false;this.initialize=function(data,orderAmount,period){this.defaultInitialFee=orderAmount*eval(data.default_initial_fee)/100;this.defaultInitialFee=this.defaultInitialFee.toFixed();this.initialFee=this.defaultInitialFee;this.minInitialFee=orderAmount*eval(data.minimum_initial_fee)/100;this.minInitialFee=this.minInitialFee.toFixed();this.processingFee=eval(data.processing_fee);this.monthlyFee=eval(data.monthly_fee);this.defaultCreditTime=eval(data.default_credit_term);this.creditTime=period?period:this.defaultCreditTime;this.yearlyPercent=eval(data.annual_percentage_rate);this.minCreditTime=eval(data.min_credit_time);this.maxCreditTime=eval(data.max_credit_time);this.description=data.description;this.orderTotal=orderAmount;this.bankCode=data.code;this.bankModel=data.model;this.name=data.name;this.processing_fee_show=data.processing_fee_show;this.show_calculator=data.show_calculator;this.show_terms=data.show_terms;this.calculator_editable=data.calculator_editable;this.lending_terms=data.lending_terms;this.calculateAndShow();};this.calculate=function(){var value=null;if(this.creditTime==0){return 0;}
if(this.bankModel=='privatpartly'&&this.monthlyFee){var monthlyFee=this.monthlyFee/100;value=(parseFloat(this.orderTotal)*monthlyFee*(parseInt(this.creditTime)+1)+parseFloat(this.orderTotal))/(parseInt(this.creditTime)+1);}
else{switch(this.bankCode){case('privatbank'):var processingFee=this.processingFee/100;var monthlyFee=this.monthlyFee/100;var yearlyPercent=this.yearlyPercent/100;var tmp1=(this.orderTotal-this.initialFee)*(1+processingFee);var tmp2=yearlyPercent/12*365/360;value=(tmp1*tmp2)/(1-Math.pow(1+tmp2,-this.creditTime))+tmp1*monthlyFee;break;default:var processingFee=this.processingFee/100;var monthlyFee=this.monthlyFee/100;var yearlyPercent=this.yearlyPercent/100;var tmp=Math.pow((1+yearlyPercent/12),this.creditTime);value=(this.orderTotal-this.initialFee)*(1+processingFee)*(monthlyFee+tmp*yearlyPercent/12/(tmp-1));break;}}
return value;};this.calculateAndShow=function(){if($('monthly-payment')){var price=this.calculate();if(price){$('monthly-payment').innerHTML=price.toFixed();}else{$('monthly-payment').innerHTML=0;}}};this.updateValues=function(){this.initialFee=this.initialFee===undefined?0:this.initialFee;this.creditTime=this.creditTime===undefined?0:this.creditTime;if($('initialFee')){$('initialFee').value=this.initialFee;}
if($('creditTime')){$('creditTime').value=this.creditTime;}
if($('processingFee'))
$('processingFee').innerHTML=this.processingFee+'%';if($('monthlyFee')){$('monthlyFee').innerHTML=this.monthlyFee+'%';}
if($('yearlyPercent'))
$('yearlyPercent').innerHTML=this.yearlyPercent+'%';this.calculateAndShow();};{_this.initialize(data,orderAmount,period);}};;(function(){var pasteEventName=(Prototype.Browser.IE?'paste':'input'),iPhone=(window.orientation!=undefined);if(typeof(Prototype)=="undefined")
throw"MaskedInput requires Prototype to be loaded.";Element.addMethods({caret:function(element,begin,end){if(element.length==0)return;if(typeof begin=='number'){end=(typeof end=='number')?end:begin;if(element.setSelectionRange){element.focus();element.setSelectionRange(begin,end);}else if(element.createTextRange){var range=element.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select();}}else{if(element.setSelectionRange){begin=element.selectionStart;end=element.selectionEnd;}else if(document.selection&&document.selection.createRange){var range=document.selection.createRange();begin=0-range.duplicate().moveStart('character',-100000);end=begin+range.text.length;}
return{begin:begin,end:end};}}});MaskedInput=Class.create({initialize:function(selector,mask,settings){this.elements=$$(selector);this.mask(mask,settings);},unmask:function(){this.elements.each(function(el){el.fire("mask:unmask");});return this;},mask:function(mask,settings){if(!mask&&this.elements.length>0){var input=$(this.elements[0]);var tests=input.retrieve("tests");return $A(input.retrieve("buffer")).map(function(c,i){return tests[i]?c:null;}).join('');}
settings=Object.extend({placeholder:"_",completed:null},settings||{});var defs=MaskedInput.definitions;var tests=[];var partialPosition=mask.length;var firstNonMaskPos=null;var len=mask.length;$A(mask.split("")).each(function(c,i){if(c=='?'){len--;partialPosition=i;}else if(defs[c]){tests.push(new RegExp(defs[c]));if(firstNonMaskPos==null)
firstNonMaskPos=tests.length-1;}else{tests.push(null);}});this.elements.each(function(el){var input=$(el);var buffer=$A(mask.replace(/\?/,'').split("")).map(function(c,i){return defs[c]?settings.placeholder:c});var ignore=false;var focusText=input.getValue();function seekNext(pos){while(++pos<len&&!tests[pos]);return pos;};function shiftL(pos){while(!tests[pos]&&--pos>=0);for(var i=pos;i<len;i++){if(tests[i]){buffer[i]=settings.placeholder;var j=seekNext(i);if(j<len&&tests[i].test(buffer[j])){buffer[i]=buffer[j];}else
break;}}
writeBuffer();input.caret(Math.max(firstNonMaskPos,pos));};function shiftR(pos){for(var i=pos,c=settings.placeholder;i<len;i++){if(tests[i]){var j=seekNext(i);var t=buffer[i];buffer[i]=c;if(j<len&&tests[j].test(t))
c=t;else
break;}}};function keydownEvent(e){var pos=input.caret();var k=e.keyCode;ignore=(k<16||(k>16&&k<32)||(k>32&&k<41));if((pos.begin-pos.end)!=0&&(!ignore||k==8||k==46))
clearBuffer(pos.begin,pos.end);if(k==8||k==46||(iPhone&&k==127)){shiftL(pos.begin+(k==46?0:-1));e.stop();}else if(k==27){input.setValue(focusText);input.caret(0,checkVal());e.stop();}};function keypressEvent(e){if(ignore){ignore=false;return(e.keyCode==8)?false:null;}
e=e||window.event;var k=e.charCode||e.keyCode||e.which;var pos=input.caret();if(e.ctrlKey||e.altKey||e.metaKey){return true;}else if((k>=32&&k<=125)||k>186){var p=seekNext(pos.begin-1);if(p<len){var c=String.fromCharCode(k);if(tests[p].test(c)){shiftR(p);buffer[p]=c;writeBuffer();var next=seekNext(p);input.caret(next);if(settings.completed&&next==len)
settings.completed.call(input);}}}
e.stop();};function blurEvent(e){checkVal();if(input.getValue()!=focusText){if(window.Event.simulate){input.simulate('change');}}};function focusEvent(e){focusText=input.getValue();var pos=checkVal();writeBuffer();setTimeout(function(){if(pos==mask.length)
input.caret(0,pos);else
input.caret(pos);},0);};function pasteEvent(e){setTimeout(function(){input.caret(checkVal(true));},0);};function clearBuffer(start,end){for(var i=start;i<end&&i<len;i++){if(tests[i])
buffer[i]=settings.placeholder;}};function writeBuffer(){return input.setValue(buffer.join('')).getValue();};function checkVal(allow){var test=input.getValue();var lastMatch=-1;for(var i=0,pos=0;i<len;i++){if(tests[i]){buffer[i]=settings.placeholder;while(pos++<test.length){var c=test.charAt(pos-1);if(tests[i].test(c)){buffer[i]=c;lastMatch=i;break;}}
if(pos>test.length)
break;}else if(buffer[i]==test[pos]&&i!=partialPosition){pos++;lastMatch=i;}}
if(!allow&&lastMatch+1<partialPosition){input.setValue("");clearBuffer(0,len);}else if(allow||lastMatch+1>=partialPosition){writeBuffer();if(!allow)input.setValue(input.getValue().substring(0,lastMatch+1));}
return(partialPosition?i:firstNonMaskPos);};if(!input.readAttribute("readonly"))
input.observe("mask:unmask",function(){input.store("buffer",undefined).store("tests",undefined).stopObserving("mask:unmask").stopObserving("focus",focusEvent).stopObserving("blur",blurEvent).stopObserving("keydown",keydownEvent).stopObserving("keypress",keypressEvent).stopObserving(pasteEventName,pasteEvent);}).observe("focus",focusEvent).observe("blur",blurEvent).observe("keydown",keydownEvent).observe("keypress",keypressEvent).observe(pasteEventName,pasteEvent);checkVal();});return this;}});Object.extend(MaskedInput,{definitions:{'9':"[0-9]",'a':"[A-Za-z]",'*':"[A-Za-z0-9]"}});})();;if(typeof Product=='undefined'){var Product={};}
Product.Zoom=Class.create();Product.Zoom.prototype={initialize:function(imageEl,trackEl,handleEl,zoomInEl,zoomOutEl,hintEl){this.containerEl=$(imageEl).parentNode;this.imageEl=$(imageEl);this.handleEl=$(handleEl);this.trackEl=$(trackEl);this.hintEl=$(hintEl);this.containerDim=Element.getDimensions(this.containerEl);this.imageDim=Element.getDimensions(this.imageEl);this.imageDim.ratio=this.imageDim.width/this.imageDim.height;this.floorZoom=1;if(this.imageDim.width>this.imageDim.height){this.ceilingZoom=this.imageDim.width/this.containerDim.width;}else{this.ceilingZoom=this.imageDim.height/this.containerDim.height;}
if(this.imageDim.width<=this.containerDim.width&&this.imageDim.height<=this.containerDim.height){this.trackEl.up().hide();this.hintEl.hide();this.containerEl.removeClassName('product-image-zoom');return;}
this.imageX=0;this.imageY=0;this.imageZoom=1;this.sliderSpeed=0;this.sliderAccel=0;this.zoomBtnPressed=false;this.showFull=false;this.selects=document.getElementsByTagName('select');this.draggable=new Draggable(imageEl,{starteffect:false,reverteffect:false,endeffect:false,snap:this.contain.bind(this)});this.slider=new Control.Slider(handleEl,trackEl,{axis:'horizontal',minimum:0,maximum:Element.getDimensions(this.trackEl).width,alignX:0,increment:1,sliderValue:0,onSlide:this.scale.bind(this),onChange:this.scale.bind(this)});this.scale(0);Event.observe(this.imageEl,'dblclick',this.toggleFull.bind(this));Event.observe($(zoomInEl),'mousedown',this.startZoomIn.bind(this));Event.observe($(zoomInEl),'mouseup',this.stopZooming.bind(this));Event.observe($(zoomInEl),'mouseout',this.stopZooming.bind(this));Event.observe($(zoomOutEl),'mousedown',this.startZoomOut.bind(this));Event.observe($(zoomOutEl),'mouseup',this.stopZooming.bind(this));Event.observe($(zoomOutEl),'mouseout',this.stopZooming.bind(this));},toggleFull:function(){this.showFull=!this.showFull;if(typeof document.body.style.maxHeight=="undefined"){for(i=0;i<this.selects.length;i++){this.selects[i].style.visibility=this.showFull?'hidden':'visible';}}
val_scale=!this.showFull?this.slider.value:1;this.scale(val_scale);this.trackEl.style.visibility=this.showFull?'hidden':'visible';this.containerEl.style.overflow=this.showFull?'visible':'hidden';this.containerEl.style.zIndex=this.showFull?'1000':'9';return this;},scale:function(v){var centerX=(this.containerDim.width*(1-this.imageZoom)/2-this.imageX)/this.imageZoom;var centerY=(this.containerDim.height*(1-this.imageZoom)/2-this.imageY)/this.imageZoom;var overSize=(this.imageDim.width>this.containerDim.width&&this.imageDim.height>this.containerDim.height);this.imageZoom=this.floorZoom+(v*(this.ceilingZoom-this.floorZoom));if(overSize){if(this.imageDim.width>this.containerDim.width){this.imageEl.style.width=(this.imageZoom*this.containerDim.width)+'px';}
if(this.containerDim.ratio){this.imageEl.style.height=(this.imageZoom*this.containerDim.width*this.containerDim.ratio)+'px';}}else{this.slider.setDisabled();}
this.imageX=this.containerDim.width*(1-this.imageZoom)/2-centerX*this.imageZoom;this.imageY=this.containerDim.height*(1-this.imageZoom)/2-centerY*this.imageZoom;this.contain(this.imageX,this.imageY,this.draggable);return true;},startZoomIn:function()
{if(!this.slider.disabled){this.zoomBtnPressed=true;this.sliderAccel=.002;this.periodicalZoom();this.zoomer=new PeriodicalExecuter(this.periodicalZoom.bind(this),.05);}
return this;},startZoomOut:function()
{if(!this.slider.disabled){this.zoomBtnPressed=true;this.sliderAccel=-.002;this.periodicalZoom();this.zoomer=new PeriodicalExecuter(this.periodicalZoom.bind(this),.05);}
return this;},stopZooming:function()
{if(!this.zoomer||this.sliderSpeed==0){return;}
this.zoomBtnPressed=false;this.sliderAccel=0;},periodicalZoom:function()
{if(!this.zoomer){return this;}
if(this.zoomBtnPressed){this.sliderSpeed+=this.sliderAccel;}else{this.sliderSpeed/=1.5;if(Math.abs(this.sliderSpeed)<.001){this.sliderSpeed=0;this.zoomer.stop();this.zoomer=null;}}
this.slider.value+=this.sliderSpeed;this.slider.setValue(this.slider.value);this.scale(this.slider.value);return this;},contain:function(x,y,draggable){var dim=Element.getDimensions(draggable.element);var xMin=0,xMax=this.containerDim.width-dim.width;var yMin=0,yMax=this.containerDim.height-dim.height;x=x>xMin?xMin:x;x=x<xMax?xMax:x;y=y>yMin?yMin:y;y=y<yMax?yMax:y;if(this.containerDim.width>dim.width){x=(this.containerDim.width/2)-(dim.width/2);}
if(this.containerDim.height>dim.height){y=(this.containerDim.height/2)-(dim.height/2);}
this.imageX=x;this.imageY=y;this.imageEl.style.left=this.imageX+'px';this.imageEl.style.top=this.imageY+'px';return[x,y];}}
Product.Config=Class.create();Product.Config.prototype={initialize:function(config){this.config=config;this.taxConfig=this.config.taxConfig;this.settings=$$('.super-attribute-select');this.state=new Hash();this.priceTemplate=new Template(this.config.template);this.prices=config.prices;this.settings.each(function(element){Event.observe(element,'change',this.configure.bind(this))}.bind(this));this.settings.each(function(element){var attributeId=element.id.replace(/[a-z]*/,'');if(attributeId&&this.config.attributes[attributeId]){element.config=this.config.attributes[attributeId];element.attributeId=attributeId;this.state[attributeId]=false;}}.bind(this))
var childSettings=[];for(var i=this.settings.length-1;i>=0;i--){var prevSetting=this.settings[i-1]?this.settings[i-1]:false;var nextSetting=this.settings[i+1]?this.settings[i+1]:false;if(i==0){this.fillSelect(this.settings[i])}
else{this.settings[i].disabled=true;}
$(this.settings[i]).childSettings=childSettings.clone();$(this.settings[i]).prevSetting=prevSetting;$(this.settings[i]).nextSetting=nextSetting;childSettings.push(this.settings[i]);}
if(config.defaultValues){this.values=config.defaultValues;}
var separatorIndex=window.location.href.indexOf('#');if(separatorIndex!=-1){var paramsStr=window.location.href.substr(separatorIndex+1);var urlValues=paramsStr.toQueryParams();if(!this.values){this.values={};}
for(var i in urlValues){this.values[i]=urlValues[i];}}
this.configureForValues();document.observe("dom:loaded",this.configureForValues.bind(this));},configureForValues:function(){if(this.values){this.settings.each(function(element){var attributeId=element.attributeId;element.value=(typeof(this.values[attributeId])=='undefined')?'':this.values[attributeId];this.configureElement(element);}.bind(this));}},configure:function(event){var element=Event.element(event);this.configureElement(element);},configureElement:function(element){this.reloadOptionLabels(element);if(element.value){this.state[element.config.id]=element.value;if(element.nextSetting){element.nextSetting.disabled=false;this.fillSelect(element.nextSetting);this.resetChildren(element.nextSetting);}}
else{this.resetChildren(element);}
this.reloadPrice();},reloadOptionLabels:function(element){var selectedPrice;if(element.options[element.selectedIndex].config){selectedPrice=parseFloat(element.options[element.selectedIndex].config.price)}
else{selectedPrice=0;}
for(var i=0;i<element.options.length;i++){if(element.options[i].config){element.options[i].text=this.getOptionLabel(element.options[i].config,element.options[i].config.price-selectedPrice);}}},resetChildren:function(element){if(element.childSettings){for(var i=0;i<element.childSettings.length;i++){element.childSettings[i].selectedIndex=0;element.childSettings[i].disabled=true;if(element.config){this.state[element.config.id]=false;}}}},fillSelect:function(element){var attributeId=element.id.replace(/[a-z]*/,'');var options=this.getAttributeOptions(attributeId);this.clearSelect(element);element.options[0]=new Option(this.config.chooseText,'');var prevConfig=false;if(element.prevSetting){prevConfig=element.prevSetting.options[element.prevSetting.selectedIndex];}
if(options){var index=1;for(var i=0;i<options.length;i++){var allowedProducts=[];if(prevConfig){for(var j=0;j<options[i].products.length;j++){if(prevConfig.config.allowedProducts&&prevConfig.config.allowedProducts.indexOf(options[i].products[j])>-1){allowedProducts.push(options[i].products[j]);}}}else{allowedProducts=options[i].products.clone();}
if(allowedProducts.size()>0){options[i].allowedProducts=allowedProducts;element.options[index]=new Option(this.getOptionLabel(options[i],options[i].price),options[i].id);element.options[index].config=options[i];index++;}}}},getOptionLabel:function(option,price){var price=parseFloat(price);if(this.taxConfig.includeTax){var tax=price/(100+this.taxConfig.defaultTax)*this.taxConfig.defaultTax;var excl=price-tax;var incl=excl*(1+(this.taxConfig.currentTax/100));}else{var tax=price*(this.taxConfig.currentTax/100);var excl=price;var incl=excl+tax;}
if(this.taxConfig.showIncludeTax||this.taxConfig.showBothPrices){price=incl;}else{price=excl;}
var str=option.label;if(price){if(this.taxConfig.showBothPrices){str+=' '+this.formatPrice(excl,true)+' ('+this.formatPrice(price,true)+' '+this.taxConfig.inclTaxTitle+')';}else{str+=' '+this.formatPrice(price,true);}}
return str;},formatPrice:function(price,showSign){var str='';price=parseFloat(price);if(showSign){if(price<0){str+='-';price=-price;}
else{str+='+';}}
var roundedPrice=(Math.round(price*100)/100).toString();if(this.prices&&this.prices[roundedPrice]){str+=this.prices[roundedPrice];}
else{str+=this.priceTemplate.evaluate({price:price.toFixed(2)});}
return str;},clearSelect:function(element){for(var i=element.options.length-1;i>=0;i--){element.remove(i);}},getAttributeOptions:function(attributeId){if(this.config.attributes[attributeId]){return this.config.attributes[attributeId].options;}},reloadPrice:function(){var price=0;var oldPrice=0;for(var i=this.settings.length-1;i>=0;i--){var selected=this.settings[i].options[this.settings[i].selectedIndex];if(selected.config){price+=parseFloat(selected.config.price);oldPrice+=parseFloat(selected.config.oldPrice);}}
optionsPrice.changePrice('config',{'price':price,'oldPrice':oldPrice});optionsPrice.reload();return price;if($('product-price-'+this.config.productId)){$('product-price-'+this.config.productId).innerHTML=price;}
this.reloadOldPrice();},reloadOldPrice:function(){if($('old-price-'+this.config.productId)){var price=parseFloat(this.config.oldPrice);for(var i=this.settings.length-1;i>=0;i--){var selected=this.settings[i].options[this.settings[i].selectedIndex];if(selected.config){price+=parseFloat(selected.config.price);}}
if(price<0)
price=0;price=this.formatPrice(price);if($('old-price-'+this.config.productId)){$('old-price-'+this.config.productId).innerHTML=price;}}}}
Product.Super={};Product.Super.Configurable=Class.create();Product.Super.Configurable.prototype={initialize:function(container,observeCss,updateUrl,updatePriceUrl,priceContainerId){this.container=$(container);this.observeCss=observeCss;this.updateUrl=updateUrl;this.updatePriceUrl=updatePriceUrl;this.priceContainerId=priceContainerId;this.registerObservers();},registerObservers:function(){var elements=this.container.getElementsByClassName(this.observeCss);elements.each(function(element){Event.observe(element,'change',this.update.bindAsEventListener(this));}.bind(this));return this;},update:function(event){var elements=this.container.getElementsByClassName(this.observeCss);var parameters=Form.serializeElements(elements,true);new Ajax.Updater(this.container,this.updateUrl+'?ajax=1',{parameters:parameters,onComplete:this.registerObservers.bind(this)});var priceContainer=$(this.priceContainerId);if(priceContainer){new Ajax.Updater(priceContainer,this.updatePriceUrl+'?ajax=1',{parameters:parameters});}}}
Product.OptionsPrice=Class.create();Product.OptionsPrice.prototype={initialize:function(config){this.productId=config.productId;this.priceFormat=config.priceFormat;this.includeTax=config.includeTax;this.defaultTax=config.defaultTax;this.currentTax=config.currentTax;this.productPrice=config.productPrice;this.showIncludeTax=config.showIncludeTax;this.showBothPrices=config.showBothPrices;this.productPrice=config.productPrice;this.productOldPrice=config.productOldPrice;this.skipCalculate=config.skipCalculate;this.duplicateIdSuffix=config.idSuffix;this.specialTaxPrice=config.specialTaxPrice;this.oldPlusDisposition=config.oldPlusDisposition;this.plusDisposition=config.plusDisposition;this.oldMinusDisposition=config.oldMinusDisposition;this.minusDisposition=config.minusDisposition;this.optionPrices={};this.containers={};this.displayZeroPrice=true;this.initPrices();},setDuplicateIdSuffix:function(idSuffix){this.duplicateIdSuffix=idSuffix;},initPrices:function(){this.containers[0]='product-price-'+this.productId;this.containers[1]='bundle-price-'+this.productId;this.containers[2]='price-including-tax-'+this.productId;this.containers[3]='price-excluding-tax-'+this.productId;this.containers[4]='old-price-'+this.productId;this.containers[5]='min-product-price-'+this.productId;this.containers[6]='max-product-price-'+this.productId;this.containers[7]='new-price-'+this.productId;},changePrice:function(key,price){this.optionPrices[key]=price;},getOptionPrices:function(){var price=0;var nonTaxable=0;var oldPrice=0;var priceInclTax=0;var currentTax=this.currentTax;$H(this.optionPrices).each(function(pair){if('undefined'!=typeof(pair.value.price)&&'undefined'!=typeof(pair.value.oldPrice)){price+=parseFloat(pair.value.price);oldPrice+=parseFloat(pair.value.oldPrice);}else if(pair.key=='nontaxable'){nonTaxable=pair.value;}else if(pair.key=='priceInclTax'){priceInclTax+=pair.value;}else if(pair.key=='optionsPriceInclTax'){priceInclTax+=pair.value*(100+currentTax)/100;}else{price+=parseFloat(pair.value);oldPrice+=parseFloat(pair.value);}});var result=[price,nonTaxable,oldPrice,priceInclTax];return result;},getConfigPrices:function(){var price=0;var nonTaxable=0;var oldPrice=0;var minPrice=0;var minOldPrice=0;var maxPrice=0;var maxOldPrice=0;var priceInclTax=0;var currentTax=this.currentTax;$H(this.optionPrices).each(function(pair){if('undefined'!=typeof(pair.value.price)){price=parseFloat(pair.value.price);if('undefined'!=typeof(pair.value.oldPrice)){oldPrice=parseFloat(pair.value.oldPrice);}}
if('undefined'!=typeof(pair.value.minPrice)&&'undefined'!=typeof(pair.value.maxPrice)){minPrice=pair.value.minPrice*1;maxPrice=pair.value.maxPrice*1;}});var result=[price,oldPrice,minPrice,minOldPrice,maxPrice,maxOldPrice];return result;},reload:function(){var price;var formattedPrice;var config=false;if('undefined'!=typeof(this.optionPrices)&&'undefined'!=typeof(this.optionPrices.config)&&'undefined'!=typeof(this.optionPrices.config.configurable)){var config=this.optionPrices.config.configurable;}
if(config==true){var optionPrices=this.getConfigPrices();var price=optionPrices[0];var oldPrice=optionPrices[1];var minPrice=optionPrices[2];var minOldPrice=optionPrices[3];var maxPrice=optionPrices[4];var maxOldPrice=optionPrices[5];if(minPrice==0||maxPrice==0){$('price-delimiter').style.display='none';}
else{$('price-delimiter').style.display='inline-block';}
if(price==oldPrice||oldPrice==0){var containerMainprice='product-price-'+this.productId;var containerOldPrice='';}
else{var containerMainprice='new-price-'+this.productId;var containerOldPrice='old-price-'+this.productId;}
$H(this.containers).each(function(pair){var _productPrice=0;if($(pair.value)){if(pair.value==containerMainprice){_productPrice=price*1;}else if(pair.value=='min-product-price-'+this.productId){_productPrice=minPrice*1;}else if(pair.value=='max-product-price-'+this.productId){_productPrice=maxPrice*1;}else if(pair.value==containerOldPrice){_productPrice=oldPrice*1;}
var sumTag=$(pair.value).childElements()[0].childElements();sumTag.each(function(node){if(node.hasClassName('sum'))
$(node).innerHTML=number_format(_productPrice,0,'.',' ');});if(_productPrice!=0){$(pair.value).style.display='inline-block';if(price!=oldPrice&&oldPrice!=0&&(pair.value==containerMainprice||pair.value==containerOldPrice)){$(pair.value).style.display='block';}}
else{$(pair.value).style.display='none';}};}.bind(this));}
else{var optionPrices=this.getOptionPrices();var nonTaxable=optionPrices[1];var optionOldPrice=optionPrices[2];var priceInclTax=optionPrices[3];optionPrices=optionPrices[0];$H(this.containers).each(function(pair){var _productPrice;var _plusDisposition;var _minusDisposition;if($(pair.value)){if(pair.value=='old-price-'+this.productId&&this.productOldPrice!=this.productPrice){_productPrice=this.productOldPrice;_plusDisposition=this.oldPlusDisposition;_minusDisposition=this.oldMinusDisposition;}else{_productPrice=this.productPrice;_plusDisposition=this.plusDisposition;_minusDisposition=this.minusDisposition;}
var price=0;if(pair.value=='old-price-'+this.productId&&optionOldPrice!==undefined){price=optionOldPrice+parseFloat(_productPrice);}else{price=optionPrices+parseFloat(_productPrice);priceInclTax+=parseFloat(_productPrice)*(100+this.currentTax)/100;}
if(this.specialTaxPrice=='true'){var excl=price;var incl=priceInclTax;}else if(this.includeTax=='true'){var tax=price/(100+this.defaultTax)*this.defaultTax;var excl=price-tax;var incl=excl*(1+(this.currentTax/100));}else{var tax=price*(this.currentTax/100);var excl=price;var incl=excl+tax;}
excl+=parseFloat(_plusDisposition);incl+=parseFloat(_plusDisposition);excl-=parseFloat(_minusDisposition);incl-=parseFloat(_minusDisposition);excl+=parseFloat(nonTaxable);incl+=parseFloat(nonTaxable);if(pair.value=='price-including-tax-'+this.productId){price=incl;}else if(pair.value=='old-price-'+this.productId){if(this.showIncludeTax||this.showBothPrices){price=incl;}else{price=excl;}}else{if(this.showIncludeTax){price=incl;}else{if(!this.skipCalculate||_productPrice==0){price=excl;}else{price=optionPrices+parseFloat(_productPrice);}}}
if(price<0)price=0;if(price>0||this.displayZeroPrice){formattedPrice=this.formatPrice(price);}else{formattedPrice='';}
if($(pair.value).select('.price')[0]){$(pair.value).select('.price')[0].innerHTML=formattedPrice;if($(pair.value+this.duplicateIdSuffix)&&$(pair.value+this.duplicateIdSuffix).select('.price')[0]){$(pair.value+this.duplicateIdSuffix).select('.price')[0].innerHTML=formattedPrice;}}else{$(pair.value).innerHTML=formattedPrice;if($(pair.value+this.duplicateIdSuffix)){$(pair.value+this.duplicateIdSuffix).innerHTML=formattedPrice;}}};}.bind(this));}},formatPrice:function(price){return formatCurrency(price,this.priceFormat);}}
function number_format(number,decimals,dec_point,thousands_sep){var i,kw,kd;if(isNaN(decimals=Math.abs(decimals))){decimals=2;}
if(dec_point==undefined){dec_point=",";}
if(thousands_sep==undefined){thousands_sep=".";}
i=parseInt(number=(+number||0).toFixed(decimals))+"";kw=i.split(/(?=(?:\d{3})+$)/).join(thousands_sep);kd=(decimals?dec_point+Math.abs(number-i).toFixed(decimals).replace(/-/,0).slice(2):"");return kw+kd;};if(typeof Product=='undefined'){var Product={};}
Product.Config=Class.create();Product.Config.prototype={initialize:function(config){this.config=config;this.taxConfig=this.config.taxConfig;if(config.containerId){this.settings=$$('#'+config.containerId+' '+'.super-attribute-select');}else{this.settings=$$('.super-attribute-select');}
this.state=new Hash();this.priceTemplate=new Template(this.config.template);this.prices=config.prices;if(config.defaultValues){this.values=config.defaultValues;}
var separatorIndex=window.location.href.indexOf('#');if(separatorIndex!=-1){var paramsStr=window.location.href.substr(separatorIndex+1);var urlValues=paramsStr.toQueryParams();if(!this.values){this.values={};}
for(var i in urlValues){this.values[i]=urlValues[i];}}
if(config.inputsInitialized){this.values={};this.settings.each(function(element){if(element.value){var attributeId=element.id.replace(/[a-z]*/,'');this.values[attributeId]=element.value;}}.bind(this));}
this.settings.each(function(element){Event.observe(element,'change',this.configure.bind(this))}.bind(this));this.settings.each(function(element){var attributeId=element.id.replace(/[a-z]*/,'');if(attributeId&&this.config.attributes[attributeId]){element.config=this.config.attributes[attributeId];element.attributeId=attributeId;this.state[attributeId]=false;}}.bind(this))
var childSettings=[];for(var i=this.settings.length-1;i>=0;i--){var prevSetting=this.settings[i-1]?this.settings[i-1]:false;var nextSetting=this.settings[i+1]?this.settings[i+1]:false;if(i==0){this.fillSelect(this.settings[i])}else{this.settings[i].disabled=true;}
$(this.settings[i]).childSettings=childSettings.clone();$(this.settings[i]).prevSetting=prevSetting;$(this.settings[i]).nextSetting=nextSetting;childSettings.push(this.settings[i]);}
this.configureForValues();document.observe("dom:loaded",this.configureForValues.bind(this));},configureForValues:function(){if(this.values){this.settings.each(function(element){var attributeId=element.attributeId;element.value=(typeof(this.values[attributeId])=='undefined')?'':this.values[attributeId];this.configureElement(element);}.bind(this));}},configure:function(event){var element=Event.element(event);this.configureElement(element);},configureElement:function(element){this.reloadOptionLabels(element);if(element.value){this.state[element.config.id]=element.value;if(element.nextSetting){element.nextSetting.disabled=false;this.fillSelect(element.nextSetting);this.resetChildren(element.nextSetting);}}
else{this.resetChildren(element);}
this.reloadPrice();},reloadOptionLabels:function(element){var selectedPrice;if(element.options[element.selectedIndex].config&&!this.config.stablePrices){selectedPrice=parseFloat(element.options[element.selectedIndex].config.price)}
else{selectedPrice=0;}
for(var i=0;i<element.options.length;i++){if(element.options[i].config){element.options[i].text=this.getOptionLabel(element.options[i].config,element.options[i].config.price-selectedPrice);}}},resetChildren:function(element){if(element.childSettings){for(var i=0;i<element.childSettings.length;i++){element.childSettings[i].selectedIndex=0;element.childSettings[i].disabled=true;if(element.config){this.state[element.config.id]=false;}}}},fillSelect:function(element){var attributeId=element.id.replace(/[a-z]*/,'');var options=this.getAttributeOptions(attributeId);this.clearSelect(element);element.options[0]=new Option(this.config.chooseText,'');var prevConfig=false;if(element.prevSetting){prevConfig=element.prevSetting.options[element.prevSetting.selectedIndex];}
if(options){var index=1;for(var i=0;i<options.length;i++){var allowedProducts=[];if(prevConfig){for(var j=0;j<options[i].products.length;j++){if(prevConfig.config.allowedProducts&&prevConfig.config.allowedProducts.indexOf(options[i].products[j])>-1){allowedProducts.push(options[i].products[j]);}}}else{allowedProducts=options[i].products.clone();}
if(allowedProducts.size()>0){options[i].allowedProducts=allowedProducts;element.options[index]=new Option(this.getOptionLabel(options[i],options[i].price),options[i].id);if(typeof options[i].price!='undefined'){element.options[index].setAttribute('price',options[i].price);}
element.options[index].config=options[i];index++;}}}},getOptionLabel:function(option,price){var price=parseFloat(price);if(this.taxConfig.includeTax){var tax=price/(100+this.taxConfig.defaultTax)*this.taxConfig.defaultTax;var excl=price-tax;var incl=excl*(1+(this.taxConfig.currentTax/100));}else{var tax=price*(this.taxConfig.currentTax/100);var excl=price;var incl=excl+tax;}
if(this.taxConfig.showIncludeTax||this.taxConfig.showBothPrices){price=incl;}else{price=excl;}
var str=option.label;if(price){if(this.taxConfig.showBothPrices){str+=' '+this.formatPrice(excl,true)+' ('+this.formatPrice(price,true)+' '+this.taxConfig.inclTaxTitle+')';}else{str+=' '+this.formatPrice(price,true);}}
return str;},formatPrice:function(price,showSign){var str='';price=parseFloat(price);if(showSign){if(price<0){str+='-';price=-price;}
else{str+='+';}}
var roundedPrice=(Math.round(price*100)/100).toString();if(this.prices&&this.prices[roundedPrice]){str+=this.prices[roundedPrice];}
else{str+=this.priceTemplate.evaluate({price:price.toFixed(2)});}
return str;},clearSelect:function(element){for(var i=element.options.length-1;i>=0;i--){element.remove(i);}},getAttributeOptions:function(attributeId){if(this.config.attributes[attributeId]){return this.config.attributes[attributeId].options;}},reloadPrice:function(){if(this.config.disablePriceReload){return;}
var price=0;var oldPrice=0;for(var i=this.settings.length-1;i>=0;i--){var selected=this.settings[i].options[this.settings[i].selectedIndex];if(selected.config){price+=parseFloat(selected.config.price);oldPrice+=parseFloat(selected.config.oldPrice);}}
optionsPrice.changePrice('config',{'price':price,'oldPrice':oldPrice});optionsPrice.reload();return price;if($('product-price-'+this.config.productId)){$('product-price-'+this.config.productId).innerHTML=price;}
this.reloadOldPrice();},reloadOldPrice:function(){if(this.config.disablePriceReload){return;}
if($('old-price-'+this.config.productId)){var price=parseFloat(this.config.oldPrice);for(var i=this.settings.length-1;i>=0;i--){var selected=this.settings[i].options[this.settings[i].selectedIndex];if(selected.config){price+=parseFloat(selected.config.price);}}
if(price<0)
price=0;price=this.formatPrice(price);if($('old-price-'+this.config.productId)){$('old-price-'+this.config.productId).innerHTML=price;}}}};Product.Configurable=Class.create();Product.Configurable.prototype=Object.create(Product.Config.prototype);Product.Configurable.prototype={initialize:function(config){this.config=config;this.taxConfig=this.config.taxConfig;if(config.containerId){this.settings=$$('#'+config.containerId+' '+'.super-attribute-select');}else{this.settings=$$('.super-attribute-select');}
this.state=new Hash();this.priceTemplate=new Template(this.config.template);if(config.defaultValues){this.values=config.defaultValues;}
var separatorIndex=window.location.href.indexOf('#super');if(separatorIndex!=-1){var paramsStr=window.location.href.substr(separatorIndex+6);var urlValues=paramsStr.toQueryParams();if(!this.values){this.values={};}
for(var i in urlValues){this.values[i]=urlValues[i];}}
this.settings.each(function(element){Event.observe(element,'click',this.configure.bind(this))}.bind(this));this.settings.each(function(element){var attributeId=element.id.replace(/[a-z]*/,'');if(attributeId&&this.config.attributes[attributeId]){element.config=this.config.attributes[attributeId];element.attributeId=attributeId;this.state[attributeId]=false;}}.bind(this))
var childSettings=[];for(var i=this.settings.length-1;i>=0;i--){var otherSettings=Array();var k=0;for(var j=0;j<=this.settings.length-1;j++){if(j!=i){otherSettings[k]=this.settings[j]?this.settings[j]:false;k++;}}
$(this.settings[i]).otherSettings=otherSettings;var prevSetting=this.settings[i-1]?this.settings[i-1]:false;var nextSetting=this.settings[i+1]?this.settings[i+1]:false;$(this.settings[i]).childSettings=childSettings.clone();$(this.settings[i]).prevSetting=prevSetting;$(this.settings[i]).nextSetting=nextSetting;childSettings.push(this.settings[i]);}
if($('config-error'))
this.configureForValues();else{document.observe("dom:loaded",this.configureForValues.bind(this));}
if(allo.session.loaded){this.reloadBuyButton();}else{document.observe('session:loaded',this.reloadBuyButton.bind(this));}},configureForValues:function(){if(this.values){for(var j=0;j<this.settings.length;j++){var element=this.settings[j];var foundProducts=0;var attributeId=element.attributeId;element.value=(typeof(this.values[attributeId])=='undefined')?'':this.values[attributeId];var elementOptions=element.config.options;if(element.value!=''){for(var i=0;i<elementOptions.length;i++){if(elementOptions[i].id==element.value){if(elementOptions[i].allowedProducts.length>0){foundProducts=1;var ulChildren=element.children;for(var k=0;k<ulChildren.length;k++){var childId=ulChildren[k].id;var optionAttributeValue=childId.replace(/[a-z]*/,'');if(optionAttributeValue==element.value){ulChildren[k].attributes.selected.value=true;}else{ulChildren[k].attributes.selected.value=false;}}
if(elementOptions[i].allowedProducts.length==1){this.config.chosenProductId=elementOptions[i].allowedProducts[0];}}}}}
if(foundProducts==1){this.configureElement(element);}}}},configure:function(event){if(event.target.nodeName==='LABEL'&(event.target.parentNode.hasClassName("colorconfcolca")||event.target.parentNode.className==='')||event.target.nodeName==='LI'&(event.target.hasClassName("colorconfcolca")||event.target.className===''))
{var element=this.getEventTarget(event);this.configureElement(element);}},getEventTarget:function(e){var ul=e.currentTarget;var ulChildren=ul.children;if(e.target.nodeName==="LI")
{var optionId=e.target.id.replace(/[a-z]*/,'');}else{var optionId=e.target.parentNode.id.replace(/[a-z]*/,'');}
var targetoption=jQuery('li#option'+optionId);if(ul.value==optionId){ul.value=false;}else{ul.value=optionId;}
for(var i=0;i<ulChildren.length;i++){if(ulChildren[i].attributes[0].value!='owl-controls'){if(ulChildren[i].attributes[0].value==='owl-stage-outer')
{for(var ii=0;ii<ulChildren[i].children[0].children.length;ii++){ulChildren[i].children[0].children[ii].children[0].attributes.selected.value=false;}}else{ulChildren[i].attributes.selected.value=false;}}}
if(ul.value){if(e.target.nodeName==="LI")
{e.target.attributes.selected.value=true;}else{e.target.parentNode.attributes.selected.value=true;}
var targetoption=jQuery('li#option'+optionId);for(var targeti=0;targeti<targetoption.length;targeti++){jQuery('li#option'+optionId)[targeti].attributes.selected.value=true;}}
var attributeId=ul.id.replace(/[a-z]*/,'');document.fire('configurable:drop',attributeId);document.fire('configurable:selected',attributeId);return ul;},configureElement:function(element){this.state[element.config.id]=element.value;this.changeLink(element);var isMobile=CURRENT_BASE_URL.indexOf('m.');var condition=true;if(isMobile==-1){isMobile=false;condition=typeof(zoomer)!='undefined';}else{isMobile=true;condition=typeof(ProductMediaManager)!='undefined'&&ProductMediaManager.imageWrapper!=null;}
if(condition){Product.Configurable.prototype.showImage(element);}else{document.observe("images:loaded",function(event){Product.Configurable.prototype.showImage(element);});}
this.fillOtherSettings(element);$('config-error').style.display='none';this.reloadPrice();this.reloadBuyButton();},changeLink:function(element){var queryString='';for(var i=0;i<this.settings.length;i++){var attributeId=this.settings[i].id.replace(/[a-z]*/,'');if(this.state[attributeId]!=false){queryString=queryString
+attributeId*1+'='
+this.state[attributeId]*1+'&';}}
var queryStrLength=queryString.length;if(queryStrLength>0&&queryString.substr(queryStrLength-1)=='&'){queryString=queryString.substr(0,queryStrLength-1);}
if(queryString.length>0){queryString='super'+queryString;}
location.hash=queryString;},showImage:function(element){var attributeValue=element.value;var imageElementArray=this._getImageElementArray(attributeValue);if(imageElementArray.length>0){var imageElement=imageElementArray[0];}else{imageElementArray=$$('ul.product-thumbnails li.main');if(imageElementArray.length>0){var imageElement=imageElementArray[0];}else{imageElementArray=$$('ul.product-thumbnails li.first');if(imageElementArray.length>0){var imageElement=imageElementArray[0];}}}
if(typeof(imageElement)!='undefined'){var mobileImageLink=jQuery(imageElement).find('a.thumb-link');if(mobileImageLink.length>0){imageElement=mobileImageLink[0];}
imageElement.click();}},_getImageElementArray:function(attributeValue){var imageElementId="ul.product-thumbnails li#"+attributeValue;var imageElementArray=$$(imageElementId);if(!imageElementArray.length){imageElementArray=$$(".product-thumbnails #"+attributeValue);}
return imageElementArray;},reloadBuyButton:function(){var baseProductId=this.config.productId;var chosenProduct=this.config.chosenProductId;if(undefined==chosenProduct){var chosenProduct=0;}
var buyButtonName='buy-button_'+baseProductId;var buyButton='button[name="'+buyButtonName+'"]';var buyButtonId='';$$(buyButton).each(function(button){if(button.hasClassName('big')){buyButtonId=button.identify();allo.blocks.updateBlock({'id':buyButtonId,'type':'cart','templateName':'buy_card','elementId':baseProductId},{'type':'Card','action':'actions','category':'above','chosenProduct':chosenProduct});}});},fillOtherSettings:function(element){var currentOptionProducts=Array();var attributeId=element.id.replace(/[a-z]*/,'');var attributeValue=element.value;var attributeOptions=this.config.attributes[attributeId].options;if(attributeValue!=false){for(var i=0;i<attributeOptions.length;i++){if(attributeOptions[i].id==attributeValue){var currentOptionProducts=attributeOptions[i].products;break;}}}else{for(var i=0;i<attributeOptions.length;i++){for(var j=0;j<attributeOptions[i].products.length;j++){currentOptionProducts.push(attributeOptions[i].products[j]);}}}
var allSettings=this.settings;for(var i=0;i<allSettings.length;i++){if(allSettings[i]!=element){var settingAttributeId=allSettings[i].attributeId;var settingsAttributeOptions=this.config.attributes[settingAttributeId].options;if(settingsAttributeOptions){for(var k=0;k<settingsAttributeOptions.length;k++){var option=settingsAttributeOptions[k];var allowedProducts=[];var optionProducts=option.products;for(var j=0;j<currentOptionProducts.length;j++){for(var z=0;z<optionProducts.length;z++){if(currentOptionProducts[j]==optionProducts[z])
allowedProducts.push(currentOptionProducts[j]);}}
settingsAttributeOptions[k].allowedProducts=allowedProducts;this.settings[i].config.options[k]=settingsAttributeOptions[k];if(allSettings[i].children[0].className!='owl-stage-outer'){var li='li#option'+settingsAttributeOptions[k].id;var elementLi=jQuery(allSettings[i]).find(li);}else{var li='li#option'+settingsAttributeOptions[k].id;var elementLi=jQuery(allSettings[i]).find(li);}
if(allowedProducts.size()>0){elementLi.removeClass('disabled');}else{elementLi.addClass('disabled');}}
if(this.state[settingAttributeId]){allSettings[i].value=this.state[settingAttributeId];}}}}
document.fire('colorcolca:selected',attributeId);},reloadOptionLabels:function(element){var selectedPrice;if(element.options[element.selectedIndex].config&&!this.config.stablePrices){selectedPrice=parseFloat(element.options[element.selectedIndex].config.price)}
else{selectedPrice=0;}
for(var i=0;i<element.options.length;i++){if(element.options[i].config){element.options[i].text=this.getOptionLabel(element.options[i].config,element.options[i].config.price-selectedPrice);}}},resetChildren:function(element){if(element.childSettings){for(var i=0;i<element.childSettings.length;i++){element.childSettings[i].selectedIndex=0;element.childSettings[i].disabled=true;if(element.config){this.state[element.config.id]=false;}}}},fillSelect:function(element){var attributeId=element.id.replace(/[a-z]*/,'');var options=this.getAttributeOptions(attributeId);this.clearSelect(element);element.options[0]=new Option(this.config.chooseText,'');var prevConfig=false;if(element.prevSetting){prevConfig=element.prevSetting.options[element.prevSetting.selectedIndex];}
if(options){var index=1;for(var i=0;i<options.length;i++){var allowedProducts=[];if(prevConfig){for(var j=0;j<options[i].products.length;j++){if(prevConfig.config.allowedProducts&&prevConfig.config.allowedProducts.indexOf(options[i].products[j])>-1){allowedProducts.push(options[i].products[j]);}}}else{allowedProducts=options[i].products.clone();}
if(allowedProducts.size()>0){options[i].allowedProducts=allowedProducts;element.options[index]=new Option(this.getOptionLabel(options[i],options[i].price),options[i].id);if(typeof options[i].price!='undefined'){element.options[index].setAttribute('price',options[i].price);}
element.options[index].config=options[i];index++;}}}},getOptionLabel:function(option,price){var price=parseFloat(price);if(this.taxConfig.includeTax){var tax=price/(100+this.taxConfig.defaultTax)*this.taxConfig.defaultTax;var excl=price-tax;var incl=excl*(1+(this.taxConfig.currentTax/100));}else{var tax=price*(this.taxConfig.currentTax/100);var excl=price;var incl=excl+tax;}
if(this.taxConfig.showIncludeTax||this.taxConfig.showBothPrices){price=incl;}else{price=excl;}
var str=option.label;if(price){if(this.taxConfig.showBothPrices){str+=' '+this.formatPrice(excl,true)+' ('+this.formatPrice(price,true)+' '+this.taxConfig.inclTaxTitle+')';}else{str+=' '+this.formatPrice(price,true);}}
return str;},formatPrice:function(price,showSign){var str='';price=parseFloat(price);if(showSign){if(price<0){str+='-';price=-price;}
else{str+='+';}}
var roundedPrice=(Math.round(price*100)/100).toString();if(this.prices&&this.prices[roundedPrice]){str+=this.prices[roundedPrice];}
else{str+=this.priceTemplate.evaluate({price:price.toFixed(2)});}
return str;},clearSelect:function(element){for(var i=element.options.length-1;i>=0;i--){element.remove(i);}},getAttributeOptions:function(attributeId){if(this.config.attributes[attributeId]){return this.config.attributes[attributeId].options;}},reloadPrice:function(){if(this.config.disablePriceReload){return;}
var price=0;var oldPrice=0;var allowedProducts=Array();for(var i=0;i<this.settings.length;i++){var foundState=false;var attributeSetting=this.settings[i];var attributeId=attributeSetting.id.replace(/[a-z]*/,'');var state=this.state[attributeId];if(state){foundState=true;for(var k=0;k<attributeSetting.config.options.length;k++){if(attributeSetting.config.options[k].id==state){selectedAllowedProducts=attributeSetting.config.options[k].allowedProducts;break;}}
var allAllowedProducts=allowedProducts;if(allowedProducts.length>0){var allowedProducts=Array();for(var j=0;j<allAllowedProducts.length;j++){for(var z=0;z<selectedAllowedProducts.length;z++){if(allAllowedProducts[j]==selectedAllowedProducts[z])
allowedProducts.push(selectedAllowedProducts[z]);}}}
else{allowedProducts=selectedAllowedProducts;}}}
if(foundState){if(allowedProducts.length==1){this.config.chosenProductId=allowedProducts[0];}else{this.config.chosenProductId=0;}}else{allowedProducts=Object.keys(this.config.simpleProducts);this.config.chosenProductId=0;}
var simpleProducts=this.config.simpleProducts;if(allowedProducts.length>0){var minPrice=simpleProducts[allowedProducts[0]].basePrice*1;var maxPrice=simpleProducts[allowedProducts[0]].basePrice*1;for(var i=0;i<allowedProducts.length;i++){var simpleProductPrice=simpleProducts[allowedProducts[i]].basePrice*1;if(minPrice>simpleProductPrice){minPrice=simpleProductPrice}
if(maxPrice<simpleProductPrice){maxPrice=simpleProductPrice}}}
if(allowedProducts.length==1){var price=simpleProducts[allowedProducts[0]].basePrice;var oldPrice=simpleProducts[allowedProducts[0]].oldPrice;optionsPrice.changePrice('config',{'price':price,'oldPrice':oldPrice,'configurable':true});}
else if(minPrice==maxPrice){var price=minPrice;optionsPrice.changePrice('config',{'price':price,'oldPrice':oldPrice,'configurable':true});}
else{optionsPrice.changePrice('config',{'minPrice':minPrice,'maxPrice':maxPrice,'configurable':true});}
optionsPrice.reload();return price;},reloadOldPrice:function(){if(this.config.disablePriceReload){return;}
if($('old-price-'+this.config.productId)){var price=parseFloat(this.config.oldPrice);for(var i=this.settings.length-1;i>=0;i--){var selected=this.settings[i].options[this.settings[i].selectedIndex];if(selected.config){price+=parseFloat(selected.config.price);}}
if(price<0)
price=0;price=this.formatPrice(price);if($('old-price-'+this.config.productId)){$('old-price-'+this.config.productId).innerHTML=price;}}}};Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined")
Calendar._SDN_len=3;var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len);}
Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined")
Calendar._SMN_len=3;ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len);}
Calendar._SMN=ar;}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.is_gecko=navigator.userAgent.match(/gecko/i);Calendar.getStyle=function(element,style){if(element.currentStyle){var y=element.currentStyle[style];}else if(window.getComputedStyle){var y=document.defaultView.getComputedStyle(element,null).getPropertyValue(style);}
return y;};Calendar.getAbsolutePos=function(element){var res=new Object();res.x=0;res.y=0;do{res.x+=element.offsetLeft||0;res.y+=element.offsetTop||0;element=element.offsetParent;if(element){if(element.tagName.toUpperCase()=='BODY')break;var p=Calendar.getStyle(element,'position');if((p!=='static')&&(p!=='relative'))break;}}while(element);return res;if(element!==null){res.x=element.offsetLeft;res.y=element.offsetTop;var offsetParent=element.offsetParent;var parentNode=element.parentNode;while(offsetParent!==null){res.x+=offsetParent.offsetLeft;res.y+=offsetParent.offsetTop;if(offsetParent!=document.body&&offsetParent!=document.documentElement){res.x-=offsetParent.scrollLeft;res.y-=offsetParent.scrollTop;}
if(Calendar.is_gecko){while(offsetParent!=parentNode&&parentNode!==null){res.x-=parentNode.scrollLeft;res.y-=parentNode.scrollTop;parentNode=parentNode.parentNode;}}
parentNode=offsetParent.parentNode;offsetParent=offsetParent.offsetParent;}}
return res;};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement;}else if(type=="mouseout"){related=evt.toElement;}}
while(related){if(related==el){return true;}
related=related.parentNode;}
return false;};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return;}
var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i];}}
el.className=ar.join(" ");};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className;};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName))
f=f.parentNode;return f;};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1)
f=f.parentNode;return f;};Calendar.stopEvent=function(ev){ev||(ev=window.event);if(Calendar.is_ie){ev.cancelBubble=true;ev.returnValue=false;}else{ev.preventDefault();ev.stopPropagation();}
return false;};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func);}else if(el.addEventListener){el.addEventListener(evname,func,true);}else{el["on"+evname]=func;}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func);}else if(el.removeEventListener){el.removeEventListener(evname,func,true);}else{el["on"+evname]=null;}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type);}else{el=document.createElement(type);}
if(typeof parent!="undefined"){parent.appendChild(el);}
return el;};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true);}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el;}else if(typeof el.parentNode.month!="undefined"){return el.parentNode;}
return null;};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el;}else if(typeof el.parentNode.year!="undefined"){return el.parentNode;}
return null;};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false;}
var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}
if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active");}
var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0)
s.left=cd.offsetLeft+"px";else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined")
mcw=50;s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px";}
s.top=(cd.offsetTop+cd.offsetHeight)+"px";};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false;}
var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}
if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active");}
cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true;}else{yr.style.display="none";}
yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep;}
if(show){var s=yc.style;s.display="block";if(cd.navtype<0)
s.left=cd.offsetLeft+"px";else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined")
ycw=50;s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px";}
s.top=(cd.offsetTop+cd.offsetHeight)+"px";}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false;}
if(cal.timeout){clearTimeout(cal.timeout);}
var el=cal.activeDiv;if(!el){return false;}
var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev);}
var mon=Calendar.findMonth(target);var date=null;if(mon){date=new CalendarDateObject(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}else{var year=Calendar.findYear(target);if(year){date=new CalendarDateObject(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}}
with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev);}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return;}
var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite");}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2)))
Calendar.removeClass(el,"active");Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite");}
ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false;}else
dx=pos.x-x;if(dx<0)dx=0;var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;)
if(range[i]==current)
break;while(count-->0)
if(decrease){if(--i<0)
i=range.length-1;}else if(++i>=range.length)
i=0;var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();}
var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}
Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon;}else if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}
var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}
Calendar.addClass(year,"hilite");cal.hilitedYear=year;}else if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}else if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}
return Calendar.stopEvent(ev);};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev);}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false;}
var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posX=ev.pageX;posY=ev.pageY;}
cal.hideShowCovered();var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev);};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false;}
cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev);}
cal.hideShowCovered();};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false;}
var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300)with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver);}else
addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp);}else if(cal.isPopup){cal._dragStart(ev);}
if(el.navtype==-1||el.navtype==1){if(cal.timeout)clearTimeout(cal.timeout);cal.timeout=setTimeout("Calendar.showMonthsCombo()",250);}else if(el.navtype==-2||el.navtype==2){if(cal.timeout)clearTimeout(cal.timeout);cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250);}else{cal.timeout=null;}
return Calendar.stopEvent(ev);};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty();}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false;}
if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1);}
el.calendar.tooltips.innerHTML=el.ttip;}
if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite");}}
return Calendar.stopEvent(ev);};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled)
return false;removeClass(el,"hilite");if(el.caldate)
removeClass(el.parentNode,"rowhilite");if(el.calendar)
el.calendar.tooltips.innerHTML=_TT["SEL_DATE"];return stopEvent(ev);}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el;}}
cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl)
cal._toggleMultipleDate(new CalendarDateObject(date));else
newdate=!el.disabled;if(other_month)
cal._init(cal.firstDayOfWeek,date);}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return;}
date=new CalendarDateObject(cal.date);if(el.navtype==0)
date.setDateOnly(new CalendarDateObject());cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max);}
date.setMonth(m);};switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:"";}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+"the corresponding file in \"lang\" subdir to match calendar-en.js\n"+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n";}
alert(text);return;case-2:if(year>cal.minYear){date.setFullYear(year-1);}
break;case-1:if(mon>0){setMonth(mon-1);}else if(year-->cal.minYear){date.setFullYear(year);setMonth(11);}
break;case 1:if(mon<11){setMonth(mon+1);}else if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0);}
break;case 2:if(year<cal.maxYear){date.setFullYear(year+1);}
break;case 100:cal.setFirstDayOfWeek(el.fdow);return;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;)
if(range[i]==current)
break;if(ev&&ev.shiftKey){if(--i<0)
i=range.length-1;}else if(++i>=range.length)
i=0;var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false;}
break;}
if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true;}else if(el.navtype==0)
newdate=closing=true;}
if(newdate){ev&&cal.callHandler();}
if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler();}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true;}else{parent=_par;this.isPopup=false;}
this.date=this.dateStr?new CalendarDateObject(this.dateStr):new CalendarDateObject();var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none";}
div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2)
cell.className+=" nav";Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell;};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"];}
row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"];}
for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell);}}
this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row);}
for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell);}}
if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number")
part._range=range_start;else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10)txt='0'+i;else txt=''+i;part._range[part._range.length]=txt;}}
Calendar._add_evs(part);return part;};var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm)hrs-=12;var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12)
AP=makeTimePart("ampm",pm?"pm":"am",["am","pm"]);else
cell.innerHTML="&nbsp;";cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm)hrs-=12;if(hrs==0)hrs=12;AP.innerHTML=pm?"pm":"am";}
H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins;};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(/pm/i.test(AP.innerHTML)&&h<12)
h+=12;else if(/am/i.test(AP.innerHTML)&&h==12)
h=0;}
var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler();};})();}else{this.onSetTime=this.onUpdateTime=function(){};}
var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move";}
this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn);}
div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr);}
this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple)
return false;(Calendar.is_ie)&&(ev=window.event);var act=(Calendar.is_ie||ev.type=="keypress"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break;default:return false;}}else switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 27:act&&cal.callCloseHandler();break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x];};setVars();function prevMonth(){var date=new CalendarDateObject(cal.date);date.setDate(date.getDate()-step);cal.setDate(date);};function nextMonth(){var date=new CalendarDateObject(cal.date);date.setDate(date.getDate()+step);cal.setDate(date);};while(1){switch(K){case 37:if(--x>=0)
ne=cal.ar_days[y][x];else{x=6;K=38;continue;}
break;case 38:if(--y>=0)
ne=cal.ar_days[y][x];else{prevMonth();setVars();}
break;case 39:if(++x<7)
ne=cal.ar_days[y][x];else{x=0;K=40;continue;}
break;case 40:if(++y<cal.ar_days.length)
ne=cal.ar_days[y][x];else{nextMonth();setVars();}
break;}
break;}
if(ne){if(!ne.disabled)
Calendar.cellClick(ne);else if(prev)
prevMonth();else
nextMonth();}}
break;case 13:if(act)
Calendar.cellClick(cal.currentDateEl,ev);break;default:return false;}
return Calendar.stopEvent(ev);};Calendar.prototype._init=function(firstDayOfWeek,date){var today=new CalendarDateObject(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year);}else if(year>this.maxYear){year=this.maxYear;date.setFullYear(year);}
this.firstDayOfWeek=firstDayOfWeek;this.date=new CalendarDateObject(date);var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0)
day1+=7;date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";cell.innerHTML=date.getWeekNumber();cell=cell.nextSibling;}
row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day";cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true;}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue;}}else{cell.otherMonth=false;hasdays=true;}
cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates)
dates[date.print("%Y%m%d")]=cell;if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip)
cell.title=toolTip;}
if(status===true){cell.className+=" disabled";cell.disabled=true;}else{if(/disabled/i.test(status))
cell.disabled=true;cell.className+=" "+status;}}
if(!cell.disabled){cell.caldate=new CalendarDateObject(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell;}
if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"];}
if(weekend.indexOf(wday.toString())!=-1)
cell.className+=cell.otherMonth?" oweekend":" weekend";}}
if(!(hasdays||this.showsOtherMonths))
row.className="emptyrow";}
this.title.innerHTML=Calendar._MN[month]+", "+year;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates();};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d)
continue;if(cell)
cell.className+=" selected";}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date;}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds];}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction;};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date);}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date);};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays();};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction;};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z;};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat));}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this);}
this.hideShowCovered();};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null;};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el);};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false;}
var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode);if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev);}};Calendar.prototype.show=function(){var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active");}}
this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar);}
this.hideShowCovered();};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar);}
this.element.style.display="none";this.hidden=true;this.hideShowCovered();};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show();};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true;}
function fixPosition(box){if(box.x<0)
box.x=0;if(box.y<0)
box.y=0;var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);if(Calendar.is_ie){br.y+=document.body.scrollTop;br.x+=document.body.scrollLeft;}else{br.y+=window.scrollY;br.x+=window.scrollX;}
var tmp=box.x+box.width-br.x;if(tmp>0)box.x-=tmp;tmp=box.y+box.height-br.y;if(tmp>0)box.y-=tmp;};this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var w=self.element.offsetWidth;var h=self.element.offsetHeight;self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1);}
switch(valign){case"T":p.y-=h;break;case"B":p.y+=el.offsetHeight;break;case"C":p.y+=(el.offsetHeight-h)/2;break;case"t":p.y+=el.offsetHeight-h;break;case"b":break;}
switch(halign){case"L":p.x-=w;break;case"R":p.x+=el.offsetWidth;break;case"C":p.x+=(el.offsetWidth-w)/2;break;case"l":p.x+=el.offsetWidth-w;break;case"r":break;}
p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y);};if(Calendar.is_khtml)
setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);else
Calendar.continuation_for_the_fucking_khtml_browser();};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str;};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str;};Calendar.prototype.parseDate=function(str,fmt){if(!fmt)
fmt=this.dateFormat;this.setDate(Date.parseDate(str,fmt));};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera)
return;function getVisib(obj){var value=obj.style.visibility;if(!value){if(document.defaultView&&typeof(document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml)
value=document.defaultView.getComputedStyle(obj,"").getPropertyValue("visibility");else
value='';}else if(obj.currentStyle){value=obj.currentStyle.visibility;}else
value='';}
return value;};var tags=new Array("applet","iframe","select");var el=this.element;var p=Calendar.getAbsolutePos(el);var EX1=p.x;var EX2=el.offsetWidth+EX1;var EY1=p.y;var EY2=el.offsetHeight+EY1;for(var k=tags.length;k>0;){var ar=document.getElementsByTagName(tags[--k]);var cc=null;for(var i=ar.length;i>0;){cc=ar[--i];p=Calendar.getAbsolutePos(cc);var CX1=p.x;var CX2=cc.offsetWidth+CX1;var CY1=p.y;var CY2=cc.offsetHeight+CY1;if(this.hidden||(CX1>EX2)||(CX2<EX1)||(CY1>EY2)||(CY2<EY1)){if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}
cc.style.visibility=cc.__msh_save_visibility;}else{if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}
cc.style.visibility="hidden";}}}};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell);}
if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend");}
cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling;}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none";};Calendar.prototype._dragStart=function(ev){if(this.dragging){return;}
this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX;}
var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd);}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(str,fmt){var today=new CalendarDateObject();var y=0;var m=-1;var d=0;var a=str;var i;for(i=0;i<Calendar._MN.length;i++){a=a.replace(Calendar._MN[i],enUS.m.wide[i]);}
for(i=0;i<Calendar._SMN.length;i++){a=a.replace(Calendar._SMN[i],enUS.m.abbr[i]);}
a=a.replace(Calendar._am,'am');a=a.replace(Calendar._am.toLowerCase(),'am');a=a.replace(Calendar._pm,'pm');a=a.replace(Calendar._pm.toLowerCase(),'pm');a=a.split(/\W+/);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i])
continue;switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":for(j=0;j<12;++j){if(enUS.m.abbr[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}
break;case"%B":for(j=0;j<12;++j){if(enUS.m.wide[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}
break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12)
hr+=12;else if(/am/i.test(a[i])&&hr>=12)
hr-=12;break;case"%M":min=parseInt(a[i],10);break;}}
if(isNaN(y))y=today.getFullYear();if(isNaN(m))m=today.getMonth();if(isNaN(d))d=today.getDate();if(isNaN(hr))hr=today.getHours();if(isNaN(min))min=today.getMinutes();if(y!=0&&m!=-1&&d!=0)
return new CalendarDateObject(y,m,d,hr,min,0);y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break;}}
if(t!=-1){if(m!=-1){d=m+1;}
m=t;}}else if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1;}else if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);}else if(d==0){d=a[i];}}
if(y==0)
y=today.getFullYear();if(m!=-1&&d!=0)
return new CalendarDateObject(y,m,d,hr,min,0);return today;};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth();}
if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29;}else{return Date._MD[month];}};Date.prototype.getDayOfYear=function(){var now=new CalendarDateObject(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new CalendarDateObject(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY);};Date.prototype.getWeekNumber=function(){var d=new CalendarDateObject(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var DoW=d.getDay();d.setDate(d.getDate()-(DoW+6)%7+3);var ms=d.valueOf();d.setMonth(0);d.setDate(4);return Math.round((ms-d.valueOf())/(7*864e5))+1;};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()));};Date.prototype.setDateOnly=function(date){var tmp=new CalendarDateObject(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate());};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0)
ir=12;var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._pm.toUpperCase():Calendar._am.toUpperCase();s["%P"]=pm?Calendar._pm.toLowerCase():Calendar._am.toLowerCase();s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(''+y).substr(2,2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml)
return str.replace(re,function(par){return s[par]||par;});var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],'g');str=str.replace(re,tmp);}}
return str;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new CalendarDateObject(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth())
this.setDate(28);this.__msh_oldSetFullYear(y);};CalendarDateObject.prototype=new Date();CalendarDateObject.prototype.constructor=CalendarDateObject;CalendarDateObject.prototype.parent=Date.prototype;function CalendarDateObject(){var dateObj;if(arguments.length>1){dateObj=eval("new this.parent.constructor("+Array.prototype.slice.call(arguments).join(",")+");");}else if(arguments.length>0){dateObj=new this.parent.constructor(arguments[0]);}else{dateObj=new this.parent.constructor();if(typeof(CalendarDateObject._SERVER_TIMZEONE_SECONDS)!="undefined"){dateObj.setTime((CalendarDateObject._SERVER_TIMZEONE_SECONDS+dateObj.getTimezoneOffset()*60)*1000);}}
return dateObj;}
window._dynarch_popupCalendar=null;;Calendar.setup=function(params){function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def;}};param_default("inputField",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",2);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var tmp=["inputField","displayArea","button"];for(var i in tmp){if(typeof params[tmp[i]]=="string"){params[tmp[i]]=document.getElementById(params[tmp[i]]);}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false;}function onSelect(cal){var p=cal.params;var changeOnClose=p.inputField.hasClassName('change-on-close');var update=((cal.dateClicked||p.electric)&&!changeOnClose);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);if(typeof p.inputField.onchange=="function")p.inputField.onchange();if(typeof fireEvent=='function')fireEvent(p.inputField,"change");}if(update&&p.displayArea)p.displayArea.innerHTML=cal.date.print(p.daFormat);if(update&&typeof p.onUpdate=="function")p.onUpdate(cal);if(update&&p.flat){if(typeof p.flatCallback=="function")p.flatCallback(cal);}if(update&&p.singleClick&&cal.dateClicked)cal.callCloseHandler();};if(params.flat!=null){if(typeof params.flat=="string")params.flat=document.getElementById(params.flat);if(!params.flat){alert("Calendar.setup:\n  Flat specified but can't find parent.");return false;}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat);}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value);}cal.create(params.flat);cal.show();return false;}var triggerEl=params.button||params.displayArea||params.inputField;triggerEl["on"+params.eventName]=function(){var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(dateEl)params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt);if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide();});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;mustCreate=true;}else{if(params.date)cal.setDate(params.date);cal.hide();}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d;}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate)cal.create();cal.refresh();if(!params.position)cal.showAtElement(params.button||params.displayArea||params.inputField,params.align);else cal.showAt(params.position[0],params.position[1]);return false;};return cal;};;allo.zoomerWindowVars=new function(){this.galleryCollection=new Object();this.galleryPopupCollection=new Object();this.galleryZoomCollection=new Object();this.galleryThumbnailsCollection=new Object();this.galleryImagesCollection=new Object();this.galleryVideosCollection=new Object();this.reviewThree=new Object();this.gallerySize=new Object();this.galleryKeys=new Array();this.currentImage=null;};allo.zoomerWindow=function(){var _this=this;var _settings=new Object();var _zoomerScroll=null;var _lightBox=null;var _thumbnailClick=function(){var prevImageId=_getActiveIdByThumbnail();var element=$(this);var imageId=element.readAttribute('imageid');_zoomerScroll.show(imageId);if(prevImageId){_stopVideoById(prevImageId);}};var _addToCart=function(){_lightBox.close();window.setTimeout(function(){var selector='[name=buy-button_'+_this.get('productId')+']';var element=$('zoomWindow').select(selector).first();cartController.data.href=$('zoomWindow').select(selector).first().onclick().replace('checkout','j2tajaxcheckout/index/cart');if(!cartController.ifCanBuyConfigurable(element))
return this;cartController.sendCart();},1000);};var _getActiveIdByThumbnail=function(){var activeThumbnail=$$('#imagesListMove li.selectedItem');if(activeThumbnail&&activeThumbnail.length){var Id=activeThumbnail[0].readAttribute('imageid');return Id;}else{return false;}};var _stopVideoById=function(Id){var frames=$$('#gallery-'+Id+' iframe');if(frames&&frames.length){frames[0].src=frames[0].src;}};var _stopVideoPlaying=function(){$$('#zoomerBlock li.video iframe').each(function(videoFrame){videoFrame.src=videoFrame.src;});};var _openWindow=function(imageId){var gallery=_this.get('gallery');var galleryPopup=_this.get('galleryPopup');var data={'addToCart':_this.get('addToCart'),'productName':_this.get('productName'),'productPrice':_this.get('productPrice'),'productSpecialPrice':_this.get('productSpecialPrice'),'galleryKeys':_this.get('galleryKeys'),'gallery':gallery,'galleryPopup':galleryPopup,'galleryImages':_this.get('galleryImages'),'galleryVideos':_this.get('galleryVideos'),'galleryThumbnails':_this.get('galleryThumbnails'),'currentImage':gallery[_this.get('currentImageId')],'productId':_this.get('productId'),'isSaleable':_this.get('isSaleable'),'isInStock':_this.get('isInStock'),'showPrice':_this.get('showPrice'),'finalPrice':_this.get('finalPrice'),'preOrder':_this.get('preOrder'),'preOrderLabelRewrite':_this.get('preOrderLabelRewrite'),'preOrderTitle':_this.get('preordertitle'),'comingSoon':_this.get('comingSoon'),'phonenumber':_this.get('phoneNumber'),'callcheck':_this.get('callcheck'),'forexample':_this.get('forexample'),'waitforyou':_this.get('waitforyou'),'staticBl':_this.get('staticBlock'),'buy':Translator.translate('Buy'),'productSku':_this.get('productSku'),'reviewThree':_this.get('reviewThree')};$('zoomWindow').innerHTML=new EJS(allo.templates.tpl.customer_zoomer).render(data);_lightBox=new Lightbox($('zoomWindow'));_lightBox.open();_lightBox.closeObserver=_stopVideoPlaying;_zoomerScroll=new allo.zoomerScroll;_zoomerScroll.set('galleryKeys',_this.get('galleryKeys'));_zoomerScroll.set('galleryZoom',(_this.get('galleryZoom'))?_this.get('galleryZoom'):_this.get('gallery'));_zoomerScroll.set('gallerySize',_this.get('gallerySize'));_zoomerScroll.set('galleryZoomPercent',_this.get('galleryZoomPercent'));_zoomerScroll.set('gallery',_this.get('galleryImages'));_zoomerScroll.set('galleryPopup',(_this.get('galleryPopup'))?_this.get('galleryPopup'):_this.get('galleryImages'));_zoomerScroll.set('galleryVideos',_this.get('galleryVideos'));_zoomerScroll.set('visualElementSize',_this.get('visualElementSize'));_zoomerScroll.set('reviewThree',_this.get('reviewThree'));_zoomerScroll.build(imageId);$$('#zoomWindow .imagesList li').each(function(item){$(item).observe('click',_thumbnailClick);});allo.blocks.updateBlock({'id':'zoomerToCard','type':'cart','templateName':'buy_card','elementId':_this.get('productId'),'observer':function(){$$('#zoomWindow .but').each(function(item){$(item).observe('click',_addToCart);});}},{'type':'Card','action':'actions','category':'above'});if(navigator.appVersion.indexOf("MSIE")==-1){new MaskedInput('#buy-through-phone-form-input-pop','(999)-999-99-99',{placeholder:'_'});}
if(!_this.get('showPrice')&&(_this.get('preOrder')>0)){new callBackRequestNewPop($('buy-through-phone-container-zoomer'),{productSku:data['productSku'],productName:data['productName']});}};this.openElementInPopup=function(elemClick){_openClick.apply(elemClick);return _this;};var _openClick=function(){var gallery=_this.get('gallery');var imageId=$(this).readAttribute('imageid');if(!imageId){imageId=_this.get('currentImageId');}
var reviewThreeId=$(this).readAttribute('id');if(reviewThreeId==='review-three'){imageId=reviewThreeId;}
_openWindow(imageId);return false;};var _openDblClick=function(){var gallery=_this.get('gallery');var imageId=$(this).readAttribute('imageid');if(!imageId){imageId=_this.get('currentImageId');}
_openWindow(imageId);return false;};this.clearVars=function(){allo.zoomerWindowVars.galleryCollection=new Object();allo.zoomerWindowVars.galleryPopupCollection=new Object();allo.zoomerWindowVars.galleryZoomCollection=new Object();allo.zoomerWindowVars.galleryThumbnailsCollection=new Object();allo.zoomerWindowVars.galleryImagesCollection=new Object();allo.zoomerWindowVars.galleryVideosCollection=new Object();allo.zoomerWindowVars.gallerySize=new Object();allo.zoomerWindowVars.galleryKeys=new Array();allo.zoomerWindowVars.currentImage=null;}
this.changeCartImage=function(id){$$('.product-thumbnails li').each(function(item){$(item).removeClassName('thumb-active');});$$('.product-thumbnails li').each(function(item){if(item.getAttribute('imageid')!=id){return;}
element=item;});element.addClassName('thumb-active');var gallery=_this.get('galleryImages');if(!gallery)
var gallery=allo.zoomerWindowVars.galleryImagesCollection;$('image').src=gallery[id];_this.set('currentImageId',id);}
this.changeCartImageOnMediaTab=function(id){$$('.media-gallery a').each(function(item){$(item).removeClassName('thumb-active');});$$('.media-gallery a').each(function(item){if(item.getAttribute('imageid')!=id){return;}
element=item;});element.addClassName('thumb-active');_this.set('currentImageId',id);}
this.clickToImage=function()
{_openWindow(_this.get('currentImageId'));}
this.set=function(name,value){_settings[name]=value;return _this;};this.get=function(name){return _settings[name];};this.ready=function(){var selector=_this.get('image');$$(selector).each(function(item){item.observe('click',_openClick);});$$('.main-thumbnails>ul.product-thumbnails>li').each(function(item){item.observe('dblclick',_openDblClick);});document.fire('images:loaded');};};allo.zoomerTool=function(){var _this=this;var _settings=new Object();var _status=false;var _imageW=null;var _imageH=null;this.set=function(name,value){_settings[name]=value;return _this;};this.get=function(name){return _settings[name];};var _imageMove=function(pointerX,pointerY){var zoomerBlock=$('zoomerBlock');var image=$$('#zoomerIncrese img').first();var coordsBlock=zoomerBlock.cumulativeOffset();var blockX=coordsBlock[0];var blockY=coordsBlock[1];var blockH=zoomerBlock.getHeight();var blockW=zoomerBlock.getWidth();var cursorX=pointerX-blockX;var cursorY=pointerY-blockY;var procentX=100/(blockW/cursorX);var procentY=100/(blockH/cursorY);var imageW=_imageW-blockW;var imageH=_imageH-blockH;var moveX=(imageW*procentX/100)*-1;var moveY=(imageH*procentY/100)*-1;image.style.left=moveX+'px';image.style.top=moveY+'px';};var _mouseMoveEvent=function(event){var pointerX=Event.pointerX(event);var pointerY=Event.pointerY(event);_imageMove(pointerX,pointerY);};this.isShowed=function(){return _status;};this.hide=function(){$('zoomerIncrese').hide();_status=false;var zoomerBlock=$('zoomerBlock');zoomerBlock.removeClassName('zoomCursor_in');zoomerBlock.removeClassName('zoomCursor_out');zoomerBlock.addClassName('zoomCursor_in');};this.show=function(id,event){var urlArray=_this.get('gallery');var url=urlArray[id];var gallerySizeArray=_this.get('gallerySize');var gallerySize=gallerySizeArray[id];if(typeof(gallerySize)=='undefined'){return false;}
_imageW=gallerySize.width;_imageH=gallerySize.height;if(_this.get('disable')==true){return;}
$('zoomerBlock').observe('mousemove',_mouseMoveEvent);$('zoomerIncrese').innerHTML='<img style="position:relative" src="'+url+'" />';$('zoomerIncrese').show();if(event){_mouseMoveEvent(event);}
_status=true;var zoomerBlock=$('zoomerBlock');zoomerBlock.removeClassName('zoomCursor_in');zoomerBlock.removeClassName('zoomCursor_out');zoomerBlock.addClassName('zoomCursor_out');};};allo.zoomerScroll=function(){var _this=this;var _settings=new Object();var _currentImageId=0;var _zoomerTool=null;_galleryPositions=new Object();this.set=function(name,value){_settings[name]=value;return _this;};this.get=function(name){return _settings[name];};var _getImageArrayKey=function(id){var keys=_this.get('galleryKeys');var ret=null;keys.each(function(item,key){if(item==id){ret=key;return;}});return ret;};var _zoomImage=function(event){if(_zoomerTool.isShowed()){_zoomerTool.hide();}
else{_zoomerTool.set('gallery',_this.get('galleryZoom'));_zoomerTool.set('gallerySize',_this.get('gallerySize'));_zoomerTool.show(_this.getId(),event);}};this.getId=function(){if(_currentImageId==0||!_currentImageId){var keys=_this.get('galleryKeys');_currentImageId=keys[0];};return _currentImageId;};this.canZoom=function(id){var zoomerBlock=$('zoomerBlock');var gallerySize=_this.get('gallerySize');var imageSize=gallerySize[id];if(typeof(imageSize)=='undefined'){return false;}
if(imageSize.type&&imageSize.type=='video'){return false;}
if(zoomerBlock.getWidth()>imageSize.width&&zoomerBlock.getHeight()>imageSize.height){return false;};var galleryZoomPercent=_this.get('galleryZoomPercent');var percent=100/(imageSize.width/zoomerBlock.getWidth());if(galleryZoomPercent>percent){return false;}
var percent=100/(imageSize.height/zoomerBlock.getHeight());if(galleryZoomPercent>percent){return false;}
return true;};this.changeImageBorder=function(id){$$('.imagesList li').each(function(item){if(item.getAttribute('imageid')!=id){return;}
element=item;});$$('#zoomWindow .imagesList li').each(function(item){item.removeClassName('selectedItem');});if(typeof(element)!='undefined')
element.addClassName('selectedItem');}
this.show=function(id){_zoomerTool.hide();_currentImageId=id;var zoomerBlock=$('zoomerBlock');var zoomerBlockPane=$$('#zoomerBlock ul').first();var position=_galleryPositions[id];zoomerBlockPane.style.left=(position*-1)+'px';if(_this.canZoom(id)){zoomerBlock.addClassName('zoomCursor_in');_zoomerTool.set('disable',false);}
else{zoomerBlock.removeClassName('zoomCursor_in');zoomerBlock.removeClassName('zoomCursor_out');_zoomerTool.set('disable',true);}
_this.changeImageBorder(_currentImageId);if(_this.showMoveButtons()){if(_this.canScrollLeft()){$$('#zoomWindow .leftPointer')[0].removeClassName('inactive');}
else{$$('#zoomWindow .leftPointer')[0].addClassName('inactive');}
if(_this.canScrollRight()){$$('#zoomWindow .rightPointer')[0].removeClassName('inactive');}
else{$$('#zoomWindow .rightPointer')[0].addClassName('inactive');}}else{$$('#zoomWindow .leftPointer')[0].hide();$$('#zoomWindow .rightPointer')[0].hide();}};this.showMoveButtons=function(){return $$('#imagesListMove').length>0;}
this.canScrollLeft=function(){var key=_getImageArrayKey(_this.getId());if(key<=0){return false;}
return true;}
this.canScrollRight=function(){var key=_getImageArrayKey(_this.getId());var keys=_this.get('galleryKeys');if(key>=keys.length-1){return false;}
return true;}
this.scrollLeft=function(){if(!_this.canScrollLeft())
return;var key=_getImageArrayKey(_this.getId());var keys=_this.get('galleryKeys');key=key-1;_this.show(keys[key]);_this.stopVideoPlaying(key+1);};this.scrollRight=function(){if(!_this.canScrollRight())
return;var key=_getImageArrayKey(_this.getId());var keys=_this.get('galleryKeys');key=key+1;_this.show(keys[key]);_this.stopVideoPlaying(key-1);};this.stopVideoPlaying=function(key){var keys=_this.get('galleryKeys');var Id='#gallery-'+keys[key]+' iframe';var element=$$(Id);if(element&&element.length){element[0].src=element[0].src;}}
this.build=function(imageId){var zoomerBlock=$('zoomerBlock');var keys=_this.get('galleryKeys');var gallery=_this.get('galleryPopup');var videos=_this.get('galleryVideos');var reviewThree=_this.get('reviewThree');var gallerySize=_this.get('gallerySize');var string='';var visualSize=_this.get('visualElementSize');var imageHeight=visualSize?visualSize.height:zoomerBlock.getHeight()-20;var imageWidth=visualSize?visualSize.width:zoomerBlock.getWidth()-20;var blockWidth=0;keys.each(function(item){_galleryPositions[item]=blockWidth;var gallerySize=_this.get('gallerySize');var options=gallerySize[item];var elementType='image';if(options&&options.type){elementType=options.type;}
switch(elementType){case'image':string=string+'<li id="gallery-'+item+'" class="image" style="float:left"><img height="'+imageHeight+'px" width="'+imageWidth+'px" src="'+gallery[item]+'" /></li>';break;case'video':string=string+'<li id="gallery-'+item+'" class="video" style="float:left">'+videos[item]+'</li>';break;case'review-three':string=string+'<li id="gallery-'+item+'" class="review-three" style="float:left">'+reviewThree[item]+'</li>';break;}
blockWidth=blockWidth+imageWidth+10;});string='<ul style="position:relative; left:0px; width:'+blockWidth+'px">'+string+'</ul>';if(visualSize){string=['<div id="zoomerViewPort" style="width: ',visualSize.width,'px;height: ',visualSize.height,'px;">',string,'</div>'].join('');}
string=string+'<div id="zoomerIncrese" style="position:relative;"></div>';zoomerBlock.innerHTML=string;$$('#zoomWindow .sliderArea .leftPanel .leftPointer').each(function(item){$(item).observe('click',_this.scrollLeft);});$$('#zoomWindow .sliderArea .leftPanel .rightPointer').each(function(item){$(item).observe('click',_this.scrollRight);});_zoomerTool=new allo.zoomerTool;$('zoomerBlock').observe('click',_zoomImage);if(!imageId){imageId=_this.getId();}
_this.show(imageId);if(_this.canZoom(imageId)){zoomerBlock.addClassName('zoomCursor_in');};}
var keys=[37,38,39,40];var keydown=function(e){for(var i=keys.length;i--;){if(e.keyCode===keys[i]){e.preventDefault();return;}}}
var wheel=function(e){e.preventDefault();}
var _DisableScroll=function(){if(window.addEventListener){window.addEventListener('DOMMouseScroll',wheel,false);}
window.onmousewheel=document.onmousewheel=wheel;document.onkeydown=keydown;}
var _EnableScroll=function(){if(window.removeEventListener){window.removeEventListener('DOMMouseScroll',wheel,false);}
window.onmousewheel=document.onmousewheel=document.onkeydown=null;}
var _KeyPress=function(e){var evtobj=window.event?event:e
if(evtobj.keyCode==39||evtobj.keyCode==39&&evtobj.ctrlKey){_DisableScroll();_this.scrollRight();}
if(evtobj.keyCode==37||evtobj.keyCode==37&&evtobj.ctrlKey){_DisableScroll();_this.scrollLeft();}}
$('zoomWindow').observe('lb:beforeclose',function(e){_EnableScroll();})
document.body.onkeydown=_KeyPress;};var callBackRequestNewPop=Class.create({options:{'formLink':null,'inputLink':null,'buttonSendLink':null,'formSuccessLink':null,'formEnterLink':null,'statusSend':false},initialize:function(container,options){this.container=container;function getElBySelector(selector){return container.down(selector);};this.options.buttonOpen=getElBySelector('#buy-through-phone-button-pop');this.options.buttonClose=getElBySelector('#buy-through-phone-form-close-pop');this.options.inputLink=getElBySelector('#buy-through-phone-form-input-pop');this.options.formLink=getElBySelector('#buy-through-phone-form-pop');this.options.buttonSendLink=getElBySelector('#waiting-for-call-pop');this.options.formSuccessLink=getElBySelector('#buy-through-phone-form-success-pop');this.options.formEnterLink=getElBySelector('#buy-through-phone-form-enter-pop');this.options.phoneMessageLink=getElBySelector('#enter_the_phone_message-pop');this.productSku=options.productSku;this.productName=options.productName;this.countryPath='+38';this.ajaxUrl=CURRENT_BASE_URL+'/callback/request/add';this._resetForm();this.options.buttonOpen.observe('click',this._showForm.bind(this));this.options.buttonClose.observe('click',this._closeForm.bind(this));this.options.buttonSendLink.observe('click',this._sendForm.bind(this));this.options.inputLink.observe('keypress',function(event){if(event.keyCode==13){this._sendForm();}}.bind(this));},_ajaxSent:function(transport){this.options.statusSend=false;this.options.buttonSendLink.removeClassName('blocked');jsonData=transport.responseText.evalJSON();if(jsonData.success==true){_gaq.push(['_trackEvent','Card','actions','pre-order-send']);this._resetForm(true);this.options.formSuccessLink.style.display='block';return;}
if(jsonData.errors.phone==true){this.options.phoneMessageLink.style.color='#ff0000';}},_resetForm:function(mainExcluded){if(!mainExcluded){this.options.formLink.style.display='none';}
this.options.formSuccessLink.style.display='none';this.options.formEnterLink.style.display='none';this.options.phoneMessageLink.style.color='#000000';},_showForm:function(){this.options.inputLink.value='';this._resetForm(true);if(this.options.formLink.style.display=='none'){this.options.formLink.style.display='block';this.options.formEnterLink.style.display='block';}
else{this.options.formLink.style.display='none';}},_closeForm:function(){this.options.formLink.style.display='none';},_sendForm:function(){if(this.options.statusSend!=false){return;}
var re=/[-\(\)]*/g;var form_tel_val=this.options.inputLink.value.replace(re,'');var phoneNumber=this.countryPath+form_tel_val;this.options.statusSend=true;this.options.buttonSendLink.addClassName('blocked');var params={parameters:{phone_number:phoneNumber,product_sku:this.productSku,product_name:this.productName},onSuccess:this._ajaxSent.bind(this)}
new Ajax.Request(this.ajaxUrl,params);}});;var RoomZoom=new Class.create();RoomZoom.prototype={initialize:function(el,settings){settings=Object.extend({opacity:0.5,zoomType:'standard',zoomWidth:300,zoomHeight:300,xOffset:10,yOffset:0,position:"right",preloadImages:true,preloadText:'Loading zoom',title:true,lens:true,imageOpacity:0.4,alwaysOn:false,showEffect:'show',hideEffect:'hide',fadeinSpeed:0.5,fadeoutSpeed:0.5,smoothingSpeed:40,smoothing:true,thumbnailChange:'click',disableExpand:false},settings||{});var obj;this.obj=obj=this;this.settings=settings;this.obj.el=this.el=el;this.timer=null;this.activated=false;this.visible=false;this.el.rel=($(el).readAttribute('rel'))?($(el).readAttribute('rel')):this._randomString(4);el.zoom_active=false;el.zoom_disabled=false;el.largeimageloading=false;el.largeimageloaded=false;el.scale={};el.timer=null;el.mousepos={};el.mouseDown=false;$(el).setStyle({'outline-style':'none','text-decoration':'none'});var img=this.img=$(el).select('img');el.title=$(el).readAttribute('title');el.imagetitle=img[0].readAttribute('title');var zoomtitle=(el.title.length>0)?el.title:el.imagetitle;var smallimage=this.smallimage=new Smallimage(img);var lens=this.lens=new Lens();var stage=this.stage=new Stage();var largeimage=this.largeimage=new Largeimage();var loader=this.loader=new Loader();$(el).observe('click',(function(e){this._expand(e);e.preventDefault();return false;}).bindAsEventListener(this));var zoomtypes=['standard','drag','innerzoom','reverse'];if(!zoomtypes.any(function(n){return n==obj.settings.zoomType;})){obj.settings.zoomType='standard';}
var switchTypes=['click','mouseover'];if(!switchTypes.any(function(n){return n==obj.settings.thumbnailChange;})){obj.settings.thumbnailChange='click';}
function Smallimage(image){var $obj=this;this.node=image[0];this.findborder=function(){var bordertop=0;bordertop=image[0].getStyle('border-top-width');btop='';var borderleft=0;borderleft=image[0].getStyle('border-left-width');bleft='';if(bordertop){for(i=0;i<3;i++){var x=[];x=bordertop.substr(i,1);if(isNaN(x)==false){btop=btop+''+bordertop.substr(i,1);}else{break;}}}
if(borderleft){for(i=0;i<3;i++){if(!isNaN(borderleft.substr(i,1))){bleft=bleft+borderleft.substr(i,1)}else{break;}}}
$obj.btop=(btop.length>0)?eval(btop):0;$obj.bleft=(bleft.length>0)?eval(bleft):0;};this.fetchdata=function(){$obj.findborder();$obj.w=image[0].width;$obj.h=image[0].height;$obj.ow=image[0].getWidth();$obj.oh=image[0].getHeight();$obj.pos=image[0].cumulativeOffset();$obj.pos.l=image[0].cumulativeOffset()[0]+$obj.bleft;$obj.pos.t=image[0].cumulativeOffset()[1]+$obj.btop;$obj.pos.r=$obj.w+$obj.pos.l;$obj.pos.b=$obj.h+$obj.pos.t;$obj.rightlimit=image[0].cumulativeOffset()[0]+$obj.ow;$obj.bottomlimit=image[0].cumulativeOffset()[1]+$obj.oh;};this.node.onerror=function(){alert('Problems while loading image.');throw'Problems while loading image.';};this.node.onload=function(){$obj.fetchdata();if(!$("zoomPad"+obj.el.rel))obj.create();};return $obj;};function Loader(){var $obj=this;this.append=function(){this.node=new Element('div',({'id':'zoomPreload'+obj.el.rel,'class':'zoomPreload'}));this.node.setStyle({'visibility':'hidden'}).update(settings.preloadText);$('zoomPad'+obj.el.rel).appendChild(this.node);};this.show=function(){this.node.top=(smallimage.oh-this.node.getHeight())/2;this.node.left=(smallimage.ow-this.node.getWidth())/2;this.node.setStyle({'top':this.node.top+'px','left':this.node.left+'px','position':'absolute','visibility':'visible'});};this.hide=function(){this.node.setStyle({'visibility':'hidden'});};return this;}
function Lens(){var $obj=this;this.node=new Element('div',({'id':'zoomPup'+obj.el.rel,'class':'zoomPup'}));this.append=function(){$('zoomPad'+obj.el.rel).appendChild($(this.node).hide());if(settings.zoomType=='reverse'){this.image=new Image();this.image.src=smallimage.node.src;$(this.node).childElements().each(function(child){child.remove()});$(this.node).appendChild(this.image);}};this.setdimensions=function(){this.node.w=(parseInt((settings.zoomWidth)/el.scale.x)>smallimage.w)?smallimage.w:(parseInt(settings.zoomWidth/el.scale.x));this.node.h=(parseInt((settings.zoomHeight)/el.scale.y)>smallimage.h)?smallimage.h:(parseInt(settings.zoomHeight/el.scale.y));this.node.top=(smallimage.oh-this.node.h-2)/2;this.node.left=(smallimage.ow-this.node.w-2)/2;this.node.setStyle({'top':0,'left':0,'width':this.node.w+'px','height':this.node.h+'px','position':'absolute','display':'none','borderWidth':1+'px','opacity':settings.opacity});if(settings.zoomType=='reverse'){this.image.src=smallimage.node.src;$(this.node).setOpacity(1);$(this.image).setStyle({'position':'absolute','display':'block','left':-(this.node.left+1-smallimage.bleft)+'px','top':-(this.node.top+1-smallimage.btop)+'px'});}};this.setcenter=function(){this.node.top=(smallimage.oh-this.node.h-2)/2;this.node.left=(smallimage.ow-this.node.w-2)/2;this.node.setStyle({'top':this.node.top+'px','left':this.node.left+'px'});if(settings.zoomType=='reverse'){$(this.image).setStyle({'position':'absolute','display':'block','left':-(this.node.left+1-smallimage.bleft)+'px','top':-(this.node.top+1-smallimage.btop)+'px'});}
largeimage.setposition();};this.setposition=function(e){el.mousepos.x=e.pageX;el.mousepos.y=e.pageY;var lensleft=0;var lenstop=0;function overleft(lens){return el.mousepos.x-(lens.w)/2<smallimage.pos.l;}
function overright(lens){return el.mousepos.x+(lens.w)/2>smallimage.pos.r;}
function overtop(lens){return el.mousepos.y-(lens.h)/2<smallimage.pos.t;}
function overbottom(lens){return el.mousepos.y+(lens.h)/2>smallimage.pos.b;}
lensleft=el.mousepos.x+smallimage.bleft-smallimage.pos.l-(this.node.w+2)/2;lenstop=el.mousepos.y+smallimage.btop-smallimage.pos.t-(this.node.h+2)/2;if(overleft(this.node)){lensleft=smallimage.bleft-1;}else if(overright(this.node)){lensleft=smallimage.w+smallimage.bleft-this.node.w-1;}
if(overtop(this.node)){lenstop=smallimage.btop-1;}else if(overbottom(this.node)){lenstop=smallimage.h+smallimage.btop-this.node.h-1;}
this.node.left=lensleft;this.node.top=lenstop;this.node.setStyle({'left':lensleft+'px','top':lenstop+'px'});if(settings.zoomType=='reverse'){if(Prototype.Browser.IE&&Prototype.BrowserFeatures['Version']>7){this.node.childElements().each(function(child){child.remove()});this.node.appendChild(this.image);}
this.image.setStyle({'position':'absolute','display':'block','left':-(this.node.left+1-smallimage.bleft)+'px','top':-(this.node.top+1-smallimage.btop)+'px'});}
largeimage.setposition();};this.hide=function(){img[0].setOpacity(1);this.node.hide();};this.show=function(){if(settings.zoomType!='innerzoom'&&(settings.lens||settings.zoomType=='drag')){this.node.show();}
if(settings.zoomType=='reverse'){img[0].setOpacity(settings.imageOpacity);}};this.getoffset=function(){var o={};o.left=$obj.node.left;o.top=$obj.node.top;return o;};return this;};function Stage(){var $obj=this;this.effect=null;this.node=new Element("div",({'id':'zoomWindow'+obj.el.rel,'class':'zoomWindow'}));this.node.update('<div id="zoomWrapper'+obj.el.rel+'" class="zoomWrapper"><div id="zoomWrapperImage'+obj.el.rel+'" class="zoomWrapperImage"></div></div>')
this.ieframe=new Element('iframe',({'id':'zoomIframe'+ +obj.el.rel,'class':'zoomIframe'+ +obj.el.rel,'src':'javascript:\'\';','marginwidth':0,'marginheight':0,'align':'bottom','scrolling':'no','frameborder':0}))
this.setposition=function(){this.node.leftpos=0;this.node.toppos=0;if(settings.zoomType!='innerzoom'){switch(settings.position){case"left":this.node.leftpos=(smallimage.pos.l-smallimage.bleft-Math.abs(settings.xOffset)-settings.zoomWidth>0)?(0-settings.zoomWidth-Math.abs(settings.xOffset)):(smallimage.ow+Math.abs(settings.xOffset));this.node.toppos=Math.abs(settings.yOffset);break;case"top":this.node.leftpos=Math.abs(settings.xOffset);this.node.toppos=(smallimage.pos.t-smallimage.btop-Math.abs(settings.yOffset)-settings.zoomHeight>0)?(0-settings.zoomHeight-Math.abs(settings.yOffset)):(smallimage.oh+Math.abs(settings.yOffset));break;case"bottom":this.node.leftpos=Math.abs(settings.xOffset);this.node.toppos=(smallimage.pos.t-smallimage.btop+smallimage.oh+Math.abs(settings.yOffset)+settings.zoomHeight<screen.height)?(smallimage.oh+Math.abs(settings.yOffset)):(0-settings.zoomHeight-Math.abs(settings.yOffset));break;default:this.node.leftpos=(smallimage.rightlimit+Math.abs(settings.xOffset)+settings.zoomWidth<screen.width)?(smallimage.ow+Math.abs(settings.xOffset)):(0-settings.zoomWidth-Math.abs(settings.xOffset));this.node.toppos=Math.abs(settings.yOffset);break;}}
this.node.setStyle({'left':this.node.leftpos+'px','top':this.node.toppos+'px'});return this;};this.append=function(){$('zoomPad'+obj.el.rel).appendChild(this.node);this.node.setStyle({'position':'absolute','display':'none','zIndex':5001});if(settings.zoomType=='innerzoom'){this.node.setStyle({'cursor':'default'});var thickness=(smallimage.bleft==0)?1:smallimage.bleft;$('zoomWrapper'+obj.el.rel).setStyle({'borderWidth':thickness+'px'});}
$('zoomWrapper'+obj.el.rel).setStyle({'width':Math.round(settings.zoomWidth)+'px'});$('zoomWrapperImage'+obj.el.rel).setStyle({'width':'100%','height':Math.round(settings.zoomHeight)+'px'});$obj.setposition();};this.hide=function(){this.visible=false;switch(settings.hideEffect){case'fadeout':if(this.effect){this.effect.cancel();this.effect=null;}
this.effect=Effect.Fade(this.node,{duration:settings.fadeoutSpeed,to:0,afterFinish:function(){$obj.effect=null;$obj.node.setOpacity(1);}});break;default:this.node.hide();break;}
this.ieframe.hide();};this.show=function(){if(this.visible){return;}
this.activated=this.visible=true;switch(settings.showEffect){case'fadein':var from=0;if(this.effect){this.effect.cancel();this.effect=null;from=this.node.getOpacity();}else{this.node.setOpacity(0);}
this.node.show();if($('zoomWrappergal1')){if($$('#zoomWrappergal1 img')[0].getWidth()<$('zoomWrappergal1').getWidth()){$('zoomWrappergal1').style.width=$$('#zoomWrappergal1 img')[0].getWidth()+'px';}else{$('zoomWrappergal1').setStyle({'width':Math.round(settings.zoomWidth)+'px'});}}
this.effect=Effect.Fade(this.node,{duration:settings.fadeinSpeed,from:from,to:1,afterFinish:function(){$obj.effect=null;}});break;default:this.node.show();break;}
if(obj.isIE6()&&settings.zoomType!='innerzoom'){this.ieframe.width=this.node.width;this.ieframe.height=this.node.height;this.ieframe.left=this.node.leftpos;this.ieframe.top=this.node.toppos;this.ieframe.setStyle({'display':'block','position':"absolute",'left':this.ieframe.left+'px','top':this.ieframe.top+'px','zIndex':99,'width':this.ieframe.width+'px','height':this.ieframe.height+'px'});$('zoomPad'+obj.el.rel).appendChild(this.ieframe);this.ieframe.show();};};};function Largeimage(){var $obj=this;this.node=new Image();this.loadimage=function(url){loader.show();this.url=url;this.node.style.position='absolute';this.node.style.border='0px';this.node.style.display='none';this.node.style.left='-5000px';this.node.style.top='0px';document.body.appendChild(this.node);this.node.src=url;};this.fetchdata=function(){var image=$(this.node);var scale={};this.node.style.display='block';$obj.w=image.width;$obj.h=image.height;$obj.pos=image.cumulativeOffset();$obj.pos.l=image.cumulativeOffset()[0];$obj.pos.t=image.cumulativeOffset()[1];$obj.pos.r=$obj.w+$obj.pos.l;$obj.pos.b=$obj.h+$obj.pos.t;scale.x=($obj.w/smallimage.w);scale.y=($obj.h/smallimage.h);el.scale=scale;document.body.removeChild(this.node);$('zoomWrapperImage'+obj.el.rel).childElements().each(function(child){child.remove()});$('zoomWrapperImage'+obj.el.rel).appendChild(this.node);lens.setdimensions();};this.node.onerror=function(){alert('Problems while loading the big image.');throw'Problems while loading the big image.';};this.node.onload=function(){$obj.fetchdata();loader.hide();el.largeimageloading=false;el.largeimageloaded=true;if(settings.zoomType=='drag'||settings.alwaysOn||el.zoom_active){lens.show();stage.show();lens.setcenter();}};this.setposition=function(){var left=-el.scale.x*(lens.getoffset().left-smallimage.bleft+1);var top=-el.scale.y*(lens.getoffset().top-smallimage.btop+1);left=Math.round(left);top=Math.round(top);if(settings.smoothing==false){$($obj.node).setStyle({'left':left+'px','top':top+'px'});}else{var leftLarge,topLarge,widthDiff,heightDiff;leftLarge=parseInt($($obj.node).getStyle('left'));topLarge=parseInt($($obj.node).getStyle('top'));widthDiff=(left-leftLarge);heightDiff=(top-topLarge);if(!heightDiff&&!widthDiff){$obj.continueMoves=null;return}
$obj.continueMoves=true;widthDiff*=settings.smoothingSpeed/100;if(widthDiff<1&&widthDiff>0){widthDiff=1;}else{if(widthDiff>-1&&widthDiff<0){widthDiff=-1;}}
leftLarge+=widthDiff;heightDiff*=settings.smoothingSpeed/100;if(heightDiff<1&&heightDiff>0){heightDiff=1;}else{if(heightDiff>-1&&heightDiff<0){heightDiff=-1;}}
topLarge+=heightDiff;$($obj.node).setStyle({'left':leftLarge+'px','top':topLarge+'px'});}
if($obj.continueMoves){$obj.continueMoves=setTimeout(obj._continueMove.bind(obj),100);}};return this;};if(img[0].complete){smallimage.fetchdata();if(!$("zoomPad"+obj.el.rel))obj.create();}},create:function(){if(!$("zoomPad"+this.el.rel)){this.el.zoomPad=new Element('div',({'id':'zoomPad'+this.el.rel,'class':'zoomPad'}));this.img[0].wrap(this.el.zoomPad);}
if(this.settings.zoomType=='innerzoom'){this.settings.zoomWidth=this.smallimage.w;this.settings.zoomHeight=this.smallimage.h;}
if(!$("zoomPup"+this.el.rel)){this.lens.append();}
if(!$("zoomWindow"+this.el.rel)){this.stage.append();}
if(!$("zoomPreload"+this.el.rel)){this.loader.append();}
if(this.settings.preloadImages||this.settings.zoomType=='drag'||this.settings.alwaysOn){this.load();}
this.init();},init:function(){var smallimage=this.smallimage;var el=this.el;var settings=this.settings;if(this.settings.zoomType=='drag'){$("zoomPad"+this.el.rel).observe('mousedown',function(){this.el.mouseDown=true;}.bind(this));$("zoomPad"+this.el.rel).observe('mouseup',function(){this.el.mouseDown=false;}.bind(this));document.body.ondragstart=function(){return false;};$("zoomPad"+this.el.rel).setStyle({'cursor':'default'});$("zoomPup"+this.el.rel).setStyle({'cursor':'move'});}
if(this.settings.zoomType=='innerzoom'){$("zoomWrapper"+this.el.rel).setStyle({'cursor':'crosshair'});}
$("zoomPad"+this.el.rel).up('div').observe('mouseover',function(event){clearTimeout(this.timer);this._drag(event);}.bind(this));$("zoomPad"+this.el.rel).observe('mouseout',function(event){this.timer=setTimeout(function(){this.deactivate()}.bind(this),20)}.bind(this));$("zoomPad"+this.el.rel).observe('mousemove',function(e){if(e.pageX>smallimage.pos.r||e.pageX<smallimage.pos.l||e.pageY<smallimage.pos.t||e.pageY>smallimage.pos.b){this.lens.setcenter();return false;}
el.zoom_active=true;if(el.largeimageloaded&&this.activated){this.activate(e);}
if(el.largeimageloaded&&(settings.zoomType!='drag'||(settings.zoomType=='drag'&&el.mouseDown))){this.lens.setposition(e);}}.bind(this));var thumb_preload=new Array();var i=0;var thumblist=new Array();thumblist=$$('a').findAll(function(link){var regex=new RegExp("^gallery[\\s]*:[\\s]*"+this.trim(el.rel),"i");var rel=link.readAttribute('rel');if(regex.test(rel)){return link;}}.bind(this));thumblist.each(function(thumbnail){if(settings.preloadImages){thumb_preload[i]=new Image();thumb_preload[i].src=thumbnail.readAttribute('href');i++;}
thumbnail.observe(this.settings.thumbnailChange,function(e){if($(thumbnail).up().hasClassName('thumb-active')){e.stop();return false;}
thumblist.each(function(thumb){$(thumb).up().removeClassName('thumb-active');});e.stop();this.swapimage(thumbnail);return false;}.bind(this));if(this.settings.thumbnailChange!='click'){thumbnail.observe('click',function(e){e.stop();return false;});}}.bind(this))},load:function(){if(this.el.largeimageloaded==false&&this.el.largeimageloading==false){var url=$(this.el).readAttribute('href');this.el.largeimageloading=true;this.largeimage.loadimage(url);}},activate:function(e){clearTimeout(this.el.timer);this.lens.show();this.stage.show();},deactivate:function(e){switch(this.settings.zoomType){case'drag':break;default:this.img[0].writeAttribute('title',this.el.imagetitle);$(this.el).writeAttribute('title',this.el.title);if(this.settings.alwaysOn){this.lens.setcenter();}else{this.stage.hide();this.lens.hide();}
break;}
this.el.zoom_active=false;},swapimage:function(link){this.el.largeimageloading=false;this.el.largeimageloaded=false;var smallimage=link.readAttribute('rev');var largeimage=link.readAttribute('href');if(smallimage&&largeimage){$(link).up().addClassName('thumb-active');$(this.el).writeAttribute('href',largeimage);this.img[0].writeAttribute('src',smallimage);this.lens.hide();this.stage.hide();this.load();}else{alert('ERROR :: Missing parameter for largeimage or smallimage.');throw'ERROR :: Missing parameter for largeimage or smallimage.';}
return false;},isIE6:function(){return(Prototype.Browser.IE&&Prototype.BrowserFeatures['Version']<7);},trim:function(str){var string=new String(str);return string.strip();},_continueMove:function(){this.largeimage.setposition()},_drag:function(event){this.img[0].writeAttribute('title','');this.el.writeAttribute('title','');this.el.zoom_active=true;this.smallimage.fetchdata();if(this.el.largeimageloaded){this.activate(event);}else{this.load();}},changeZoomType:function(type){var zoomtypes=['standard','drag','innerzoom'];if(!zoomtypes.any(function(n){return n==type;})){type='standard';}
this.settings.zoomType=type;$('zoomWindow'+this.el.rel).remove()
this.stage.append()
this.init()},_randomString:function(length){var chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');if(!length){length=Math.floor(Math.random()*chars.length);}
var str='';for(var i=0;i<length;i++){str+=chars[Math.floor(Math.random()*chars.length)];}
return str;},_expand:function(e){e.preventDefault();if(!this.settings.disableExpand){this.expand();}
return false;},expand:function(){window.lightbox.start(this.el);}};LightboxOptions=Object.extend({fileLoadingImage:'',overlayOpacity:0.8,animate:true,resizeSpeed:7,borderSize:0,labelImage:"Image",labelOf:"of"},window.LightboxOptions||{});var MagicLightbox=Class.create();MagicLightbox.prototype={imageArray:[],activeImage:undefined,initialize:function(){this.keyboardAction=this.keyboardAction.bindAsEventListener(this);if(LightboxOptions.resizeSpeed>10)LightboxOptions.resizeSpeed=10;if(LightboxOptions.resizeSpeed<1)LightboxOptions.resizeSpeed=1;this.resizeDuration=LightboxOptions.animate?((11-LightboxOptions.resizeSpeed)*0.15):0;this.overlayDuration=LightboxOptions.animate?0.2:0;var size=(LightboxOptions.animate?250:1)+'px';var objBody=$$('body')[0];objBody.appendChild(Builder.node('div',{id:'overlay'}));var zT=$('zoomer')?$('zoomer').title:'';objBody.appendChild(Builder.node('div',{id:'lightbox'},[Builder.node('div',{id:'outerImageContainer'},Builder.node('div',{id:'imageContainer'},[Builder.node('img',{id:'lightboxImage'}),Builder.node('div',{id:'hoverNav'},[Builder.node('a',{id:'closeLink',href:'#'}),Builder.node('a',{id:'prevLink',href:'#','onclick':"_gaq.push(['_trackEvent', 'Card', 'actions', 'big-photo-switch', '"+zT+"'])"}),Builder.node('a',{id:'nextLink',href:'#','onclick':"_gaq.push(['_trackEvent', 'Card', 'actions', 'big-photo-switch', '"+zT+"'])"})]),Builder.node('div',{id:'loading'},Builder.node('a',{id:'loadingLink',href:'#'},Builder.node('img',{src:LightboxOptions.fileLoadingImage})))])),Builder.node('div',{id:'imageDataContainer'},Builder.node('div',{id:'imageData'},[Builder.node('div',{id:'imageDetails'},[Builder.node('span',{id:'caption'}),Builder.node('span',{id:'numberDisplay'})]),Builder.node('div',{id:'bottomNav'})]))]));$('overlay').hide().observe('click',(function(){this.end();}).bind(this));$('lightbox').hide().observe('click',(function(event){if(event.element().id=='lightbox')this.end();}).bind(this));$('outerImageContainer').setStyle({width:size,height:size});$('prevLink').observe('click',(function(event){event.stop();this.changeImage(this.activeImage-1);}).bindAsEventListener(this));$('nextLink').observe('click',(function(event){event.stop();this.changeImage(this.activeImage+1);}).bindAsEventListener(this));$('closeLink').observe('click',(function(event){event.stop();this.end();}).bind(this));$('loadingLink').observe('click',(function(event){event.stop();this.end();}).bind(this));var th=this;(function(){var ids='overlay lightbox outerImageContainer imageContainer lightboxImage hoverNav prevLink nextLink loading loadingLink '+'imageDataContainer imageData imageDetails caption numberDisplay bottomNav closeLink';$w(ids).each(function(id){th[id]=$(id);});}).defer();},start:function(imageLink,i){$$('select','object','embed').each(function(node){node.style.visibility='hidden'});var arrayPageSize=this.getPageSize();$('overlay').setStyle({width:arrayPageSize[0]+'px',height:arrayPageSize[1]+'px'});new Effect.Appear(this.overlay,{duration:this.overlayDuration,from:0.0,to:LightboxOptions.overlayOpacity});this.imageArray=[];if(!i){var imageNum=0;}else{var imageNum=i;}
if((imageLink.getAttribute("rel")=='lightbox')){this.imageArray.push([imageLink.href,imageLink.title]);}else{this.imageArray=$$(imageLink.tagName+'[href][rel="gallery:'+imageLink.rel+'"]').collect(function(anchor){return[anchor.href,anchor.title];}).uniq();if(this.imageArray.length>=1){while(this.imageArray[imageNum][0]!=imageLink.href){imageNum++;}}else{this.imageArray=$$(imageLink.tagName+'[href][rel="'+imageLink.rel+'"]').collect(function(anchor){return[anchor.href,anchor.title];}).uniq();}}
var arrayPageScroll=document.viewport.getScrollOffsets();var lightboxTop=arrayPageScroll[1]+(document.viewport.getHeight()/10);var lightboxLeft=arrayPageScroll[0];this.lightbox.setStyle({top:lightboxTop+'px',left:lightboxLeft+'px'}).show();this.changeImage(imageNum);},changeImage:function(imageNum){if(imageNum>(this.imageArray.length-1)){imageNum=0;}else if(imageNum<0){imageNum=this.imageArray.length-1;}
this.activeImage=imageNum;if(LightboxOptions.animate)this.loading.show();this.lightboxImage.hide();this.hoverNav.hide();this.prevLink.hide();this.nextLink.hide();this.imageDataContainer.setStyle({opacity:.0001});this.numberDisplay.hide();var imgPreloader=new Image();imgPreloader.onload=(function(){this.lightboxImage.src=this.imageArray[this.activeImage][0];this.lightboxImage.width=imgPreloader.width;this.lightboxImage.height=imgPreloader.height;this.resizeImageContainer(imgPreloader.width,imgPreloader.height);}).bind(this);imgPreloader.src=this.imageArray[this.activeImage][0];},resizeImageContainer:function(imgWidth,imgHeight){var widthCurrent=this.outerImageContainer.getWidth();var heightCurrent=this.outerImageContainer.getHeight();var widthNew=(imgWidth+LightboxOptions.borderSize*2);var heightNew=(imgHeight+LightboxOptions.borderSize*2);var xScale=(widthNew/widthCurrent)*100;var yScale=(heightNew/heightCurrent)*100;var wDiff=widthCurrent-widthNew;var hDiff=heightCurrent-heightNew;if(hDiff!=0)new Effect.Scale(this.outerImageContainer,yScale,{scaleX:false,duration:this.resizeDuration,queue:'front'});if(wDiff!=0)new Effect.Scale(this.outerImageContainer,xScale,{scaleY:false,duration:this.resizeDuration});var timeout=0;if((hDiff==0)&&(wDiff==0)){timeout=100;if(Prototype.Browser.IE)timeout=250;}
(function(){this.imageDataContainer.setStyle({width:widthNew+'px'});this.showImage();}).bind(this).delay(timeout/1000);},showImage:function(){this.loading.hide();new Effect.Appear(this.lightboxImage,{duration:this.resizeDuration,queue:'end',afterFinish:(function(){this.updateDetails();}).bind(this)});this.preloadNeighborImages();},updateDetails:function(){this.caption.update(this.imageArray[this.activeImage][1]).show();if(this.imageArray.length>1){this.numberDisplay.update(LightboxOptions.labelImage+' '+(this.activeImage+1)+' '+LightboxOptions.labelOf+'  '+this.imageArray.length).show();}
new Effect.Parallel([],{duration:this.resizeDuration,afterFinish:(function(){var arrayPageSize=this.getPageSize();this.overlay.setStyle({width:arrayPageSize[0]+'px',height:arrayPageSize[1]+'px'});this.updateNav();}).bind(this)});},updateNav:function(){this.hoverNav.show();if(this.imageArray.length>1){this.prevLink.show();this.nextLink.show();}
this.enableKeyboardNav();},enableKeyboardNav:function(){document.observe('keydown',this.keyboardAction);},disableKeyboardNav:function(){document.stopObserving('keydown',this.keyboardAction);},keyboardAction:function(event){var keycode=event.keyCode;var escapeKey;if(event.DOM_VK_ESCAPE){escapeKey=event.DOM_VK_ESCAPE;}else{escapeKey=27;}
var key=String.fromCharCode(keycode).toLowerCase();if(key.match(/x|o|c/)||(keycode==escapeKey)){this.end();}else if((key=='p')||(keycode==37)){if(this.activeImage!=0){this.disableKeyboardNav();this.changeImage(this.activeImage-1);}}else if((key=='n')||(keycode==39)){if(this.activeImage!=(this.imageArray.length-1)){this.disableKeyboardNav();this.changeImage(this.activeImage+1);}}},preloadNeighborImages:function(){var preloadNextImage,preloadPrevImage;if(this.imageArray.length>this.activeImage+1){preloadNextImage=new Image();preloadNextImage.src=this.imageArray[this.activeImage+1][0];}
if(this.activeImage>0){preloadPrevImage=new Image();preloadPrevImage.src=this.imageArray[this.activeImage-1][0];}},end:function(){this.disableKeyboardNav();this.lightbox.hide();new Effect.Fade(this.overlay,{duration:this.overlayDuration});$$('select','object','embed').each(function(node){node.style.visibility='visible'});},getPageSize:function(){var xScroll,yScroll;if(window.innerHeight&&window.scrollMaxY){xScroll=window.innerWidth+window.scrollMaxX;yScroll=window.innerHeight+window.scrollMaxY;}else if(document.body.scrollHeight>document.body.offsetHeight){xScroll=document.body.scrollWidth;yScroll=document.body.scrollHeight;}else{xScroll=document.body.offsetWidth;yScroll=document.body.offsetHeight;}
var windowWidth,windowHeight;if(self.innerHeight){if(document.documentElement.clientWidth){windowWidth=document.documentElement.clientWidth;}else{windowWidth=self.innerWidth;}
windowHeight=self.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){windowWidth=document.documentElement.clientWidth;windowHeight=document.documentElement.clientHeight;}else if(document.body){windowWidth=document.body.clientWidth;windowHeight=document.body.clientHeight;}
if(yScroll<windowHeight){pageHeight=windowHeight;}else{pageHeight=yScroll;}
if(xScroll<windowWidth){pageWidth=xScroll;}else{pageWidth=windowWidth;}
return[pageWidth,pageHeight];}}
document.observe('dom:loaded',function(){window.lightbox=new MagicLightbox();});Validation.defaultOptions.immediate=true;Validation.defaultOptions.addClassNameToContainer=true;Event.observe(document,'dom:loaded',function(){var inputs=$$('ul.options-list input');for(var i=0,l=inputs.length;i<l;i++){inputs[i].addClassName('change-container-classname');}})
if(!window.Enterprise){window.Enterprise={};}
Enterprise.templatesPattern=/(^|.|\r|\n)(\{\{(.*?)\}\})/;Enterprise.TopCart={initialize:function(container){this.container=$(container);if(this.container){this.element=this.container.up(0);this.elementHeader=this.container.previous(0);this.intervalDuration=4000;this.interval=null;this.onElementMouseOut=this.handleMouseOut.bindAsEventListener(this);this.onElementMouseOver=this.handleMouseOver.bindAsEventListener(this);this.onElementMouseClick=this.handleMouseClick.bindAsEventListener(this);this.element.observe('mouseout',this.onElementMouseOut);this.element.observe('mouseover',this.onElementMouseOver);this.elementHeader.observe('click',this.onElementMouseClick);}},handleMouseOut:function(evt){if($(this.elementHeader).hasClassName('expanded')){this.interval=setTimeout(this.hideCart.bind(this),this.intervalDuration);}},handleMouseOver:function(evt){if(this.interval!==null){clearTimeout(this.interval);this.interval=null;}},handleMouseClick:function(evt){if(!$(this.elementHeader).hasClassName('expanded')&&!$(this.container.id).hasClassName('process')){this.showCart();}
else{this.hideCart();}},showCart:function(timePeriod){this.container.parentNode.style.zIndex=992;new Effect.SlideDown(this.container.id,{duration:0.5,beforeStart:function(effect){$(effect.element.id).addClassName('process');},afterFinish:function(effect){$(effect.element.id).removeClassName('process');}});$(this.elementHeader).addClassName('expanded');if(timePeriod){this.timePeriod=timePeriod*1000;this.interval=setTimeout(this.hideCart.bind(this),this.timePeriod);}},hideCart:function(){if(!$(this.container.id).hasClassName('process')&&$(this.elementHeader).hasClassName('expanded')){new Effect.SlideUp(this.container.id,{duration:0.5,beforeStart:function(effect){$(effect.element.id).addClassName('process');},afterFinish:function(effect){$(effect.element.id).removeClassName('process');effect.element.parentNode.style.zIndex=1;}});}
if(this.interval!==null){clearTimeout(this.interval);this.interval=null;}
$(this.elementHeader).removeClassName('expanded');}};Enterprise.Bundle={oldReloadPrice:false,initialize:function(){this.slider=$('bundleProduct');this.xOffset=$('bundle-product-wrapper').getDimensions().width;},swapReloadPrice:function(){Enterprise.Bundle.oldReloadPrice=Product.Bundle.prototype.reloadPrice;Product.Bundle.prototype.reloadPrice=Enterprise.Bundle.reloadPrice;Product.Bundle.prototype.selection=Enterprise.Bundle.selection;},reloadPrice:function(){var result=Enterprise.Bundle.oldReloadPrice.bind(this)();var priceContainer,duplicateContainer=null
if(priceContainer=$('bundle-product-wrapper').down('.price-box .price-as-configured')){if(duplicateContainer=$('bundle-product-wrapper').down('.duplicate-price-box .price-as-configured')){duplicateContainer.down('.price').update(priceContainer.down('.price').innerHTML);}}
if(!this.summaryTemplate&&$('bundle-summary-template')){this.summaryTemplate=new Template($('bundle-summary-template').innerHTML,Enterprise.templatesPattern);this.optionTemplate=new Template($('bundle-summary-option-template').innerHTML,Enterprise.templatesPattern);this.optionMultiTemplate=new Template($('bundle-summary-option-multi-template').innerHTML,Enterprise.templatesPattern);}
if(this.summaryTemplate&&$('bundle-summary')){var summaryHTML='';for(var option in this.config.options){if(typeof(this.config.selected[option])!=='undefined'){var optionHTML='';for(var i=0,l=this.config.selected[option].length;i<l;i++){var selection=this.selection(option,this.config.selected[option][i]);if(selection&&this.config.options[option].isMulti){optionHTML+=this.optionMultiTemplate.evaluate(selection);}else if(selection){optionHTML+=this.optionTemplate.evaluate(selection);}}
if(optionHTML.length>0){summaryHTML+=this.summaryTemplate.evaluate({label:this.config.options[option].title.escapeHTML(),options:optionHTML});}}}
$('bundle-summary').update(summaryHTML).childElements().last().addClassName('last');}
return result;},selection:function(optionId,selectionId){if(selectionId==''||selectionId=='none'){return false;}
var qty=null;if(this.config.options[optionId].selections[selectionId].customQty==1&&!this.config['options'][optionId].isMulti){if($('bundle-option-'+optionId+'-qty-input')){qty=$('bundle-option-'+optionId+'-qty-input').value;}else{qty=1;}}else{qty=this.config.options[optionId].selections[selectionId].qty;}
return{qty:qty,name:this.config.options[optionId].selections[selectionId].name.escapeHTML()};},start:function(){if(!$('bundle-product-wrapper').hasClassName('moving-now')){new Effect.Move(this.slider,{x:-this.xOffset,y:0,mode:'relative',duration:1.5,beforeStart:function(effect){$('bundle-product-wrapper').setStyle({height:$('productView').getHeight()+'px'});$('options-container').show();Enterprise.BundleSummary.initialize();$('bundle-product-wrapper').addClassName('moving-now');},afterFinish:function(effect){$('bundle-product-wrapper').setStyle({height:'auto'});$('productView').hide();$('bundle-product-wrapper').removeClassName('moving-now');}});}},end:function(){if(!$('bundle-product-wrapper').hasClassName('moving-now')){new Effect.Move(this.slider,{x:this.xOffset,y:0,mode:'relative',duration:1.5,beforeStart:function(effect){$('bundle-product-wrapper').setStyle({height:$('options-container').getHeight()+'px'});$('productView').show();$('bundle-product-wrapper').addClassName('moving-now');},afterFinish:function(effect){$('bundle-product-wrapper').setStyle({height:'auto'});$('options-container').hide();Enterprise.BundleSummary.exitSummary();$('bundle-product-wrapper').removeClassName('moving-now');}});}}};Enterprise.BundleSummary={initialize:function(){this.summary=$('bundleSummary');this.summaryOffsetTop=$('customizeTitle').getDimensions().height;this.summary.setStyle({top:this.summaryOffsetTop+"px"});this.summaryContainer=this.summary.up(0);this.doNotCheck=false;this.summaryStartY=this.summary.positionedOffset().top;this.summaryStartY=this.summaryOffsetTop;this.summaryStartX=this.summary.positionedOffset().left;this.onDocScroll=this.handleDocScroll.bindAsEventListener(this);this.GetScroll=setInterval(this.onDocScroll,50);this.onEffectEnds=this.effectEnds.bind(this);},handleDocScroll:function(){if(this.currentOffsetTop==document.viewport.getScrollOffsets().top&&(this.checkOffset(null)==null)){return;}else{if(this.currentOffsetTop==document.viewport.getScrollOffsets().top){this.doNotCheck=true;}
this.currentOffsetTop=document.viewport.getScrollOffsets().top;}
if(this.currentEffect){this.currentEffect.cancel();var topOffset=0;if(this.summaryContainer.viewportOffset().top<-60){topOffset=-(this.summaryContainer.viewportOffset().top);}else{topOffset=this.summaryStartY;}
topOffset=this.checkOffset(topOffset);if(topOffset===null){this.currentEffect=false;return;}
this.currentEffect.start({x:this.summaryStartX,y:topOffset,mode:'absolute',duration:0.3,afterFinish:this.onEffectEnds});return;}
this.currentEffect=new Effect.Move(this.summary);},effectEnds:function(){if(this.doNotCheck==true){this.doNotCheck=false;}},checkOffset:function(offset){if(this.doNotCheck&&offset===null){return null;}
var dimensions=this.summary.getDimensions();var parentDimensions=this.summary.up().getDimensions();if((offset!==null?offset:this.summary.offsetTop)+dimensions.height>=parentDimensions.height){offset=parentDimensions.height-dimensions.height;}else if(offset===null&&this.currentOffsetTop>(this.summaryContainer.viewportOffset().top)&&(this.currentOffsetTop-this.summaryContainer.viewportOffset().top)>this.summary.offsetTop){offset=this.currentOffsetTop-this.summaryContainer.viewportOffset().top;}
return offset;},exitSummary:function(){clearInterval(this.GetScroll);}};Enterprise.Tabs=Class.create();Object.extend(Enterprise.Tabs.prototype,{initialize:function(container){this.container=$(container);this.container.addClassName('tab-list');this.tabs=this.container.select('dt.tab');this.activeTab=this.tabs.first();this.tabs.first().addClassName('first');this.tabs.last().addClassName('last');this.onTabClick=this.handleTabClick.bindAsEventListener(this);for(var i=0,l=this.tabs.length;i<l;i++){this.tabs[i].observe('click',this.onTabClick);}
this.select();},handleTabClick:function(evt){this.activeTab=Event.findElement(evt,'dt');this.select();},select:function(){for(var i=0,l=this.tabs.length;i<l;i++){if(this.tabs[i]==this.activeTab){this.tabs[i].addClassName('active');this.tabs[i].style.zIndex=this.tabs.length+2;new Effect.Appear(this.tabs[i].next('dd'),{duration:0.5});this.tabs[i].parentNode.style.height=this.tabs[i].next('dd').getHeight()+15+'px';}else{this.tabs[i].removeClassName('active');this.tabs[i].style.zIndex=this.tabs.length+1-i;this.tabs[i].next('dd').hide();}}}});Enterprise.Slider=Class.create();Object.extend(Enterprise.Slider.prototype,{initialize:function(container,config){this.container=$(container);this.config={panelCss:'slider-panel',sliderCss:'slider',itemCss:'slider-item',slideButtonCss:'slide-button',slideButtonInactiveCss:'inactive',forwardButtonCss:'forward',backwardButtonCss:'backward',pageSize:6,scrollSize:2,slideDuration:1.0,slideDirection:'horizontal',fadeEffect:true};Object.extend(this.config,config||{});this.items=this.container.select('.'+this.config.itemCss);this.isPlaying=false;this.isAbsolutized=false;this.offset=0;this.onClick=this.handleClick.bindAsEventListener(this);this.sliderPanel=this.container.down('.'+this.config.panelCss);this.slider=this.sliderPanel.down('.'+this.config.sliderCss);this.container.select('.'+this.config.slideButtonCss).each(this.initializeHandlers.bind(this));this.updateButtons();Event.observe(window,'load',this.initializeDimensions.bind(this));},initializeHandlers:function(element){if(element.hasClassName(this.config.forwardButtonCss)||element.hasClassName(this.config.backwardButtonCss)){element.observe('click',this.onClick);}},handleClick:function(evt){var element=Event.element(evt);if(!element.hasClassName(this.config.slideButtonCss)){element=element.up('.'+this.config.slideButtonCss);}
if(!element.hasClassName(this.config.slideButtonInactiveCss)){element.hasClassName(this.config.forwardButtonCss)||this.backward();element.hasClassName(this.config.backwardButtonCss)||this.forward();}
Event.stop(evt);},updateButtons:function(){var buttons=this.container.select('.'+this.config.slideButtonCss);for(var i=0,l=buttons.length;i<l;i++){if(buttons[i].hasClassName(this.config.backwardButtonCss)){if(this.offset<=0){buttons[i].addClassName(this.config.slideButtonInactiveCss);}
else{buttons[i].removeClassName(this.config.slideButtonInactiveCss);}}else if(buttons[i].hasClassName(this.config.forwardButtonCss)){if(this.offset>=this.items.length-this.config.pageSize){buttons[i].addClassName(this.config.slideButtonInactiveCss);}
else{buttons[i].removeClassName(this.config.slideButtonInactiveCss);}}}},initializeDimensions:function(){if((this.config.slideDirection=='horizontal'&&this.sliderPanel.style.width)||(this.config.slideDirection!='horizontal'&&this.sliderPanel.style.height)){return this;}
var firstItem=this.items.first();var offset=0;if(this.config.slideDirection=='horizontal'){offset=(parseInt(firstItem.getStyle('margin-left'))+parseInt(firstItem.getStyle('margin-right')))*(this.config.pageSize-1);this.sliderPanel.setStyle({width:(firstItem.getDimensions().width*this.config.pageSize+offset)+'px'});}else{offset=(parseInt(firstItem.getStyle('margin-bottom'))+parseInt(firstItem.getStyle('margin-top')))*(this.config.pageSize-1);this.sliderPanel.setStyle({height:(firstItem.getDimensions().height*this.config.pageSize+offset)+'px'});}
var dimensions=this.sliderPanel.getDimensions();var sliderParent=this.sliderPanel.up();sliderParent.setStyle({width:dimensions.width+'px',height:dimensions.height+'px'});return this;},absolutize:function(){if(!this.isAbsolutized){this.isAbsolutized=true;var dimensions=this.sliderPanel.getDimensions();this.sliderPanel.setStyle({height:dimensions.height+'px',width:dimensions.width+'px'});this.slider.absolutize();}},forward:function(){if(this.offset+this.config.pageSize<=this.items.length-1){this.slide(true);}},backward:function(){if(this.offset>0){this.slide(false);}},slide:function(isForward){if(this.isPlaying){return;}
this.absolutize();this.effectConfig={duration:this.config.slideDuration};if(this.config.slideDirection=='horizontal'){this.effectConfig.x=this.getSlidePosition(isForward).left;}else{this.effectConfig.y=this.getSlidePosition(isForward).top;}
this.start();},start:function()
{if(this.config.fadeEffect){this.fadeIn();}else{this.move();}},fadeIn:function()
{new Effect.Fade(this.slider.up('div.slider-panel'),{from:1.0,to:0.5,afterFinish:this.move.bind(this),beforeStart:this.effectStarts.bind(this),duration:0.3});},fadeOut:function()
{new Effect.Fade(this.slider.up('div.slider-panel'),{from:0.5,to:1.0,afterFinish:this.effectEnds.bind(this),duration:0.3});},move:function()
{if(this.config.fadeEffect){this.effectConfig.afterFinish=this.fadeOut.bind(this);}else{this.effectConfig.afterFinish=this.effectEnds.bind(this);this.effectConfig.beforeStart=this.effectStarts.bind(this);}
new Effect.Move(this.slider,this.effectConfig);},effectStarts:function(){this.isPlaying=true;},effectEnds:function(){this.isPlaying=false;this.updateButtons();},getSlidePosition:function(isForward){var targetOffset;if(isForward){targetOffset=Math.min(this.items.length-this.config.pageSize,this.offset+this.config.scrollSize)}
else{targetOffset=Math.max(this.offset-this.config.scrollSize,0);}
this.offset=targetOffset;var item=this.items[targetOffset];var itemOffset={left:0,top:0};itemOffset.left=-(item.cumulativeOffset().left
-this.slider.cumulativeOffset().left+this.slider.offsetLeft);itemOffset.top=-(item.cumulativeOffset().top
-this.slider.cumulativeOffset().top+this.slider.offsetTop);return itemOffset;}});Enterprise.PopUpMenu={currentPopUp:null,documentHandlerInitialized:false,popUpZIndex:994,hideDelay:2000,hideOnClick:true,hideInterval:null,initializeDocumentHandler:function(){if(!this.documentHandlerInitialized){this.documentHandlerInitialized=true;Event.observe(document.body,'click',this.handleDocumentClick.bindAsEventListener(this));}},handleDocumentClick:function(evt){if(this.currentPopUp!==null){var element=Event.element(evt);if(!this.currentPopUp.onlyShowed&&this.hideOnClick){this.hide();}else{this.currentPopUp.onlyShowed=false;}}},handlePopUpOver:function(evt){if(this.currentPopUp!==null){this.currentPopUp.removeClassName('faded');this.resetTimeout(0);}},handlePopUpOut:function(evt){if(this.currentPopUp!==null){this.currentPopUp.addClassName('faded');this.resetTimeout(1);}},show:function(trigger){this.initializeDocumentHandler();var container=$(trigger).up('.switch-wrapper');if(!$('popId-'+container.id)){return;}
if(this.currentPopUp!==null&&$('popId-'+container.id)!==this.currentPopUp){this.hide(true);}else if(this.currentPopUp!==null&&this.currentPopUp===$('popId-'+container.id)){this.hide();return;}
this.currentPopUp=$('popId-'+container.id);this.currentPopUp.container=container;this.currentPopUp.container.oldZIndex=this.currentPopUp.container.style.zIndex;this.currentPopUp.container.style.zIndex=this.popUpZIndex;new Effect.Appear(this.currentPopUp,{duration:0.3});if(!this.currentPopUp.isHandled){this.currentPopUp.observe('mouseover',this.handlePopUpOver.bindAsEventListener(this));this.currentPopUp.observe('mouseout',this.handlePopUpOut.bindAsEventListener(this));this.currentPopUp.isHandled=true;}
this.currentPopUp.onlyShowed=true;this.currentPopUp.container.down('.switcher').addClassName('list-opened');this.resetTimeout(2);},hide:function(){if(this.currentPopUp!==null){if(arguments.length==0){new Effect.Fade(this.currentPopUp,{duration:0.3});}else{this.currentPopUp.hide();}
this.currentPopUp.container.style.zIndex=this.currentPopUp.container.oldZIndex;this.resetTimeout(0);this.currentPopUp.container.down('.switcher').removeClassName('list-opened');this.currentPopUp=null;}},resetTimeout:function(delay){if(this.hideTimeout!==null){clearTimeout(this.hideTimeout);this.hideTimeout=null;}
if(delay){this.hideTimeout=setTimeout(this.hide.bind(this),this.hideDelay*delay);}}};function popUpMenu(element){Enterprise.PopUpMenu.show(element);};allo.glob=Class.create();allo.glob.city_id_cookie_name="city_id";allo.glob.askquestion_text_cookie_name="askquestion-text";allo.glob.form_type_cookie_name='askquestion-form-type';allo.glob.reload_after_login_cookie_name='askquestion-reload-after-login';allo.glob.old_tab_cookie_name='askquestion-old-tab';allo.glob.current_page_cookie_name='askquestion-current-page';function in_array(needle,haystack,strict){var strict=!!strict;for(var key in haystack){if((strict&&haystack[key]===needle)||(!strict&&haystack[key]==needle)){return true;}}
return false;}
function DownOnLoad(num)
{if(num>0)
{var url="#down";location.href=url;}}
function DownAfterLoad()
{if($$('.reviews-block')[0])
{var url="#down";location.href=url;}}
Element.prototype.triggerEvent=function(eventName)
{if(document.createEvent)
{var evt=document.createEvent('HTMLEvents');evt.initEvent(eventName,true,true);return this.dispatchEvent(evt);}
if(this.fireEvent)
return this.fireEvent('on'+eventName);}
function compareDocumentPosition(a,b){return a.compareDocumentPosition?a.compareDocumentPosition(b):(a!=b&&a.contains(b)&&16)+
(a!=b&&b.contains(a)&&8)+(a.sourceIndex>=0&&b.sourceIndex>=0?(a.sourceIndex<b.sourceIndex&&4)+(a.sourceIndex>b.sourceIndex&&2):1);}
allo.dontbuyitfee=false;allo.dontbuyittime=false;allo.checkoutPage=new function(){var _self=this;var _textDeliveryByAddressType={'im':'','tt':''};this.changedCityUrl=null;this.changedShippingUrl=null;this.changedPaymentUrl=null;this.paymentMethod=null;this.period=null;this.condition=null;this.creditBankList=null;this.shippingMethod=null;this.shippingScroll=false;this.paymentScroll=false;this.shippingCost=null;this.shippingAddressId=null;this.shippingFloor=null;this.serviceLift=null;this.inputserviceLiftchecked=0;this.specifyByManager=null;this.methodName=null;this.methodSpecifyByNewPost=null;this.serviceCharge=null;this.serviceChargePM=null;this.products=new Array();this.totalPrice=null;this.loadedMethods=new Object();this.textDelivery=null;this.rule=null;this.disableSubmit=null;this.isOpenBankBoard=true;this.showLastName=function(){var url=CURRENT_BASE_URL+'checkout/onepage/checkShowLastName/',ajaxParams={payment_method:_self.paymentMethod,payment_bill_method:$("payment_bill_methods").value};new Ajax.Request(url,{parameters:ajaxParams,onSuccess:function(transport){allo.checkout.parseAjaxResponse(transport,allo.checkoutPage.showLastName_response);}});}
this.showLastName_response=function(response){var lastName=$("lastname-container");var middleName=$("middlename-container");if(response&&response.vars.showLastName){middleName.show();return lastName.show();}
middleName.hide();return lastName.hide();}
this.fillOutConteinerSippingInfo=function(){if(_self.paymentMethod==null||_self.shippingMethod==null||_self.shippingCost==null||_self.specifyByManager==null||_self.methodName==null){return;}
var element='';var floorRise='';var container=$('container-for-shipping-info');paymentMethodIsCheckmo=(_self.paymentMethod=='checkmo');byNewPostTarifs=false;decoration='rpc';tempper=_self.shippingCost=='0'?Translator.translate('Free'):_self.shippingCost+' <span class="currcy">.</span>';if(!byNewPostTarifs&&_self.specifyByManager){tempper='  ';}
var type='<div class="type">'
+'<div class="type_right_name"><div class="lpc">'+_self.methodName+'</div>'
+'<div class="'+decoration+'">'+tempper+'</div></div>'
+'</div>';if(_self.methodShowRiseOnFloor){element='<div class="inp-con">'
+'<input class="it" id="additional_floor" type="text" name="additional[floor]"/>'
+'<p class="feedback validation-advice">  "  "    "    "</p>'
+'<input class="ic" id="additional_not_use_rise_on_floor" type="checkbox" name="additional[not_use_rise_on_floor]"/>'
+'    '
+'</div>';floorRise='<div class="type"><div class="type_left">  :</div><div class="type_right"><div class="lpc">'+element+'</div><div class="rpc" id="cont-for-fp"></div></div></div>';}}
this.loadPaymentMethod=function(e){if(selectedMethod=='privatbank'||selectedMethod=='ukrsibbank'){if($('bk_sidebarbank')){$('bk_sidebarbank').innerHTML=window.currentBank.description;}}
if(typeof(window.currentBank)!='undefined'){if($('mininitialfee'))
$('mininitialfee').innerHTML=window.currentBank.minInitialFee;if($('min_credit_time'))
$('min_credit_time').innerHTML=window.currentBank.minCreditTime;if($('max_credit_time'))
$('max_credit_time').innerHTML=window.currentBank.maxCreditTime;}
_self.showLastName();}
this.updateShippingAddresses=function(method){var shippingAdressesUrl=CURRENT_BASE_URL+'checkout/onepage/updateShippingAddresses/';var methodCode=null;if(method){methodCode=method.method_code;}
var ajaxParams={shipping_method:methodCode,payment_method:allo.checkoutPage.paymentMethod,restore_checkout_order_id:restore_checkout_order_id};$('shipping_address_container').update('');$('shipping_address_container').addClassName('loading-gif');$('shipping_address_container').removeClassName('hide');new Ajax.Request(shippingAdressesUrl,{parameters:ajaxParams,onSuccess:function(transport){allo.checkout.parseAjaxResponse(transport,allo.checkoutPage.updateShippingAddresses_response);if(window.checkoutTracker){window.checkoutTracker.observeSelectElement($('shipping_address_select'));window.checkoutTracker.handleFirstActivationOnSelect($('shipping_address_select'));window.checkoutTracker.addElementToCollection($('shipping_address_select'));}}});}
this.updateShippingAddresses_response=function(response){$('shipping_address_container').removeClassName('loading-gif');$('shipping_address_container').update(response.address_html);allo.checkoutPage.updateNoTt();if(restore_checkout){allo.checkoutPage.changedCityUrl=origin_changeCityUrl;allo.checkoutPage.changedShippingUrl=origin_changeCityUrl;allo.checkoutPage.changedPaymentUrl=origin_changeCityUrl;restore_checkout_order_id=null;$('payment_methods_conteiner').setStyle({'pointer-events':null,'opacity':'1'});$('shipping_methods_container').setStyle({'pointer-events':null,'opacity':'1'});$('shipping_address_container').setStyle({'pointer-events':null,'opacity':'1'});restore_checkout=false;}};this.updateNoTt=function(){if($('error-no-tt')){$$('.product-item').each(function(b){b.addClassName('cantbuythis');});};};this.updateShippingAddressesStore={};this.changedCity=function(city_id){$('shipping_methods_container').update('');$('shipping_methods_container').addClassName('loading-gif');$('shipping_methods_container').removeClassName('hide');$('payment_methods_conteiner').update('');$('payment_methods_conteiner').addClassName('loading-gif');$('payment_methods_conteiner').removeClassName('hide');var params={city_id:city_id,bank:allo.checkoutPage.paymentMethod,period:allo.checkoutPage.period}
new Ajax.Request(allo.checkoutPage.changedCityUrl,{parameters:params,onSuccess:function(transport){allo.checkout.parseAjaxResponse(transport,allo.checkoutPage.changedCity_response);}});}
this.changedCity_response=function(response){window.ifValidCity=true;var shippingMethodsContainer=$('shipping_methods_container');shippingMethodsContainer.removeClassName('loading-gif');shippingMethodsContainer.update(response.shipping_html);var paymentMethodsConteiner=$('payment_methods_conteiner');paymentMethodsConteiner.removeClassName('loading-gif');paymentMethodsConteiner.update(response.payments_html);var paymentMethodSelect=$('payment_method_select');if(paymentMethodSelect&&paymentMethodSelect.value!='bill'){var billFieldsCorporate=$('bill-fields-corporate');if(billFieldsCorporate){billFieldsCorporate.hide();}}
var is_credit=response.is_credit;if(is_credit=='1'){if(!jQuery('.payment_credit_conteiner #name-container').length){var paymentCreditConteiner=jQuery('.payment_credit_conteiner').first();paymentCreditConteiner.prepend(jQuery('#middlename-container'));paymentCreditConteiner.prepend(jQuery('#name-container'));paymentCreditConteiner.prepend(jQuery('#lastname-container'));jQuery('#middlename-container').show();jQuery('#lastname-container').show();}}else{if(jQuery('.payment_credit_conteiner #name-container').length){var checkoutFormList=jQuery('#checkout_form>.form-list');checkoutFormList.prepend(jQuery('#middlename-container'));checkoutFormList.prepend(jQuery('#lastname-container'));checkoutFormList.prepend(jQuery('#name-container'));jQuery('#middlename-container').hide();jQuery('#lastname-container').hide();}}
allo.checkoutPage.showCurrentBankBoard();allo.checkoutPage.loadedMethods=response.shipping_data.evalJSON();var selectedShippingMethod=$('shipping_method_select');if(selectedShippingMethod){selectedShippingMethod=selectedShippingMethod.value;}
allo.checkoutPage.changeShippingMethod_process(selectedShippingMethod);$('checkout_submit').removeAttribute("choose_city");}
this.changeCreditBank=function(event){var element=Event.element(event);$$('#creditBank li').invoke("removeClassName","checked");jQuery(element).closest('li')[0].addClassName('checked');var dataset=element.dataset;var bankId=dataset.id;var newPaymentMethod=null;var data=allo.checkoutPage.creditBankList;var alternateCondition=allo.checkoutPage.condition=='credit'?'installment_plan':'credit';if(data['banks_list'][bankId]['model']=='broker'){$('prescoring').value=1;}
allo.checkoutPage.showCurrentBankBoard();var periods=null;if(data['bank_credit_list'][bankId][allo.checkoutPage.condition]){periods=data['bank_credit_list'][bankId][allo.checkoutPage.condition];if(!data['bank_credit_list'][bankId][alternateCondition]){$(alternateCondition).disabled=true;}}
else{periods=data['bank_credit_list'][bankId][alternateCondition];$(alternateCondition).checked=true;$(alternateCondition).disabled=false;$(allo.checkoutPage.condition).disabled=true;allo.checkoutPage.condition=alternateCondition;}
if(periods){if(periods[allo.checkoutPage.period]){newPaymentMethod=data['credits_list'][periods[allo.checkoutPage.period]];}
else{for(var p in periods){allo.checkoutPage.period=p;newPaymentMethod=data['credits_list'][periods[p]];break;}}}
jQuery('#periodSlider').slider("value",allo.checkoutPage.period);}
this.showCurrentBankBoard=function(){if(!allo.checkoutPage.isOpenBankBoard){return;}
if(jQuery('#creditBank li.checked')){var currentBankId=jQuery('#creditBank li.checked').attr('value');if(currentBankId){jQuery(".credit-bank-board .bank-board[data-bank-id!='"+currentBankId+"']").hide();if(jQuery(".credit-bank-board .bank-board[data-bank-id='"+currentBankId+"']").length){jQuery(".credit-bank-board").show();jQuery(".credit-bank-board .bank-board[data-bank-id='"+currentBankId+"']").show();}else{jQuery(".credit-bank-board").hide();}}}}
this.closeBankBoard=function(){allo.checkoutPage.isOpenBankBoard=false;jQuery(".credit-bank-board").hide();}
this.changeCreditCondition=function(event){var bankId=$('creditBank').select('.checked')[0].readAttribute('value');var element=Event.element(event);var newPaymentMethod=null;var data=allo.checkoutPage.creditBankList;allo.checkoutPage.condition=allo.checkoutPage.condition=='credit'?'installment_plan':'credit';var periods=data['bank_credit_list'][bankId][allo.checkoutPage.condition];if(periods){if(periods[allo.checkoutPage.period]){newPaymentMethod=data['credits_list'][periods[allo.checkoutPage.period]];}
else{for(var p in periods){allo.checkoutPage.period=p;newPaymentMethod=data['credits_list'][periods[p]];break;}}}
jQuery('#periodSlider').slider("value",allo.checkoutPage.period);}
this.periodSliderChanged=function(event,ui){var value=ui.value;var bankId=$('creditBank').select('.checked')[0].childElements()[0].dataset.id;var data=allo.checkoutPage.creditBankList;var currCredit=$('payment_method_select').value;var values=Object.keys(data['bank_credit_list'][bankId][allo.checkoutPage.condition]);var newValue=value;var maxValue=2;var minValue=36;if(!in_array(value,values)){for(var i=0;i<values.length;i++){newValue=parseInt(newValue);values[i]=parseInt(values[i]);if(values[i]<value){newValue=values[i];}}
newValue=parseInt(newValue);values[0]=parseInt(values[0]);if(newValue<values[0]){newValue=values[0];}}
for(var i=0;i<values.length;i++){minValue=parseInt(minValue);maxValue=parseInt(maxValue);values[i]=parseInt(values[i]);if(values[i]<minValue){minValue=values[i];}
if(values[i]>maxValue){maxValue=values[i];}}
var slider=jQuery('#periodSlider');slider.slider('option','min',+minValue);slider.slider('option','max',+maxValue);allo.checkoutPage.createSlider(event,ui);allo.checkoutPage.period=newValue;if($('creditTime'))
$('creditTime').value=newValue;if(newValue!=value){jQuery('#periodSlider').slider("value",newValue);ui.value=newValue;return;}
var sliderPosition=allo.checkoutPage.createSliderValue(event,ui);var newCredit=data['credits_list'][data['bank_credit_list'][bankId][allo.checkoutPage.condition][value]];if(currCredit!=newCredit){jQuery('#payment_method_select option:contains()').detach();var o=new Option("",newCredit);jQuery(o).html("");jQuery("#payment_method_select").append(o);$('payment_method_select').value=newCredit;allo.checkoutPage.changePaymentMethod();}
else{window.currentBank.creditTime=allo.checkoutPage.period;window.currentBank.calculateAndShow();}}
this.createSlider=function(event,ui){var slider=jQuery('#periodSlider');var stepWidth=+368/34;var sliderMin=+slider.slider('option').min;var sliderMargin=(sliderMin-2);var sliderMax=+slider.slider('option').max;var positionLeft=stepWidth*sliderMargin;slider[0].style.left=positionLeft+'px';var sliderWidth=(sliderMax-sliderMin)*stepWidth;slider.slider().width(sliderWidth);if(sliderMin==2){jQuery('#periodSlidermin')[0].style.backgroundColor='#568da7';}
else{jQuery('#periodSlidermin')[0].style.backgroundColor='#d2d2d2';}
var tooltip=jQuery('.credit_term_slider .for_label')[0];tooltip.style.left=positionLeft+'px';tooltip.style.width=sliderWidth+'px';var sliderPosition=allo.checkoutPage.createSliderValue(event,ui);};this.createSliderValue=function(event,ui){var slider=jQuery('#periodSlider');var sliderWidth=slider[0].style.width;sliderWidth=+(sliderWidth.substring(0,sliderWidth.length-2));if(typeof(ui.value)=='undefined')
var val=slider.slider("value");else{var val=+ui.value;}
var min=+(slider.slider('option').min);var max=+(slider.slider('option').max);var position=((val-min)/(max-min))*100;var position=position+'%';var labelForSlider=jQuery("#periodSlider_value");labelForSlider[0].style.left=position;labelForSlider.html(val);labelForSlider.data('value',val);};this.changeShippingMethod=function(event){var element=Event.element(event);var value=element.value;var selected=jQuery("#shipping_method_select option:selected");jQuery("#shipping_method_select").find('option').removeAttr("selected");selected.attr("selected","selected");jQuery("#shipping_method_select").val(selected.val());allo.checkoutPage.changeShippingMethod_process(value);}
this.changeShippingMethod_process=function(value){var cookie=new CookieProvider();cookie.createCookie('shipping_method_code',value);var method=allo.checkoutPage.getLoadedMethod(value);allo.checkoutPage.updateShippingAddresses(method);allo.createShippingInfoCheckout=new allo.CreateShippingInfoCheckout(method);_self.updateCart();}
this.updateCart=function(){url=allo.checkoutPage.checkoutSidebar.qtyUrl;url+='bank'+'/'+allo.checkoutPage.paymentMethod+'/'+'period'+'/'+allo.checkoutPage.period+'/';params=Form.serialize($('checkout_sidebar'),true);allo.checkoutPage.checkoutSidebar.loadCart(url,params);}
this.getLoadedMethod=function(value){return allo.checkoutPage.loadedMethods[value];}
this.changeShippingAddress=function(event){var element=Event.element(event);var addressId=element.value;_self.shippingCost=0;_self.changeShippingAddress_process(addressId);}
this.changeShippingAddress_process=function(addressId){_self.rule=_self.updateShippingAddressesStore[addressId];_self.updateDeliveryText();if(_self.rule.cost!=undefined){_self.shippingCost=_self.rule.cost;_self.shippingAddressId=addressId;allo.checkoutPage.fillOutConteinerSippingInfo();url=allo.checkoutPage.checkoutSidebar.qtyUrl;url+='bank'+'/'+allo.checkoutPage.paymentMethod+'/'+'period'+'/'+allo.checkoutPage.period+'/';params=Form.serialize($('checkout_sidebar'),true);params['do_not_save_quote']=true;allo.checkoutPage.checkoutSidebar.loadCart(url,params);}
else{_self.shippingAddressId=null;}
if(_self.rule.time==''||_self.rule.time==undefined){$('shipping_address_info').hide();return false;}
$('shipping_address_info_conteiner').update('      '+'wqwq');$('shipping_address_info').show();}
this.createScroll=function(contentClass,scrollClass,scrollBarClass,newBlockClass,scrollSetuppped){if(scrollSetuppped==false){allo.scroll.initScroll(contentClass,scrollClass,scrollBarClass,newBlockClass);allo.scroll.scrollSetup(scrollClass,scrollBarClass,newBlockClass,contentClass);if(contentClass=='shipping_address_select_div'){allo.delivery.scrollSetuped=true;}else if(contentClass=='shipping_method_select_div'){allo.checkoutPage.shippingScroll=true;}else if(contentClass=='payment_method_select_div'){allo.checkoutPage.paymentScroll=true;}}
allo.scroll.setupScrollWheel(contentClass,250,170);allo.scroll.activeWheelBlock={blockClass:contentClass,stepScrollWheel:null};allo.scroll.activeWheelBlock.stepScrollWheel=allo.scroll.getWheelStep(20);};this.updateDeliveryText=function(){var text_delivery=allo.checkoutPage.textDelivery;var deliveryPeriodCode=document.getElementById('delivery-period-code');var deliveryPeriod=document.getElementById('delivery-period');if(typeof(text_delivery)!='undefined'&&deliveryPeriod&&deliveryPeriodCode){if(text_delivery!=true){allo.checkoutPage.getTextDeliveryByAddressType(text_delivery);}
document.getElementById('delivery-period-label').style.display='none';var deliveryPeriodBlock=document.getElementsByClassName('delivery-period-block')[0];deliveryPeriodBlock.classList.remove('ttBlock');deliveryPeriodBlock.style.display='none';var markersLength=document.getElementsByClassName('open-map-to-marker').length;if((typeof(_textDeliveryByAddressType['preorder_code'])!='undefined')&&(_textDeliveryByAddressType['preorder_code']=='preorder')){if(_textDeliveryByAddressType['preorder_text']!==''){document.getElementById('delivery-period-label').style.display='inline-block';deliveryPeriodBlock.style.display='block';}
deliveryPeriod.innerHTML=_textDeliveryByAddressType['preorder_text'];deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['preorder_code'];}else{if(_self.rule&&_self.rule.type=='im'&&_textDeliveryByAddressType['im']!==null){if(markersLength==1){document.getElementsByClassName('open-map-to-marker')[0].style.display='block';}
if(_textDeliveryByAddressType['im']!==''){document.getElementById('delivery-period-label').style.display='inline-block';deliveryPeriodBlock.style.display='block';}
deliveryPeriod.innerHTML=_textDeliveryByAddressType['im'];deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['im_code'];}else if(_self.rule&&_self.rule.type=='tt'&&(_textDeliveryByAddressType['tt']!==null)){if(_textDeliveryByAddressType['tt']!==''){deliveryPeriodBlock.style.display='block';document.getElementById('delivery-period-label').style.display='none';deliveryPeriodBlock.classList.add('ttBlock');if(markersLength==1){document.getElementsByClassName('open-map-to-marker')[0].style.display='block';}}
deliveryPeriod.innerHTML='<div class="deliveryTtIcon"></div>'+_textDeliveryByAddressType['tt'];deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['tt_code'];}
else{if(typeof(_textDeliveryByAddressType['default'])!='undefined'&&_textDeliveryByAddressType['default']!==null){if(_textDeliveryByAddressType['default']!==''){deliveryPeriodBlock.style.display='block';document.getElementById('delivery-period-label').style.display='inline-block';}
deliveryPeriod.innerHTML=_textDeliveryByAddressType['default'];}
deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['default_code'];}}}else{if(deliveryPeriodCode){if((typeof(_textDeliveryByAddressType['preorder_code'])!='undefined')&&(_textDeliveryByAddressType['preorder_code']=='preorder')){deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['preorder_code'];}else{if(_self.rule&&_self.rule.type=='im'){deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['im_code'];}else if(_self.rule&&_self.rule.type=='tt'){deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['tt_code'];}else{deliveryPeriodCode.dataset.ruleId=_textDeliveryByAddressType['default_code'];}}}}};this.storeMap=null;this.createStoreMap=function(data){if(_map&&_map!=null){_map.open();}
data=JSON.parse(allo.checkoutPage.storeMap);if(typeof(window.map)=='undefined'){allo.storesMap.initMap(data);}
if(allo.storesMap.selectedStoreId!=null){allo.storesMap.goToMarker(allo.storesMap.selectedStoreId);}
_map.closeObserver=function(event){if(allo.storesMap.selectedCheckoutStore){var shopsList=$('shipping_address_select-list')
if(shopsList&&typeof(shopsList)!='undefined'){var lis=$('shipping_address_select-list').select('li');lis.each(function(li){var liId=li.dataset.id;if(Number(liId)==Number(allo.storesMap.selectedCheckoutStore)){$(li).click();}})}}}};this.changeBlockHeight=function(blockId,identifier){var popupBlock=jQuery('#'+blockId);if(!identifier){identifier=0}
popupBlock.css('height',identifier+'px');};this.changeShippingAddressDefault_process=function(){document.getElementById('delivery-period-label').style.display='none';var deliveryPeriodBlock=document.getElementsByClassName('delivery-period-block')[0];deliveryPeriodBlock.classList.remove('ttBlock');deliveryPeriodBlock.style.display='none';if(_textDeliveryByAddressType['default']!==null&&typeof(_textDeliveryByAddressType['default'])!='undefined'){if(_textDeliveryByAddressType['default']!==''){document.getElementById('delivery-period-label').style.display='inline-block';deliveryPeriodBlock.style.display='block';}
document.getElementById('delivery-period').innerHTML=_textDeliveryByAddressType['default'];}
document.getElementById('delivery-period-code').dataset.ruleId=_textDeliveryByAddressType['default_code'];}
this.changePaymentMethod=function(){allo.checkoutPage.paymentMethod=$('payment_method_select').value;_self.showLastName();if(allo.checkoutPage.paymentMethod!='bill')
$('bill-fields-corporate').hide();else
{if($('payment_bill_methods').value=='corporate')
$('bill-fields-corporate').show();else{$('bill-fields-corporate').hide();}}
$('shipping_methods_container').update('');$('shipping_methods_container').addClassName('loading-gif');$('shipping_methods_container').removeClassName('hide');$('shipping_address_container').addClassName('hide');var params={city_id:$('address_city_value').value,bank:allo.checkoutPage.paymentMethod,period:allo.checkoutPage.period}
new Ajax.Request(allo.checkoutPage.changedCityUrl,{parameters:params,onSuccess:function(transport){allo.checkout.parseAjaxResponse(transport,allo.checkoutPage.changedCity_response);if(window.checkoutTracker&&$('payment_bill_methods')){window.checkoutTracker.observeSelectElement($('payment_bill_methods'),' ');window.checkoutTracker.addElementToCollection($('payment_bill_methods'));}}});allo.checkoutPage.fillOutConteinerSippingInfo();if(typeof(window.currentBank)!='undefined'){window.currentBank.updateValues();}}
this.clickPaymentBillMethod=function(event){var element=Event.element(event);if(!$('bill-fields-corporate')){return;}
_self.showLastName();if(element.value=='corporate'){$('bill-fields-corporate').show();}
else{$('bill-fields-corporate').hide();}}
this.clickChangeValue=function(object){object.up().down('div.value').hide();object.up().down('div.input-box').show();object.hide();};this.getTextDeliveryByAddressType=function(textDeliveryByAddressType){_textDeliveryByAddressType=textDeliveryByAddressType;};this.selectCityObserver=function(element){var cityId=element.readAttribute('rel');var cityName='';for(var i=0;i<element.childElements().length;i++){cityName=cityName+element.childElements()[i].textContent;}
$('address_city').value=cityName;allo.checkoutPage.changedCity(cityId);$('address_city_value').value=cityId;$('address_city').setStyle({background:'none'});var cookie=new CookieProvider();cookie.createCookie($('address_city').name,$('address_city').getValue());cookie.createCookie(allo.glob.city_id_cookie_name,$('address_city_value').getValue());if(allo.session.data.universalGa&&$('address_city').value)
Ecommerce.Checkout.send('4',Translator.translate('BlueAcorn_UniversalAnalytics::City filled'));};this.sameWordsObserver=function(_elementLoaded,_onSelectFunction){$('wrong-city-validation').hide();var lists=_elementLoaded.getElementsBySelector('ul li');if($('address_city').value.toLowerCase()==lists[1].innerHTML.toLowerCase()&&lists.length==2){_onSelectFunction(lists[1]);_elementLoaded.hide();}};this.changingCityObserver=function(element){$('address_city').setStyle({background:'none'});if($("address_city").value){$('checkout_submit').setAttribute("choose_city","true");$('checkout_submit').setStyle({opacity:0.5,'pointer-events':'none'});jQuery('#credits-block-container').css({opacity:0.5,pointerEvents:'none'});}
else
{$('checkout_submit').removeAttribute("choose_city");$('checkout_submit').setStyle({opacity:1,'pointer-events':'all'});jQuery('#credits-block-container').css({opacity:1,pointerEvents:'all'});}};this.leaveCityInput=function(element){$('checkout_submit').removeAttribute("choose_city");if(Ajax.activeRequestCount==0){$('checkout_submit').setStyle({opacity:1,'pointer-events':'all'});jQuery('#credits-block-container').css({opacity:1,pointerEvents:'all'});}};this.ifEmptyCity=function(element){window.ifValidCity=false;$("address_city_value").removeAttribute("value");$('address_city').setStyle({background:'#fff7f5'});if(element.value.length==0){element.observe('blur',function(){element.placeholder='  ';})
element.observe('focus',function(){element.placeholder='';})
$('payment_methods_conteiner').update('<label style="color: #929292;"> </label>');$('shipping_methods_container').update('<label style="color: #929292;"> </label>');$('shipping_address_container').update('');}};this.fire=function(eventName){if(document.readyState==="complete"){if(!document.body.hasClassName('checkout-onepage-index'))return;var container=$$('.wrapper');if(container&&container.length)
container.first().fire(eventName);}else{document.observe('dom:loaded',function(){this.fire(eventName);}.bind(this));}}
this.fire('checkout:inited');this.showHideComment=function(element,hideCommentText,showCommentText){if(element.getAttribute('expanded')=='false'){Effect.SlideDown('comments-box',{duration:0.1});var text=hideCommentText;var attributeValue='true';}else{Effect.SlideUp('comments-box',{duration:0.1});var text=showCommentText;var attributeValue='false';}
element.setAttribute('expanded',attributeValue);element.innerHTML=text;return false;};};allo.checkoutPage.checkoutSidebar=new function()
{var _self=this;this.qtyUrl=null;this.addToOrder=null;this.ajaxSended=0;this.totalPrice=null;this.changeFloor=function(operation)
{if(!operation){return;}
checkoutFieldUseServiceLift=$('service_lift');checkoutFieldNeedFloor=$('need-rise-floor');checkoutFieldFloor=$('checkout-field-floor');checkoutFieldNoFloor=$('checkout-field-nofloor');var floorPaidContent=$('floor-paid-content');if(operation=='no-floor'&&checkoutFieldNoFloor.checked){checkoutFieldFloor.value='';floorPaidContent.hide();checkoutFieldNeedFloor.checked=false;checkoutFieldUseServiceLift.checked=false;allo.checkoutPage.serviceLift=0;allo.checkoutPage.inputserviceLiftchecked=0;}
if(operation=='no-floor'&&!checkoutFieldNoFloor.checked&&checkoutFieldFloor.value==''){checkoutFieldFloor.value='1';dataFloor=1;}
if(operation=='floor'){dataFloor=checkoutFieldFloor.value;while(dataFloor.match(/[^0-9]/i)){dataFloor=dataFloor.replace(/[^0-9]/i,'');}
checkoutFieldFloor.value=parseInt(dataFloor);}
if(operation=='floor'&&checkoutFieldFloor.value==0){checkoutFieldFloor.value='';}
if(operation=='floor'&&checkoutFieldFloor.value==''){checkoutFieldNoFloor.checked=true;}
if(operation=='floor'&&checkoutFieldFloor.value!=''){checkoutFieldNoFloor.checked=false;}
if(checkoutFieldNoFloor.checked){allo.checkoutPage.shippingFloor='noFloor';}
else{allo.checkoutPage.shippingFloor=dataFloor;if(allo.checkoutPage.shippingFloor<3)
checkoutFieldUseServiceLift.checked=false;}
if(checkoutFieldUseServiceLift.checked){allo.checkoutPage.serviceLift=1;}
else{allo.checkoutPage.serviceLift=0;}
if(operation=='usefloor'){floorPaidContent.show();checkoutFieldNoFloor.checked=false;}
else{url=allo.checkoutPage.checkoutSidebar.qtyUrl;url+='bank'+'/'+allo.checkoutPage.paymentMethod+'/'+'period'+'/'+allo.checkoutPage.period+'/';params=Form.serialize($('checkout_sidebar'),true);_self.loadCart(url,params);}};var _initializeFloor=function()
{var _keyUpChanges=null;checkoutFieldUseServiceLift=$('service_lift');checkoutFieldNeedFloor=$('need-rise-floor');checkoutFieldFloor=$('checkout-field-floor');checkoutFieldNoFloor=$('checkout-field-nofloor');if(!checkoutFieldFloor||!checkoutFieldNoFloor){return;}
checkoutFieldUseServiceLift.observe('click',function(){if(allo.checkoutPage.inputserviceLiftchecked==0){allo.checkoutPage.inputserviceLiftchecked=1}
else if(allo.checkoutPage.inputserviceLiftchecked==1){checkoutFieldUseServiceLift.checked=false;allo.checkoutPage.inputserviceLiftchecked=0;}
clearTimeout(_keyUpChanges);_self.changeFloor('floor');});checkoutFieldNeedFloor.observe('change',function(){clearTimeout(_keyUpChanges);_self.changeFloor('usefloor');});checkoutFieldFloor.observe('keyup',function(){clearTimeout(_keyUpChanges);_keyUpChanges=window.setTimeout(function(){var floorValueInt=isNaN(parseInt(checkoutFieldFloor.value));if(floorValueInt){checkoutFieldFloor.value='';$('cont-for-fp').update('= 0 .');}
else{_self.changeFloor('floor');}},500);});checkoutFieldNoFloor.observe('change',function(){clearTimeout(_keyUpChanges);_self.changeFloor('no-floor');});};this.updateStuff=function(data)
{if(this.ajaxSended>0){return;}
if(data['top_cart_inner']&&$('innerWrapper')){$('innerWrapper').update(data['top_cart_inner']);}
if(data['items_count']&&$('topCartCount')){$('topCartCount').update(data['items_count']);}
if(data['checkout_sidebar']){$('checkout_sidebar').replace(data['checkout_sidebar']);allo.checkoutPage.updateNoTt();}
if(data['rise_on_floor'].trim()){$('shipping_floor_container').update(data['rise_on_floor']);$('shipping_floor_container').style.display='list-item';}else{$('shipping_floor_container').update(data['rise_on_floor']);$('shipping_floor_container').style.display='none';}
if(data.hasOwnProperty('allow_not_call')&&window.notCallMe){notCallMe.update(data['allow_not_call']);}
if(selectedMethod=='promocredit'){window.promoCredit.checkNullCredit();$('credit-calculator').hide();if(!$('promocredit-text').visible()){$('promocredit-text').show();}}
$$('.bank-about').each(function(b){b.remove();});if(data.vars){_self.totalPrice=data.vars.totalPrice;}};this.loadCart=function(url,params,refreshShipping){allo.checkoutPage.textDelivery=true;refreshShipping=refreshShipping||false;params=params||Array();params['updates[0]']='top_cart_inner';params['updates[1]']='items_count';params['updates[2]']='checkout_sidebar';params['updates[3]']='rise_on_floor';params['city']=$('address_city_value').value;params['shipping']=allo.checkoutPage.shippingMethod;params['shipping_address_id']=allo.checkoutPage.shippingAddressId;params['floor']=allo.checkoutPage.shippingFloor;params['service_lift']=allo.checkoutPage.serviceLift;params['abandoned_timestamp']=allo.abandoned.checkout.getSetTimeOut()===0?allo.abandoned.checkout.getTimestamp():0;var initialFee=$('initialFee');if(initialFee){params['initial_fee']=initialFee.value;}
var reloadLocation=false;if(params['reload_location']){reloadLocation=true;}
allo.checkoutPage.checkoutSidebar.ajaxSended++;new Ajax.Request(url,{parameters:params,onComplete:function(response){if(200!=response.status){if(reloadLocation){location.reload();}}else{var responseData=jQuery.parseJSON(response.responseText);if(responseData['abandoned_timestamp']){allo.abandoned.checkout.setTimestamp(responseData['abandoned_timestamp']).restartAjaxSend();}}},onSuccess:function(transport){var cityId=0;allo.checkoutPage.checkoutSidebar.parseAjaxResponse(transport,function(response){allo.checkoutPage.checkoutSidebar.updateStuff(response);allo.checkoutPage.textDelivery=response.text_delivery;if(allo.checkoutPage.rule){allo.checkoutPage.updateDeliveryText();}});allo.checkoutPage.fillOutConteinerSippingInfo();if(refreshShipping){$('address_city_suggest').select('li').each(function(elem){if(elem.hasClassName('selected')){cityId=elem.getAttribute('rel');}});if(cityId==0||cityId==null){cityId=$('address_city_value').getAttribute('value');}
if(cityId!=0){allo.checkoutPage.changedCity(cityId);}}},onFailure:function(transport){if(reloadLocation){location.reload();}}});};this.clickQty=function(e){var anchor=e.target;var inputId=anchor.onclick();var params;var currentInputValue=$(inputId).value;if($(anchor).hasClassName('control-up')){$(inputId).value=parseInt($(inputId).value,10)+1;}
else if(currentInputValue<=1){return;}
else{$(inputId).value=parseInt($(inputId).value,10)-1;}
url=allo.checkoutPage.checkoutSidebar.qtyUrl;url+='bank'+'/'+allo.checkoutPage.paymentMethod+'/'+'period'+'/'+allo.checkoutPage.period+'/';params=Form.serialize($('checkout_sidebar'),true);allo.checkoutPage.checkoutSidebar.loadCart(url,params,true);anchor.up('span').addClassName('invisible');allo.checkoutPage.checkoutSidebar.disableQtyBtns();$(inputId).hide();anchor.stopObserving();}
this.qtyField=function(e){var anchor=e.target;var params;url=allo.checkoutPage.checkoutSidebar.qtyUrl;url+='bank'+'/'+allo.checkoutPage.paymentMethod+'/'+'period'+'/'+allo.checkoutPage.period+'/';params=Form.serialize($('checkout_sidebar'),true);allo.checkoutPage.checkoutSidebar.loadCart(url,params,true);anchor.nextElementSibling.addClassName('invisible');allo.checkoutPage.checkoutSidebar.disableQtyBtns();$(anchor).hide();$(anchor).setAttribute('readonly',true);anchor.stopObserving();}
this.disableQtyBtns=function(){var qtyLink=$$('.qty-link');var qtyField=$$('.qty');qtyField.each(function(item){item.setStyle({'pointer-events':'none'});});qtyLink.each(function(item){item.setStyle({'pointer-events':'none'});});}
this.initialize=function(){var self=this;var qtyField=$$('.qty');document.stopObserving('click',this.observeSidebarControls);document.stopObserving('keyup',this.observeQtyInput);document.observe('click',this.observeSidebarControls);qtyField.each(function(anchor){anchor.observe('keyup',allo.checkoutPage.checkoutSidebar.observeQtyInput);anchor.observe('change',function(event){event.target.observe('blur',allo.checkoutPage.checkoutSidebar.observeQtyInput);});})
_initializeFloor();},this.observeSidebarControls=function(e){var elem=e.element();if(!elem)return;if(/^additional-products/.test(elem.id)){allo.checkoutPage.checkoutSidebar.buyAdditional(elem);}else if(elem.hasClassName('remove-sidebar-product')){allo.checkoutPage.checkoutSidebar.removeProductFromCart(elem);}else if(elem.hasClassName('qty-link')){allo.checkoutPage.checkoutSidebar.clickQty(e);}},this.observeQtyInput=function(e){if(e.type=='blur'||e.keyCode==13){var element=e.element();if(element){if(element.hasClassName('qty')){allo.checkoutPage.checkoutSidebar.qtyField(e)}}}},this.buyAdditional=function(elem){if(!elem)return;if(elem.tagName!='INPUT')return;if(!/^additional-products/.test(elem.id))return;elem.hide();var loaderSelector='add_to_order_loader-'+elem.value;$(loaderSelector).show();var params=Form.serialize($('crosssell_products_form'),true);params['updates[0]']='top_cart_inner';params['updates[1]']='items_count';params['updates[2]']='checkout_sidebar';params['city']=$('address_city_value').value;params['bank']=allo.checkoutPage.paymentMethod;params['shipping']=allo.checkoutPage.shippingMethod;params['shipping_address_id']=allo.checkoutPage.shippingAddressId;if(allo.session.data.universalGa)
Ecommerce.Cart.send(elem.value,{event:'add',category:'Checkout',action:'accessory',label:'add to cart'});_self.loadCart('/checkout/cart/buyAdditional',params,true);},this.buyAdditionalByProductId=function(productId){if(!productId){return;}
var params={'additional[]':productId,'bank':allo.checkoutPage.paymentMethod};if(allo.session.data.universalGa)
Ecommerce.Cart.send(productId,{event:'add',category:'Checkout',action:'accessory',label:'add to cart'});_self.loadCart('/checkout/cart/buyAdditional',params,true);},this.removeProductFromCart=function(elem){if(!elem)return;var superData=elem.onclick();var url=superData.url;if($('credit-calculator')){url+='bank'+'/'+allo.checkoutPage.paymentMethod+'/';}
params=superData.html_updates;params['city']=$('address_city_value').value;params['bank']=allo.checkoutPage.paymentMethod;params['shipping']=allo.checkoutPage.shippingMethod;params['shipping_address_id']=allo.checkoutPage.shippingAddressId;params['reload_location']=true;elem.addClassName('loading-gif');_self.loadCart(url,params,true);},this.parseAjaxResponse=function(transport,successCallback){this.ajaxSended--;var r=transport.responseText.evalJSON();if(r.status!="error"&&r['sendSC']){allo.sendSC(r);}
if(r.status=="success"){successCallback(r);}else if(r.status=="error"){console.log('Ajax returned status error')}else if(r.status=="redirect"){window.location.href=r.url;}}}
allo.checkout=function(options){var urls=options.urls;var allo_checkout={};if($('register_me_checkbox')){$('register_me_checkbox').observe('click',function(e){if(e.target.checked){$$('.password-set').invoke('show');}else{$$('.password-set').invoke('hide');}});}
$$('.change_value').each(function(anch){anch.observe('click',function(e){var object=e.target;allo.checkoutPage.clickChangeValue(object);})})
if(navigator.appVersion.indexOf("MSIE")!=-1){$('address_telephone_number').observe('blur',function(){var numbersOnly=$('address_telephone_number').value.replace(/\D/g,'');if(numbersOnly.length==10){$('advice-validate-phone-phone__validator').setStyle({display:'none'});}});}
document.observe('checkout:processStarted',function(){$('checkout_loader').show();if($('advanced-navigation-overlay-checkout')){$('advanced-navigation-overlay-checkout').show();}});document.observe('checkout:processFinished',function(){if($('advanced-navigation-overlay-checkout')){$('advanced-navigation-overlay-checkout').hide();}
$('checkout_loader').hide();});allo_checkout.parseAjaxResponse=function(transport,successCallback){var r=transport.responseText.evalJSON();if(r.status!="error"&&r['sendSC']){allo.sendSC(r);}
if(r.status=="success"){successCallback(r);}else if(r.status=="error"){console.log('Ajax returned status error')}}
allo_checkout.ajax_updateShippingMethods=function(city_id){return allo.checkoutPage.changedCity(city_id);}
allo.checkout=allo_checkout;return allo_checkout;};document.observe('dom:loaded',function(){if(allo.cookies.get('unsuccessful_checkout')){_gaq.push(['_trackEvent','Checkout_form','attempts_send','unsuccessful - '+allo.cookies.get('unsuccessful_checkout')]);allo.cookies.set('unsuccessful_checkout',0);}
isCtrl=false;function highlighter(inp){var inp=$(inp);inp.observe('focus',function(){inp.addClassName("input-highlighted");});inp.observe('blur',function(e){inp.removeClassName("input-highlighted");})}
$$('.highlight-inputs input     ').each(function(inp){highlighter(inp);});$$('.highlight-inputs textarea  ').each(function(inp){highlighter(inp);});Event.observe(document,'keydown',function(e){if(e.which==17)isCtrl=true;if(e.which==67&&isCtrl){addLink();}});function addLink(){var body_element=document.getElementsByClassName('main')[0],selection,selection=window.getSelection(),sel=selection.toString();if(sel.length<30){return}else{var pagelink="<br />: <a href='"+document.location.href+"'>"+document.location.href+"</a><br />";var copytext=sel+pagelink;var newdiv=document.createElement('div');body_element.appendChild(newdiv);newdiv.innerHTML=copytext;selection.selectAllChildren(newdiv);window.setTimeout(function(){body_element.removeChild(newdiv);},0);}}});function trackRewindCarousel(carouselObj,nextButton,previousButton,cat,action,label,value){nextButton.observe('click',function(){if(!this.hasClassName('next_button_disabled')){var cInd=Math.ceil(carouselObj.currentIndex()/carouselObj.nbVisible)+2;_gaq.push(['_trackEvent',cat,action,label+'-'+cInd]);}});previousButton.observe('click',function(){if(!this.hasClassName('previous_button_disabled')){var cInd=Math.ceil(carouselObj.currentIndex()/carouselObj.nbVisible);_gaq.push(['_trackEvent',cat,action,label+'-'+cInd]);}});}
function extend(Child,Parent){var F=function(){}
F.prototype=Parent.prototype
Child.prototype=new F()
Child.prototype.constructor=Child
Child.superclass=Parent.prototype}
function validVal(event){if(!event){event=window.event;}
var keyCode=event.keyCode;if((keyCode>45&&keyCode<58)||(keyCode>95&&keyCode<106)||(keyCode>36&&keyCode<41)||keyCode==8||keyCode==9||keyCode==13){return true;}else{return false;}}
function updateCalc(element,onlyInitialFee){window.currentBank.lockCheckout=false;var danger=$('danger-min-fee');var element=$('initialFee');if(danger){danger.hide();}
if(window.currentBank.calculator_editable==='yes'){if(eval(element.value)<window.currentBank.minInitialFee||element.value==''){if(danger){danger.show();}
window.currentBank.lockCheckout=true;}}else{element.value=window.currentBank.minInitialFee;var initialFeeLabel=$('initial-fee-label');if(initialFeeLabel){initialFeeLabel.innerHTML=window.currentBank.minInitialFee;}}
window.currentBank.initialFee=eval(element.value);if(!onlyInitialFee){$('danger-min-time').hide();$('danger-max-time').hide();var element=$('creditTime');if(eval(element.value)<window.currentBank.minCreditTime||element.value==''){$('danger-min-time').show();window.currentBank.lockCheckout=true;}else if(eval(element.value)>window.currentBank.maxCreditTime){window.currentBank.lockCheckout=true;$('danger-max-time').show();}
window.currentBank.creditTime=eval(element.value);}
window.currentBank.calculateAndShow();}
allo.ie8=(navigator.appVersion.indexOf('MSIE 8.')==-1)?false:true;allo.ff=(navigator.userAgent.toLowerCase().indexOf("firefox")!=-1);allo.chrome=window.chrome?true:false;allo.ChangeShippingMethodA=function(){var gurrante=$('gurrante');var sections=$$('.sm_for-product'),pre='sma_';if((allo.ie8||allo.chrome)&&gurrante)
gurrante.addClassName('big-marg');if(allo.ff&&gurrante)
gurrante.addClassName('small-marg');this.open=function(id){sections.each(function(el){el.hide();});$(pre+id).show();};}
allo.CreateShippingInfoCheckout=function(method){allo.checkoutPage.paymentMethod=$('payment_method_select').value;allo.checkoutPage.shippingMethod=method.method_code;allo.checkoutPage.shippingCost=method.shipping_cost;allo.checkoutPage.specifyByManager=method.specify_by_manager;allo.checkoutPage.methodName=method.method_name;allo.checkoutPage.methodShowRiseOnFloor=method.show_rise_on_floor;allo.checkoutPage.methodSpecifyByNewPost=method.specify_by_new_post;allo.checkoutPage.fillOutConteinerSippingInfo();return;this.checkIfValueEmpty=function(){if(!method.show_rise_on_floor)return true;if(Number(input.value.replace(/\D+/g,""))<=0&&!check.checked){validate_ad.show();input.focus();return false;}else{return true;}};};function startAccordionVacancy(acc){acc.each(function(element){var id=Number(element.id.replace(/\D+/g,""));var elementBody=$('vacancy-content'+id);var arrow=element.down();elementBody.hide();element.observe('click',function(e){e.stop();new Effect.toggle(elementBody,'blind',{duration:0.4});if(arrow.className!="vacancy-header-arrow vacancy-header-arrow-wide"){arrow.addClassName('vacancy-header-arrow-wide');var url=CURRENT_BASE_URL+'vacancipage/index/vacancyviewcounter/id/'+id;new Ajax.Request(url);}
else{arrow.removeClassName('vacancy-header-arrow-wide');}});});}
function openAttachResumeForm(acc){acc.each(function(element){var id=Number(element.id.replace(/\D+/g,""));var elementBody=$('send-resume-'+id);elementBody.hide();element.observe('click',function(e){e.stop();new Effect.toggle(elementBody,'blind',{duration:0.4});if(elementBody.down('input').hasClassName('validation-failed')){elementBody.down('input').removeClassName('validation-failed');elementBody.down('input').next().remove();};});});}
function startSelectAttribute(el){var city=document.getElementById('city-select');var city_code=city.options[city.selectedIndex].value;var activity=document.getElementById('activity-select');var activity_code=activity.options[activity.selectedIndex].value;var city_visible=false;var activity_visible=false;$$('.vacancy').each(function(element){element.hide();var vacancyid=Number(element.id.replace(/\D+/g,""));var children=document.getElementById('vacancy-additional-info'+vacancyid).children;for(var i=0;i<children.length;i++){var child=children[i];if(city_code==0){city_visible=true;}else
if(child.className=='city vacancy-content-label'){var cityid=Number(child.id.replace(/\D+/g,""));if(cityid==city_code){city_visible=true;}else{city_visible=false;}}
if(activity_code==0){activity_visible=true;}else
if(child.className=='activity vacancy-content-label'){var activityid=Number(child.id.replace(/\D+/g,""));if(activityid==activity_code){activity_visible=true;}else{activity_visible=false;}}}
if(city_visible&&activity_visible){element.show();}});}
function dump(obj){var out="";if(obj&&typeof(obj)=="object"){for(var i in obj){out+=i+": "+obj[i]+"\n";}}else{out=obj;}}
var OfflineEventAccordion=Class.create();OfflineEventAccordion.prototype={accordionHeadClass:'',accordionBodyClass:'',initialize:function(headClass,bodyClass){this.accordionHeadClass=headClass;this.accordionBodyClass=bodyClass;this.observeElements();},observeElements:function(){$$('.'+this.accordionHeadClass).each(function(element){element.observe('click',function(e){e.stop();elementBody=element.next(this.accordionBodyClass);new Effect.toggle(elementBody,'slide',{duration:0.4});});});}};allo.ui=new function(){this.buffer=new function()
{var _self=this;var _selects=new Array();this.register=function(uiId,object){_selects[uiId]=object;return _self;};this.get=function(uiId){if(!_self.is(uiId)){return null;}
return _selects[uiId];};this.is=function(uiId){if(typeof(_selects[uiId])=='undefined'){return false;}
return true;};};this.select=function(elementSelect)
{var _self=this;var _uiId=null;var _selectedElement=elementSelect;var _ulElement=null;var _eventOnChange=null;if(_selectedElement.getAttribute('uiid')){return allo.ui.buffer.get(_selectedElement.getAttribute('uiid'));}
this.getUiId=function()
{return _uiId;};this.fill=function(){var sP=_selectedElement;var sUl=sP.previous('ul');var content='';_uiId=allo.tools.uniqid();_selectedElement.setAttribute('uiid',_uiId);allo.ui.buffer.register(_uiId,_self);_ulElement=sUl;for(var i=0;i<sP.length;i++){if(i==sP.selectedIndex)
content+='<li class="selected"';else
content+='<li';content+=' value="'+sP[i].value+'"';content+=' origintext="'+sP[i].text+'"';content+=' code="'+sP[i].getAttribute('code')+'"';content+=' price="'+sP[i].getAttribute('price')+'">';content+=sP[i].text;content+='</li>';}
sUl.update(content);for(var j=0;j<sUl.childNodes.length;j++){sUl.childElements()[j].observe('click',function(event){_self.selectUlLi(this,event);});}
$$('.lightbox')[0].observe('click',function(e){var preg=/(selectReplacement)/;if(!preg.test(e.element().up().className)){$$('.selectOpen').each(function(sO){_self.closeUl(sO);});}});};this.selectUlLi=function(li,event){var ul=li.up();if(li.hasClassName('selected')&&!ul.hasClassName('selectOpen')){_self.openUl(ul);return;}
if(ul.down('li.selected')){ul.down('li.selected').removeClassName('selected');}
li.addClassName('selected');_self.closeUl(ul);var select=ul.next('select');for(var i=0;i<select.length;i++){if(select[i].value==li.getAttribute('value')){select[i].selected=true;select.simulate('change');break;}}
if(_eventOnChange){_eventOnChange(event,_selectedElement,li);}};this.openUl=function(ul){_self.createMask();if(!ul.hasClassName('selectOpen')){$$('.selectOpen').each(function(elmUl){_self.closeUl(elmUl);});ul.childElements().each(function(li){li.innerHTML=li.getAttribute('origintext')+' - '+li.getAttribute('price')+'.';});ul.addClassName('selectOpen');}
$('selectReplacementMask').show();$('selectReplacementMask').observe('click',function(){this.hide();_self.closeUl(ul);});return;};this.closeUl=function(ul){if(ul.hasClassName('selectOpen')){ul.removeClassName('selectOpen');ul.childElements().each(function(li){li.innerHTML=li.getAttribute('origintext');});}
if($('selectReplacementMask')){$('selectReplacementMask').hide();}
return;};this.setValue=function(value){var childElements=_ulElement.childElements();$(childElements).each(function(element){if(element.value==value){element.removeClassName('selected');element.simulate('click');}});return _self;};this.onChange=function(func){_eventOnChange=func;return _self;};this.createMask=function(){if($('selectReplacementMask')){return;}
$(document.body).insert({top:'<div id="selectReplacementMask" style="display:none;position:fixed;width:100%;height:100%;z-index:18;"></div>'});};_self.fill();};};allo.getNewsletterDataBox=function(){var validations=['required-entry','validate-email'];var result=true;for(var i=0;i<validations.length;i++){result&=Validation.get(validations[i]).test($('newsletter-box').value);}
if(result){var url=CURRENT_BASE_URL+'/newsletter/subscriber/new/';new Ajax.Request(url,{method:'POST',parameters:$('newsletter-box').serialize(true),onSuccess:function(transport){var data=transport.responseText.evalJSON();if(data['status']==='success'){$('newsletter-validate-detail-box').hide();$('newsletter-success-box').show();$('newsletter-success-message-box').innerHTML=data['result']['massage'];}}})
return false;}
else
return false;};document.observe('dom:loaded',function(){allo.stripNames();});allo.subText=function(text){var lastIndex=text.lastIndexOf(" ");var str=text.substring(0,lastIndex);return str;}
allo.getLineCount=function(element){var height=element.getHeight();var lineheight=element.getStyle('line-height');if(lineheight.indexOf('px')>=0){lineheight=lineheight.replace('px','');}
else{var fontSize=getComputedStyle(element).getPropertyValue('font-size').replace("px","");lineheight=lineheight.replace('em','');lineheight=fontSize*lineheight;}
var res=(Math.round(height/parseInt(lineheight)));return res;}
allo.stripNames=function(){$$(".product-name-strip a").each(function(i){var text=i.innerHTML.strip();var count=0;while(allo.getLineCount(i)>2)
{count++;if(count>100)break;if(text.length<20)break;if(text.indexOf(" ")==-1){text=text.substring(0,20);i.update(text+'...');break;}
text=allo.subText(text);i.update(text+'...');}});}
allo.getLoginData=function(action){$('messages').hide();isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(!$('email').value||!$('pass').value||($('pass').value.length<6)||!isValidEmail.test($('email').value))
{errMessage=Translator.translate('This field is required.');validationFormIfEmpty(['email','pass'],errMessage);return false;}
$('advanced-navigation-overlay-login').show();var url=CURRENT_BASE_URL+'customer/account/loginPost/';new Ajax.Request(url,{method:'POST',parameters:$('login-form').serialize(true),onSuccess:function(transport){$('advanced-navigation-overlay-login').hide();var data=transport.responseText.evalJSON();if(data['status']==='success'){if(data['result']['is_login']===true&&data['result']['login_url'])
{_gaq.push(['_trackEvent','authorization',action,'login']);var cookie=new CookieProvider();cookie.createCookie(allo.glob.reload_after_login_cookie_name,true);document.location.href=data['result']['login_url'];}else if(data['result']['message']){$('messages').show();$('error-message-login').innerHTML=data['result']['message'];}}}})
return false;};allo.getLoginBeforeData=function(action){$('messages').hide();isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(!$('email').value||!$('pass').value||($('pass').value.length<6)||!isValidEmail.test($('email').value))
{errMessage=Translator.translate('This field is required.');validationFormIfEmpty(['email','pass'],errMessage);return false;}
$('advanced-navigation-overlay-login').show();var url=CURRENT_BASE_URL+'customer/account/loginPostBefore/';new Ajax.Request(url,{method:'POST',parameters:$('login-form').serialize(true),onSuccess:function(transport){$('advanced-navigation-overlay-login').hide();var data=transport.responseText.evalJSON();if(data['status']==='success'){if(data['result']['is_login']===true&&data['result']['login_url'])
{_gaq.push(['_trackEvent','authorization',action,'login']);document.location.reload();}else if(data['result']['suser_choose']&&data['result']['form']){jQuery('.header').first().replaceWith(data['result']['form']);}
else if(data['result']['message']){$('messages').show();$('error-message-login').innerHTML=data['result']['message'];}}}})
return false;};allo.getRegisterData=function(){if($('form-validate').canSubmit===false){return false;}
$('messages').hide();useremail=document.getElementById('form-validate').email.value;isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(!$('firstname').value||!useremail||!$('password').value||($('password').value.length<6)||!isValidEmail.test(useremail))
{errMessage=Translator.translate('This field is required.');validationFormIfEmpty(['firstname','email_address','password'],errMessage);document.getElementById('advice-validate-ajax-email_address').innerHTML=errMessage;return false;}
$('advanced-navigation-overlay-register').show();var url=CURRENT_BASE_URL+'/customer/account/createpost/';new Ajax.Request(url,{method:'POST',parameters:$('form-validate').serialize(true),onSuccess:function(transport){$('advanced-navigation-overlay-register').hide();var data=transport.responseText.evalJSON();if(data['status']==='success'){result=data['result'];if(result['is_registered']===true&&result['success_url'])
{_gaq.push(['_trackEvent','authorization','registration','login']);document.location.href=result['success_url'];}else if(result['message']){$('messages').show();if(document.getElementById('advice-validate-email-email')){document.getElementById('advice-validate-email-email').style.display='none';}
if($('first-tab')){$('first-tab').triggerEvent('click');}else{choiceMenuLogin();}
$('error-message-login').innerHTML='<li><span>'+result['message']+'</span></li>';$('email').value=document.getElementById('form-validate').email.value;$('pass').value='';}else if(result['email_invalid_message']){validationFormIfEmailNoValid('email_address',result['email_invalid_message']);}}}})
return false;};allo.hideLoginPopup=function(){window.popupLoginLightbox.close();window.popupLoginLightbox=new TemplateLightbox($('customer-popup-login'),{cssClass:'customer-popup-login'});var dataForm=new VarienForm('login-form-popup',true);return false;};allo.showLoginPopup=function(){window.popupLoginLightbox.container.down('#email-popup').value='';window.popupLoginLightbox.container.down('#pass-popup').value='';if(window.popupLoginLightbox.container.down('#advice-validate-email-email'))
window.popupLoginLightbox.container.down('#advice-validate-email-email').style.display="none";window.popupLoginLightbox.open();return false;};allo.showLogin=function(Node){var popup=window.popupLoginLightbox.container;var windowScroll=window.scrollY;var windowHeight;if(typeof window.innerHeight!='undefined')
windowHeight=window.innerHeight;else
windowHeight=document.documentElement.offsetHeight;var scroll=Node.cumulativeOffset();allo.showLoginPopup();if((windowScroll+50)>Math.round(scroll[1]-popup.getHeight()/2+Node.getHeight()/2)){popup.style.top=Math.round(windowScroll+50)+'px';popup.style.left=Math.round(scroll[0]-popup.getWidth()/2+Node.getWidth()/2)+'px';}
else{if((windowScroll+windowHeight-50)>Math.round(scroll[1]+popup.getHeight()/2+Node.getHeight()/2)){popup.style.top=Math.round(scroll[1]-popup.getHeight()/2+Node.getHeight()/2)+'px';popup.style.left=Math.round(scroll[0]-popup.getWidth()/2+Node.getWidth()/2)+'px';}
else{popup.style.top=Math.round(windowScroll+windowHeight-popup.getHeight()-50)+'px';popup.style.left=Math.round(scroll[0]-popup.getWidth()/2+Node.getWidth()/2)+'px';}}};allo.checkEmailAndShowLoginPopup=function(Node,form,callback){var email=jQuery(Node).find('#askaquestion-email').val();var text=jQuery(Node).find('#askaquestion-comment').val()
allo.putDataInCookie(text,"askquestion",productTabs.currentTab.tabName);if(email){isValidEmail=/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i;if(isValidEmail.test(email)){var url=CURRENT_BASE_URL+'/customer/account/checkUserByEmail/';new Ajax.Request(url,{method:'POST',parameters:'email='+email,onSuccess:function(transport){var data=transport.responseText.evalJSON();if(data['status']==='success'){if(data['result']['user_exist']==true){allo.showLogin(Node,true);jQuery('#email').val(email);return;}}
if(callback&&form){callback(form);return;}}.bind(this)});}}};allo.showReloginPopupOnQuestion=function(element){var Node=$(element);Node=Node.match('form')?Node:Node.up('form');var text=jQuery(Node).find('#askaquestion-comment').val();allo.putDataInCookie(text,"askquestion",productTabs.currentTab.tabName);allo.showLogin($(element),false);};allo.prepareLoginOnAnswer=function(element){var Node=$(element);Node=Node.match('form')?Node:Node.up('form');var text=jQuery(Node).find('textarea[name="text"]').val();allo.putDataInCookie(text,Node.id,productTabs.currentTab.tabName,productTabs.currentTab.tabUrl);allo.showLogin($(element),false);};allo.putDataInCookie=function(text,type,tab,page){var cookie=new CookieProvider();cookie.createCookie(allo.glob.askquestion_text_cookie_name,text);cookie.createCookie(allo.glob.form_type_cookie_name,type);cookie.createCookie(allo.glob.old_tab_cookie_name,tab);cookie.createCookie(allo.glob.current_page_cookie_name,page);}
validationFormIfEmpty=function(arrayIds,errMessage){for(i=0;i<arrayIds.length;i++)
{if(!($(arrayIds[i]).value)){Validation.ajaxError($(arrayIds[i]),errMessage);}}}
validationFormIfEmailNoValid=function(elementId,errMessage){name='validate-ajax';advice=Validation.getAdvice(name,$(elementId));if(!advice){advice=Validation.createAdvice(name,$(elementId),false,errMessage);}
Validation.showAdvice($(elementId),advice,name);Validation.updateCallback($(elementId),'failed');$(elementId).addClassName('validation-failed');$(elementId).addClassName(name);document.getElementById('advice-validate-ajax-email_address').innerHTML=errMessage;}
CookieProvider=Class.create();CookieProvider.prototype={initialize:function(){},getDomain:function(url){var parts=url.split('.');var data={subdomain:null,domain:null,type:null};var dd=parts.slice(-2).join('.');if(parts.length==3){data.subdomain=parts[0];data.domain="."+parts.slice(-2).join('.');data.type=parts[2];}
else if(parts.length==2){data.domain="."+parts.join('.');data.type=parts[1];}
return data;},createCookie:function(name,value,days){if(!name||!value&&!days){return;}
var date=new Date();switch(name){case allo.glob.city_id_cookie_name:{date.setTime(date.getTime()+(5*365*24*60*60*1000));}
break;default:days?date.setTime(date.getTime()+(days*24*60*60*1000)):date.setTime(date.getTime()+(30*60*1000));break;}
var nameValue=name+"="+encodeURI(value);var expires="; expires="+date.toGMTString();var path="; path=/";var domain="; domain="+this.getDomain(document.location.hostname).domain;document.cookie=nameValue+expires+domain+path;},readCookie:function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;},eraseCookie:function(name){this.createCookie(name,"",-1);}};allo.preOrderRedirect=function(productUrl,productId,price,credit){var buyurl=CURRENT_BASE_URL+'productinstores/stores/buypreorder';var crediturl=CURRENT_BASE_URL+'productinstores/stores/creditpreorder';var url=productUrl;if(typeof(price)!='undefined'&&Number(price)>0){if(credit){var url=crediturl+'?id='+productId+'&ts='+Date.now();}else{var url=buyurl+'?id='+productId+'&ts='+Date.now();}}
Mage.Cookies.set('pre-order',true);setLocation(url);};allo.shoPreOrderPopup=function(selector){var cookie=new CookieProvider();var preorder=cookie.readCookie('pre-order');if(preorder=="true"){$(selector).style.display='block';$(selector+'-enter').style.display='block';Mage.Cookies.set('pre-order',false);}};allo.informAvailabilityRedirect=function(url){Mage.Cookies.set('inform-availability',true);setLocation(url);};allo.showAvailabilityPopup=function(){var cookie=new CookieProvider();var preorder=cookie.readCookie('inform-availability');if(preorder=="true"){if(!window.productAlertStockProduct)
window.productAlertStockProduct=new Lightbox($('productalert-stock-lightbox-product'));window.productAlertStockProduct.open();Mage.Cookies.set('inform-availability',false);}};function showReview(elem){var id=elem.parentElement.parentElement.id;elem.remove;elem.parentElement.textContent=jQuery('.review-full-text-main-tab[id='+id+']')[0].textContent;jQuery('.review-full-text-main-tab[id='+id+']').remove();};CheckoutEffect=Object.create(Effect);CheckoutEffect.Appear=function(element){element=$(element);var options=Object.extend({from:(element.getStyle('display')=='none'?0.0:element.getOpacity()||0.0),to:1.0,afterFinishInternal:function(effect){effect.element.forceRerendering();},beforeFinishInternal:function(effect){if(effect.element.hasAttribute('id')){var dropDowns=Array($('payment_method_select-list'),$('shipping_method_select-list'),$('shipping_address_select-list'),$('payment_bill_methods-list'));currentDropDownId=effect.element.getAttribute('id');dropDowns.each(function(element){if(element){var elementId=element.getAttribute('id');if(element.getAttribute('id')!=currentDropDownId){var divClassName=elementId.split('-list')[0];var parentDiv=element.up('div.'+divClassName+'_div');parentDiv.hide();element.up('div.fireselect-container').style.zIndex=0;element.showing=false;element.hide();}}});if(currentDropDownId=='shipping_address_select-list'){var contentClass='shipping_address_select_div';var scrollClass='scroll-item_addresses';var scrollBarClass='scrollbar-addresses';var newBlockClass='shipping_address_select_new_div';var scrollSetupped=allo.delivery.scrollSetuped;}else if(currentDropDownId=='shipping_method_select-list'){var contentClass='shipping_method_select_div';var scrollClass='scroll-item_schipmethods';var scrollBarClass='scrollbar-schipmethods';var newBlockClass='shipping_method_select_new_div';var scrollSetupped=allo.checkoutPage.shippingScroll;}else if(currentDropDownId=='payment_method_select-list'){var contentClass='payment_method_select_div';var scrollClass='scroll-item_paymentmethods';var scrollBarClass='scrollbar-paymentmethods';var newBlockClass='payment_method_select_new_div';var scrollSetupped=allo.checkoutPage.paymentScroll;}}
allo.checkoutPage.createScroll(contentClass,scrollClass,scrollBarClass,newBlockClass,scrollSetupped);},beforeSetup:function(effect){effect.element.setOpacity(effect.options.from).show();}},arguments[1]||{});return new Effect.Opacity(element,options);};Validation.add('validate-email-without-cyrillic','Please enter a valid email address. For example johndoe@domain.com.',function(v){return Validation.get('IsEmpty').test(v)||(/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/i).test(v);});;var RubberSlider=new Class.create({initialize:function(container,options){this.currentSlideNum=0;this.imagesContainer=container.down('.images-container');this.data={controls:container.select('.controls li'),slides:container.select('.slide'),gradients:container.select('.gradient'),movers:container.select('.mover'),pause:container.down('.pause'),container:container,effectDuration:options.effectDuration||0.5,playInterval:options.rotationTime||3000,pageType:options.pageType||'',onBeforeSwitch:options.onBeforeSwitch};this.updateSize();var relations=this.setRelations(this.data);this.relations=relations;this.observeControls(relations);this.observeMovers(relations);this.observePause();this.observeResize();this.play();},setRelations:function(data){var relations=[];for(var i=0;i<data.slides.length;i++){relations.push({control:data.controls[i],slide:data.slides[i],gradient:data.gradients[i]});}
return relations;},observeControls:function(relations){relations.each(function(th,index){th.control.observe('click',function(){if(!this.disabled&&this.currentSlideNum!=index){this.switchSlides(this.currentSlideNum,index,relations);}}.bind(this));}.bind(this));},observeMovers:function(relations){this.data.movers.each(function(th){th.observe('click',function(){if(!this.disabled){if(th.hasClassName('next')){this.next();}else{this.previous();}}}.bind(this));}.bind(this));},observePause:function(){this.data.pause.observe('click',function(){this.data.pause.toggleClassName('current');if(this.playing){this.stop();this.paused=true;}
else{this.play();this.paused=false;}}.bind(this));},switchSlides:function(oldNum,newNum,relations,callback){if(this.data.onBeforeSwitch)
{this.data.onBeforeSwitch(this,oldNum,newNum);}
this.disabled=true;this.stop();var newOffset=-relations[newNum].slide.offsetLeft;var oldOffset=-this.imagesContainer.offsetLeft;var callback=callback||Prototype.emptyFunction;relations[oldNum].gradient.style.zIndex=5;relations[newNum].gradient.style.zIndex=4;new Effect.Move(this.imagesContainer,{x:newOffset,mode:'absolute',duration:this.data.effectDuration});new Effect.Opacity(relations[newNum].gradient,{from:0,to:1,duration:this.data.effectDuration});new Effect.Opacity(relations[oldNum].gradient,{from:1,to:0,duration:this.data.effectDuration,afterFinish:function(){this.disabled=false;relations[oldNum].control.removeClassName('current');relations[newNum].control.addClassName('current');relations[oldNum].gradient.style.zIndex=0;relations[newNum].gradient.style.zIndex=1;if(!this.paused){this.play();}
new callback();}.bind(this)});this.currentSlideNum=newNum;},next:function(){if(this.currentSlideNum<this.relations.length-1){this.switchSlides(this.currentSlideNum,this.currentSlideNum+1,this.relations);}else{this.imagesContainer.appendChild(this.relations[0].slide);this.imagesContainer.style.left=this.imagesContainer.offsetLeft+this.oneSlideWidth+'px';this.switchSlides(this.currentSlideNum,0,this.relations,function(){this.imagesContainer.insert({top:this.relations[0].slide});this.imagesContainer.style.left=0;}.bind(this));}},previous:function(){if(this.currentSlideNum>0){this.switchSlides(this.currentSlideNum,this.currentSlideNum-1,this.relations);}else{this.imagesContainer.insert({top:this.relations[this.relations.length-1].slide});this.imagesContainer.style.left=this.imagesContainer.offsetLeft-this.oneSlideWidth+'px';this.switchSlides(this.currentSlideNum,this.relations.length-1,this.relations,function(){this.imagesContainer.appendChild(this.relations[this.relations.length-1].slide);this.imagesContainer.style.left=-((this.relations.length-1)*this.oneSlideWidth)+'px';}.bind(this));}},play:function(){var slideTitle=this.data.slides[this.currentSlideNum].down('a').title,slideNum=this.currentSlideNum+1;if(this.data.pageType!=''){_gaq.push(['_trackEvent','Big-promo-show',this.data.pageType,slideNum+'-'+slideTitle,,true]);}
this.stop();this.playInterval=setInterval(function(){this.next();}.bind(this),this.data.playInterval);this.playing=true;},stop:function(){clearInterval(this.playInterval);this.playing=false;},observeResize:function(){Event.observe(window,'resize',this.updateSize.bind(this));},updateSize:function(){this.data.slides.each(function(th){th.style.width=this.data.container.offsetWidth+'px';this.oneSlideWidth=this.data.container.offsetWidth;this.imagesContainer.style.left=-(this.currentSlideNum*this.oneSlideWidth)+'px';}.bind(this));}});;if(typeof Prototype=='undefined'||!Prototype.Version.match("1.6"))
throw("Prototype-UI library require Prototype library >= 1.6.0");if(Prototype.Browser.WebKit){Prototype.Browser.WebKitVersion=parseFloat(navigator.userAgent.match(/AppleWebKit\/([\d\.\+]*)/)[1]);Prototype.Browser.Safari2=(Prototype.Browser.WebKitVersion<420);}
if(Prototype.Browser.IE){Prototype.Browser.IEVersion=parseFloat(navigator.appVersion.split(';')[1].strip().split(' ')[1]);Prototype.Browser.IE6=Prototype.Browser.IEVersion==6;Prototype.Browser.IE7=Prototype.Browser.IEVersion==7;}
Prototype.falseFunction=function(){return false};Prototype.trueFunction=function(){return true};var UI={Abstract:{},Ajax:{}};Object.extend(Class.Methods,{extend:Object.extend.methodize(),addMethods:Class.Methods.addMethods.wrap(function(proceed,source){if(!source)return this;if(!source.hasOwnProperty('methodsAdded'))
return proceed(source);var callback=source.methodsAdded;delete source.methodsAdded;proceed(source);callback.call(source,this);source.methodsAdded=callback;return this;}),addMethod:function(name,lambda){var methods={};methods[name]=lambda;return this.addMethods(methods);},method:function(name){return this.prototype[name].valueOf();},classMethod:function(){$A(arguments).flatten().each(function(method){this[method]=(function(){return this[method].apply(this,arguments);}).bind(this.prototype);},this);return this;},undefMethod:function(name){this.prototype[name]=undefined;return this;},removeMethod:function(name){delete this.prototype[name];return this;},aliasMethod:function(newName,name){this.prototype[newName]=this.prototype[name];return this;},aliasMethodChain:function(target,feature){feature=feature.camelcase();this.aliasMethod(target+"Without"+feature,target);this.aliasMethod(target,target+"With"+feature);return this;}});Object.extend(Number.prototype,{snap:function(round){return parseInt(round==1?this:(this/round).floor()*round);}});Object.extend(String.prototype,{camelcase:function(){var string=this.dasherize().camelize();return string.charAt(0).toUpperCase()+string.slice(1);},makeElement:function(){var wrapper=new Element('div');wrapper.innerHTML=this;return wrapper.down();}});Object.extend(Array.prototype,{empty:function(){return!this.length;},extractOptions:function(){return this.last().constructor===Object?this.pop():{};},removeAt:function(index){var object=this[index];this.splice(index,1);return object;},remove:function(object){var index;while((index=this.indexOf(object))!=-1)
this.removeAt(index);return object;},insert:function(index){var args=$A(arguments);args.shift();this.splice.apply(this,[index,0].concat(args));return this;}});Element.addMethods({getScrollDimensions:function(element){return{width:element.scrollWidth,height:element.scrollHeight}},getScrollOffset:function(element){return Element._returnOffset(element.scrollLeft,element.scrollTop);},setScrollOffset:function(element,offset){element=$(element);if(arguments.length==3)
offset={left:offset,top:arguments[2]};element.scrollLeft=offset.left;element.scrollTop=offset.top;return element;},getNumStyle:function(element,style){var value=parseFloat($(element).getStyle(style));return isNaN(value)?null:value;},appendText:function(element,text){element=$(element);text=String.interpret(text);element.appendChild(document.createTextNode(text));return element;}});document.whenReady=function(callback){if(document.loaded)
callback.call(document);else
document.observe('dom:loaded',callback);};Object.extend(document.viewport,{getScrollOffset:document.viewport.getScrollOffsets,setScrollOffset:function(offset){Element.setScrollOffset(Prototype.Browser.WebKit?document.body:document.documentElement,offset);},getScrollDimensions:function(){return Element.getScrollDimensions(Prototype.Browser.WebKit?document.body:document.documentElement);}});(function(){UI.Options={methodsAdded:function(klass){klass.classMethod($w(' setOptions allOptions optionsGetter optionsSetter optionsAccessor '));},setOptions:function(options){if(!this.hasOwnProperty('options'))
this.options=this.allOptions();this.options=Object.extend(this.options,options||{});},allOptions:function(){var superclass=this.constructor.superclass,ancestor=superclass&&superclass.prototype;return(ancestor&&ancestor.allOptions)?Object.extend(ancestor.allOptions(),this.options):Object.clone(this.options);},optionsGetter:function(){addOptionsAccessors(this,arguments,false);},optionsSetter:function(){addOptionsAccessors(this,arguments,true);},optionsAccessor:function(){this.optionsGetter.apply(this,arguments);this.optionsSetter.apply(this,arguments);}};function addOptionsAccessors(receiver,names,areSetters){names=$A(names).flatten();if(names.empty())
names=Object.keys(receiver.allOptions());names.each(function(name){var accessorName=(areSetters?'set':'get')+name.camelcase();receiver[accessorName]=receiver[accessorName]||(areSetters?function(value){return this.options[name]=value}:function(){return this.options[name]});});}})();UI.Carousel=Class.create(UI.Options,{options:{direction:"horizontal",previousButton:".previous_button",nextButton:".next_button",container:".container",scrollInc:"auto",disabledButtonSuffix:'_disabled',overButtonSuffix:'_over'},initialize:function(element,options){this.setOptions(options);this.element=$(element);this.id=this.element.id;this.imageLoaded=false;this.container=this.element.down(this.options.container).firstDescendant();this.elements=this.container.childElements();this.previousButton=this.options.previousButton==false?null:this.element.down(this.options.previousButton);this.nextButton=this.options.nextButton==false?null:this.element.down(this.options.nextButton);this.showingControls=true;this.prepareContainer();this.observeResize();this.posAttribute=(this.options.direction=="horizontal"?"left":"top");this.dimAttribute=(this.options.direction=="horizontal"?"width":"height");this.elementSize=this.computeElementSize();this.nbVisible=this.currentSize()/this.elementSize;var scrollInc=this.options.scrollInc;if(scrollInc=="auto")
scrollInc=Math.floor(this.nbVisible);if(this.previousButton&&this.nextButton){[this.previousButton,this.nextButton].each(function(button){if(!button)return;var className=(button==this.nextButton?"next_button":"previous_button")+this.options.overButtonSuffix;button.clickHandler=this.scroll.bind(this,(button==this.nextButton?-1:1)*scrollInc*this.elementSize);button.observe("click",button.clickHandler).observe("mouseover",function(){button.addClassName(className)}.bind(this)).observe("mouseout",function(){button.removeClassName(className)}.bind(this));},this);this.controls=[this.previousButton,this.nextButton];var seeAll;if(seeAll=this.element.down('.see-all')){this.controls.push(seeAll);}}else{this.controls=null;}
this.checkControls();this.updateButtons();this.prepareContainer();this.updateSize();this.checkControls();this.preparePopups();this.element.down('.container').style.height=this.container.getHeight()+'px';},prepareContainer:function(){var oneWidth=this.elements[0].getWidth();if(this.element.up()){var containerWidth=this.element.up().getWidth();}
else{var containerWidth=this.element.up('.main')?this.element.up('.main').getWidth():0;}
this.element.style.width=containerWidth+'px';var controlsWidth=0;if(this.previousButton){controlsWidth+=this.previousButton.getWidth();}
if(this.nextButton){controlsWidth+=this.nextButton.getWidth();}
var controlsWidth=this.previousButton.getWidth()+this.nextButton.getWidth();var resultWidth=Math.floor((containerWidth-controlsWidth)/oneWidth)*oneWidth;if(parseInt(resultWidth))
this.element.down(this.options.container).style.width=resultWidth+'px';},preparePopups:function(){var popups=this.container.select('.attributes');var self=this;if(popups.length){popups.each(function(th){th.style.position='absolute';var slideNum=th.readAttribute('rel')
th.slide=self.elements[slideNum];th.target=th.slide.down('.popup-target');if(Prototype.Browser.IE){document.observe('dom:loaded',function(){document.body.insertBefore(th);});}else{document.body.insert({before:th});}
th.slide.down('img').observe('mouseover',function(e){clearTimeout(th.timer);var coords=th.target.cumulativeOffset();th.style.left=coords[0]+'px';th.style.top=coords[1]+'px';th.style.display='block';});th.slide.observe('mouseover',function(){clearTimeout(th.timer);})
th.observe('mouseover',function(){clearTimeout(th.timer);});th.slide.observe('mouseout',function(e){th.timer=setTimeout(function(){th.style.display='none';},10);});th.observe('mouseout',function(){th.timer=setTimeout(function(){th.style.display='none';},10);});});}},checkControls:function(){if(this.controls){if(this.nbVisible>=this.elements.length&&this.showingControls){this.controls.invoke('hide','');this.showingControls=false;}
if(this.nbVisible<this.elements.length&&!this.showingControls){this.controls.invoke('show','');this.showingControls=true;}}},observeResize:function(){Event.observe(window,'resize',function(){this.prepareContainer();this.updateSize();this.checkControls();}.bind(this));},destroy:function($super){[this.previousButton,this.nextButton].each(function(button){if(!button)return;button.stopObserving("click",button.clickHandler);},this);this.element.remove();this.fire('destroyed');},fire:function(eventName,memo){memo=memo||{};memo.carousel=this;return this.element.fire('carousel:'+eventName,memo);},observe:function(eventName,handler){this.element.observe('carousel:'+eventName,handler.bind(this));return this;},stopObserving:function(eventName,handler){this.element.stopObserving('carousel:'+eventName,handler);return this;},checkScroll:function(position,updatePosition){if(position>0)
position=0;else{if(Prototype.Browser.IE7&&($('dynamic-navigation-product'))){var i=0;this.elements.each(function(elem){i++;});var str="<li class='item'></li>";var j=0;while(i%5!=0){i++;};var limit=i*this.elementSize;}
else{var limit=this.elements.last().positionedOffset()[this.posAttribute]+this.elementSize;}
var carouselSize=this.currentSize();if(position+limit<carouselSize)
position+=carouselSize-(position+limit);position=Math.min(position,0);}
if(updatePosition)
this.container.style[this.posAttribute]=position+"px";return position;},scroll:function(deltaPixel){if(this.options.beforeScroll)
{this.options.beforeScroll(this,deltaPixel);}
var type='';if(this.id){type=this.id.replace('Carousel','');}
if(type&&!this.imageLoaded){window.lazyLoadingImages.update().load(type).show(type);this.imageLoaded=true;}
if(this.animating)
return this;var position=this.currentPosition()+deltaPixel;position=this.checkScroll(position,false);deltaPixel=position-this.currentPosition();if(deltaPixel!=0){this.animating=true;this.fire("scroll:started");var that=this;this.container.morph("opacity:0.5",{duration:0.2,afterFinish:function(){that.container.morph(that.posAttribute+": "+position+"px",{duration:0.4,delay:0.2,afterFinish:function(){that.container.morph("opacity:1",{duration:0.2,afterFinish:function(){that.animating=false;jQuery(document).trigger("scroll:ended");that.updateButtons().fire("scroll:ended",{shift:deltaPixel/that.currentSize()});}});}});}});}
return this;},scrollTo:function(index){if(this.animating||index<0||index>this.elements.length||index==this.currentIndex()||isNaN(parseInt(index)))
return this;return this.scroll((this.currentIndex()-index)*this.elementSize);},updateButtons:function(){this.updatePreviousButton();this.updateNextButton();return this;},updatePreviousButton:function(){var position=this.currentPosition();var previousClassName="previous_button"+this.options.disabledButtonSuffix;if(this.previousButton){if(this.previousButton.hasClassName(previousClassName)&&position!=0){this.previousButton.removeClassName(previousClassName);this.fire('previousButton:enabled');}
if(!this.previousButton.hasClassName(previousClassName)&&(position==0||position==null)){this.previousButton.addClassName(previousClassName);this.fire('previousButton:disabled');}}},updateNextButton:function(){var lastPosition=this.currentLastPosition();var size=this.currentSize();var nextClassName="next_button"+this.options.disabledButtonSuffix;if(this.nextButton){if(this.nextButton.hasClassName(nextClassName)&&lastPosition!=size){this.nextButton.removeClassName(nextClassName);this.fire('nextButton:enabled');}
if(!this.nextButton.hasClassName(nextClassName)&&lastPosition==size){this.nextButton.addClassName(nextClassName);this.fire('nextButton:disabled');}
if(this.afterUpdateNextButton){this.afterUpdateNextButton();}}},computeElementSize:function(){return this.elements.first().getDimensions()[this.dimAttribute];},currentIndex:function(){return-this.currentPosition()/this.elementSize;},currentLastPosition:function(){if(this.container.childElements().empty())
return 0;return this.currentPosition()+
this.elements.last().positionedOffset()[this.posAttribute]+
this.elementSize;},currentPosition:function(){return this.container.getNumStyle(this.posAttribute);},currentSize:function(){return this.container.parentNode.getDimensions()[this.dimAttribute];},updateSize:function(){this.nbVisible=this.currentSize()/this.elementSize;var scrollInc=this.options.scrollInc;if(scrollInc=="auto")
scrollInc=Math.floor(this.nbVisible);[this.previousButton,this.nextButton].each(function(button){if(!button)return;button.stopObserving("click",button.clickHandler);button.clickHandler=this.scroll.bind(this,(button==this.nextButton?-1:1)*scrollInc*this.elementSize);button.observe("click",button.clickHandler);},this);this.checkScroll(this.currentPosition(),true);this.updateButtons().fire('sizeUpdated');return this;},refreshElements:function(){this.elements=this.container.childElements();}});UI.Ajax.Carousel=Class.create(UI.Carousel,{options:{elementSize:-1,url:null},initialize:function($super,element,options,afterUpdateNextButton){if(!options.url)
throw("url option is required for UI.Ajax.Carousel");if(!options.elementSize)
throw("elementSize option is required for UI.Ajax.Carousel");$super(element,options);this.endIndex=0;this.hasMore=true;this.updateHandler=this.update.bind(this);this.updateAndScrollHandler=function(nbElements,transport,json){this.update(transport,json);this.scroll(nbElements);}.bind(this);this.runRequest.bind(this).defer({parameters:{from:0,to:Math.ceil(this.nbVisible)-1},onSuccess:this.updateHandler});this.afterUpdateNextButton=afterUpdateNextButton;},runRequest:function(options){this.requestRunning=true;new Ajax.Request(this.options.url,Object.extend({method:"GET"},options));this.fire("request:started");return this;},scroll:function($super,deltaPixel){if(this.animating||this.requestRunning)
return this;var nbElements=(-deltaPixel)/this.elementSize;if(this.hasMore&&nbElements>0&&this.currentIndex()+this.nbVisible+nbElements-1>this.endIndex){var from=this.endIndex+1;var to=Math.ceil(from+this.nbVisible-1);this.runRequest({parameters:{from:from,to:to},onSuccess:this.updateAndScrollHandler.curry(deltaPixel).bind(this)});return this;}
else
$super(deltaPixel);},update:function(transport,json){this.requestRunning=false;this.fire("request:ended");if(!json)
json=transport.responseJSON;this.hasMore=json.more;this.endIndex=Math.max(this.endIndex,json.to);this.elements=this.container.insert({bottom:json.html}).childElements();return this.updateButtons();},computeElementSize:function(){return this.options.elementSize;},updateSize:function($super){var nbVisible=this.nbVisible;$super();if(Math.floor(this.nbVisible)-Math.floor(nbVisible)>=1&&this.hasMore){if(this.currentIndex()+Math.floor(this.nbVisible)>=this.endIndex){var nbNew=Math.floor(this.currentIndex()+Math.floor(this.nbVisible)-this.endIndex);this.runRequest({parameters:{from:this.endIndex+1,to:this.endIndex+nbNew},onSuccess:this.updateHandler});}}
return this;},updateNextButton:function($super){var lastPosition=this.currentLastPosition();var size=this.currentSize();var nextClassName="next_button"+this.options.disabledButtonSuffix;if(this.nextButton.hasClassName(nextClassName)&&lastPosition!=size){this.nextButton.removeClassName(nextClassName);this.fire('nextButton:enabled');}
if(!this.nextButton.hasClassName(nextClassName)&&lastPosition==size&&!this.hasMore){this.nextButton.addClassName(nextClassName);this.fire('nextButton:disabled');}}});UI.TsgCarousel=Class.create(UI.Carousel,{options:{direction:"horizontal",previousButton:".previous_button",nextButton:".next_button",container:".container",scrollInc:"auto",disabledButtonSuffix:'_disabled',overButtonSuffix:'_over'},prepareContainer:function(){}});;CarouselNavigation=Class.create(Abstract,{initialize:function(scroller,slides,controls,options){this.scrolling=false;this.scroller=$(scroller);this.slides=slides;this.controls=controls;this.options=Object.extend({duration:1,auto:false,frequency:3,visibleSlides:1,controlClassName:'carousel-control',jumperClassName:'carousel-jumper',disabledClassName:'carousel-disabled',selectedClassName:'carousel-selected',circular:false,wheel:true,effect:'scroll',transition:'sinoidal'},options||{});if(this.options.effect=='fade'){this.options.circular=true;}
this.slides.each(function(slide,index){slide._index=index;});if(this.controls){this.controls.invoke('observe','click',this.click.bind(this));}
if(this.options.wheel){this.scroller.observe('mousewheel',this.wheel.bindAsEventListener(this)).observe('DOMMouseScroll',this.wheel.bindAsEventListener(this));;}
if(this.options.auto){this.start();}
if(this.options.initial){var initialIndex=this.slides.indexOf($(this.options.initial));if(initialIndex>(this.options.visibleSlides-1)&&this.options.visibleSlides>1){if(initialIndex>this.slides.length-(this.options.visibleSlides+1)){initialIndex=this.slides.length-this.options.visibleSlides;}}
this.moveTo(this.slides[initialIndex]);}},click:function(event){this.stop();var element=event.findElement('a');if(!element.hasClassName(this.options.disabledClassName)){if(element.hasClassName(this.options.controlClassName)){eval("this."+element.rel+"()");}else if(element.hasClassName(this.options.jumperClassName)){this.moveTo(element.rel);if(this.options.selectedClassName){this.controls.invoke('removeClassName',this.options.selectedClassName);element.addClassName(this.options.selectedClassName);}}}
this.deactivateControls();event.stop();},moveTo:function(element){if(this.options.beforeMove&&(typeof this.options.beforeMove=='function')){this.options.beforeMove();}
this.previous=this.current?this.current:this.slides[0];this.current=$(element);var scrollerOffset=this.scroller.cumulativeOffset();var elementOffset=this.current.cumulativeOffset();if(this.scrolling){this.scrolling.cancel();}
switch(this.options.effect){case'fade':this.scrolling=new Effect.Opacity(this.scroller,{from:1.0,to:0,duration:this.options.duration,afterFinish:(function(){this.scroller.scrollLeft=elementOffset[0]-scrollerOffset[0];this.scroller.scrollTop=elementOffset[1]-scrollerOffset[1];new Effect.Opacity(this.scroller,{from:0,to:1.0,duration:this.options.duration,afterFinish:(function(){if(this.controls){this.activateControls();}
if(this.options.afterMove&&(typeof this.options.afterMove=='function')){this.options.afterMove();}}).bind(this)});}).bind(this)});break;case'scroll':default:var transition;switch(this.options.transition){case'spring':transition=Effect.Transitions.spring;break;case'sinoidal':default:transition=Effect.Transitions.sinoidal;break;}
this.scrolling=new Effect.SmoothScroll(this.scroller,{duration:this.options.duration,x:(elementOffset[0]-scrollerOffset[0]),y:(elementOffset[1]-scrollerOffset[1]),transition:transition,afterFinish:(function(){if(this.controls){this.activateControls();}
if(this.options.afterMove&&(typeof this.options.afterMove=='function')){this.options.afterMove();}
this.scrolling=false;}).bind(this)});break;}
return false;},prev:function(){if(this.current){var currentIndex=this.current._index;var prevIndex=(currentIndex==0)?(this.options.circular?this.slides.length-1:0):currentIndex-1;}else{var prevIndex=(this.options.circular?this.slides.length-1:0);}
if(prevIndex==(this.slides.length-1)&&this.options.circular&&this.options.effect!='fade'){this.scroller.scrollLeft=(this.slides.length-1)*this.slides.first().getWidth();this.scroller.scrollTop=(this.slides.length-1)*this.slides.first().getHeight();prevIndex=this.slides.length-2;}
this.moveTo(this.slides[prevIndex]);},next:function(){if(this.current){var currentIndex=this.current._index;var nextIndex=(this.slides.length-1==currentIndex)?(this.options.circular?0:currentIndex):currentIndex+1;}else{var nextIndex=1;}
if(nextIndex==0&&this.options.circular&&this.options.effect!='fade'){this.scroller.scrollLeft=0;this.scroller.scrollTop=0;nextIndex=1;}
if(nextIndex>this.slides.length-(this.options.visibleSlides+1)){nextIndex=this.slides.length-this.options.visibleSlides;}
this.moveTo(this.slides[nextIndex]);},first:function(){this.moveTo(this.slides[0]);},last:function(){this.moveTo(this.slides[this.slides.length-1]);},toggle:function(){if(this.previous){this.moveTo(this.slides[this.previous._index]);}else{return false;}},stop:function(){if(this.timer){clearTimeout(this.timer);}},start:function(){this.periodicallyUpdate();},pause:function(){this.stop();this.activateControls();},resume:function(event){if(event){var related=event.relatedTarget||event.toElement;if(!related||(!this.slides.include(related)&&!this.slides.any(function(slide){return related.descendantOf(slide);}))){this.start();}}else{this.start();}},periodicallyUpdate:function(){if(this.timer!=null){clearTimeout(this.timer);this.next();}
this.timer=setTimeout(this.periodicallyUpdate.bind(this),this.options.frequency*1000);},wheel:function(event){event.cancelBubble=true;event.stop();var delta=0;if(!event){event=window.event;}
if(event.wheelDelta){delta=event.wheelDelta/120;}else if(event.detail){delta=-event.detail/3;}
if(!this.scrolling){this.deactivateControls();if(delta>0){this.prev();}else{this.next();}}
return Math.round(delta);},deactivateControls:function(){this.controls.invoke('addClassName',this.options.disabledClassName);},activateControls:function(){this.controls.invoke('removeClassName',this.options.disabledClassName);}});Effect.SmoothScroll=Class.create();Object.extend(Object.extend(Effect.SmoothScroll.prototype,Effect.Base.prototype),{initialize:function(element){this.element=$(element);var options=Object.extend({x:0,y:0,mode:'absolute'},arguments[1]||{});this.start(options);},setup:function(){if(this.options.continuous&&!this.element._ext){this.element.cleanWhitespace();this.element._ext=true;this.element.appendChild(this.element.firstChild);}
this.originalLeft=this.element.scrollLeft;this.originalTop=this.element.scrollTop;if(this.options.mode=='absolute'){this.options.x-=this.originalLeft;this.options.y-=this.originalTop;}},update:function(position){this.element.scrollLeft=this.options.x*position+this.originalLeft;this.element.scrollTop=this.options.y*position+this.originalTop;}});;function HeaderMenu(){this.menuLinks=Array();this.activeMenuLink=undefined;this.initLink=function(link_id){headerMenu.menuLinks.push(link_id)
var link=jQuery('#'+link_id);if(link){link.mouseenter(function(){headerMenu.showPopupMenu(link);});link.mouseleave(function(){headerMenu.hidePopupMenu();});}}
this.showPopupMenu=function(linkElement)
{this.hidePopupMenu();linkElement.addClass('active');if(linkElement.attr('id')=='main-menu'){jQuery('.page').first().addClass('active-menu');}
this.activeMenuLink=linkElement;}
this.hidePopupMenu=function()
{if(this.activeMenuLink){this.activeMenuLink.removeClass('active');if(this.activeMenuLink.attr('id')=='main-menu'){jQuery('.page').first().removeClass('active-menu');}
this.activeMenuLink=undefined;}}}
function isHomePage(){var url,i,k,baseUrl;url=unsetProtocolFromUrl(window.location.href);i=url.indexOf('?');if(url.indexOf('?')>-1){url=url.substr(0,i);}
k=url.indexOf('#');if(url.indexOf('#')>-1){url=url.substr(0,k);}
baseUrl=unsetProtocolFromUrl(BASE_URL);return url==baseUrl;}
function unsetProtocolFromUrl(url){var result=url;if(url.indexOf("https")!=-1){result=url.replace("https:","");}else{result=url.replace("http:","");}
return result;}
var headerMenu=new HeaderMenu();var showOnOver=function(link_id){if(!headerMenu){headerMenu=new HeaderMenu();}
headerMenu.initLink(link_id);};document.observe('dom:loaded',function()
{initialiseLevelsMenuCatalog();});function initialiseLevelsMenuCatalog()
{var nav_container=$$('.nav-container').first();var nav_menu=$$('ul#nav').first();var nav_blocks_container=$$('.nav-container .menu-blocks').first();var links=$$('.nav-container .relative-wrapper');var show_advanced_button=$('show-advanced');var show_advanced=false;var selected_menu_item=undefined;var selected_menu_link=undefined;var menu_selected=false;var previousX,previousY;function isAChildOf(_parent,_child)
{if(_parent==_child){return false;}
while(_child&&_child!==_parent){_child=_child.parentNode;}
return _child===_parent;}
function findAncestor(el,class_name)
{if(!el)return el;if(el.classList.contains(class_name)){return el;}
while((el=el.parentElement)&&!el.classList.contains(class_name));return el;}
function showRightBlockContainer(showRightBlock){if(showRightBlock)
nav_blocks_container.style.display='block';else{nav_blocks_container.style.display='none';}
if(!menu_selected){menu_selected=true;nav_menu.classList.add("selected");nav_container.style.height=(nav_menu.getHeight()+1)+'px';}}
function hideRightBlockContainer(){if(menu_selected){hideAdvanced();nav_blocks_container.style.display='none';menu_selected=false;nav_menu.classList.remove("selected");}}
function selectMenuItem(item){var condition=(typeof(item.block)=='undefined'||item.block==null);var showRightBlock=true;if(condition){showRightBlock=false;}
showRightBlockContainer(showRightBlock);hideSelectedMenuItem();item.li.addClassName('over');if(!condition){megaMenu_showImage(item.block);item.block.style.display='block';}
if(item.block){jQuery(item.block.parentElement).height();}
if(show_advanced&&!item.li.hasClassName('advanced')){hideAdvanced();}
selected_menu_item=item;setTimeout(function(){selected_menu_link=item;},100);}
function hideSelectedMenuItem()
{if(selected_menu_item){selected_menu_item.li.removeClassName('over');var condition=(typeof(selected_menu_item.block)=='undefined'||selected_menu_item.block==null)
if(!condition)
selected_menu_item.block.style.display='none';selected_menu_item=undefined;}}
function isSelectedMenu(item){return selected_menu_item===item;}
function isAllowedToClick(item){return selected_menu_link===item;}
function showAdvanced(){if(links){links.each(function(link,index){var menu_item=$(link);if(menu_item.li.hasClassName('advanced')){menu_item.li.show();}});show_advanced_button.hide();show_advanced=true;nav_container.style.height=(nav_menu.getHeight()+1)+'px';}}
function hideAdvanced(){if(links){var exist=false;links.each(function(link,index){var menu_item=$(link);if(menu_item.li.hasClassName('advanced')){menu_item.li.hide();exist=true;}});if(exist){show_advanced_button.show();nav_container.style.height=(nav_menu.getHeight()+1)+'px';}
show_advanced=false;}}
if(nav_container){nav_container.observe('mouseout',function(e){if(e.relatedTarget&&e.relatedTarget!=nav_container&&!isAChildOf(nav_container,e.relatedTarget)){hideSelectedMenuItem();hideRightBlockContainer();}});}
function megaMenu_showImage(div){try{if(div){var imgs=div.select('img');imgs.each(function(img){var src=img.getAttribute('data-src');if(src){img.setAttribute('src',src);img.removeAttribute('data-src');}});}}catch(e){console.log('before switch, exception occures : '+e);}}
var menu_count=links.length;if(links){links.each(function(link,index){var menu_item=$(link);if(typeof(menu_item.onclick())!='undefined')
menu_item.block=$(menu_item.onclick().id);menu_item.li=menu_item.up('li');if(menu_count>17&&index>15){menu_item.li.addClassName('advanced');}
if(isHomePage()==true){megaMenu_showImage(menu_item.block);}
link.observe('click',function(event){if(!isSelectedMenu(menu_item)){selectMenuItem(menu_item);event.preventDefault();}else{if(!isAllowedToClick(menu_item)){event.preventDefault();}}});link.observe('mousemove',function(event){if(!menu_selected){selectMenuItem(menu_item);return;}
var Ax,A1x,Bx,Cx,Ay,A1y,By,Cy;A1x=event.pageX;A1y=event.pageY;if(previousX||previousY){if(Math.abs(previousX-A1x)<10&&Math.abs(previousY-A1y)<10){return;}
Ax=previousX;Ay=previousY;var offset=jQuery(nav_container).offset();var height=jQuery(nav_container).outerHeight();var width=jQuery(nav_menu).outerWidth();Bx=offset.left+width;By=offset.top;Cx=offset.left+width;Cy=offset.top+height+(height/4);if(isShowMenuBlock(Ax,A1x,Bx,Cx,Ay,A1y,By,Cy)){selectMenuItem(menu_item);}}
previousX=A1x;previousY=A1y;});});}
hideAdvanced();if(show_advanced_button){show_advanced_button.observe('mouseenter',function(e){show_advanced_button.addClassName('over');showAdvanced();});show_advanced_button.observe('mouseleave',function(e){show_advanced_button.removeClassName('over');});}
function isShowMenuBlock(Ax,A1x,Bx,Cx,Ay,A1y,By,Cy){var cosA,cosB,cosC;var isShow=false;if(A1x<Ax){return isShow=true;}
cosA=(Ay-A1y)/Math.sqrt(Math.pow((Ax-A1x),2)+Math.pow((Ay-A1y),2));if(!isNaN(cosA)){if(cosA>=0){cosB=(Ay-By)/Math.sqrt(Math.pow((Ax-Bx),2)+Math.pow((Ay-By),2));if(cosA>=cosB){isShow=true;}};if(cosA<0){cosC=(Ay-Cy)/Math.sqrt(Math.pow((Ax-Cx),2)+Math.pow((Ay-Cy),2));if(cosA<=cosC){isShow=true;};};}else{isShow=false;};return isShow;};};window.globalLightboxZIndexCounter=1500;window.globalOpenedLightboxCounter=0;var Lightbox=Class.create({open:function(){window.document.observe('keydown',this._closeOnEscapeHandler);this._centerWindow(this.container);this.container.fire('lb:beforeopen',this);this.container.style.zIndex=1+(++window.globalLightboxZIndexCounter);this._fade('open',this.container);window.globalOpenedLightboxCounter++;this.container.fire('lb:afteropen',this);window.document.fire('somelb:opened',this);$('bg_fade').observe('click',function(event){this.close();}.bind(this));},observe:function(event,handler){this.container.observe(event,handler);},stopObserving:function(event,handler){this.container.stopObserving(event,handler);},closeObserver:null,close:function(dontFade){window.globalOpenedLightboxCounter--;window.document.stopObserving('keydown',this._closeOnEscapeHandler);allo.dontbuyit=false;window.cantbuythis=false;this.container.fire('lb:beforeclose',this);this._fade('close',this.container,dontFade);this.container.fire('lb:afterclose',this);$('bg_fade').stopObserving('click');if(this.closeObserver){this.closeObserver();}},_fade:function fadeBg(userAction,whichDiv,dontFade){if(userAction=='close'){if(window.globalOpenedLightboxCounter==0){if(typeof dontFade=='undefined')
new Effect.Fade(this.bgFade,{duration:.5,from:0.4,to:0,afterFinish:this._makeInvisible.bind(this),afterUpdate:this._hideLayer(whichDiv)});else
this._hideLayer(whichDiv);}else{this._hideLayer(whichDiv);}}else{if(this.bgFade.style.visibility=="visible")
this._showLayer(whichDiv);else
new Effect.Appear(this.bgFade,{duration:.5,from:0,to:0.4,beforeUpdate:this._makeVisible.bind(this),afterFinish:this._showLayer(whichDiv)});}},_makeVisible:function makeVisible(){this.bgFade.style.visibility="visible";this.bgFade.style.zIndex="299";},_makeInvisible:function makeInvisible(){this.bgFade.style.visibility="hidden";},_showLayer:function showLayer(userAction){var elem=$(userAction);if(elem)
elem.style.display="block";},_hideLayer:function hideLayer(userAction){var elem=$(userAction);if(elem)
elem.style.display="none";},_centerWindow:function centerWindow(element){var windowHeight=parseFloat($(element).getHeight())/2;var windowWidth=parseFloat($(element).getWidth())/2;var scrollTop=self.pageYOffset||(document.documentElement&&document.documentElement.scrollTop)||(document.body&&document.body.scrollTop);if(typeof window.innerHeight!='undefined'){$(element).style.top=Math.round(document.body.offsetTop+((window.innerHeight-$(element).getHeight()))/2)+'px';$(element).style.left=Math.round(document.body.offsetLeft+((window.innerWidth-$(element).getWidth()))/2)+'px';}else{$(element).style.top=Math.round(document.body.offsetTop+((document.documentElement.offsetHeight-$(element).getHeight()))/2)+'px';$(element).style.left=Math.round(document.body.offsetLeft+((document.documentElement.offsetWidth-$(element).getWidth()))/2)+'px';}
h=(window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight));$(element).style.top=Math.round(scrollTop+h/2-windowHeight)+'px';if(parseInt($(element).style.top)<50)
$(element).style.top='50px';},_closeOnEscape:function(event){if(event.keyCode==27)
{this.close()}},initialize:function(containerDiv){this.container=containerDiv;if(this.container)
this.container.style.zIndex=1+(++window.globalLightboxZIndexCounter);this._hideLayer(this.container);this._closeOnEscapeHandler=this._closeOnEscape.bind(this);var bgFade=$('bg_fade');if(!bgFade){bgFade=$(document.createElement('div'));bgFade.id='bg_fade';bgFade.addClassName('bg-fade');if(Prototype.Browser.IE){bgFade.addClassName('class','bg-fade');}
document.body.insertBefore(bgFade,document.body.firstChild);}
this.bgFade=bgFade;$(document.body).insert({top:this.container});if(this.container&&this.container.select('.lb-close')){this.container.select('.lb-close').each(function(th){th.observe('click',function(){this.close();}.bind(this));}.bind(this));}}});var TemplateLightbox=Class.create(Lightbox,{initialize:function($super,template,evalParams){var inner=new Template(template.innerHTML).evaluate(evalParams);;var containerDiv=new Element('div',{'class':'lightbox'}).update(inner);$(document.body).insert({'top':containerDiv});$super(containerDiv);this.container=containerDiv;if(Prototype.Browser.IE){containerDiv.addClassName('lightbox');}
this.content=containerDiv.down('.lb-content');if(evalParams.cssClass){containerDiv.addClassName(evalParams.cssClass);}}});var AjaxLightbox=Class.create(TemplateLightbox,{initialize:function($super,template,params){this.loaded=false;this.params=params;$super(template,params);},open:function($super){if(!this.loaded){this.load();}else{var email=jQuery('.login-menu .login-form-container #email').val();if(!email){email=jQuery('form .form-list #email').val();}
if(!email){email=jQuery('.account-login #email').val();}
if(!email){email=jQuery('#email-popup').val();}
jQuery('.lb-content .forgot-password #email_address_forgot_pass').val(email);}
$super();},load:function(){var self=this;var parameters=(this.params.parameters)?this.params.parameters:{"just_for_post":1};this.container.addClassName('loading');if(this.params.href){new Ajax.Request(this.params.href,{method:'post',parameters:parameters,onComplete:function(transport){self.content.update(transport.responseText);self.container.removeClassName('loading');if(self.params.callback){self.params.callback(self);}
self.loaded=true;self._centerWindow(self.container);}});}}});;function reflow(){$$('body')[0].addClassName('reflow');$$('body')[0].removeClassName('reflow');}
LinkFolder=Class.create({initialize:function(ul,seeAllText,lCount,beginCount){this.items=ul.select('li');if(beginCount)
if(this.items.length<=beginCount)return false;if(this.items.length<=lCount)return false;this.link=this.appendLink(ul,seeAllText);this.setClasses(lCount);this.observeLink(this.link,this.foldLinks);},appendLink:function(ul,seeAllText){var seeAll=new Element('li').appendChild(new Element('a',{'class':'blue-link normal',href:'javascript:;'}).update('<span>'+seeAllText+'</span>'));ul.insert({bottom:seeAll});return seeAll;},setClasses:function(count){var items=this.items;this.foldLinks=[];if(count<items.length){for(var i=count;i<items.length;i++){if(!items[i].hasClassName('active')){items[i].addClassName('no-display');this.foldLinks.push(items[i]);}}}},observeLink:function(seeAll,links){seeAll.observe('click',function(){links.each(function(th){th.removeClassName('no-display');});seeAll.remove();});},reset:function(){if(this.link){this.link.remove();}
this.items.invoke('removeClassName','no-display');}});BrandFolder=Class.create(LinkFolder,{observeLink:function(seeAll,links){seeAll.observe('click',function(){links.each(function(th){th.removeClassName('no-display');});this.sortAlphabetically(this.items);}.bind(this));},reset:function(){if(this.link&&this.link.parentNode){this.link.remove();}
this.items.invoke('removeClassName','no-display');},sortAlphabetically:function(links){if(!links||!links.length)return;var ul=links[0].up();var sortData=[];var sortKeys=[];for(var index=0;index<links.length;index++){var link=links[index].down('a');if(!link)continue;var text=link.getInnerText();text=text.replace(/\(\d+\)/i,'');if(text)text=text.trim();sortData[text]=links[index];sortKeys.push(text);}
if(!sortKeys.length)return;sortKeys.sort(function(a,b){if(a<b)
return-1;else if(a>b)
return 1;return 0;});if(!ul)return;ul.innerHTML='';for(var index=0;index<sortKeys.length;index++){ul.appendChild(sortData[sortKeys[index]]);}}});Ajax.Request.prototype.respondToReadyState=function(readyState){var state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);if(response.transport.readyState==4){if(response.getResponseHeader('Login-Required')=='true'){window.location.reload();return;}}
if(state=='Complete'){try{this._complete=true;(this.options['on'+response.status]||this.options['on'+(this.success()?'Success':'Failure')]||Prototype.emptyFunction)(response,response.headerJSON);}catch(e){this.dispatchException(e);}
var contentType=response.getHeader('Content-type');if(this.options.evalJS=='force'||(this.options.evalJS&&this.isSameOrigin()&&contentType&&contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i)))
this.evalResponse();}
try{(this.options['on'+state]||Prototype.emptyFunction)(response,response.headerJSON);Ajax.Responders.dispatch('on'+state,this,response,response.headerJSON);}catch(e){this.dispatchException(e);}
if(state=='Complete'){this.transport.onreadystatechange=Prototype.emptyFunction;}};var lazierLoadAutoHook=true;var lazierLoadDefaultOptions={treshold:100,extensions:['gif','png','jpg','jpeg'],minWidth:100,minHeight:100}
if(!JS_BRAMUS){var JS_BRAMUS=new Object();}
JS_BRAMUS.lazierLoad=Class.create();JS_BRAMUS.lazierLoad.prototype={initialize:function(options){this.rubberSlide=$('rubberSlide');this.rubberSlideImg=$$('#rubberSlide img');if(this.rubberSlide){this.rubberSlideImg.each(function(image,i){if(i>0){new JS_BRAMUS.lazierLoadImage(image,options);}});}}}
JS_BRAMUS.lazierLoadImage=Class.create();JS_BRAMUS.lazierLoadImage.prototype={options:null,element:null,loading:false,loaded:false,position:null,lazyScroller:null,initialize:function(image,options){this.options=Object.clone(lazierLoadDefaultOptions);Object.extend(this.options,options||{});this.element=image;this.element.origSrc=this.element.src;this.element.fileName=this.element.origSrc.substring(this.element.origSrc.lastIndexOf('/')+1,this.element.origSrc.length);this.element.fileType=this.element.fileName.substring(this.element.fileName.lastIndexOf('.')+1,this.element.fileName.length);this.element.src='';this.lazyScroller=this.lazyScroll.bindAsEventListener(this);Event.observe(window,'load',this.lazyScroller.bind(this),false);},lazyScroll:function(){this.loading=true;var newImage=null;newImage=new Image();newImage.src=this.element.origSrc;if(newImage.complete){this.element.src=newImage.src;this.loaded=true;}else{newImage.onload=function(){this.element.src=newImage.src;this.loaded=true;}.bind(this);}}}
if(lazierLoadAutoHook==true){if((!Prototype.Browser.IE)){if(navigator.userAgent.indexOf('KHTML')===-1){function initLazierLoad(){myLL=new JS_BRAMUS.lazierLoad();}
Event.observe(document,'dom:loaded',initLazierLoad,false);}}};allo.auth_tabs=function(container)
{var table=container.select('table').first();var headers=table.select('div');var bodys=container.select('div.container');var counter=0;headers.each(function(element){var index=counter;element.observe('click',function(e){var src=this;headers.each(function(item){item.removeClassName('active');});src.addClassName('active');bodys.each(function(item){item.hide();});bodys[index].show();});counter++;});};UI.Tab=Class.create({element:null,tabGroup:null,currentSelectGroup:0,options:{tabWrapper:'.tab-wrapper',tabItem:'div',slideWrapper:'.slide-wrapper',slideItem:'div'},initialize:function(element,option){this.element=element;this.options=$H(this.options).merge(option).toObject();this.tabGroup=this._createGroup();if(this.tabGroup.length)
this.currentSelectGroup=this.tabGroup[0];this.observeTabs(this.tabGroup);},_createGroup:function(){var tabWrapper=this.element.select(this.options.tabWrapper).first();var slideWrapper=this.element.select(this.options.slideWrapper).first();var tabs=tabWrapper.select(this.options.tabItem);var slides=slideWrapper.select(this.options.slideItem);var tabGroup=[];for(var i=0;i<tabs.length;i++){var group={};group.tab=tabs[i];group.slide=slides[i];group.index=i;tabGroup.push(group);}
return tabGroup;},observeTabs:function(tabGroup)
{$this=this;tabGroup.each(function(item){var tmp=item;item.tab.observe('click',function(e){e.stop();if(window&&window.event)
window.event.returnValue=false;var current=this.getSelectGroup();this._switch(current,tmp);}.bind($this));});},_switch:function(oldGroup,newGroup){if(oldGroup.index==newGroup.index)
return;this.toggleTab(oldGroup.tab,0);this._toggleSlide(oldGroup.slide,0);this._toggleSlide(newGroup.slide,1);this.toggleTab(newGroup.tab,1);this.currentSelectGroup=newGroup;},toggleTab:function(tab,direction){tab.toggleClassName('active');allo.stripNames();},_toggleSlide:function(slide,direction){slide.toggle();},getSelectGroup:function()
{return this.currentSelectGroup;}});UI.TabSlider=Class.create(UI.Tab,{isAnimate:0,sliderOptions:{duration:0.5,effectName:'Fade'},initialize:function($super,element,option){this.sliderOptions=$H(this.sliderOptions).merge(option.slider).toObject();$super(element,option);},_toggleSlide:function(slide,direction){var effectOption={duration:this.sliderOptions.duration,afterFinish:function(){$this.isAnimate--;}};if(direction)
{effectOption.from=0;effectOption.to=1;}
else
{effectOption.from=1;effectOption.to=0;}
$this=this;slide.setStyle({visibility:effectOption.from,display:'block'});Effect[this.sliderOptions.effectName](slide,effectOption);},_switch:function($super,oldGroup,newGroup){if(this.isAnimate&&oldGroup.index==newGroup.index)
return;this.isAnimate=2;$super(oldGroup,newGroup);}});;UI.CarouselTab=Class.create(UI.Tab,{initialize:function($super,element,option){option=$H({carouselItem:'li',minSlideCount:0,naviganionButton:'a'}).merge(option).toObject();$super($(element),option);var curentSelectGroup=this.getSelectGroup();this._createCarousel(curentSelectGroup);},_switch:function($super,oldGroup,newGroup){$super(oldGroup,newGroup);var curentSelectGroup=this.getSelectGroup();if(!curentSelectGroup.carousel)
this._createCarousel(curentSelectGroup);},_createGroup:function($super){var slides=this.element.select(this.options.slideItem);if(slides.length==0)
return $super();var tabWrapper=this.element.select(this.options.tabWrapper).first();var tabs=tabWrapper.select(this.options.tabItem);var tabGroup=[];for(var i=0;i<tabs.length;i++){var group={};group.tab=tabs[i];group.slide=slides[i];group.index=i;tabGroup.push(group);}
return tabGroup;},_createCarousel:function(group){var items=group.slide.select(this.options.carouselItem);if(items.length>this.options.minSlideCount){var carousel=new UI.CarouselLazyImage(group.slide.id);group.carousel=carousel;}
else{var carousel=new UI.CarouselLazyImage(group.slide.id);$$('#'+group.slide.id+' > a ').each(function(a){a.setStyle({visibility:'hidden'});})}}});UI.CarouselLazyImage=Class.create(UI.Carousel,{initialize:function($super,element,options){$super(element,options);this.printImage(this.currentIndex());},scroll:function($super,deltaPixel,force){var pImage=function(){var direction=deltaPixel<0?1:-1;var currentIndex=this.currentIndex();var newIndex=Math.abs((deltaPixel+this.currentPosition())/this.elementSize);this.printImage(newIndex);}.bind(this);if(!force||(force&&typeof force!='boolean')){$super(deltaPixel);if(this.animating){pImage();}
return;}
if(this.options.beforeScroll)
{this.options.beforeScroll(this,deltaPixel);}
if(this.animating)
return this;var position=this.currentPosition()+deltaPixel;position=this.checkScroll(position,false);deltaPixel=position-this.currentPosition();if(deltaPixel!=0){this.animating=true;this.fire("scroll:started");pImage();var that=this;var css={};css[that.posAttribute]=position+"px";that.container.setStyle(css);that.animating=false;that.updateButtons().fire("scroll:ended",{shift:deltaPixel/that.currentSize()});}},scrollTo:function($super,index,force){if(this.animating||index<0||index>this.elements.length||index==this.currentIndex()||isNaN(parseInt(index)))
return this;return this.scroll((this.currentIndex()-index)*this.elementSize,force);},printImage:function(index){this.elements.some(function(element,b){if(b>=index&&b<=(this.nbVisible+index-1)){var img=element.select('img[data-src]').first();if(img){var url=img.readAttribute('data-src');img.removeAttribute('data-src');img.setAttribute('src',url);}}},this);}});;function acc_openInfoItemEditor(root_id){acc_cancelInfoItem('firstname');acc_cancelInfoItem('email');acc_cancelInfoItem('telephone');var td=$('edit-'+root_id);td.select('div.value-text').each(function(el){el.removeClassName('show')
el.addClassName('hide')});td.select('div.value-editor').each(function(el){el.removeClassName('hide')
el.addClassName('show')});td.select('div.value-buttons').each(function(el){el.removeClassName('hide')
el.addClassName('show')});td.select('div.value-editor input').each(function(el){el.focus();});return false;}
function acc_saveInfoItem(e,root_id,form,url){if(form&&form.validator.validate())
{var form_data=$(form.form.id).serialize(true);new Ajax.Request(url,{method:'post',asynchronous:true,evalScripts:false,onComplete:function(response,data){if(200!=response.status){alert(Translator.translate('The request failed'));acc_cancelInfoItem(root_id);}
var overlay=$('info-item-edit-overlay-'+root_id);if(overlay)
overlay.remove();},onSuccess:function(response){var data=response.responseJSON;if(data)
{if(data.result=='success')
{var td=$('edit-'+root_id);$(root_id+'_old').setValue(data.data);$(root_id).setValue(data.data);td.select('div.value-text span').each(function(el){el.update(data.text)});acc_cancelInfoItem(root_id);}
else{alert(Translator.translate('Mistake  ')+data.error);acc_cancelInfoItem(root_id);}}
else{alert(Translator.translate('The request failed'));acc_cancelInfoItem(root_id);}},onLoading:function(request,data){var td=$('edit-'+root_id);var overlay=new Element('div',{'id':'info-item-edit-overlay-'+root_id,'class':'navigation-overlay','style':'width: '+td.getWidth()+'px; height: '+td.getHeight()+'px;'});td.insert({top:overlay});overlay.show();},parameters:form_data});}}
function acc_cancelInfoItem(root_id){var td=$('edit-'+root_id);var val=$(root_id+'_old').getValue();$(root_id).setValue(val);$(root_id).removeClassName('validation-failed');td.select('div.value-editor div.validation-advice').each(function(el){el.hide();});td.select('div.value-text').each(function(el){el.removeClassName('hide')
el.addClassName('show')});td.select('div.value-editor').each(function(el){el.removeClassName('show')
el.addClassName('hide')});td.select('div.value-buttons').each(function(el){el.removeClassName('show')
el.addClassName('hide')});return false;}
function updatElement(element){var value='';for(var i=0;i<element.childElements().length;i++){value=value+element.childElements()[i].textContent;}
$('address_city').value=value;$('address_city_value').value=element.readAttribute('rel');Validation.validate($('address_city'));Validation.validate($('address_city_value'));}
function acc_openAddressEditor(form_url,address_id,autocomplete_url){new Ajax.Request(form_url,{method:'post',asynchronous:true,evalScripts:true,onComplete:function(response,data){},onSuccess:function(response){var data=response.responseText;if(data)
{acc_cancelAddressEditor();var tab=$('address-'+address_id);if(address_id){tab.insert({after:data});}
else{tab.insert({before:data});tab.hide();}
var _elementLoaded=$('address_city_suggest');new Autocomplete.Extend.Autocompleter($('address_city'),_elementLoaded,autocomplete_url,{paramName:'name',method:'get',minChars:2,onSuccess:function(resp){_elementLoaded.innerHTML=resp.responseText;var list=$$('#address_city_suggest li');if($$('#address_city_suggest li.active span.complete-value').first().innerHTML==''&&list.length==2){updatElement($$('#address_city_suggest li.active').first());resp.responseText='';$('address_city_loader').hide();}},updateElement:function(element){updatElement(element);},indicator:$('address_city_loader')});var formAddrEdit=new VarienForm('form-addr-edit',true);var fff=$('form-addr-edit');new Event.observe('form-addr-edit','submit',(function(e,form,address_id){e.stop();Event.stop(e);acc_saveAddress(e,form,address_id);}).bindAsEventListener(this,formAddrEdit,address_id));}
else{alert(Translator.translate('The request failed'));}},onLoading:function(request,data){}});}
function acc_saveAddress(e,form,addr_id)
{if(form&&form.validator.validate())
{var form_data=$(form.form.id).serialize(true);var form_url=$(form.form.id).action;var td=$('address-editor').up().up();var overlay=new Element('div',{'id':'address-edit-overlay','class':'navigation-overlay','style':'width: '+td.getWidth()+'px; height: '+(td.getHeight()-15)+'px;'});td.insert({top:overlay});overlay.show();new Ajax.Request(form_url,{method:'post',asynchronous:true,evalScripts:false,onComplete:function(response,data){if(200!=response.status){alert(Translator.translate('The request failed'));}
var overlay=$('address-edit-overlay');if(overlay)
overlay.remove();},onSuccess:function(response){var data=response.responseJSON;if(data)
{if(data.action=='success')
{var addrSect=$('customerAddressBook');addrSect.replace(data.block);}
else{alert(Translator.translate('Mistake  ')+data.message);}}
else{}},parameters:form_data});}}
function acc_cancelAddressEditor()
{var open_editor=$('address-editor');if(open_editor&&open_editor.up()&&open_editor.up().up())
open_editor.up().up().remove();$('address-0').show();};!function(t){var e={},s={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){},onSliderResize:function(){}};t.fn.bxSlider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){t(this).bxSlider(n)}),this;var o={},r=this;e.el=this;var a=t(window).width(),l=t(window).height(),d=function(){o.settings=t.extend({},s,n),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=r.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in e)if(void 0!==t.style[e[i]])return o.cssPrefix=e[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),r.data("origStyle",r.attr("style")),r.children(o.settings.slideSelector).each(function(){t(this).data("origStyle",t(this).attr("style"))}),c()},c=function(){r.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),o.viewport=r.parent(),o.loader=t('<div class="bx-loading" />'),o.viewport.prepend(o.loader),r.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing"),f(),o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:p()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",u()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:o.settings.slideZIndex,display:"block"})),o.controls.el=t('<div class="bx-controls" />'),o.settings.captions&&P(),o.active.last=o.settings.startSlide==x()-1,o.settings.video&&r.fitVids();var e=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(e=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&T(),o.settings.controls&&C(),o.settings.auto&&o.settings.autoControls&&E(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),g(e,h)},g=function(e,i){var s=e.find("img, iframe").length;if(0==s)return i(),void 0;var n=0;e.find("img, iframe").each(function(){t(this).one("load",function(){++n==s&&i()}).each(function(){this.complete&&t(this).load()})})},h=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var e="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,e).clone().addClass("bx-clone"),s=o.children.slice(-e).clone().addClass("bx-clone");r.append(i).prepend(s)}o.loader.remove(),S(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(v()),r.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&t(window).bind("resize",Z),o.settings.auto&&o.settings.autoStart&&H(),o.settings.ticker&&L(),o.settings.pager&&q(o.settings.startSlide),o.settings.controls&&W(),o.settings.touchEnabled&&!o.settings.ticker&&O()},v=function(){var e=0,s=t();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var n=1==o.settings.moveSlides?o.active.index:o.active.index*m();for(s=o.children.eq(n),i=1;i<=o.settings.maxSlides-1;i++)s=n+i>=o.children.length?s.add(o.children.eq(i-1)):s.add(o.children.eq(n+i))}else s=o.children.eq(o.active.index);else s=o.children;return"vertical"==o.settings.mode?(s.each(function(){e+=t(this).outerHeight()}),o.settings.slideMargin>0&&(e+=o.settings.slideMargin*(o.settings.minSlides-1))):e=Math.max.apply(Math,s.map(function(){return t(this).outerHeight(!1)}).get()),e},p=function(){var t="100%";return o.settings.slideWidth>0&&(t="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),t},u=function(){var t=o.settings.slideWidth,e=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>e&&!o.carousel||"vertical"==o.settings.mode?t=e:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(e>o.maxThreshold||e<o.minThreshold&&(t=(e-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),t},f=function(){var t=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)t=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)t=o.settings.maxSlides;else{var e=o.children.first().width();t=Math.floor(o.viewport.width()/e)}else"vertical"==o.settings.mode&&(t=o.settings.minSlides);return t},x=function(){var t=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)t=o.children.length/m();else for(var e=0,i=0;e<o.children.length;)++t,e=i+f(),i+=o.settings.moveSlides<=f()?o.settings.moveSlides:f();else t=Math.ceil(o.children.length/f());return t},m=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=f()?o.settings.moveSlides:f()},S=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var t=o.children.last(),e=t.position();b(-(e.left-(o.viewport.width()-t.width())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,e=o.children.eq(i).position();b(-e.top,"reset",0)}}else{var e=o.children.eq(o.active.index*m()).position();o.active.index==x()-1&&(o.active.last=!0),void 0!=e&&("horizontal"==o.settings.mode?b(-e.left,"reset",0):"vertical"==o.settings.mode&&b(-e.top,"reset",0))}},b=function(t,e,i,s){if(o.usingCSS){var n="vertical"==o.settings.mode?"translate3d(0, "+t+"px, 0)":"translate3d("+t+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==e?(r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),D()})):"reset"==e?r.css(o.animProp,n):"ticker"==e&&(r.css("-"+o.cssPrefix+"-transition-timing-function","linear"),r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),b(s.resetValue,"reset",0),N()}))}else{var a={};a[o.animProp]=t,"slide"==e?r.animate(a,i,o.settings.easing,function(){D()}):"reset"==e?r.css(o.animProp,t):"ticker"==e&&r.animate(a,speed,"linear",function(){b(s.resetValue,"reset",0),N()})}},w=function(){for(var e="",i=x(),s=0;i>s;s++){var n="";o.settings.buildPager&&t.isFunction(o.settings.buildPager)?(n=o.settings.buildPager(s),o.pagerEl.addClass("bx-custom-pager")):(n=s+1,o.pagerEl.addClass("bx-default-pager")),e+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}o.pagerEl.html(e)},T=function(){o.settings.pagerCustom?o.pagerEl=t(o.settings.pagerCustom):(o.pagerEl=t('<div class="bx-pager" />'),o.settings.pagerSelector?t(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),w()),o.pagerEl.on("click","a",I)},C=function(){o.controls.next=t('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=t('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",y),o.controls.prev.bind("click",z),o.settings.nextSelector&&t(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&t(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=t('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},E=function(){o.controls.start=t('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=t('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=t('<div class="bx-controls-auto" />'),o.controls.autoEl.on("click",".bx-start",k),o.controls.autoEl.on("click",".bx-stop",M),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?t(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),A(o.settings.autoStart?"stop":"start")},P=function(){o.children.each(function(){var e=t(this).find("img:first").attr("title");void 0!=e&&(""+e).length&&t(this).append('<div class="bx-caption"><span>'+e+"</span></div>")})},y=function(t){o.settings.auto&&r.stopAuto(),r.goToNextSlide(),t.preventDefault()},z=function(t){o.settings.auto&&r.stopAuto(),r.goToPrevSlide(),t.preventDefault()},k=function(t){r.startAuto(),t.preventDefault()},M=function(t){r.stopAuto(),t.preventDefault()},I=function(e){o.settings.auto&&r.stopAuto();var i=t(e.currentTarget),s=parseInt(i.attr("data-slide-index"));s!=o.active.index&&r.goToSlide(s),e.preventDefault()},q=function(e){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),o.pagerEl.html(e+1+o.settings.pagerShortSeparator+i),void 0):(o.pagerEl.find("a").removeClass("active"),o.pagerEl.each(function(i,s){t(s).find("a").eq(e).addClass("active")}),void 0)},D=function(){if(o.settings.infiniteLoop){var t="";0==o.active.index?t=o.children.eq(0).position():o.active.index==x()-1&&o.carousel?t=o.children.eq((x()-1)*m()).position():o.active.index==o.children.length-1&&(t=o.children.eq(o.children.length-1).position()),t&&("horizontal"==o.settings.mode?b(-t.left,"reset",0):"vertical"==o.settings.mode&&b(-t.top,"reset",0))}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},A=function(t){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[t]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},W=function(){1==x()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==x()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},H=function(){o.settings.autoDelay>0?setTimeout(r.startAuto,o.settings.autoDelay):r.startAuto(),o.settings.autoHover&&r.hover(function(){o.interval&&(r.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(r.startAuto(!0),o.autoPaused=null)})},L=function(){var e=0;if("next"==o.settings.autoDirection)r.append(o.children.clone().addClass("bx-clone"));else{r.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();e="horizontal"==o.settings.mode?-i.left:-i.top}b(e,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){r.stop()},function(){var e=0;o.children.each(function(){e+="horizontal"==o.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)});var i=o.settings.speed/e,s="horizontal"==o.settings.mode?"left":"top",n=i*(e-Math.abs(parseInt(r.css(s))));N(n)}),N()},N=function(t){speed=t?t:o.settings.speed;var e={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?e=r.find(".bx-clone").first().position():i=o.children.first().position();var s="horizontal"==o.settings.mode?-e.left:-e.top,n="horizontal"==o.settings.mode?-i.left:-i.top,a={resetValue:n};b(s,"ticker",speed,a)},O=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",X)},X=function(t){if(o.working)t.preventDefault();else{o.touch.originalPos=r.position();var e=t.originalEvent;o.touch.start.x=e.changedTouches[0].pageX,o.touch.start.y=e.changedTouches[0].pageY,o.viewport.bind("touchmove",Y),o.viewport.bind("touchend",V)}},Y=function(t){var e=t.originalEvent,i=Math.abs(e.changedTouches[0].pageX-o.touch.start.x),s=Math.abs(e.changedTouches[0].pageY-o.touch.start.y);if(3*i>s&&o.settings.preventDefaultSwipeX?t.preventDefault():3*s>i&&o.settings.preventDefaultSwipeY&&t.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var n=0;if("horizontal"==o.settings.mode){var r=e.changedTouches[0].pageX-o.touch.start.x;n=o.touch.originalPos.left+r}else{var r=e.changedTouches[0].pageY-o.touch.start.y;n=o.touch.originalPos.top+r}b(n,"reset",0)}},V=function(t){o.viewport.unbind("touchmove",Y);var e=t.originalEvent,i=0;if(o.touch.end.x=e.changedTouches[0].pageX,o.touch.end.y=e.changedTouches[0].pageY,"fade"==o.settings.mode){var s=Math.abs(o.touch.start.x-o.touch.end.x);s>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto())}else{var s=0;"horizontal"==o.settings.mode?(s=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(s=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&s>0||o.active.last&&0>s)?b(i,"reset",200):Math.abs(s)>=o.settings.swipeThreshold?(0>s?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto()):b(i,"reset",200)}o.viewport.unbind("touchend",V)},Z=function(){var e=t(window).width(),i=t(window).height();(a!=e||l!=i)&&(a=e,l=i,r.redrawSlider(),o.settings.onSliderResize.call(r,o.active.index))};return r.goToSlide=function(e,i){if(!o.working&&o.active.index!=e)if(o.working=!0,o.oldIndex=o.active.index,o.active.index=0>e?x()-1:e>=x()?0:e,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=x()-1,o.settings.pager&&q(o.active.index),o.settings.controls&&W(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=v()&&o.viewport.animate({height:v()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",o.settings.slideZIndex+1).fadeIn(o.settings.speed,function(){t(this).css("zIndex",o.settings.slideZIndex),D()});else{o.settings.adaptiveHeight&&o.viewport.height()!=v()&&o.viewport.animate({height:v()},o.settings.adaptiveHeightSpeed);var s=0,n={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var a=o.children.eq(o.children.length-1);n=a.position(),s=o.viewport.width()-a.outerWidth()}else{var l=o.children.length-o.settings.minSlides;n=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var d=1==o.settings.moveSlides?o.settings.maxSlides-m():(x()-1)*m()-(o.children.length-o.settings.maxSlides),a=r.children(".bx-clone").eq(d);n=a.position()}else if("next"==i&&0==o.active.index)n=r.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(e>=0){var c=e*m();n=o.children.eq(c).position()}if("undefined"!=typeof n){var g="horizontal"==o.settings.mode?-(n.left-s):-n.top;b(g,"slide",o.settings.speed)}}},r.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var t=parseInt(o.active.index)+1;r.goToSlide(t,"next")}},r.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var t=parseInt(o.active.index)-1;r.goToSlide(t,"prev")}},r.startAuto=function(t){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=t&&A("stop"))},r.stopAuto=function(t){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=t&&A("start"))},r.getCurrentSlide=function(){return o.active.index},r.getCurrentSlideElement=function(){return o.children.eq(o.active.index)},r.getSlideCount=function(){return o.children.length},r.redrawSlider=function(){o.children.add(r.find(".bx-clone")).outerWidth(u()),o.viewport.css("height",v()),o.settings.ticker||S(),o.active.last&&(o.active.index=x()-1),o.active.index>=x()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(w(),q(o.active.index))},r.destroySlider=function(){o.initialized&&(o.initialized=!1,t(".bx-clone",this).remove(),o.children.each(function(){void 0!=t(this).data("origStyle")?t(this).attr("style",t(this).data("origStyle")):t(this).removeAttr("style")}),void 0!=t(this).data("origStyle")?this.attr("style",t(this).data("origStyle")):t(this).removeAttr("style"),t(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.settings.controls&&o.pagerEl.remove(),t(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&t(window).unbind("resize",Z))},r.reloadSlider=function(t){void 0!=t&&(n=t),r.destroySlider(),d()},d(),this}}(jQuery);;(function(t){"use strict";function e(t,e,r){return t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent?t.attachEvent("on"+e,r):void 0}function r(t,e){var r,n;for(r=0,n=t.length;n>r;r++)if(t[r]===e)return!0;return!1}function n(t,e){var r;t.createTextRange?(r=t.createTextRange(),r.move("character",e),r.select()):t.selectionStart&&(t.focus(),t.setSelectionRange(e,e))}function a(t,e){try{return t.type=e,!0}catch(r){return!1}}t.Placeholders={Utils:{addEventListener:e,inArray:r,moveCaret:n,changeType:a}}})(this),function(t){"use strict";function e(){}function r(){try{return document.activeElement}catch(t){}}function n(t,e){var r,n,a=!!e&&t.value!==e,u=t.value===t.getAttribute(k);return(a||u)&&"true"===t.getAttribute(P)?(t.removeAttribute(P),t.value=t.value.replace(t.getAttribute(k),""),t.className=t.className.replace(V,""),n=t.getAttribute(M),parseInt(n,10)>=0&&(t.setAttribute("maxLength",n),t.removeAttribute(M)),r=t.getAttribute(U),r&&(t.type=r),!0):!1}function a(t){var e,r,n=t.getAttribute(k);return""===t.value&&n?(t.setAttribute(P,"true"),t.value=n,t.className+=" "+R,r=t.getAttribute(M),r||(t.setAttribute(M,t.maxLength),t.removeAttribute("maxLength")),e=t.getAttribute(U),e?t.type="text":"password"===t.type&&G.changeType(t,"text")&&t.setAttribute(U,"password"),!0):!1}function u(t,e){var r,n,a,u,i,l,o;if(t&&t.getAttribute(k))e(t);else for(a=t?t.getElementsByTagName("input"):f,u=t?t.getElementsByTagName("textarea"):h,r=a?a.length:0,n=u?u.length:0,o=0,l=r+n;l>o;o++)i=r>o?a[o]:u[o-r],e(i)}function i(t){u(t,n)}function l(t){u(t,a)}function o(t){return function(){b&&t.value===t.getAttribute(k)&&"true"===t.getAttribute(P)?G.moveCaret(t,0):n(t)}}function c(t){return function(){a(t)}}function s(t){return function(e){return A=t.value,"true"===t.getAttribute(P)&&A===t.getAttribute(k)&&G.inArray(C,e.keyCode)?(e.preventDefault&&e.preventDefault(),!1):void 0}}function d(t){return function(){n(t,A),""===t.value&&(t.blur(),G.moveCaret(t,0))}}function g(t){return function(){t===r()&&t.value===t.getAttribute(k)&&"true"===t.getAttribute(P)&&G.moveCaret(t,0)}}function v(t){return function(){i(t)}}function p(t){t.form&&(T=t.form,"string"==typeof T&&(T=document.getElementById(T)),T.getAttribute(D)||(G.addEventListener(T,"submit",v(T)),T.setAttribute(D,"true"))),G.addEventListener(t,"focus",o(t)),G.addEventListener(t,"blur",c(t)),b&&(G.addEventListener(t,"keydown",s(t)),G.addEventListener(t,"keyup",d(t)),G.addEventListener(t,"click",g(t))),t.setAttribute(j,"true"),t.setAttribute(k,x),(b||t!==r())&&a(t)}var f,h,b,m,A,y,E,x,L,T,S,N,w,B=["text","search","url","tel","email","password","number","textarea"],C=[27,33,34,35,36,37,38,39,40,8,46],I="#ccc",R="placeholdersjs",V=RegExp("(?:^|\\s)"+R+"(?!\\S)"),k="data-placeholder-value",P="data-placeholder-active",U="data-placeholder-type",D="data-placeholder-submit",j="data-placeholder-bound",q="data-placeholder-focus",F="data-placeholder-live",M="data-placeholder-maxlength",$=document.createElement("input"),Q=document.getElementsByTagName("head")[0],X=document.documentElement,z=t.Placeholders,G=z.Utils;if(z.nativeSupport=void 0!==$.placeholder,!z.nativeSupport){for(f=document.getElementsByTagName("input"),h=document.getElementsByTagName("textarea"),b="false"===X.getAttribute(q),m="false"!==X.getAttribute(F),y=document.createElement("style"),y.type="text/css",E=document.createTextNode("."+R+" { color:"+I+"; }"),y.styleSheet?y.styleSheet.cssText=E.nodeValue:y.appendChild(E),Q.insertBefore(y,Q.firstChild),w=0,N=f.length+h.length;N>w;w++)S=f.length>w?f[w]:h[w-f.length],x=S.attributes.placeholder,x&&(x=x.nodeValue,x&&G.inArray(B,S.type)&&p(S));L=setInterval(function(){for(w=0,N=f.length+h.length;N>w;w++)S=f.length>w?f[w]:h[w-f.length],x=S.attributes.placeholder,x?(x=x.nodeValue,x&&G.inArray(B,S.type)&&(S.getAttribute(j)||p(S),(x!==S.getAttribute(k)||"password"===S.type&&!S.getAttribute(U))&&("password"===S.type&&!S.getAttribute(U)&&G.changeType(S,"text")&&S.setAttribute(U,"password"),S.value===S.getAttribute(k)&&(S.value=x),S.setAttribute(k,x)))):S.getAttribute(P)&&(n(S),S.removeAttribute(k));m||clearInterval(L)},100)}G.addEventListener(t,"beforeunload",function(){z.disable()}),z.disable=z.nativeSupport?e:i,z.enable=z.nativeSupport?e:l}(this),function(t){"use strict";function e(t,e){return e.getAttribute("data-placeholder-active")?"":t.call(this,e)}var r=t.Element.Methods.getValue,n=t.Element.getValue,a=$F;Placeholders.nativeSupport||($F=function(t){return e.call(this,a,t)},t.Element.getValue=function(t){return e.call(this,n,t)},Element.addMethods(["INPUT","TEXTAREA"],{getValue:function(t){return e.call(this,r,t)}}))}(Form);;!function(){var AbstractChosen,SelectParser,a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};SelectParser=function(){function SelectParser(){this.options_index=0,this.parsed=[]}return SelectParser.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},SelectParser.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:this.escapeExpression(a.label),children:0,disabled:a.disabled,classes:a.className}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},SelectParser.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},SelectParser.prototype.escapeExpression=function(a){var b,c;return null==a||a===!1?"":/[\&\<\>\"\'\`]/.test(a)?(b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/&(?!\w+;)|[\<\>\"\'\`]/g,a.replace(c,function(a){return b[a]||"&amp;"})):a},SelectParser}(),SelectParser.select_to_array=function(a){var b,c,d,e,f;for(c=new SelectParser,f=a.childNodes,d=0,e=f.length;e>d;d++)b=f[d],c.add_node(b);return c.parsed},AbstractChosen=function(){function AbstractChosen(a,b){this.form_field=a,this.options=null!=b?b:{},AbstractChosen.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return AbstractChosen.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},AbstractChosen.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text},AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=!0},AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=!1},AbstractChosen.prototype.input_focus=function(){var a=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},AbstractChosen.prototype.input_blur=function(){var a=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return a.blur_test()},100))},AbstractChosen.prototype.results_option_build=function(a){var b,c,d,e,f;for(b="",f=this.results_data,d=0,e=f.length;e>d;d++)c=f[d],b+=c.group?this.result_add_group(c):this.result_add_option(c),(null!=a?a.first:void 0)&&(c.selected&&this.is_multiple?this.choice_build(c):c.selected&&!this.is_multiple&&this.single_set_selected_text(c.text));return b},AbstractChosen.prototype.result_add_option=function(a){var b,c;return a.search_match?this.include_option_in_results(a)?(b=[],a.disabled||a.selected&&this.is_multiple||b.push("active-result"),!a.disabled||a.selected&&this.is_multiple||b.push("disabled-result"),a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=document.createElement("li"),c.className=b.join(" "),c.style.cssText=a.style,c.setAttribute("data-option-array-index",a.array_index),c.innerHTML=a.search_text,this.outerHTML(c)):"":""},AbstractChosen.prototype.result_add_group=function(a){var b,c;return a.search_match||a.group_match?a.active_options>0?(b=[],b.push("group-result"),a.classes&&b.push(a.classes),c=document.createElement("li"),c.className=b.join(" "),c.innerHTML=a.search_text,this.outerHTML(c)):"":""},AbstractChosen.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing?this.winnow_results():void 0},AbstractChosen.prototype.reset_single_select_options=function(){var a,b,c,d,e;for(d=this.results_data,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.selected?e.push(a.selected=!1):e.push(void 0);return e},AbstractChosen.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},AbstractChosen.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},AbstractChosen.prototype.winnow_results=function(){var a,b,c,d,e,f,g,h,i,j,k,l;for(this.no_results_clear(),d=0,f=this.get_search_text(),a=f.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i=new RegExp(a,"i"),c=this.get_search_regex(a),l=this.results_data,j=0,k=l.length;k>j;j++)b=l[j],b.search_match=!1,e=null,this.include_option_in_results(b)&&(b.group&&(b.group_match=!1,b.active_options=0),null!=b.group_array_index&&this.results_data[b.group_array_index]&&(e=this.results_data[b.group_array_index],0===e.active_options&&e.search_match&&(d+=1),e.active_options+=1),(!b.group||this.group_search)&&(b.search_text=b.group?b.label:b.text,b.search_match=this.search_string_match(b.search_text,c),b.search_match&&!b.group&&(d+=1),b.search_match?(f.length&&(g=b.search_text.search(i),h=b.search_text.substr(0,g+f.length)+"</em>"+b.search_text.substr(g+f.length),b.search_text=h.substr(0,g)+"<em>"+h.substr(g)),null!=e&&(e.group_match=!0)):null!=b.group_array_index&&this.results_data[b.group_array_index].search_match&&(b.search_match=!0)));return this.result_clear_highlight(),1>d&&f.length?(this.update_results_content(""),this.no_results(f)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},AbstractChosen.prototype.get_search_regex=function(a){var b;return b=this.search_contains?"":"^",new RegExp(b+a,"i")},AbstractChosen.prototype.search_string_match=function(a,b){var c,d,e,f;if(b.test(a))return!0;if(this.enable_split_word_search&&(a.indexOf(" ")>=0||0===a.indexOf("["))&&(d=a.replace(/\[|\]/g,"").split(" "),d.length))for(e=0,f=d.length;f>e;e++)if(c=d[e],b.test(c))return!0},AbstractChosen.prototype.choices_count=function(){var a,b,c,d;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,d=this.form_field.options,b=0,c=d.length;c>b;b++)a=d[b],a.selected&&(this.selected_option_count+=1);return this.selected_option_count},AbstractChosen.prototype.choices_click=function(a){return a.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},AbstractChosen.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},AbstractChosen.prototype.clipboard_event_checker=function(){var a=this;return setTimeout(function(){return a.results_search()},50)},AbstractChosen.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},AbstractChosen.prototype.include_option_in_results=function(a){return this.is_multiple&&!this.display_selected_options&&a.selected?!1:!this.display_disabled_options&&a.disabled?!1:a.empty?!1:!0},AbstractChosen.prototype.search_results_touchstart=function(a){return this.touch_started=!0,this.search_results_mouseover(a)},AbstractChosen.prototype.search_results_touchmove=function(a){return this.touch_started=!1,this.search_results_mouseout(a)},AbstractChosen.prototype.search_results_touchend=function(a){return this.touch_started?this.search_results_mouseup(a):void 0},AbstractChosen.prototype.outerHTML=function(a){var b;return a.outerHTML?a.outerHTML:(b=document.createElement("div"),b.appendChild(a),b.innerHTML)},AbstractChosen.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},AbstractChosen.default_multiple_text="Select Some Options",AbstractChosen.default_single_text="Select an Option",AbstractChosen.default_no_result_text="No results match",AbstractChosen}(),this.Chosen=function(b){function Chosen(){return a=Chosen.__super__.constructor.apply(this,arguments)}return c(Chosen,b),Chosen.prototype.setup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field.hasClassName("chosen-rtl")},Chosen.prototype.set_default_values=function(){return Chosen.__super__.set_default_values.call(this),this.single_temp=new Template('<a class="chosen-single chosen-default" tabindex="-1"><span>#{default}</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.multi_temp=new Template('<ul class="chosen-choices"><li class="search-field"><input type="text" value="#{default}" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'),this.no_results_temp=new Template('<li class="no-results">'+this.results_none_found+' "<span>#{terms}</span>"</li>')},Chosen.prototype.set_up_html=function(){var a,b;return a=["chosen-container"],a.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&a.push(this.form_field.className),this.is_rtl&&a.push("chosen-rtl"),b={"class":a.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(b.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=this.is_multiple?new Element("div",b).update(this.multi_temp.evaluate({"default":this.default_text})):new Element("div",b).update(this.single_temp.evaluate({"default":this.default_text})),this.form_field.hide().insert({after:this.container}),this.dropdown=this.container.down("div.chosen-drop"),this.search_field=this.container.down("input"),this.search_results=this.container.down("ul.chosen-results"),this.search_field_scale(),this.search_no_results=this.container.down("li.no-results"),this.is_multiple?(this.search_choices=this.container.down("ul.chosen-choices"),this.search_container=this.container.down("li.search-field")):(this.search_container=this.container.down("div.chosen-search"),this.selected_item=this.container.down(".chosen-single")),this.results_build(),this.set_tab_index(),this.set_label_behavior()},Chosen.prototype.on_ready=function(){return this.form_field.fire("chosen:ready",{chosen:this})},Chosen.prototype.register_observers=function(){var a=this;return this.container.observe("touchstart",function(b){return a.container_mousedown(b)}),this.container.observe("touchend",function(b){return a.container_mouseup(b)}),this.container.observe("mousedown",function(b){return a.container_mousedown(b)}),this.container.observe("mouseup",function(b){return a.container_mouseup(b)}),this.container.observe("mouseenter",function(b){return a.mouse_enter(b)}),this.container.observe("mouseleave",function(b){return a.mouse_leave(b)}),this.search_results.observe("mouseup",function(b){return a.search_results_mouseup(b)}),this.search_results.observe("mouseover",function(b){return a.search_results_mouseover(b)}),this.search_results.observe("mouseout",function(b){return a.search_results_mouseout(b)}),this.search_results.observe("mousewheel",function(b){return a.search_results_mousewheel(b)}),this.search_results.observe("DOMMouseScroll",function(b){return a.search_results_mousewheel(b)}),this.search_results.observe("touchstart",function(b){return a.search_results_touchstart(b)}),this.search_results.observe("touchmove",function(b){return a.search_results_touchmove(b)}),this.search_results.observe("touchend",function(b){return a.search_results_touchend(b)}),this.form_field.observe("chosen:updated",function(b){return a.results_update_field(b)}),this.form_field.observe("chosen:activate",function(b){return a.activate_field(b)}),this.form_field.observe("chosen:open",function(b){return a.container_mousedown(b)}),this.form_field.observe("chosen:close",function(b){return a.input_blur(b)}),this.search_field.observe("blur",function(b){return a.input_blur(b)}),this.search_field.observe("keyup",function(b){return a.keyup_checker(b)}),this.search_field.observe("keydown",function(b){return a.keydown_checker(b)}),this.search_field.observe("focus",function(b){return a.input_focus(b)}),this.search_field.observe("cut",function(b){return a.clipboard_event_checker(b)}),this.search_field.observe("paste",function(b){return a.clipboard_event_checker(b)}),this.is_multiple?this.search_choices.observe("click",function(b){return a.choices_click(b)}):this.container.observe("click",function(a){return a.preventDefault()})},Chosen.prototype.destroy=function(){return this.container.ownerDocument.stopObserving("click",this.click_test_action),this.form_field.stopObserving(),this.container.stopObserving(),this.search_results.stopObserving(),this.search_field.stopObserving(),null!=this.form_field_label&&this.form_field_label.stopObserving(),this.is_multiple?(this.search_choices.stopObserving(),this.container.select(".search-choice-close").each(function(a){return a.stopObserving()})):this.selected_item.stopObserving(),this.search_field.tabIndex&&(this.form_field.tabIndex=this.search_field.tabIndex),this.container.remove(),this.form_field.show()},Chosen.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field.disabled,this.is_disabled?(this.container.addClassName("chosen-disabled"),this.search_field.disabled=!0,this.is_multiple||this.selected_item.stopObserving("focus",this.activate_action),this.close_field()):(this.container.removeClassName("chosen-disabled"),this.search_field.disabled=!1,this.is_multiple?void 0:this.selected_item.observe("focus",this.activate_action))},Chosen.prototype.container_mousedown=function(a){return this.is_disabled||(a&&"mousedown"===a.type&&!this.results_showing&&a.stop(),null!=a&&a.target.hasClassName("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!a||a.target!==this.selected_item&&!a.target.up("a.chosen-single")||this.results_toggle():(this.is_multiple&&this.search_field.clear(),this.container.ownerDocument.observe("click",this.click_test_action),this.results_show()),this.activate_field())},Chosen.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},Chosen.prototype.search_results_mousewheel=function(a){var b;return b=a.deltaY||-a.wheelDelta||a.detail,null!=b?(a.preventDefault(),"DOMMouseScroll"===a.type&&(b=40*b),this.search_results.scrollTop=b+this.search_results.scrollTop):void 0},Chosen.prototype.blur_test=function(){return!this.active_field&&this.container.hasClassName("chosen-container-active")?this.close_field():void 0},Chosen.prototype.close_field=function(){return this.container.ownerDocument.stopObserving("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClassName("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},Chosen.prototype.activate_field=function(){return this.container.addClassName("chosen-container-active"),this.active_field=!0,this.search_field.value=this.search_field.value,this.search_field.focus()},Chosen.prototype.test_active_click=function(a){return a.target.up(".chosen-container")===this.container?this.active_field=!0:this.close_field()},Chosen.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=SelectParser.select_to_array(this.form_field),this.is_multiple?this.search_choices.select("li.search-choice").invoke("remove"):this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field.readOnly=!0,this.container.addClassName("chosen-container-single-nosearch")):(this.search_field.readOnly=!1,this.container.removeClassName("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},Chosen.prototype.result_do_highlight=function(a){var b,c,d,e,f;return this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClassName("highlighted"),d=parseInt(this.search_results.getStyle("maxHeight"),10),f=this.search_results.scrollTop,e=d+f,c=this.result_highlight.positionedOffset().top,b=c+this.result_highlight.getHeight(),b>=e?this.search_results.scrollTop=b-d>0?b-d:0:f>c?this.search_results.scrollTop=c:void 0},Chosen.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClassName("highlighted"),this.result_highlight=null},Chosen.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field.fire("chosen:maxselected",{chosen:this}),!1):(this.container.addClassName("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.value=this.search_field.value,this.winnow_results(),this.form_field.fire("chosen:showing_dropdown",{chosen:this}))},Chosen.prototype.update_results_content=function(a){return this.search_results.update(a)},Chosen.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClassName("chosen-with-drop"),this.form_field.fire("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},Chosen.prototype.set_tab_index=function(){var a;return this.form_field.tabIndex?(a=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field.tabIndex=a):void 0},Chosen.prototype.set_label_behavior=function(){var a=this;return this.form_field_label=this.form_field.up("label"),null==this.form_field_label&&(this.form_field_label=$$("label[for='"+this.form_field.id+"']").first()),null!=this.form_field_label?this.form_field_label.observe("click",function(b){return a.is_multiple?a.container_mousedown(b):a.activate_field()}):void 0},Chosen.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.value=this.default_text,this.search_field.addClassName("default")):(this.search_field.value="",this.search_field.removeClassName("default"))},Chosen.prototype.search_results_mouseup=function(a){var b;return b=a.target.hasClassName("active-result")?a.target:a.target.up(".active-result"),b?(this.result_highlight=b,this.result_select(a),this.search_field.focus()):void 0},Chosen.prototype.search_results_mouseover=function(a){var b;return b=a.target.hasClassName("active-result")?a.target:a.target.up(".active-result"),b?this.result_do_highlight(b):void 0},Chosen.prototype.search_results_mouseout=function(a){return a.target.hasClassName("active-result")||a.target.up(".active-result")?this.result_clear_highlight():void 0},Chosen.prototype.choice_build=function(a){var b,c,d=this;return b=new Element("li",{"class":"search-choice"}).update("<span>"+a.html+"</span>"),a.disabled?b.addClassName("search-choice-disabled"):(c=new Element("a",{href:"#","class":"search-choice-close",rel:a.array_index}),c.observe("click",function(a){return d.choice_destroy_link_click(a)}),b.insert(c)),this.search_container.insert({before:b})},Chosen.prototype.choice_destroy_link_click=function(a){return a.preventDefault(),a.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(a.target)},Chosen.prototype.choice_destroy=function(a){return this.result_deselect(a.readAttribute("rel"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.value.length<1&&this.results_hide(),a.up("li").remove(),this.search_field_scale()):void 0},Chosen.prototype.results_reset=function(){return this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),"function"==typeof Event.simulate&&this.form_field.simulate("change"),this.active_field?this.results_hide():void 0},Chosen.prototype.results_reset_cleanup=function(){var a;return this.current_selectedIndex=this.form_field.selectedIndex,a=this.selected_item.down("abbr"),a?a.remove():void 0},Chosen.prototype.result_select=function(a){var b,c;return this.result_highlight?(b=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field.fire("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClassName("active-result"):this.reset_single_select_options(),b.addClassName("result-selected"),c=this.results_data[b.getAttribute("data-option-array-index")],c.selected=!0,this.form_field.options[c.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(c):this.single_set_selected_text(c.text),(a.metaKey||a.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.value="","function"!=typeof Event.simulate||!this.is_multiple&&this.form_field.selectedIndex===this.current_selectedIndex||this.form_field.simulate("change"),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},Chosen.prototype.single_set_selected_text=function(a){return null==a&&(a=this.default_text),a===this.default_text?this.selected_item.addClassName("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClassName("chosen-default")),this.selected_item.down("span").update(a)},Chosen.prototype.result_deselect=function(a){var b;return b=this.results_data[a],this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),"function"==typeof Event.simulate&&this.form_field.simulate("change"),this.search_field_scale(),!0)},Chosen.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.down("abbr")||this.selected_item.down("span").insert({after:'<abbr class="search-choice-close"></abbr>'}),this.selected_item.addClassName("chosen-single-with-deselect")):void 0},Chosen.prototype.get_search_text=function(){return this.search_field.value===this.default_text?"":this.search_field.value.strip().escapeHTML()},Chosen.prototype.winnow_results_set_highlight=function(){var a;return this.is_multiple||(a=this.search_results.down(".result-selected.active-result")),null==a&&(a=this.search_results.down(".active-result")),null!=a?this.result_do_highlight(a):void 0},Chosen.prototype.no_results=function(a){return this.search_results.insert(this.no_results_temp.evaluate({terms:a})),this.form_field.fire("chosen:no_results",{chosen:this})},Chosen.prototype.no_results_clear=function(){var a,b;for(a=null,b=[];a=this.search_results.down(".no-results");)b.push(a.remove());return b},Chosen.prototype.keydown_arrow=function(){var a;return this.results_showing&&this.result_highlight?(a=this.result_highlight.next(".active-result"))?this.result_do_highlight(a):void 0:this.results_show()},Chosen.prototype.keyup_arrow=function(){var a,b,c;return this.results_showing||this.is_multiple?this.result_highlight?(c=this.result_highlight.previousSiblings(),a=this.search_results.select("li.active-result"),b=c.intersect(a),b.length?this.result_do_highlight(b.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},Chosen.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.down("a")),this.clear_backstroke()):(a=this.search_container.siblings().last(),a&&a.hasClassName("search-choice")&&!a.hasClassName("search-choice-disabled")?(this.pending_backstroke=a,this.pending_backstroke&&this.pending_backstroke.addClassName("search-choice-focus"),this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClassName("search-choice-focus")):void 0)},Chosen.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClassName("search-choice-focus"),this.pending_backstroke=null},Chosen.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.value.length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:this.results_showing&&a.preventDefault();break;case 32:this.disable_search&&a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:a.preventDefault(),this.keydown_arrow()}},Chosen.prototype.search_field_scale=function(){var a,b,c,d,e,f,g,h,i;if(this.is_multiple){for(c=0,g=0,e="position:absolute; left: -1000px; top: -1000px; display:none;",f=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],h=0,i=f.length;i>h;h++)d=f[h],e+=d+":"+this.search_field.getStyle(d)+";";return a=new Element("div",{style:e}).update(this.search_field.value.escapeHTML()),document.body.appendChild(a),g=Element.measure(a,"width")+25,a.remove(),b=this.container.getWidth(),g>b-10&&(g=b-10),this.search_field.setStyle({width:g+"px"})}},Chosen}(AbstractChosen)}.call(this);;var Profile=Class.create({initialize:function(){},openForm:function(href,params){var self=this;var lb=new AjaxLightbox($('lightboxTemplate'),{href:href,cssClass:'static-lightbox',parameters:'&template='+self.f,callback:function(lb){lb._centerWindow(lb.container);var form=lb.content.down('#form-validate');var formValidator=new Validation(form);if(params&&params.openCallback){new params.openCallback;}
form.observe('submit',function(ev){ev.stop();if(formValidator.validate()){var parameters=form.serialize();if(params&&params.load){parameters+='&load='+encodeURI(params.load);}
new Ajax.Request(form.action,{method:'post',parameters:parameters,onComplete:function(transport){var response=transport.responseJSON;if(!response){response={action:'error',message:'Error!'}}
if(response.action=='success'){lb.content.innerHTML='';}
var messageContainer=lb.content.down('#messageContainer');if(!messageContainer){messageContainer=new Element('div',{id:'messageContainer'});messageContainer.addClassName(response.action);lb.content.insert(messageContainer);}
messageContainer.update(response.message);lb._centerWindow(lb.container);if(params&&params.update&&response.block){$(params.update).replace(response.block);}
if(params&&params.callback){new params.callback;}}});}});}});lb.open();lb.observe('lb:afterclose',function(){lb.container.remove()});},send:function(href,params){if(params&&params.confirm&&!confirm(params.confirm)){if(params.cancelCallback){new params.cancelCallback;}
return;}
var parameters='';if(typeof params=='string'){parameters=params;}
if(params&&params.load){parameters='load='+encodeURI(params.load);}
if(params&&params.getParam){parameters=params.getParam;}
if(params.inPlace){if(Object.isArray(params.inPlace.link)){params.inPlace.link.invoke('hide');}
else
params.inPlace.link.hide();params.inPlace.preloader.show();}
new Ajax.Request(href,{method:'post',parameters:parameters,onComplete:function(transport){var response=transport.responseJSON;if(!response){response={action:'error',message:'Error!'}}
if(!params.noLightbox){var lb=new TemplateLightbox($('lightboxTemplate'),{});var messageContainer=new Element('div',{id:'messageContainer'});lb.content.insert(messageContainer);messageContainer.update(response.message);lb.open();}
if(params.inPlace){if(Object.isArray(params.inPlace.link))
params.inPlace.link.invoke('show');else
params.inPlace.link.show();params.inPlace.preloader.hide();}
if(params&&params.update&&response.block){$(params.update).replace(response.block);}
if(params&&params.callback){new params.callback;}}});return false;}});var profile=new Profile();;function openSuAddressEditor(form_url,autocomplete_city_url,load_address_url,address_id){function updatElementSuser(element){var cityName="";if(element.childElements()){for(var i=0;i<element.childElements().length;i++){cityName+=element.childElements()[i].textContent;}}
else{cityName=element.innerHTML;}
$('address_city').value=cityName;$('address_city_value').value=element.readAttribute('rel');if(Validation.validate($('address_city_value'))){loadAddresses(load_address_url,$('address_city_value').value);}}
new Ajax.Request(form_url,{method:'post',asynchronous:true,evalScripts:true,onComplete:function(response,data){},onSuccess:function(response){var data=response.responseText;if(data)
{cancelSuAddressEditor();var tab=$('address-su-'+address_id);if(address_id){tab.insert({after:data});}
else{tab.insert({before:data});tab.hide();}
$('address_city').focus();var _elementLoaded=$('address_city_suggest');new Autocomplete.Extend.Autocompleter($('address_city'),_elementLoaded,autocomplete_city_url,{paramName:'name',method:'get',minChars:2,indicator:$('address_city_loader'),onSuccess:function(resp){_elementLoaded.innerHTML=resp.responseText;var list=$$('#address_city_suggest li');if($$('#address_city_suggest li.active span.complete-value').first().innerHTML==''&&list.length==2){updatElementSuser($$('#address_city_suggest li.active').first());resp.responseText='';$('address_city_loader').hide();}},updateElement:function(element){updatElementSuser(element)}});var formAddrEdit=new VarienForm('form-addr-edit',true);new Event.observe('form-addr-edit','submit',(function(e,form,address_id){e.stop();Event.stop(e);saveSuAddress(e,form,address_id);}).bindAsEventListener(this,formAddrEdit,address_id));}
else{alert(Translator.translate('The request failed'));}},onLoading:function(request,data){}});}
function loadAddresses(url,city_id){new Ajax.Request(url+'?city_id='+city_id,{method:'get',asynchronous:true,evalScripts:true,onSuccess:function(response){if(response.error){alert(response.message);}
else{$('shipping_address_select').update(response.responseText);}},onLoading:function(request,data){$('address_loader').show();},onComplete:function(response,data){$('address_loader').hide();}});}
function saveSuAddress(e,form,addr_id){if(form&&form.validator.validate())
{var form_data=$(form.form.id).serialize(true);var form_url=$(form.form.id).action;var td=$('address-editor').up().up();var overlay=new Element('div',{'id':'address-edit-overlay','class':'navigation-overlay','style':'width: '+td.getWidth()+'px; height: '+(td.getHeight()-15)+'px;'});td.insert({top:overlay});overlay.show();new Ajax.Request(form_url,{method:'post',asynchronous:true,evalScripts:false,onComplete:function(response,data){if(200!=response.status){alert(Translator.translate('The request failed'));}
var overlay=$('address-edit-overlay');if(overlay)
overlay.remove();},onSuccess:function(response){var data=response.responseJSON;if(data)
{if(data.action=='success')
{var addrSect=$('customer-su-address-book');addrSect.replace(data.block);}
else{alert(Translator.translate('Mistake  ')+data.message);}}
else{}},parameters:form_data});}}
function cancelSuAddressEditor(){var open_editor=$('address-editor');if(open_editor)
open_editor.remove();$('address-su-0').show();}
function setDefaultAddress(element,data){var params=Object.extend(data.params,{noLightbox:true,inPlace:{link:$$('.default-city-select-su'),preloader:element.previous('.loading-gif')}});profile.send(data.url,params);}
function deleteAddress(element,data){var params=Object.extend(data.params,{noLightbox:true,inPlace:{link:element,preloader:element.next('.loading-gif')}});profile.send(data.url,params);};function setCookie(id,type){var date=new Date();days='365';date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();document.cookie=type+id+"= 1"+expires+"; path=/";}
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
function voteQst(elem,event){var id=$(elem).up().id.replace(/\D+/g,'');if(readCookie('qst'+id)==null){if(elem.sending)return false;elem.sending=true;var links=elem.up();links.update('<span class="loading-gif"></span>');new Ajax.Request(base_url+'askquestion/vote/qst/',{parameters:{id:id},onComplete:function(response){var jsonR=response.responseText.evalJSON(true);if(jsonR.status=='1'){links.up().down('.votes-count').update('<span class="updated">'+jsonR.qty+'</span>');links.update('<span class="message">'+jsonR.message+'</span>');setCookie(id,'qst');}
else{alert(jsonR.message);}
elem.sending=false;}});}
else{alert("  !");}}
function spamQst(elem,event){var id=elem.up().id.replace(/\D+/g,'');if(readCookie('qst'+id)==null){if(elem.sending)return false;elem.sending=true;var links=elem.up();links.update('<span class="loading-gif"></span>');new Ajax.Request(base_url+'askquestion/vote/spamqst/',{parameters:{id:id},onComplete:function(response){var jsonR=response.responseText.evalJSON(true);if(jsonR.status=='1'){links.update('<span class="message">'+jsonR.message+'</span>');setCookie(id,'qst');}
else{alert(jsonR.message);}
elem.sending=false;}});}
else{alert("     !");}}
function voteAnsw(elem,event){var id=elem.up().id.replace(/\D+/g,'');if(readCookie('answ'+id)==null){if(elem.sending)return false;elem.sending=true;var links=elem.up();links.update('<span class="loading-gif"></span>');new Ajax.Request(base_url+'askquestion/vote/answ/',{parameters:{id:id},onComplete:function(response){var jsonR=response.responseText.evalJSON(true);if(jsonR.status=='1'){links.up().down('.votes-count').update('<span class="updated">'+jsonR.qty+'</span>');links.update('<span class="message">'+jsonR.message+'</span>');setCookie(id,'answ');}
else{alert(jsonR.message);}
elem.sending=false;}});}
else{alert("  !");}}
function spamAnsw(elem,event){var id=elem.up().id.replace(/\D+/g,'');;if(readCookie('answ'+id)==null){if(elem.sending)return false;elem.sending=true;var links=elem.up();links.update('<span class="loading-gif"></span>');new Ajax.Request(base_url+'askquestion/vote/spamansw/',{parameters:{id:id},onComplete:function(response){var jsonR=response.responseText.evalJSON(true);if(jsonR.status=='1'){links.update('<span class="message">'+jsonR.message+'</span>');setCookie(id,'answ');}
else{alert(jsonR.message);}
elem.sending=false;}});}
else{alert("     !");}}
function longer(elem){elem.up().hide();elem.up('div').down('p.askTextLong').show();}
function shorter(elem){elem.up().hide();elem.up('div').down('p.askTextShort').show();}
function showAllAnswers(elem){var id=elem.up().id.replace('3answers','');if(elem.up('div.question').down('div.allanswersblock').innerHTML==''){new Ajax.Request(base_url+'askquestion/vote/allanswers/',{parameters:{id:id},onComplete:function(response){elem.up('div.question').down('div.allanswersblock').innerHTML=response.responseText;elem.up().remove();}});}else{elem.up().hide();elem.up('div.question').down('div.allanswersblock').show();}}
function showAllMainTabAnswers(elem){var id=elem.up().id.replace('3answers','');if(elem.up('div.question').down('div.allanswersblock').innerHTML==''){new Ajax.Request(base_url+'askquestion/vote/allmaintabanswers/',{parameters:{id:id},onComplete:function(response){elem.up('div.question').down('div.allanswersblock').innerHTML=response.responseText;elem.up().remove();}});}else{elem.up().hide();elem.up('div.question').down('div.allanswersblock').show();}}
function hideAllAnswers(id){$('allanswers'+id).hide();$('3answers'+id).show();}
function showForm(elem){var form=elem.up('div.question').down('form');form.show();form.down('textarea').focus();}
function observerF(parameters){$$('.c-button').each(function(th){th.observe('click',function(e){e.target.up('form').hide();})});$$('.askAnswerFormS').each(function(th){th.supperShow=(th.supperShow==undefined)?th.show:th.supperShow;th.show=function(){this.getNotificationArea().hide();this.supperShow();}.bind(th);th.getNotificationArea=function(){return $$(".form-notification-area[form-owner='"+this.id+"']").first();}.bind(th);th.getMessageArea=function(){var area=this.getNotificationArea();return(area)?area.select("[id^='questionMessage']").first():null;}
th.onSuccess=function(jsonR){var message=this.getMessageArea();if(message){message.update(jsonR.message);this.getNotificationArea().show();if(window.calBlocksHeight)
window.calBlocksHeight();}}.bind(th);th.observe('submit',function(e){e.stop();if(this.sending)return false;var questionValid=new Validation(e.target,'');e.preventDefault();params=e.target.serialize();if(questionValid.validate()){this.sending=true;var request=new Ajax.Request(base_url+'askquestion/vote/submit',{method:'post',parameters:params,onComplete:function(transport){var jsonR=transport.responseText.evalJSON();if(jsonR.status==1){e.target.reset();e.target.hide();if(parameters&&parameters.ask_answer_form_hide_callback)
parameters.ask_answer_form_hide_callback(e.target);if(this.onSuccess)
this.onSuccess(jsonR);else
alert(jsonR.message);}else{alert(jsonR.message);}
this.sending=false;}.bind(this)});}}.bind(th))});}
function observerA(form){form.observe('submit',function(e){e.stop();var login=allo.session.data.customer.customer.islogged;if(login==false){allo.checkEmailAndShowLoginPopup(this,form,sendAskquestionAskPost);return;}
sendAskquestionAskPost(form);});}
function sendAskquestionAskPost(form){if(form.sending)return false;if(form.valid.validate()){form.sending=true;var request=new Ajax.Request(base_url+'askquestion/ask/askPost',{method:'post',parameters:Form.serialize(form),onComplete:function(transport){var jsonR=transport.responseText.evalJSON();if(jsonR.error==1){alert(jsonR.message);}
else{if(form.onSuccess){form.onSuccess(jsonR);}
else{alert(jsonR.message);}
form.reset();}
form.sending=false;}});}};if(!window.Enterprise){window.Enterprise={};}
if(!Enterprise.CatalogEvent){Enterprise.CatalogEvent={};}
Enterprise.CatalogEvent.Ticker=Class.create();Object.extend(Enterprise.CatalogEvent.Ticker.prototype,{initialize:function(container,seconds){this.container=$(container);this.seconds=seconds;this.start=new Date();this.interval=setInterval(this.applyTimer.bind(this),1000);this.applyTimer();},getEstimate:function(){var now=new Date();var result=this.seconds-(now.getTime()-this.start.getTime())/1000;if(result<0){return 0;}
return Math.round(result);},applyTimer:function(){var seconds=this.getEstimate();var daySec=Math.floor(seconds/(3600*24))*(3600*24);var hourSec=Math.floor(seconds/3600)*3600;var minuteSec=Math.floor(seconds/60)*60;var secondSec=seconds;this.container.down('.days').update(this.formatNumber(Math.floor(daySec/(3600*24))));this.container.down('.hour').update(this.formatNumber(Math.floor((hourSec-daySec)/3600)));this.container.down('.minute').update(this.formatNumber(Math.floor((minuteSec-hourSec)/60)));this.container.down('.second').update(this.formatNumber(seconds-minuteSec));if(daySec>0){this.container.down('.second').previous('.delimiter').hide();this.container.down('.second').hide();this.container.down('.days').show();this.container.down('.days').next('.delimiter').show();}else{this.container.down('.days').hide();this.container.down('.days').next('.delimiter').hide();this.container.down('.second').previous('.delimiter').show();this.container.down('.second').show();}},formatNumber:function(number){if(number<10){return'0'+number.toString();}
return number.toString();}});;var TopCartController=Class.create({initialize:function(){this.refresh();this.effects={overTimer:null,duration:0.3,showing:false,mouseovered:false,closeDelay:500}},refresh:function(){this.elements={cartContainer:$('topCart'),cartContent:$('topCartContent'),cartLink:$('cartHeader'),closeLink:$('cartCloseLink'),continueLink:$('continueLink')}},showCart:function(){this.effects.showing=true;new Effect.SlideDown(this.elements.cartContent,{duration:this.effects.duration,queue:{scope:'cart',limit:1}});},hideCart:function(){this.effects.showing=false;new Effect.SlideUp(this.elements.cartContent,{duration:this.effects.duration,queue:{scope:'cart',limit:1}});}});var cartLightbox=Class.create(AjaxLightbox,{lockCheckout:false,initialize:function($super,template,data){var _clickedBefore=Array();this.template=template;this.data=data;this.sup=$super;this.parametersCart={};this.dataForEjs=null;this.options={topTitle:$('topCartTitle'),innerWrapper:$('innerWrapper')};data.links.each(function(item){Event.observe(item,'click',function(){item.cartLihtboxAutoClick=true;_clickedBefore.push(item);});});this.observeLinks(data.links);Event.observe(window,'load',function(){this.observeLinks(data.links);_clickedBefore.each(function(item){if(typeof item.cartLihtboxAutoClick!='boolean'||!item.cartLihtboxAutoClick){return;}
item.cartLihtboxAutoClick=false;item.simulate('click');});}.bind(this));},checkUseParameters:function(){var searchElement=null;var result=null;jQuery.each(allo.spConfig.config.attributes,function(index,object){searchElement=jQuery('#attribute'+index).find('li[selected=true]');if(searchElement&&searchElement.length==0){result=object.label;return false;}});return result;},waitLoadTab:function(){document.observe('productTabs:tabLoaded',function(obj){document.observe('productTabs:configurableSpConfigLoaded',function(){var alertElement=jQuery('#config-error');var searchElement=null;var errorText=null;jQuery.each(allo.spConfig.config.attributes,function(index,object){searchElement=jQuery('#attribute'+index).find('li[selected=true]');if(searchElement&&searchElement.length==0){errorText=object.label;return false;}});if(errorText&&alertElement){var oldAttr=alertElement.find('#accusative-attribute');if(oldAttr){oldAttr.remove()}
alertElement.append('<div id="accusative-attribute">'
+errorText
+'</div>');alertElement.css('display','block');}});});},ifCanBuyConfigurable:function(th){if(th.hasAttribute('name')){var productId=th.getAttribute('name').replace(/\D+/g,'');}
if($$('div.product-view').length>0&&$$('div.product-view')[0].hasClassName('configurable')){if(productTabs.currentTab.tabName!='main'){if(typeof(productTabs)!='undefined'){var tabs=productTabs.tabs;var j=0;for(j;j<tabs.length;j++){if(tabs[j].tabName=='main'){productTabs.switchTab(productTabs.currentTab,tabs[j]);if(!productTabs.tabs[0].loaded){this.waitLoadTab()
break;}
var alertElement=jQuery('#config-error');var errorText=this.checkUseParameters();if(errorText&&alertElement){var oldAttr=alertElement.find('#accusative-attribute');if(oldAttr){oldAttr.remove()}
alertElement.append('<div id="accusative-attribute">'
+errorText
+'</div>');alertElement.css('display','block');}
break;}}}
return false;}}
if($$('div.product-view').length>0&&$$('div.product-view')[0].hasClassName('configurable')){if(typeof allo.spConfig!='undefined'){if(productId==allo.spConfig.config.productId){if(allo.spConfig.config.chosenProductId==undefined){var attributes=allo.spConfig.config.attributes;for(var i in attributes){if(!allo.spConfig.state[i]){var returnLabel=attributes[i].accusativeLabel;$('accusative-attribute').innerHTML=returnLabel;$('config-error').style.display='block';if(typeof(productTabs)!='undefined'){var tabs=productTabs.tabs;for(var j=0;j<tabs.length;j++){if(tabs[j].tabName=='main'){productTabs.switchTab(productTabs.currentTab,tabs[j]);if($('config-error'))
$('config-error').style.display='block';break;}}}
break;}}
return false;}else{var productAttributes=$$('.product-options')[0].getElementsByTagName("dl")[0].getElementsByTagName("dd");for(var z=0;z<=productAttributes.length-1;z++){var choosenOption=false;var productAttribute=productAttributes[z].getElementsByTagName("ul");if(productAttribute&&productAttribute.length>0){var productOptions=productAttribute[0].getElementsByTagName("li");if(productOptions&&productOptions.length>0){for(var j=0;j<=productOptions.length-1;j++){if(productOptions[j].attributes.selected.value=='true'){choosenOption=true;}}}
if(choosenOption==false){var returnLabel=productAttribute[0].config.accusativeLabel;$('accusative-attribute').innerHTML=returnLabel;$('config-error').style.display='block';if(typeof(productTabs)!='undefined'){var tabs=productTabs.tabs;for(var j=0;j<tabs.length;j++){if(tabs[j].tabName=='main'){productTabs.switchTab(productTabs.currentTab,tabs[j]);if($('config-error'))
$('config-error').style.display='block';break;}}}
return false;}}}}}}else{if(typeof(productTabs)!='undefined'){var tabs=productTabs.tabs;for(var j=0;j<tabs.length;j++){if(tabs[j].tabName=='main'){productTabs.switchTab(productTabs.currentTab,tabs[j]);if($('config-error'))
$('config-error').style.display='block';break;}}}
return false;}}
return true;},observeLinks:function(links){links.each(function(th){th.stopObserving('click');th.observe('click',function(e){e.stop();if(!this.ifCanBuyConfigurable(th))
return this;var href=th.onclick();if(!href){return this;}
if(allo.session.data.cart.items&&th.getAttribute('name')){var isInCart=this._getItem(allo.session.data.cart.items,'items',th.getAttribute('name').split('_')[1])||allo.session.data.cart.suites[th.getAttribute('name').split('_')[1]];var isCreditButton=Event.element(e).hasClassName('by-on-credit');if(!isInCart&&isCreditButton){_gaq.push(['_trackPageview','add_credit_to_cart']);}
else if(!isInCart){_gaq.push(['_trackPageview','add_cart']);}}
this.data.href=href.replace('checkout','j2tajaxcheckout/index/cart');this.sendCart();}.bind(this));}.bind(this));},buyProductById:function(productId)
{productId=parseInt(productId);if(!productId){return;}
this.data.href=CURRENT_BASE_URL+"/j2tajaxcheckout/index/cart/cart/add/product/"+productId;this.sendCart();},load:function(){var self=this;this.container.addClassName('loading');if(this.params.href){if(allo.shipping.currentShippingUpdated){self.parametersCart.cityId=allo.shipping.currentShippingData.city.id;}
if($('product-options-wrapper')){var arr=allo.spConfig.settings;var state=allo.spConfig.state;var values=new Object();arr.forEach(function(item,i,arr){values[item.attributeId]=state[item.attributeId];});self.parametersCart.superAttribute=JSON.stringify(values);}
self.parametersCart.onlyProductsList=0;new Ajax.Request(this.data.href,{method:'post',parameters:self.parametersCart,onComplete:function(transport){var response=transport.responseText.evalJSON();var rText=response.output;if(response.status=='error'){alert(rText);self.close();}else{self.content.update(rText);self.dataForEjs=response.dataForEjs;self.reloadEjsTemplate();self.container.removeClassName('loading');self.initObservers();}
if(response.cart){try{self._processButtons(response.cart,response.cart.item);self.updateCart(response.cart,{'loadMiniCart':true});if(self.data.href.indexOf('/type/credit')==-1){_gaq.push(['_trackPageview','pop-up_cart']);}
else{_gaq.push(['_trackPageview','pop-up_credit']);}}catch(e){if(console)console.log(e.stack);}}
if(response.Ga){eval(response.Ga);}}});}},updateCart:function(data,params){var type=data.type;if(data.type=='suites'){allo.session.data.cart[data.type]=data[data.type];type='items';}
var AllVars=new Object;AllVars.Cart=Translator.translate('Your cart');AllVars.proceed=Translator.translate('proceed to Checkout');AllVars.CartEmpty=Translator.translate('Your cart empty');allo.session.data.cart=data;allo.blocks.updateBlock({'id':'topCartTitle','type':'cart','templateName':'header','AllVars':AllVars});if(params&&params.loadMiniCart){allo.blocks.updateBlock({'id':'miniCartItems','type':'cart','templateName':'header_content','AllVars':AllVars});}},_processButtons:function(data,item){var selector='[name=buy-button_'+item+']';if(data.action=='delete'){data.item=this._getItem(allo.session.data.cart[data.type],data.type,item);}else{data.item=this._getItem(data[data.type],data.type,item);};allo.session.data.cart[data.type]=data[data.type];if(data.type!='items'){allo.session.data.cart['items']=data['items'];}
allo.sendSC(allo.session.data);data.item.inCart=false;if(data.action=='add'||data.action=='show'||data.action=='update'){data.item.inCart=true;}
$$(selector).each(function(element){var tplName='cart_'+element.getAttribute('template');var id=element.getAttribute('id');data.id=id?id:'';if(allo.GA.buttonsParams[id]){data.additional=allo.GA.buttonsParams[id];}
if(allo.templates.tpl[tplName]){var tpl=new EJS(allo.templates.tpl[tplName]);var html=tpl.render(data);element.up().update(html);}});cartController.observeLinks($$(selector));},_getItem:function(data,type,id){if(type=='items'){for(var i in data){if(data[i]['id']==id&&!data[i].suite){return data[i];}}}else{return data.item=data[id];}},_centerWindow:function(element){var scrollTop=self.pageYOffset||(document.documentElement&&document.documentElement.scrollTop)||(document.body&&document.body.scrollTop);if(typeof window.innerHeight!='undefined'){if($(element).getWidth()>window.innerWidth)
$(element).style.left="0px";else
$(element).style.left=Math.round(document.body.offsetLeft+((window.innerWidth-$(element).getWidth()))/2)+'px';}else{if($(element).getWidth()>document.documentElement.offsetWidth)
$(element).style.left="0px";else
$(element).style.left=Math.round(document.body.offsetLeft+((document.documentElement.offsetWidth-$(element).getWidth()))/2)+'px';}
var winHeight=typeof window.innerHeight!='undefined'?window.innerHeight:document.documentElement.offsetHeight;if(winHeight>480){$(element).style.top=Math.round(scrollTop+20)+'px';if(parseInt($(element).style.top)<50)
$(element).style.top='50px';}
else
$(element).style.top=Math.round(scrollTop)+'px';},sendCart:function(){this.sup($('lightboxTemplate'),this.data);this.open();},refreshWindow:function(link,parameters){var self=this;var value=link;var ejs=self.dataForEjs;if(ejs){self.parametersCart.creditItem=ejs.current_credit_id;self.parametersCart.creditBank=ejs.current_bank_id;self.parametersCart.creditItemPeriod=ejs.current_credit_period;}
if($('banks-container')){value+='type/credit';}
if(parameters&&!parameters.withoutRefresh&&!parameters.onlyProductsList){self.disableQtyButtons();}
if(parameters&&parameters.control){self.checkQtyChange(parameters.control);}
var requestParams=self.parametersCart;if(parameters&&parameters.crosselId){requestParams.crosselId=parameters.crosselId;}
if(parameters&&parameters.onlyProductsList){requestParams.onlyProductsList=parameters.onlyProductsList;}
else{requestParams.onlyProductsList=0;}
new Ajax.Request(value,{method:'post',parameters:requestParams,onComplete:function(transport){var response=transport.responseText.evalJSON();if(parameters&&parameters.onlyProductsList){var rText=response.products;var productsList=$$('.ajax-cart');productsList.first().replace(rText);self.enableQtyButtons();self.initObservers(parameters.onlyProductsList);}
else{if(response.crosssellUpdate){if(parameters&&parameters.crosselId){var rel=$$('li[product-id="'+parameters.crosselId+'"]').first();if(rel)
rel.update(response.crosssellUpdate);}}
if(parameters&&parameters.withoutRefresh){if(response.cart){self._processButtons(response.cart,response.cart.item);}
return;}
var rText=response.output;self.stopControlObservers();var creditLightbox=$$('.lb-contentajaxcart');creditLightbox.first().replace(rText);self.dataForEjs=response.dataForEjs;self.reloadEjsTemplate();self.content=$$('.lb-contentajaxcart').first();self.initObservers();if(response.cart){self._processButtons(response.cart,response.cart.item);self.updateCart(response.cart,{'loadMiniCart':true});}}}});},initObservers:function(onlyProductsList){var self=this;var controls=self.content.select('.qty-link');var removeProducts=self.content.select('.remove-product');var qtyInputs=self.content.select('.qty');controls.each(function(th){th.observe('click',function(){var onlyProductList=self.dataForEjs?0:1;var value=th.onclick();if(value&&!th.hasClassName('disabled')){_gaq.push(['_trackEvent','Checkout&Cart','cart','change-number-'+th.readAttribute('gaTrack')]);self.refreshWindow(value,{withoutRefresh:false,control:this,onlyProductsList:onlyProductList});}});});qtyInputs.each(function(th){th.observe('keyup',function(e){if(e.keyCode==13){var onlyProductList=self.dataForEjs?0:1;self.disableQtyButtons();var url=th.onclick().replace('__param__',th.value);_gaq.push(['_trackEvent','Checkout&Cart','cart','change-number-'+th.readAttribute('gaTrack')+'-'+th.value]);self.refreshWindow(url,{withoutRefresh:false,control:e.element(),onlyProductsList:onlyProductList});}});th.observe('change',function(e){th.observe('blur',function(e){var onlyProductList=self.dataForEjs?0:1;self.disableQtyButtons();var url=th.onclick().replace('__param__',th.value);_gaq.push(['_trackEvent','Checkout&Cart','cart','change-number-'+th.readAttribute('gaTrack')+'-'+th.value]);self.refreshWindow(url,{withoutRefresh:false,control:e.element(),onlyProductsList:onlyProductList});});});});removeProducts.each(function(t){t.observe('click',function(th){var value=th.target.onclick();if(confirm(value.confirm)){var url=value.url.replace('checkout/cart','j2tajaxcheckout/index/cart/action');th.target.addClassName('loading-gif');self.refreshWindow(url);}});});if(!onlyProductsList){var adressCity=$('address_city');var adressCityList=$('address_city_list');var continueLink=$$('.continue-link');if(adressCity&&adressCityList){var cities=new allo.cities(adressCity,adressCityList);cities.onSelect(self.reloadCreditPopup.bind(self)).emptyCity(self.ifEmptyCity.bind(self)).dispatch();}
continueLink.each(function(element){element.observe('click',function(){self.close();});});self.observeCheckoutButton();self.observeCrossSellCheckboxes();$$('.creditCitiesDefaultList').each(function(item){item.observe('click',self.selectCityCreditObserver.bind(self));});}},selectCityCreditObserver:function(event){var self=this;var element=Event.element(event);self.reloadCreditPopup(element);},selectCreditBankObserver:function(event){var self=this;var ejs=self.dataForEjs;if(ejs.stopObserve)return;var element=Event.element(event);if(!(ejs.current_bank_id=element.value))
ejs.current_bank_id=element.id;var reloadProducts=true;if(ejs.current_condition&&ejs.current_credit_period){if(ejs.current_condition&&!ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition]){ejs.current_condition=Object.keys(ejs['bank_credit_list'][ejs.current_bank_id])[0];}
if(ejs.current_condition&&ejs.current_credit_period){if(ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period]){ejs.current_credit_id=ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period]}
else{ejs.current_credit_period=Object.keys(ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition])[0];ejs.current_credit_id=ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period];}}}
if(!(ejs.current_condition&&ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition])){ejs.current_condition=null;ejs.current_credit_id=null;ejs.current_credit_period=null;reloadProducts=false;}
self.reloadEjsTemplate(reloadProducts);},selectCreditConditionObserver:function(event){var self=this;var ejs=self.dataForEjs;if(ejs.stopObserve)return;var element=Event.element(event);ejs.current_condition=element.value;var reloadProducts=true;if(ejs.current_credit_period){ejs.current_credit_id=ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period];}
if(!(ejs.current_credit_id&&ejs.current_credit_period&&ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period])){ejs.current_credit_period=Object.keys(ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition])[0];ejs.current_credit_id=ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period];}
self.reloadEjsTemplate(reloadProducts);},selectCreditProductObserver:function(event,ui){var self=this;var ejs=self.dataForEjs;if(ejs.stopObserve)return;var reloadProducts=true;var value=ui.value;var values=Object.keys(ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition]);var newValue=value;if(!in_array(value,values)){for(var i=0;i<values.length;i++){newValue=parseInt(newValue);values[i]=parseInt(values[i]);if(values[i]<value){newValue=values[i];}}
newValue=parseInt(newValue);values[0]=parseInt(values[0]);if(newValue<values[0]){newValue=values[0];}}
ejs.current_credit_period=newValue;ejs.current_credit_id=ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition][ejs.current_credit_period];self.reloadEjsTemplate(reloadProducts);},createSliderValue:function(event,ui){var slider=jQuery('#periodSlider');var sliderWidth=slider[0].style.width;sliderWidth=+(sliderWidth.substring(0,sliderWidth.length-2));if(typeof(ui.value)=='undefined')
var val=this.dataForEjs.current_credit_period;else{var val=ui.value;}
var min=+(slider.slider('option').min);var max=+(slider.slider('option').max);var position=((val-min)/(max-min))*100;var position=position+'%';var labelForSlider=jQuery("#periodSlider_value");labelForSlider[0].style.left=position;labelForSlider.html(val);labelForSlider.data('value',val);},createSlider:function(event,ui){var slider=jQuery('#periodSlider');var stepWidth=+jQuery('#periodSliderNotActive')[0].offsetWidth/34;var stepWidth=+368/34;var sliderMin=+slider.slider('option').min;var sliderMargin=(sliderMin-2);var sliderMax=+slider.slider('option').max;var positionLeft=stepWidth*sliderMargin;slider[0].style.left=(positionLeft)+'px';var sliderWidth=(sliderMax-sliderMin)*stepWidth;slider.slider().width(sliderWidth);if(sliderMin==2){jQuery('#periodSlidermin')[0].style.backgroundColor='#568da7';}
else{jQuery('#periodSlidermin')[0].style.backgroundColor='#d2d2d2';}
var tooltip=jQuery('.credit_term_slider .for_label')[0];tooltip.style.left=positionLeft+'px';tooltip.style.width=sliderWidth+'px';var sliderPosition=this.createSliderValue(event,ui);},findMinMax:function(ejs){var minValue=36;var maxValue=2;if(ejs.current_bank_id){if(ejs.current_condition){var values=Object.keys(ejs['bank_credit_list'][ejs.current_bank_id][ejs.current_condition]);for(var i=0;i<values.length;i++){minValue=parseInt(minValue);maxValue=parseInt(maxValue);values[i]=parseInt(values[i]);if(values[i]<minValue){minValue=values[i];}
if(values[i]>maxValue){maxValue=values[i];}}}
else{minValue=2;maxValue=2;}}
else{minValue=2;maxValue=2;}
var rezult=Array();rezult['maxValue']=maxValue;rezult['minValue']=minValue;return rezult;},reloadEjsTemplate:function(reloadProducts){var self=this;if(self.dataForEjs){var ejs=self.dataForEjs;ejs.steps_checked[2]=ejs.current_bank_id?true:false;ejs.steps_checked[3]=ejs.current_condition?true:false;ejs.steps_checked[4]=ejs.steps_checked[5]=ejs.current_credit_id?true:false;if(ejs.current_credit_id){var element=$('initialFee');if(element&&element.value!="")
ejs.currentInitialFee=eval(element.value);else ejs.currentInitialFee=0;}
var tplName='j2t_credit';if(allo.templates.tpl[tplName]){new EJS(allo.templates.tpl[tplName]).update('j2t_credit_placeholder',this.dataForEjs);}
self.observeTemplateElements();self.parametersCart.creditBank=ejs.current_bank_id;self.parametersCart.creditItem=ejs.current_credit_id;self.parametersCart.creditItemPeriod=ejs.current_credit_period;if(ejs.current_credit_id){window.currentBank=new bankCalculator(ejs.credits_list[ejs.current_credit_id],ejs.grand_total,ejs.current_credit_period);if(window.currentBank.calculator_editable=='no'){ejs.currentInitialFee=window.currentBank.initialFee=window.currentBank.defaultInitialFee;}
else if(ejs.currentInitialFee<window.currentBank.minInitialFee&&window.currentBank.calculator_editable=='yes'){ejs.currentInitialFee=window.currentBank.initialFee=window.currentBank.minInitialFee;}
else{window.currentBank.initialFee=ejs.currentInitialFee;}
element=$('initialFee');if(element){element.value=window.currentBank.initialFee;if(ejs.credits_list[ejs.current_credit_id].calculator_editable=='no'){var initialFeeLength=parseInt(element.value.length);element.style.width=8*initialFeeLength+'px'}}
window.currentBank.lockCheckout=false;window.currentBank.calculateAndShow();var bankAbout=$$('.ba_tabs');bankAbout.first().update(ejs.credits_list[ejs.current_credit_id].lending_terms);if(jQuery('#installment_plan').attr('disabled')){jQuery('#installment_plan').parent().hide();};var minMaxValue=self.findMinMax(ejs);jQuery("#periodSlider").slider({min:minMaxValue['minValue'],max:minMaxValue['maxValue'],step:1,value:ejs.current_credit_period,create:self.createSlider.bind(self),change:self.selectCreditProductObserver.bind(self),slide:self.createSliderValue.bind(self)});}
else{element=$('initialFee');if(element){var initialFeeLength=parseInt(element.value.length);element.style.width=8*initialFeeLength+'px'}
jQuery("#periodSlider").slider({min:2,max:2,step:1,value:2,disabled:true});}
if(ejs.current_credit_id&&ejs.current_credit_period){if(ejs.credits_list[ejs.current_credit_id].lending_terms!=''){var bankAbout=$$('.ba_tabs');bankAbout[0].style.paddingTop='20px';bankAbout[0].style.borderTop='1px solid #dadada';}
if(reloadProducts){var link=CURRENT_BASE_URL+'/j2tajaxcheckout/index/cart/type/credit/cart/show/';self.refreshWindow(link,{onlyProductsList:true});}}
else{var bankAbout=$$('.ba_tabs');bankAbout[0].style.paddingTop='0px';bankAbout[0].style.borderTop='none';}
if(ejs.current_credit_id&&jQuery('#ba_tabs').html()){jQuery('#readCreditTerms').show();}
else{jQuery('#readCreditTerms').hide();}
allo.checkoutPage.showCurrentBankBoard();}},reloadCreditPopup:function(event){var self=this;var element=event;var cityId=element.readAttribute('rel');var cityTitle=element.readAttribute('title');var adressCity=$('address_city');adressCity.value=cityTitle;self.parametersCart.cityId=cityId;var cook_old=document.cookie;var cookie=new CookieProvider();if(cookie.readCookie(allo.glob.city_id_cookie_name)!=null){cookie.eraseCookie(allo.glob.city_id_cookie_name);}
cookie.createCookie(allo.glob.city_id_cookie_name,self.parametersCart.cityId);var cook_new=document.cookie;var link=CURRENT_BASE_URL+'j2tajaxcheckout/index/cart/type/credit/cart/show/';self.refreshWindow(link);},ifEmptyCity:function(event){var self=this;var element=event;if(element.value.length==0){var ejs=self.dataForEjs;ejs.stopObserve=true;ejs.current_bank_id=null;ejs.current_condition=null;ejs.current_credit_id=null;ejs.steps_checked[1]=ejs.steps_checked[2]=ejs.steps_checked[3]=ejs.steps_checked[4]=ejs.steps_checked[5]=false;self.stopControlObservers();self.reloadEjsTemplate();jQuery('.first-step')[0].removeClassName('checked');}},observeTemplateElements:function(){var self=this;var creditBank=$$('#creditBank li');var creditProduct=$('creditProduct');var creditCondition=jQuery('input:radio[name=credit_condition_radio]');if(creditBank){creditBank.each(function(item){item.observe('click',self.selectCreditBankObserver.bind(self));});}
if(creditCondition){creditCondition.change(self.selectCreditConditionObserver.bind(self));}},stopControlObservers:function(){if(this.content&&this.crossellCallback)
this.content.stopObserving('click',this.crossellCallback);},observeCheckoutButton:function(){var self=this;var ejs=null;if(self.dataForEjs){ejs=self.dataForEjs;}
var checkoutLink=self.content.select('.checkout-link').first();if(!checkoutLink){return;}
checkoutLink.observe('click',function(){var location;var currentCredit=null;if(ejs&&ejs.current_credit_id){currentCredit=ejs.credits_list[ejs.current_credit_id].code;}
var currentCreditPeriod=null;if(ejs&&ejs.current_credit_period){currentCreditPeriod=ejs.current_credit_period;}
var choiceInitionFee=null;if(ejs&&ejs.current_condition=='credit'){choiceInitionFee=$('initialFee').value;}
if(choiceInitionFee){location=CURRENT_BASE_URL+'checkout/onepage/index/bank/'+currentCredit+'/period/'+currentCreditPeriod+'/initial_fee/'+choiceInitionFee;}else if(currentCredit&&currentCreditPeriod){location=CURRENT_BASE_URL+'checkout/onepage/index/bank/'+currentCredit+'/period/'+currentCreditPeriod;}else{location=CURRENT_BASE_URL+'checkout/onepage/';}
if(window.currentBank&&window.currentBank.lockCheckout){return;}
window.location=location;});},disableQtyButtons:function(){this.container.down('.mask').removeClassName('no-display');},enableQtyButtons:function(){this.container.down('.mask').addClassName('no-display');},lockCart:function(){var overlay=this.container.down('.mask');overlay.addClassName('invisible');overlay.removeClassName('no-display');},checkQtyChange:function(target){if(target&&(target.hasClassName('qty-link')||target.hasClassName('qty'))){this.lockCart();var qtyEditor=target.up('.qty-control').down('.qty');var qtyMask=target.up('.qty-control').down('.qty-control-mask');if(qtyMask)qtyMask.addClassName('active');if(qtyEditor)qtyEditor.style.visibility='hidden';}},observeCrossSellCheckboxes:function(){if(!this.crossellCallback)
this.crossellCallback=this.accessoryClick.bind(this);this.content.observe('click',this.crossellCallback);},accessoryClick:function(e){var el=e.element();if(!el)return;if(!el.hasClassName('crosssell-checkbox'))return;var isCredit=this.container.down('#credit-calculator');var loader=el.previous('.loading-gif');if(loader&&!isCredit){loader.setStyle({'display':'block'});el.previous().hide();}
var url=el.onclick().url;url=url.replace('checkout/cart','j2tajaxcheckout/index/cart/action');var withoutRefresh=false;var productId=el.up('.item').getAttribute('product-id');if(allo.session.data.universalGa){var event=/action\/add/.test(url)?'add':'remove';if(productId){Ecommerce.Cart.send(productId,{event:event,category:'Card',action:'accessory',label:event=='add'?'add to cart':'remove from cart'});}}
if(!isCredit){withoutRefresh=true;}
this.refreshWindow(url,{withoutRefresh:withoutRefresh,crosselId:productId});},close:function(dontFade)
{AjaxLightbox.prototype.close.call(this,dontFade);this.container.remove();}});;function sendCompare(href,sender,params){var sender=$(sender);if(sender&&sender.tagName=="SPAN")
sender=sender.next();var update=$('compare-sidebar');if(update){if(update.sending)return false;update.sending=true;params['load']='sidebar';}
if(sender){if(sender.sending)return false;sender.sending=true;if(params.updateMessage){sender.removeAttribute('onclick');if(!sender.hasClassName('btn-remove')){sender.update(params.updateMessage);sender.addClassName('silver');}}
if(sender.hasClassName('list-link')){params.needButton=true;}}
new Ajax.Request(href,{method:'post',parameters:params,onComplete:function(transport){_compareCallback(transport,params,{'update':update})}});return false;}
var _compareCallback=function(transport,params,elements){var response=transport.responseText.evalJSON();if(response.action=='error'){alert(response.message);}
var itemsInAction=Array();if(!response.itemsInAction&&response.event=='clear'){for(id in allo.session.data.comparison.items){itemsInAction.push(allo.session.data.comparison.items[id]);}}else{itemsInAction=response.itemsInAction;}
var comparison=allo.session.data.comparison=response.comparison;if(!comparison){comparison={action:'error'};if(response.status!=200){comparison.message=response.status+' '+response.statusText;}else{comparison.message='Error!';}}
comparison.itemsCount=0;if(comparison.items){comparison.itemsCount=countObj(comparison.items);}
if(elements.update){var comparisonList=new EJS(allo.templates.tpl.comparison_list);var additional=({'compar':Translator.translate("Compare"),'addedcompar':Translator.translate('Added to compare'),'delitem':Translator.translate('Remove This Item'),'question':Translator.translate('Are you sure you would like to remove this item from the compare products?'),'questionclear':Translator.translate('Are you sure you would like to remove all products from your comparison?'),'clear':Translator.translate('Reset')});comparison.additional=additional;comparisonList.update($('compare-sidebar').up(),comparison,additional);if(response.event=='clear'){$('compare-sidebar').addClassName('empty');}}
if(allo.viewMode!='product'){var comparisonLink=new EJS(allo.templates.tpl.comparison_link);if(comparison.itemsCount>0){for(id in comparison.items){var item=comparison.items[id];item.inList=true;var selector='[name=compare-'+id+']';comparison.item=item;if($$(selector)){$$(selector).each(function(el){if(allo.GA.buttonsParams[el.getAttribute('id')]){comparison.additional=allo.GA.buttonsParams[el.getAttribute('id')];}
var id=el.getAttribute('id');comparison.id=id?id:'';comparisonLink.update(el.up(),comparison);});}}}}else{var comparisonLink=new EJS(allo.templates.tpl.comparison_link_card);}
if(itemsInAction.length){for(i=0;i<itemsInAction.length;i++){if(response.event=='add'){itemsInAction[i].inList=true;}else{itemsInAction[i].inList=false;}
comparison.item=itemsInAction[i];var selector='[name=compare-'+itemsInAction[i].id+']';if($$(selector)){$$(selector).each(function(el){if(allo.GA.buttonsParams[el.getAttribute('id')]){comparison.additional=allo.GA.buttonsParams[el.getAttribute('id')];}
var id=el.getAttribute('id');comparison.id=id?id:'';comparisonLink.update(el.up(),comparison);});}}}
if(params.callback){window[params.callback](response,params);}
if(elements.update){elements.update.sending=false;}
if(elements.sender){elements.sender.sending=false;}
allo.stripNames();};;var Ecommerce=Ecommerce||{};Ecommerce.Cart=(function(){var cache=[];var getProduct=function(Id){var product=cache[Id];if(!product){var viewedProducts=allo.blocks.viewedProducts.get();if(!viewedProducts)return product;if(viewedProducts.products&&viewedProducts.products.length){for(var index=0;index<viewedProducts.products.length;index++){var prod=viewedProducts.products[index];if(prod.entryId==Id){product=prod;break;}}}}
return product;};var getCartItem=function(Id){var data=allo.session.data.cart;if(!data)return null;if(!data.items)return null;for(var i in data.items){if(data.items[i].id==Id){return data.items[i];}}
return null;};var isChangeQtyButton=function(elem){if(!elem)return false;if(!elem.hasClassName('qty-link'))return false;return true;};var isRemoveFromCart=function(elem){if(!elem)return false;if(!elem.tagName=='A')return false;if($$('body')[0].hasClassName('checkout-cart-index'))
if(elem.hasClassName('remove-icon'))return true;if(!elem.hasClassName('remove-product'))return false;return true;};var observeCartEvents=function(){document.observe('mouseup',function(e){if(!e.isLeftClick())return;var elem=e.element();if(!elem)return;if(isChangeQtyButton(elem)){var container=elem.up('li');if(!container)return;var productId=container.getAttribute('product-id');if(productId){Ecommerce.Cart.send(productId,{event:elem.hasClassName('control-down')?'remove':'add',category:'Cart',action:'click',label:elem.hasClassName('control-down')?'remove from cart':'add to cart'});}}else if(isRemoveFromCart(elem)){var container=elem.up('li');if($$('body')[0].hasClassName('checkout-cart-index'))
var container=elem.up('tr');if(!container)return;var productId=container.getAttribute('product-id');if(productId){Ecommerce.Cart.send(productId,{event:'remove',category:'Cart',action:'click',label:'remove from cart'});}}}.bind(this));};observeCartEvents();return{add:function(product){if(!product.hasOwnProperty('id')){for(var productId in product)
cache[productId]=product[productId];}else{cache[product.id]=product;}},send:function(productId,options){if(!ga)return;var product=getProduct(productId);if(!product)return;var qty=product.hasOwnProperty('quantity')?product.quantity:1;if(options.event==='remove'&&document.body.hasClassName('checkout-onepage-index')){var cartItem=getCartItem(productId);if(cartItem){qty=cartItem.q;}}
ga('ec:addProduct',{'id':product.id,'name':product.name,'category':product.category,'price':product.price,'quantity':qty});ga('ec:setAction',options.event);ga('send','event',options.category,options.action,options.label);}};})();Ecommerce.Checkout=(function(){var checkoutStep=function(stepName,element,eventName,options){this.name=stepName;this.control=$(element);this.eventName=eventName;if(options){this.option=options.hasOwnProperty('option')?options.option:null;this.immediate=options.hasOwnProperty('immediate')?options.immediate:false;this.condition=options.hasOwnProperty('condition')?options.condition:null;}};checkoutStep.prototype.send=function(option){ga('ec:setAction','checkout_option',{'step':this.name,'option':option});ga('send','event','Checkout','Option',{hitCallback:function(){var cookieName='Ga_UA_checkout_step'+this.name;allo.cookies.set(cookieName,1);}});};checkoutStep.prototype.isSend=function(){var cookieName='Ga_UA_checkout_step'+this.name;var step=allo.cookies.get(cookieName);return!!step;},checkoutStep.prototype.apply=function(){if(this.condition&&!this.condition())
return;if(this.immediate&&this.control.value){var validator=new Validator();if(validator.test(this.control.value,this.control)){if(!this.isSend())
this.send(this.control.value);}
delete validator;return;}
this.control.observe(this.eventName,function(){if(this.option){if(!this.isSend())
this.send(this.option);}else if(this.control.value){var validator=new Validator();if(validator.test(this.control.value,this.control)){if(!this.isSend())
this.send(this.control.value);}
delete validator;}}.bind(this));};var observeCheckoutEvent=function(){document.observe('checkout:inited',function(e){if(allo.session.data.universalGa){var email=getCheckoutField('email_input','email');if(email)Ecommerce.Checkout.send('1',Translator.translate('BlueAcorn_UniversalAnalytics::Email'));var phone=getCheckoutField('address_telephone_number','phone');if(phone)Ecommerce.Checkout.send('2',Translator.translate('BlueAcorn_UniversalAnalytics::Phone'));var city=$('address_city').value;if(!city){$('address_city').observe('focus',function(){Ecommerce.Checkout.send('3',Translator.translate('BlueAcorn_UniversalAnalytics::City activated'));});}}});};observeCheckoutEvent();var isSend=function(step){var cookieName='Ga_UA_checkout_step'+step;return allo.session.data.universalGa[cookieName]==1;};var getCheckoutField=function(control,field){var emailField=$(control);if(emailField)return emailField.value;var data=allo.session.data.customer;if(data&&data.customer){return data.customer[field];}};return{send:function(step,label){if(isSend(step))return;if(allo.session.data.universalGa['step_'+step])return;allo.session.data.universalGa['step_'+step]=1;var cart=allo.session.data.cart;var cartItems=cart&&cart.items?cart.items:[];for(var index=0;index<cartItems.length;index++){ga('ec:addProduct',{'id':product.id,'name':product.name,'price':product.price,'quantity':product.q});}
ga('ec:setAction','checkout',{'step':step,'label':label});ga('send','pageview',{hitCallback:function(){var cookieName='Ga_UA_checkout_step'+step;new Ajax.Request(allo.session.data.universalGa.saveUrl,{method:'post',parameters:{'step':cookieName},onSuccess:function(response){if(response&&response.responseJSON){if(response.responseJSON.action=='success')
allo.session.data.universalGa[cookieName]=1;}},onComplete:function(response){allo.session.data.universalGa['step_'+step]=0;}});}});}};})();;

(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){

$.ui=$.ui||{};$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false;}
return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"));}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent;},uniqueId:(function(){var uuid=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid);}});};})(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){$(this).removeAttr("id");}});}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false;}
img=$("img[usemap='#"+mapName+"']")[0];return!!img&&visible(img);}
return(/^(input|select|textarea|button|object)$/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element);}
function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden";}).length;}
$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")));},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN);}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0;}
if(margin){size-=parseFloat($.css(elem,"margin"+this))||0;}});return size;}
$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this);}
return this.each(function(){$(this).css(type,reduce(this,size)+"px");});};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size);}
return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px");});};});}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key));}else{return removeData.call(this);}};})($.fn.removeData);}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.extend({focus:(function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem);}},delay);}):orig.apply(this,arguments);};})($.fn.focus),disableSelection:(function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault();});};})(),enableSelection:function(){return this.unbind(".ui-disableSelection");},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex);}
if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}}
return 0;}});$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return;}
if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return;}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args);}}}};

var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=(function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove");}}catch(e){}}
orig(elems);};})($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);return constructor;};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false;}
if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{if(args.length){options=$.widget.extend.apply(null,[options].concat(args));}
this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init();}}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}}
return this;},enable:function(){return this._setOptions({disabled:false});},disable:function(){return this._setOptions({disabled:true});},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+
this.eventNamespace;element.unbind(eventName).undelegate(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get());},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});var widget=$.widget;

var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false;});var mouse=$.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event);}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);}},_mouseDown:function(event){if(mouseHandled){return;}
this._mouseMoved=false;(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true;}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true;},this.options.delay);}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true;}}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent");}
this._mouseMoveDelegate=function(event){return that._mouseMove(event);};this._mouseUpDelegate=function(event){return that._mouseUp(event);};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true;},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event);}else if(!event.which){return this._mouseUp(event);}}
if(event.which||event.button){this._mouseMoved=true;}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault();}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));}
return!this._mouseStarted;},_mouseUp:function(event){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true);}
this._mouseStop(event);}
mouseHandled=false;return false;},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance);},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});

(function(){$.ui=$.ui||{};var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)];}
function parseCss(element,property){return parseInt($.css(element,property),10)||0;}
function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}};}
if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}};}
if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}};}
return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()};}
$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth;}
var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth;}
div.remove();return(cachedScrollbarWidth=w1-w2);},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||(overflowX==="auto"&&within.width<within.element[0].scrollWidth),hasOverflowY=overflowY==="scroll"||(overflowY==="auto"&&within.height<within.element[0].scrollHeight);return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0};},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&withinElement[0].nodeType===9;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow||isDocument?withinElement.width():withinElement.outerWidth(),height:isWindow||isDocument?withinElement.height():withinElement.outerHeight()};}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments);}
options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top";}
targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"];}
pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]];});if(collision.length===1){collision[1]=collision[0];}
if(options.at[0]==="right"){basePosition.left+=targetWidth;}else if(options.at[0]==="center"){basePosition.left+=targetWidth/2;}
if(options.at[1]==="bottom"){basePosition.top+=targetHeight;}else if(options.at[1]==="center"){basePosition.top+=targetHeight/2;}
atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth;}else if(options.my[0]==="center"){position.left-=elemWidth/2;}
if(options.my[1]==="bottom"){position.top-=elemHeight;}else if(options.my[1]==="center"){position.top-=elemHeight/2;}
position.left+=myOffset[0];position.top+=myOffset[1];if(!supportsOffsetFractions){position.left=round(position.left);position.top=round(position.top);}
collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem});}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center";}
if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle";}
if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal";}else{feedback.important="vertical";}
options.using.call(this,props,feedback);};}
elem.offset($.extend(position,{using:using}));});};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight;}else if(overRight>0&&overLeft<=0){position.left=withinOffset;}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth;}else{position.left=withinOffset;}}}else if(overLeft>0){position.left+=overLeft;}else if(overRight>0){position.left-=overRight;}else{position.left=max(position.left-collisionPosLeft,position.left);}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom;}else if(overBottom>0&&overTop<=0){position.top=withinOffset;}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight;}else{position.top=withinOffset;}}}else if(overTop>0){position.top+=overTop;}else if(overBottom>0){position.top-=overBottom;}else{position.top=max(position.top-collisionPosTop,position.top);}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset;}}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset;}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;if(newOverBottom<0||newOverBottom<abs(overTop)){position.top+=myOffset+atOffset+offset;}}else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;if(newOverTop>0||abs(newOverTop)<overBottom){position.top+=myOffset+atOffset+offset;}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments);},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments);}}};(function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});}
for(i in testElementStyle){testElement.style[i]=testElementStyle[i];}
testElement.appendChild(div);testElementParent=body||document.documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);div.style.cssText="position: absolute; left: 10.7432222px;";offsetLeft=$(div).offset().left;supportsOffsetFractions=offsetLeft>10&&offsetLeft<11;testElement.innerHTML="";testElementParent.removeChild(testElement);})();})();var position=$.ui.position;

var accordion=$.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");if(!options.collapsible&&(options.active===false||options.active==null)){options.active=0;}
this._processPanels();if(options.active<0){options.active+=this.headers.length;}
this._refresh();},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?$():this.active.next()};},_createIcons:function(){var icons=this.options.icons;if(icons){$("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader);this.headers.addClass("ui-accordion-icons");}},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove();},_destroy:function(){var contents;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default "+"ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId();this._destroyIcons();contents=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom "+"ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){contents.css("height","");}},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
if(key==="event"){if(this.options.event){this._off(this.headers,this.options.event);}
this._setupEvents(value);}
this._super(key,value);if(key==="collapsible"&&!value&&this.options.active===false){this._activate(0);}
if(key==="icons"){this._destroyIcons();if(value){this._createIcons();}}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value);this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!value);}},_keydown:function(event){if(event.altKey||event.ctrlKey){return;}
var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=false;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1];break;}
if(toFocus){$(event.target).attr("tabIndex",-1);$(toFocus).attr("tabIndex",0);toFocus.focus();event.preventDefault();}},_panelKeyDown:function(event){if(event.keyCode===$.ui.keyCode.UP&&event.ctrlKey){$(event.currentTarget).prev().focus();}},refresh:function(){var options=this.options;this._processPanels();if((options.active===false&&options.collapsible===true)||!this.headers.length){options.active=false;this.active=$();}else if(options.active===false){this._activate(0);}else if(this.active.length&&!$.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){options.active=false;this.active=$();}else{this._activate(Math.max(0,options.active-1));}}else{options.active=this.headers.index(this.active);}
this._destroyIcons();this._refresh();},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all");this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide();if(prevPanels){this._off(prevHeaders.not(this.headers));this._off(prevPanels.not(this.panels));}},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId);panel.attr("aria-labelledby",headerId);}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0);}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"});}
this._createIcons();this._setupEvents(options.event);if(heightStyle==="fill"){maxHeight=parent.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.headers.each(function(){maxHeight-=$(this).outerHeight(true);});this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).css("height","").height());}).height(maxHeight);}},_activate:function(index){var active=this._findActive(index)[0];if(active===this.active[0]){return;}
active=active||this.active[0];this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop});},_findActive:function(selector){return typeof selector==="number"?this.headers.eq(selector):$();},_setupEvents:function(event){var events={keydown:"_keydown"};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.headers.add(this.headers.next()));this._on(this.headers,events);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers);},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault();if((clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.headers.index(clicked);this.active=clickedIsActive?$():clicked;this._toggle(eventData);active.removeClass("ui-accordion-header-active ui-state-active");if(options.icons){active.children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header);}
if(!clickedIsActive){clicked.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top");if(options.icons){clicked.children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader);}
clicked.next().addClass("ui-accordion-content-active");}},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=toShow;this.prevHide=toHide;if(this.options.animate){this._animate(toShow,toHide,data);}else{toHide.hide();toShow.show();this._toggleComplete(data);}
toHide.attr({"aria-hidden":"true"});toHide.prev().attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){toHide.prev().attr({"tabIndex":-1,"aria-expanded":"false"});}else if(toShow.length){this.headers.filter(function(){return parseInt($(this).attr("tabIndex"),10)===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,boxSizing=toShow.css("box-sizing"),down=toShow.length&&(!toHide.length||(toShow.index()<toHide.index())),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data);};if(typeof options==="number"){duration=options;}
if(typeof options==="string"){easing=options;}
easing=easing||options.easing||animate.easing;duration=duration||options.duration||animate.duration;if(!toHide.length){return toShow.animate(this.showProps,duration,easing,complete);}
if(!toShow.length){return toHide.animate(this.hideProps,duration,easing,complete);}
total=toShow.show().outerHeight();toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now);}});toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now);if(fx.prop!=="height"){if(boxSizing==="content-box"){adjust+=fx.now;}}else if(that.options.heightStyle!=="content"){fx.now=Math.round(total-toHide.outerHeight()-adjust);adjust=0;}}});},_toggleComplete:function(data){var toHide=data.oldPanel;toHide.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");if(toHide.length){toHide.parent()[0].className=toHide.parent()[0].className;}
this._trigger("activate",null,data);}});

var menu=$.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0});if(this.options.disabled){this.element.addClass("ui-state-disabled").attr("aria-disabled","true");}
this._on({"mousedown .ui-menu-item":function(event){event.preventDefault();},"click .ui-menu-item":function(event){var target=$(event.target);if(!this.mouseHandled&&target.not(".ui-state-disabled").length){this.select(event);if(!event.isPropagationStopped()){this.mouseHandled=true;}
if(target.has(".ui-menu").length){this.expand(event);}else if(!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer);}}}},"mouseenter .ui-menu-item":function(event){if(this.previousFilter){return;}
var target=$(event.currentTarget);target.siblings(".ui-state-active").removeClass("ui-state-active");this.focus(event,target);},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);if(!keepActiveItem){this.focus(event,item);}},blur:function(event){this._delay(function(){if(!$.contains(this.element[0],this.document[0].activeElement)){this.collapseAll(event);}});},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(event){if(this._closeOnDocumentClick(event)){this.collapseAll(event);}
this.mouseHandled=false;}});},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var elem=$(this);if(elem.data("ui-menu-submenu-carat")){elem.remove();}});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content");},_keydown:function(event){var match,prev,character,skip,preventDefault=true;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(event);}
break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=false;prev=this.previousFilter||"";character=String.fromCharCode(event.keyCode);skip=false;clearTimeout(this.filterTimer);if(character===prev){skip=true;}else{character=prev+character;}
match=this._filterMenuItems(character);match=skip&&match.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):match;if(!match.length){character=String.fromCharCode(event.keyCode);match=this._filterMenuItems(character);}
if(match.length){this.focus(event,match);this.previousFilter=character;this.filterTimer=this._delay(function(){delete this.previousFilter;},1000);}else{delete this.previousFilter;}}
if(preventDefault){event.preventDefault();}},_activate:function(event){if(!this.active.is(".ui-state-disabled")){if(this.active.is("[aria-haspopup='true']")){this.expand(event);}else{this.select(event);}}},refresh:function(){var menus,items,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length);submenus.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.parent(),submenuCarat=$("<span>").addClass("ui-menu-icon ui-icon "+icon).data("ui-menu-submenu-carat",true);item.attr("aria-haspopup","true").prepend(submenuCarat);menu.attr("aria-labelledby",item.attr("id"));});menus=submenus.add(this.element);items=menus.find(this.options.items);items.not(".ui-menu-item").each(function(){var item=$(this);if(that._isDivider(item)){item.addClass("ui-widget-content ui-menu-divider");}});items.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()});items.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!$.contains(this.element[0],this.active[0])){this.blur();}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role];},_setOption:function(key,value){if(key==="icons"){this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(value.submenu);}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value);}
this._super(key,value);},focus:function(event,item){var nested,focused;this.blur(event,event&&event.type==="focus");this._scrollIntoView(item);this.active=item.first();focused=this.active.addClass("ui-state-focus").removeClass("ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",focused.attr("id"));}
this.active.parent().closest(".ui-menu-item").addClass("ui-state-active");if(event&&event.type==="keydown"){this._close();}else{this.timer=this._delay(function(){this._close();},this.delay);}
nested=item.children(".ui-menu");if(nested.length&&event&&(/^mouse/.test(event.type))){this._startOpening(nested);}
this.activeMenu=item.parent();this._trigger("focus",event,{item:item});},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;if(this._hasScroll()){borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop;scroll=this.activeMenu.scrollTop();elementHeight=this.activeMenu.height();itemHeight=item.outerHeight();if(offset<0){this.activeMenu.scrollTop(scroll+offset);}else if(offset+itemHeight>elementHeight){this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight);}}},blur:function(event,fromFocus){if(!fromFocus){clearTimeout(this.timer);}
if(!this.active){return;}
this.active.removeClass("ui-state-focus");this.active=null;this._trigger("blur",event,{item:this.active});},_startOpening:function(submenu){clearTimeout(this.timer);if(submenu.attr("aria-hidden")!=="true"){return;}
this.timer=this._delay(function(){this._close();this._open(submenu);},this.delay);},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true");submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position);},collapseAll:function(event,all){clearTimeout(this.timer);this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));if(!currentMenu.length){currentMenu=this.element;}
this._close(currentMenu);this.blur(event);this.activeMenu=currentMenu;},this.delay);},_close:function(startMenu){if(!startMenu){startMenu=this.active?this.active.parent():this.element;}
startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active");},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length;},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text());},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(newItem&&newItem.length){this._close();this.focus(event,newItem);}},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();if(newItem&&newItem.length){this._open(newItem.parent());this._delay(function(){this.focus(event,newItem);});}},next:function(event){this._move("next","first",event);},previous:function(event){this._move("prev","last",event);},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length;},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length;},_move:function(direction,filter,event){var next;if(this.active){if(direction==="first"||direction==="last"){next=this.active
[direction==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1);}else{next=this.active
[direction+"All"](".ui-menu-item").eq(0);}}
if(!next||!next.length||!this.active){next=this.activeMenu.find(this.options.items)[filter]();}
this.focus(event,next);},nextPage:function(event){var item,base,height;if(!this.active){this.next(event);return;}
if(this.isLastItem()){return;}
if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base-height<0;});this.focus(event,item);}else{this.focus(event,this.activeMenu.find(this.options.items)
[!this.active?"first":"last"]());}},previousPage:function(event){var item,base,height;if(!this.active){this.next(event);return;}
if(this.isFirstItem()){return;}
if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base+height>0;});this.focus(event,item);}else{this.focus(event,this.activeMenu.find(this.options.items).first());}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight");},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(event,true);}
this._trigger("select",event,ui);},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).text()));});}});

$.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea=nodeName==="textarea",isInput=nodeName==="input";this.isMultiLine=isTextarea?true:isInput?false:this.element.prop("isContentEditable");this.valueMethod=this.element[isTextarea||isInput?"val":"text"];this.isNewMenu=true;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly")){suppressKeyPress=true;suppressInput=true;suppressKeyPressRepeat=true;return;}
suppressKeyPress=false;suppressInput=false;suppressKeyPressRepeat=false;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=true;this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=true;this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=true;this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=true;this._keyEvent("next",event);break;case keyCode.ENTER:if(this.menu.active){suppressKeyPress=true;event.preventDefault();this.menu.select(event);}
break;case keyCode.TAB:if(this.menu.active){this.menu.select(event);}
break;case keyCode.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term);}
this.close(event);event.preventDefault();}
break;default:suppressKeyPressRepeat=true;this._searchTimeout(event);break;}},keypress:function(event){if(suppressKeyPress){suppressKeyPress=false;if(!this.isMultiLine||this.menu.element.is(":visible")){event.preventDefault();}
return;}
if(suppressKeyPressRepeat){return;}
var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event);break;}},input:function(event){if(suppressInput){suppressInput=false;event.preventDefault();return;}
this._searchTimeout(event);},focus:function(){this.selectedItem=null;this.previous=this._value();},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return;}
clearTimeout(this.searching);this.close(event);this._change(event);}});this._initSource();this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");this._on(this.menu.element,{mousedown:function(event){event.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;});var menuElement=this.menu.element[0];if(!$(event.target).closest(".ui-menu-item").length){this._delay(function(){var that=this;this.document.one("mousedown",function(event){if(event.target!==that.element[0]&&event.target!==menuElement&&!$.contains(menuElement,event.target)){that.close();}});});}},menufocus:function(event,ui){var label,item;if(this.isNewMenu){this.isNewMenu=false;if(event.originalEvent&&/^mouse/.test(event.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent);});return;}}
item=ui.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",event,{item:item})){if(event.originalEvent&&/^key/.test(event.originalEvent.type)){this._value(item.value);}}
label=ui.item.attr("aria-label")||item.value;if(label&&$.trim(label).length){this.liveRegion.children().hide();$("<div>").text(label).appendTo(this.liveRegion);}},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=previous;this._delay(function(){this.previous=previous;this.selectedItem=item;});}
if(false!==this._trigger("select",event,{item:item})){this._value(item.value);}
this.term=this._value();this.close(event);this.selectedItem=item;}});this.liveRegion=$("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete");}});},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove();},_setOption:function(key,value){this._super(key,value);if(key==="source"){this._initSource();}
if(key==="appendTo"){this.menu.element.appendTo(this._appendTo());}
if(key==="disabled"&&value&&this.xhr){this.xhr.abort();}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
if(!element||!element[0]){element=this.element.closest(".ui-front");}
if(!element.length){element=this.document[0].body;}
return element;},_initSource:function(){var array,url,that=this;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term));};}else if(typeof this.options.source==="string"){url=this.options.source;this.source=function(request,response){if(that.xhr){that.xhr.abort();}
that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data);},error:function(){response([]);}});};}else{this.source=this.options.source;}},_searchTimeout:function(event){clearTimeout(this.searching);this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;if(!equalValues||(equalValues&&!menuVisible&&!modifierKey)){this.selectedItem=null;this.search(null,event);}},this.options.delay);},search:function(value,event){value=value!=null?value:this._value();this.term=this._value();if(value.length<this.options.minLength){return this.close(event);}
if(this._trigger("search",event)===false){return;}
return this._search(value);},_search:function(value){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:value},this._response());},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){if(index===this.requestIndex){this.__response(content);}
this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading");}},this);},__response:function(content){if(content){content=this._normalize(content);}
this._trigger("response",null,{content:content});if(!this.options.disabled&&content&&content.length&&!this.cancelSearch){this._suggest(content);this._trigger("open");}else{this._close();}},close:function(event){this.cancelSearch=true;this._close(event);},_close:function(event){if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",event);}},_change:function(event){if(this.previous!==this._value()){this._trigger("change",event,{item:this.selectedItem});}},_normalize:function(items){if(items.length&&items[0].label&&items[0].value){return items;}
return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item};}
return $.extend({},item,{label:item.label||item.value,value:item.value||item.label});});},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items);this.isNewMenu=true;this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next();}},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()));},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item);});},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item);},_renderItem:function(ul,item){return $("<li>").text(item.label).appendTo(ul);},_move:function(direction,event){if(!this.menu.element.is(":visible")){this.search(null,event);return;}
if(this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)){if(!this.isMultiLine){this._value(this.term);}
this.menu.blur();return;}
this.menu[direction](event);},widget:function(){return this.menu.element;},_value:function(){return this.valueMethod.apply(this.element,arguments);},_keyEvent:function(keyEvent,event){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(keyEvent,event);event.preventDefault();}}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value);});}});$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate.";}}},__response:function(content){var message;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return;}
if(content&&content.length){message=this.options.messages.results(content.length);}else{message=this.options.messages.noResults;}
this.liveRegion.children().hide();$("<div>").text(message).appendTo(this.liveRegion);}});var autocomplete=$.ui.autocomplete;

var lastActive,baseClasses="ui-button ui-widget ui-state-default ui-corner-all",typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var form=$(this);setTimeout(function(){form.find(":ui-button").button("refresh");},1);},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);if(name){name=name.replace(/'/g,"\\'");if(form){radios=$(form).find("[name='"+name+"'][type=radio]");}else{radios=$("[name='"+name+"'][type=radio]",radio.ownerDocument).filter(function(){return!this.form;});}}
return radios;};$.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,formResetHandler);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.prop("disabled");}else{this.element.prop("disabled",this.options.disabled);}
this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var that=this,options=this.options,toggleButton=this.type==="checkbox"||this.type==="radio",activeClass=!toggleButton?"ui-state-active":"";if(options.label===null){options.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html());}
this._hoverable(this.buttonElement);this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(options.disabled){return;}
if(this===lastActive){$(this).addClass("ui-state-active");}}).bind("mouseleave"+this.eventNamespace,function(){if(options.disabled){return;}
$(this).removeClass(activeClass);}).bind("click"+this.eventNamespace,function(event){if(options.disabled){event.preventDefault();event.stopImmediatePropagation();}});this._on({focus:function(){this.buttonElement.addClass("ui-state-focus");},blur:function(){this.buttonElement.removeClass("ui-state-focus");}});if(toggleButton){this.element.bind("change"+this.eventNamespace,function(){that.refresh();});}
if(this.type==="checkbox"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled){return false;}});}else if(this.type==="radio"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled){return false;}
$(this).addClass("ui-state-active");that.buttonElement.attr("aria-pressed","true");var radio=that.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0];}).removeClass("ui-state-active").attr("aria-pressed","false");});}else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(options.disabled){return false;}
$(this).addClass("ui-state-active");lastActive=this;that.document.one("mouseup",function(){lastActive=null;});}).bind("mouseup"+this.eventNamespace,function(){if(options.disabled){return false;}
$(this).removeClass("ui-state-active");}).bind("keydown"+this.eventNamespace,function(event){if(options.disabled){return false;}
if(event.keyCode===$.ui.keyCode.SPACE||event.keyCode===$.ui.keyCode.ENTER){$(this).addClass("ui-state-active");}}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active");});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(event){if(event.keyCode===$.ui.keyCode.SPACE){$(this).click();}});}}
this._setOption("disabled",options.disabled);this._resetButton();},_determineButtonType:function(){var ancestor,labelSelector,checked;if(this.element.is("[type=checkbox]")){this.type="checkbox";}else if(this.element.is("[type=radio]")){this.type="radio";}else if(this.element.is("input")){this.type="input";}else{this.type="button";}
if(this.type==="checkbox"||this.type==="radio"){ancestor=this.element.parents().last();labelSelector="label[for='"+this.element.attr("id")+"']";this.buttonElement=ancestor.find(labelSelector);if(!this.buttonElement.length){ancestor=ancestor.length?ancestor.siblings():this.element.siblings();this.buttonElement=ancestor.filter(labelSelector);if(!this.buttonElement.length){this.buttonElement=ancestor.find(labelSelector);}}
this.element.addClass("ui-helper-hidden-accessible");checked=this.element.is(":checked");if(checked){this.buttonElement.addClass("ui-state-active");}
this.buttonElement.prop("aria-pressed",checked);}else{this.buttonElement=this.element;}},widget:function(){return this.buttonElement;},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(baseClasses+" ui-state-active "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title");}},_setOption:function(key,value){this._super(key,value);if(key==="disabled"){this.widget().toggleClass("ui-state-disabled",!!value);this.element.prop("disabled",!!value);if(value){if(this.type==="checkbox"||this.type==="radio"){this.buttonElement.removeClass("ui-state-focus");}else{this.buttonElement.removeClass("ui-state-focus ui-state-active");}}
return;}
this._resetButton();},refresh:function(){var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");if(isDisabled!==this.options.disabled){this._setOption("disabled",isDisabled);}
if(this.type==="radio"){radioGroup(this.element[0]).each(function(){if($(this).is(":checked")){$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true");}else{$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false");}});}else if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true");}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false");}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label);}
return;}
var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];if(icons.primary||icons.secondary){if(this.options.text){buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":(icons.primary?"-primary":"-secondary")));}
if(icons.primary){buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>");}
if(icons.secondary){buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>");}
if(!this.options.text){buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){buttonElement.attr("title",$.trim(buttonText));}}}else{buttonClasses.push("ui-button-text-only");}
buttonElement.addClass(buttonClasses.join(" "));}});$.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset");},_init:function(){this.refresh();},_setOption:function(key,value){if(key==="disabled"){this.buttons.button("option",key,value);}
this._super(key,value);},refresh:function(){var rtl=this.element.css("direction")==="rtl",allButtons=this.element.find(this.options.items),existingButtons=allButtons.filter(":ui-button");allButtons.not(":ui-button").button();existingButtons.button("refresh");this.buttons=allButtons.map(function(){return $(this).button("widget")[0];}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(rtl?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(rtl?"ui-corner-left":"ui-corner-right").end().end();},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return $(this).button("widget")[0];}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");}});var button=$.ui.button;

$.extend($.ui,{datepicker:{version:"1.11.4"}});var datepicker_instActive;function datepicker_getZindex(elem){var position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}
return 0;}
function Datepicker(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"));}
$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv;},setDefaults:function(settings){datepicker_extendRemove(this._defaults,settings||{});return this;},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase();inline=(nodeName==="div"||nodeName==="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid;}
inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{});if(nodeName==="input"){this._connectDatepicker(target,inst);}else if(inline){this._inlineDatepicker(target,inst);}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))};},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return;}
this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(inst);$.data(target,"datepicker",inst);if(inst.settings.disabled){this._disableDatepicker(target);}},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove();}
if(appendText){inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>");input[isRTL?"before":"after"](inst.append);}
input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove();}
showOn=this._get(inst,"showOn");if(showOn==="focus"||showOn==="both"){input.focus(this._showDatepicker);}
if(showOn==="button"||showOn==="both"){buttonText=this._get(inst,"buttonText");buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(!buttonImage?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]){$.datepicker._hideDatepicker();}else if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0]);}else{$.datepicker._showDatepicker(input[0]);}
return false;});}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,12-1,20),dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){findMax=function(names){max=0;maxI=0;for(i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i;}}
return maxI;};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay());}
inst.input.attr("size",this._formatDate(inst,date).length);}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return;}
divSpan.addClass(this.markerClassName).append(inst.dpDiv);$.data(target,"datepicker",inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target);}
inst.dpDiv.css("display","block");},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;if(!inst){this.uuid+=1;id="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],"datepicker",inst);}
datepicker_extendRemove(inst.settings,settings||{});date=(date&&date.constructor===Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){browserWidth=document.documentElement.clientWidth;browserHeight=document.documentElement.clientHeight;scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY];}
this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv);}
$.data(this._dialogInput[0],"datepicker",inst);return this;},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();$.removeData(target,"datepicker");if(nodeName==="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp);}else if(nodeName==="div"||nodeName==="span"){$target.removeClass(this.markerClassName).empty();}
if(datepicker_instActive===inst){datepicker_instActive=null;}},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false;}).end().filter("img").css({opacity:"1.0",cursor:""});}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false);}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value);});},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true;}).end().filter("img").css({opacity:"0.5",cursor:"default"});}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true);}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value);});this._disabledInputs[this._disabledInputs.length]=target;},_isDisabledDatepicker:function(target){if(!target){return false;}
for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]===target){return true;}}
return false;},_getInst:function(target){try{return $.data(target,"datepicker");}
catch(err){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(arguments.length===2&&typeof name==="string"){return(name==="defaults"?$.extend({},$.datepicker._defaults):(inst?(name==="all"?$.extend({},inst.settings):this._get(inst,name)):null));}
settings=name||{};if(typeof name==="string"){settings={};settings[name]=value;}
if(inst){if(this._curInst===inst){this._hideDatepicker();}
date=this._getDateDatepicker(target,true);minDate=this._getMinMaxDate(inst,"min");maxDate=this._getMinMaxDate(inst,"max");datepicker_extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate);}
if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate);}
if("disabled"in settings){if(settings.disabled){this._disableDatepicker(target);}else{this._enableDatepicker(target);}}
this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst);}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value);},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst);}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst);}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault);}
return(inst?this._getDate(inst):null);},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=true,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:sel=$("td."+$.datepicker._dayOverClass+":not(."+
$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]);}
onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);}else{$.datepicker._hideDatepicker();}
return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target);}
handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target);}
handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D");}
handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");}
break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D");}
handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D");}
handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");}
break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D");}
handled=event.ctrlKey||event.metaKey;break;default:handled=false;}}else if(event.keyCode===36&&event.ctrlKey){$.datepicker._showDatepicker(this);}else{handled=false;}
if(handled){event.preventDefault();event.stopPropagation();}},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));chr=String.fromCharCode(event.charCode==null?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1);}},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal){try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst);}}
catch(err){}}
return true;},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!=="input"){input=$("input",input.parentNode)[0];}
if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput===input){return;}
var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!==inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0]);}}
beforeShow=$.datepicker._get(inst,"beforeShow");beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return;}
datepicker_extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value="";}
if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight;}
isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")==="fixed";return!isFixed;});offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){showAnim=$.datepicker._get(inst,"showAnim");duration=$.datepicker._get(inst,"duration");inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration);}else{inst.dpDiv[showAnim||"show"](showAnim?duration:null);}
if($.datepicker._shouldFocusInput(inst)){inst.input.focus();}
$.datepicker._curInst=inst;}},_updateDatepicker:function(inst){this.maxRows=4;datepicker_instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17,activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");if(activeCell.length>0){datepicker_handleMouseover.apply(activeCell.get(0));}
inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em");}
inst.dpDiv[(numMonths[0]!==1||numMonths[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)){inst.input.focus();}
if(inst.yearshtml){origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml);}
origyearshtml=inst.yearshtml=null;},0);}},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus");},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left===inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top===(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset;},_findPos:function(obj){var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"];}
position=$(obj).offset();return[position.left,position.top];},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;if(!inst||(input&&inst!==$.data(input,"datepicker"))){return;}
if(this._datepickerShowing){showAnim=this._get(inst,"showAnim");duration=this._get(inst,"duration");postProcess=function(){$.datepicker._tidyDialog(inst);};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess);}else{inst.dpDiv[(showAnim==="slideDown"?"slideUp":(showAnim==="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess);}
if(!showAnim){postProcess();}
this._datepickerShowing=false;onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst]);}
this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv);}}
this._inDialog=false;}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar");},_checkExternalClick:function(event){if(!$.datepicker._curInst){return;}
var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!==$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length===0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst)){$.datepicker._hideDatepicker();}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return;}
this._adjustInstDate(inst,offset+
(period==="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst);},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear;}else{date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();}
this._notifyChange(inst);this._adjustDate(target);},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+(period==="M"?"Month":"Year")]=inst["draw"+(period==="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target);},_selectDay:function(id,month,year,td){var inst,target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return;}
inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear));},_clearDate:function(id){var target=$(id);this._selectDate(target,"");},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr);}
this._updateAlternate(inst);onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);}else if(inst.input){inst.input.trigger("change");}
if(inst.inline){this._updateDatepicker(inst);}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!=="object"){inst.input.focus();}
this._lastInput=null;}},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");if(altField){altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");date=this._getDate(inst);dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr);});}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""];},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1;},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments";}
value=(typeof value==="object"?value.toString():value+"");if(value===""){return null;}
var iFormat,dim,extra,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff=(typeof shortYearCutoffTemp!=="string"?shortYearCutoffTemp:new Date().getFullYear()%100+parseInt(shortYearCutoffTemp,10)),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=false,date,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;},getNumber=function(match){var isDoubled=lookAhead(match),size=(match==="@"?14:(match==="!"?20:(match==="y"&&isDoubled?4:(match==="o"?3:2)))),minSize=(match==="y"?size:1),digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue;}
iValue+=num[0].length;return parseInt(num[0],10);},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]];}).sort(function(a,b){return-(a[1].length-b[1].length);});$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()){index=pair[0];iValue+=name.length;return false;}});if(index!==-1){return index+1;}else{throw"Unknown name at position "+iValue;}},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat)){throw"Unexpected literal at position "+iValue;}
iValue++;};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{checkLiteral();}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral();}else{literal=true;}
break;default:checkLiteral();}}}
if(iValue<value.length){extra=value.substr(iValue);if(!/^\s+/.test(extra)){throw"Extra/unparsed characters found in date: "+extra;}}
if(year===-1){year=new Date().getFullYear();}else if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+
(year<=shortYearCutoff?0:-100);}
if(doy>-1){month=1;day=doy;do{dim=this._getDaysInMonth(year,month-1);if(day<=dim){break;}
month++;day-=dim;}while(true);}
date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day){throw"Invalid date";}
return date;},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+
Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return"";}
var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num;}}
return num;},formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value]);},output="",literal=false;if(date){for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{output+=format.charAt(iFormat);}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'";}else{literal=true;}
break;default:output+=format.charAt(iFormat);}}}}
return output;},_possibleChars:function(format){var iFormat,chars="",literal=false,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{chars+=format.charAt(iFormat);}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'";}else{literal=true;}
break;default:chars+=format.charAt(iFormat);}}}
return chars;},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name];},_setDateFromField:function(inst,noDefault){if(inst.input.val()===inst.lastVal){return;}
var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate;}catch(event){dates=(noDefault?"":dates);}
inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst);},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()));},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date;},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst));}
catch(e){}
var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date(),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;}
matches=pattern.exec(offset);}
return new Date(year,month,day);},newDate=(date==null||date===""?defaultDate:(typeof date==="string"?offsetString(date):(typeof date==="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()==="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0);}
return this._daylightSavingAdjust(newDate);},_daylightSavingAdjust:function(date){if(!date){return null;}
date.setHours(date.getHours()>12?date.getHours()+2:0);return date;},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!==inst.selectedMonth||origYear!==inst.selectedYear)&&!noChange){this._notifyChange(inst);}
this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst));}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()==="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate;},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M");},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M");},hide:function(){$.datepicker._hideDatepicker();},today:function(){$.datepicker._gotoToday(id);},selectDay:function(){$.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false;},selectMonth:function(){$.datepicker._selectMonthYear(id,this,"M");return false;},selectYear:function(){$.datepicker._selectMonthYear(id,this,"Y");return false;}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")]);});},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date(),today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=(numMonths[0]!==1||numMonths[1]!==1),currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay))),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--;}
if(maxDate){maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--;}}}
inst.drawMonth=drawMonth;inst.drawYear=drawYear;prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'"+" title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>"));nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'"+" title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>"));currentText=this._get(inst,"currentText");gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));controls=(!inst.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+
this._get(inst,"closeText")+"</button>":"");buttonPanel=(showButtonPanel)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+
(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'"+">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);showWeek=this._get(inst,"showWeek");dayNames=this._get(inst,"dayNames");dayNamesMin=this._get(inst,"dayNamesMin");monthNames=this._get(inst,"monthNames");monthNamesShort=this._get(inst,"monthNamesShort");beforeShowDay=this._get(inst,"beforeShowDay");showOtherMonths=this._get(inst,"showOtherMonths");selectOtherMonths=this._get(inst,"selectOtherMonths");defaultDate=this._getDefaultDate(inst);html="";dow;for(row=0;row<numMonths[0];row++){group="";this.maxRows=4;for(col=0;col<numMonths[1];col++){selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));cornerClass=" ui-corner-all";calender="";if(isMultiMonth){calender+="<div class='ui-datepicker-group";if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break;}}
calender+="'>";}
calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+
(/all|left/.test(cornerClass)&&row===0?(isRTL?next:prev):"")+
(/all|right/.test(cornerClass)&&row===0?(isRTL?prev:next):"")+
this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";thead=(showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"");for(dow=0;dow<7;dow++){day=(dow+firstDay)%7;thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";}
calender+=thead+"</tr></thead><tbody>";daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth);}
leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;curRows=Math.ceil((leadDays+daysInMonth)/7);numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(dRow=0;dRow<numRows;dRow++){calender+="<tr>";tbody=(!showWeek?"":"<td class='ui-datepicker-week-col'>"+
this._get(inst,"calculateWeek")(printDate)+"</td>");for(dow=0;dow<7;dow++){daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);otherMonth=(printDate.getMonth()!==drawMonth);unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+="<td class='"+
((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+
(otherMonth?" ui-datepicker-other-month":"")+
((printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime())?" "+this._dayOverClass:"")+
(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+
(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+
(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+
(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+
((!otherMonth||showOtherMonths)&&daySettings[2]?" title='"+daySettings[2].replace(/'/g,"&#39;")+"'":"")+
(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+
(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+
(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+
(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+
(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate);}
calender+=tbody+"</tr>";}
drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++;}
calender+="</tbody></table>"+(isMultiMonth?"</div>"+
((numMonths[0]>0&&col===numMonths[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");group+=calender;}
html+=group;}
html+=buttonPanel;inst._keyEvent=false;return html;},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth){monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";}else{inMinYear=(minDate&&minDate.getFullYear()===drawYear);inMaxYear=(maxDate&&maxDate.getFullYear()===drawYear);monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+="<option value='"+month+"'"+
(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>";}}
monthHtml+="</select>";}
if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"");}
if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";}else{years=this._get(inst,"yearRange").split(":");thisYear=new Date().getFullYear();determineYear=function(value){var year=(value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year);};year=determineYear(years[0]);endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;year<=endYear;year++){inst.yearshtml+="<option value='"+year+"'"+
(year===drawYear?" selected='selected'":"")+">"+year+"</option>";}
inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null;}}
html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml;}
html+="</div>";return html;},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period==="Y"?offset:0),month=inst.drawMonth+(period==="M"?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period==="D"?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period==="M"||period==="Y"){this._notifyChange(inst);}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=(minDate&&date<minDate?minDate:date);return(maxDate&&newDate>maxDate?maxDate:newDate);},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst]);}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths==="number"?[1,numMonths]:numMonths));},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null);},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate();},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay();},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()));}
return this._isInRange(inst,date);},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");if(years){yearSplit=years.split(":");currentYear=new Date().getFullYear();minYear=parseInt(yearSplit[0],10);maxYear=parseInt(yearSplit[1],10);if(yearSplit[0].match(/[+\-].*/)){minYear+=currentYear;}
if(yearSplit[1].match(/[+\-].*/)){maxYear+=currentYear;}}
return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear));},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!=="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")};},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear;}
var date=(day?(typeof day==="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst));}});function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover");}
if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover");}}).delegate(selector,"mouseover",datepicker_handleMouseover);}
function datepicker_handleMouseover(){if(!$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover");}
if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover");}}}
function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null){target[name]=props[name];}}
return target;}
$.fn.datepicker=function(options){if(!this.length){return this;}
if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true;}
if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv);}
var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options==="string"&&(options==="isDisabled"||options==="getDate"||options==="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));}
if(options==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));}
return this.each(function(){typeof options==="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options);});};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.11.4";var datepicker=$.datepicker;

$.widget("ui.draggable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative();}
if(this.options.addClasses){this.element.addClass("ui-draggable");}
if(this.options.disabled){this.element.addClass("ui-draggable-disabled");}
this._setHandleClassName();this._mouseInit();},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._removeHandleClassName();this._setHandleClassName();}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return;}
this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._removeHandleClassName();this._mouseDestroy();},_mouseCapture:function(event){var o=this.options;this._blurActiveElement(event);if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){return false;}
this.handle=this._getHandle(event);if(!this.handle){return false;}
this._blockFrames(o.iframeFix===true?"iframe":o.iframeFix);return true;},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_blurActiveElement:function(event){var document=this.document[0];if(!this.handleElement.is(event.target)){return;}
try{if(document.activeElement&&document.activeElement.nodeName.toLowerCase()!=="body"){$(document.activeElement).blur();}}catch(error){}},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this;}
this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return $(this).css("position")==="fixed";}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(event);this.originalPosition=this.position=this._generatePosition(event,false);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this._setContainment();if(this._trigger("start",event)===false){this._clear();return false;}
this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this._normalizeRightBottom();this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event);}
return true;},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top};},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset();}
this.position=this._generatePosition(event,true);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp({});return false;}
this.position=ui.position;}
this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
return false;},_mouseStop:function(event){var that=this,dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event);}
if(this.dropped){dropped=this.dropped;this.dropped=false;}
if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(that._trigger("stop",event)!==false){that._clear();}});}else{if(this._trigger("stop",event)!==false){this._clear();}}
return false;},_mouseUp:function(event){this._unblockFrames();if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event);}
if(this.handleElement.is(event.target)){this.element.focus();}
return $.ui.mouse.prototype._mouseUp.call(this,event);},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({});}else{this._clear();}
return this;},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:true;},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("ui-draggable-handle");},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle");},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo));}
if(helperIsFunction&&helper[0]===this.element[0]){this._setPositionRelative();}
if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute");}
return helper;},_setPositionRelative:function(){if(!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative";}},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_isRootNode:function(element){return(/(html|body)/i).test(element.tagName)||element===this.document[0];},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this._isRootNode(this.offsetParent[0])){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0};}
var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(!scrollIsRootNode?this.scrollParent.scrollTop():0),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(!scrollIsRootNode?this.scrollParent.scrollLeft():0)};},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null;if(!o.containment){this.containment=null;return;}
if(o.containment==="window"){this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return;}
if(o.containment==="document"){this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return;}
if(o.containment.constructor===Array){this.containment=o.containment;return;}
if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
c=$(o.containment);ce=c[0];if(!ce){return;}
isUserScrollable=/(scroll|auto)/.test(c.css("overflow"));this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-
(parseInt(c.css("borderRightWidth"),10)||0)-
(parseInt(c.css("paddingRight"),10)||0)-
this.helperProportions.width-
this.margins.left-
this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-
(parseInt(c.css("borderBottomWidth"),10)||0)-
(parseInt(c.css("paddingBottom"),10)||0)-
this.helperProportions.height-
this.margins.top-
this.margins.bottom];this.relativeContainer=c;},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left))*mod))};},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;if(!scrollIsRootNode||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()};}
if(constrainPosition){if(this.containment){if(this.relativeContainer){co=this.relativeContainer.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top];}else{containment=this.containment;}
if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top;}}
if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left;}
if(o.axis==="y"){pageX=this.originalPageX;}
if(o.axis==="x"){pageY=this.originalPageY;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
(this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
(this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left)))};},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove();}
this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy();}},_normalizeRightBottom:function(){if(this.options.axis!=="y"&&this.helper.css("right")!=="auto"){this.helper.width(this.helper.width());this.helper.css("right","auto");}
if(this.options.axis!=="x"&&this.helper.css("bottom")!=="auto"){this.helper.height(this.helper.height());this.helper.css("bottom","auto");}},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui,this],true);if(/^(drag|start|stop)/.test(type)){this.positionAbs=this._convertPositionTo("absolute");ui.offset=this.positionAbs;}
return $.Widget.prototype._trigger.call(this,type,event,ui);},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[];$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");if(sortable&&!sortable.options.disabled){draggable.sortables.push(sortable);sortable.refreshPositions();sortable._trigger("activate",event,uiSortable);}});},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=false;$.each(draggable.sortables,function(){var sortable=this;if(sortable.isOver){sortable.isOver=0;draggable.cancelHelperRemoval=true;sortable.cancelHelperRemoval=false;sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")};sortable._mouseStop(event);sortable.options.helper=sortable.options._helper;}else{sortable.cancelHelperRemoval=true;sortable._trigger("deactivate",event,uiSortable);}});},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=false,sortable=this;sortable.positionAbs=draggable.positionAbs;sortable.helperProportions=draggable.helperProportions;sortable.offset.click=draggable.offset.click;if(sortable._intersectsWith(sortable.containerCache)){innermostIntersecting=true;$.each(draggable.sortables,function(){this.positionAbs=draggable.positionAbs;this.helperProportions=draggable.helperProportions;this.offset.click=draggable.offset.click;if(this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])){innermostIntersecting=false;}
return innermostIntersecting;});}
if(innermostIntersecting){if(!sortable.isOver){sortable.isOver=1;draggable._parent=ui.helper.parent();sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",true);sortable.options._helper=sortable.options.helper;sortable.options.helper=function(){return ui.helper[0];};event.target=sortable.currentItem[0];sortable._mouseCapture(event,true);sortable._mouseStart(event,true,true);sortable.offset.click.top=draggable.offset.click.top;sortable.offset.click.left=draggable.offset.click.left;sortable.offset.parent.left-=draggable.offset.parent.left-
sortable.offset.parent.left;sortable.offset.parent.top-=draggable.offset.parent.top-
sortable.offset.parent.top;draggable._trigger("toSortable",event);draggable.dropped=sortable.element;$.each(draggable.sortables,function(){this.refreshPositions();});draggable.currentItem=draggable.element;sortable.fromOutside=draggable;}
if(sortable.currentItem){sortable._mouseDrag(event);ui.position=sortable.position;}}else{if(sortable.isOver){sortable.isOver=0;sortable.cancelHelperRemoval=true;sortable.options._revert=sortable.options.revert;sortable.options.revert=false;sortable._trigger("out",event,sortable._uiHash(sortable));sortable._mouseStop(event,true);sortable.options.revert=sortable.options._revert;sortable.options.helper=sortable.options._helper;if(sortable.placeholder){sortable.placeholder.remove();}
ui.helper.appendTo(draggable._parent);draggable._refreshOffsets(event);ui.position=draggable._generatePosition(event,true);draggable._trigger("fromSortable",event);draggable.dropped=false;$.each(draggable.sortables,function(){this.refreshPositions();});}}});}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;if(t.css("cursor")){o._cursor=t.css("cursor");}
t.css("cursor",o.cursor);},stop:function(event,ui,instance){var o=instance.options;if(o._cursor){$("body").css("cursor",o._cursor);}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("opacity")){o._opacity=t.css("opacity");}
t.css("opacity",o.opacity);},stop:function(event,ui,instance){var o=instance.options;if(o._opacity){$(ui.helper).css("opacity",o._opacity);}}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false);}
if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset();}},drag:function(event,ui,i){var o=i.options,scrolled=false,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];if(scrollParent!==document&&scrollParent.tagName!=="HTML"){if(!o.axis||o.axis!=="x"){if((i.overflowOffset.top+scrollParent.offsetHeight)-event.pageY<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed;}else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed;}}
if(!o.axis||o.axis!=="y"){if((i.overflowOffset.left+scrollParent.offsetWidth)-event.pageX<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed;}else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed;}}}else{if(!o.axis||o.axis!=="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}}
if(!o.axis||o.axis!=="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event);}}});$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[];$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){var $t=$(this),$o=$t.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left});}});},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left-inst.margins.left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top-inst.margins.top;b=t+inst.snapElements[i].height;if(x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=false;continue;}
if(o.snapMode!=="inner"){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left;}}
first=(ts||bs||ls||rs);if(o.snapMode!=="outer"){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left;}}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=(ts||bs||ls||rs||first);}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0);});if(!group.length){return;}
min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i);});this.css("zIndex",(min+group.length));}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("zIndex")){o._zIndex=t.css("zIndex");}
t.css("zIndex",o.zIndex);},stop:function(event,ui,instance){var o=instance.options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex);}}});var draggable=$.ui.draggable;

$.widget("ui.resizable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseInt(value,10)||0;},_isNumber:function(value){return!isNaN(parseInt(value,10));},_hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false;}
var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true;}
el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has;},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;this.element.addClass("ui-resizable");$.extend(this,{_aspectRatio:!!(o.aspectRatio),aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize();}
this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});this._handles=$();if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw";}
n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){handle=$.trim(n[i]);hname="ui-resizable-"+handle;axis=$("<div class='ui-resizable-handle "+hname+"'></div>");axis.css({zIndex:o.zIndex});if("se"===handle){axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se");}
this.handles[handle]=".ui-resizable-"+handle;this.element.append(axis);}}
this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles){if(this.handles[i].constructor===String){this.handles[i]=this.element.children(this.handles[i]).first().show();}else if(this.handles[i].jquery||this.handles[i].nodeType){this.handles[i]=$(this.handles[i]);this._on(this.handles[i],{"mousedown":that._mouseDown});}
if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){axis=$(this.handles[i],this.element);padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");target.css(padPos,padWrapper);this._proportionallyResize();}
this._handles=this._handles.add(this.handles[i]);}};this._renderAxis(this.element);this._handles=this._handles.add(this.element.find(".ui-resizable-handle"));this._handles.disableSelection();this._handles.mouseover(function(){if(!that.resizing){if(this.className){axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);}
that.axis=axis&&axis[1]?axis[1]:"se";}});if(o.autoHide){this._handles.hide();$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(o.disabled){return;}
$(this).removeClass("ui-resizable-autohide");that._handles.show();}).mouseleave(function(){if(o.disabled){return;}
if(!that.resizing){$(this).addClass("ui-resizable-autohide");that._handles.hide();}});}
this._mouseInit();},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove();};if(this.elementIsWrapper){_destroy(this.element);wrapper=this.element;this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper);wrapper.remove();}
this.originalElement.css("resize",this.originalResizeStyle);_destroy(this.originalElement);return this;},_mouseCapture:function(event){var i,handle,capture=false;for(i in this.handles){handle=$(this.handles[i])[0];if(handle===event.target||$.contains(handle,event.target)){capture=true;}}
return!this.options.disabled&&capture;},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;this.resizing=true;this._renderProxy();curleft=this._num(this.helper.css("left"));curtop=this._num(this.helper.css("top"));if(o.containment){curleft+=$(o.containment).scrollLeft()||0;curtop+=$(o.containment).scrollTop()||0;}
this.offset=this.helper.offset();this.position={left:curleft,top:curtop};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()};this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};this.originalPosition={left:curleft,top:curtop};this.originalMousePosition={left:event.pageX,top:event.pageY};this.aspectRatio=(typeof o.aspectRatio==="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);cursor=$(".ui-resizable-"+this.axis).css("cursor");$("body").css("cursor",cursor==="auto"?this.axis+"-resize":cursor);el.addClass("ui-resizable-resizing");this._propagate("start",event);return true;},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=(event.pageX-smp.left)||0,dy=(event.pageY-smp.top)||0,trigger=this._change[a];this._updatePrevProperties();if(!trigger){return false;}
data=trigger.apply(this,[event,dx,dy]);this._updateVirtualBoundaries(event.shiftKey);if(this._aspectRatio||event.shiftKey){data=this._updateRatio(data,event);}
data=this._respectSize(data,event);this._updateCache(data);this._propagate("resize",event);props=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize();}
if(!$.isEmptyObject(props)){this._updatePrevProperties();this._trigger("resize",event,this.ui());this._applyChanges();}
return false;},_mouseStop:function(event){this.resizing=false;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;if(this._helper){pr=this._proportionallyResizeElements;ista=pr.length&&(/textarea/i).test(pr[0].nodeName);soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height;soffsetw=ista?0:that.sizeDiff.width;s={width:(that.helper.width()-soffsetw),height:(that.helper.height()-soffseth)};left=(parseInt(that.element.css("left"),10)+
(that.position.left-that.originalPosition.left))||null;top=(parseInt(that.element.css("top"),10)+
(that.position.top-that.originalPosition.top))||null;if(!o.animate){this.element.css($.extend(s,{top:top,left:left}));}
that.helper.height(that.size.height);that.helper.width(that.size.width);if(this._helper&&!o.animate){this._proportionallyResize();}}
$("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",event);if(this._helper){this.helper.remove();}
return false;},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height};},_applyChanges:function(){var props={};if(this.position.top!==this.prevPosition.top){props.top=this.position.top+"px";}
if(this.position.left!==this.prevPosition.left){props.left=this.position.left+"px";}
if(this.size.width!==this.prevSize.width){props.width=this.size.width+"px";}
if(this.size.height!==this.prevSize.height){props.height=this.size.height+"px";}
this.helper.css(props);return props;},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:Infinity,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:Infinity};if(this._aspectRatio||forceAspectRatio){pMinWidth=b.minHeight*this.aspectRatio;pMinHeight=b.minWidth/this.aspectRatio;pMaxWidth=b.maxHeight*this.aspectRatio;pMaxHeight=b.maxWidth/this.aspectRatio;if(pMinWidth>b.minWidth){b.minWidth=pMinWidth;}
if(pMinHeight>b.minHeight){b.minHeight=pMinHeight;}
if(pMaxWidth<b.maxWidth){b.maxWidth=pMaxWidth;}
if(pMaxHeight<b.maxHeight){b.maxHeight=pMaxHeight;}}
this._vBoundaries=b;},_updateCache:function(data){this.offset=this.helper.offset();if(this._isNumber(data.left)){this.position.left=data.left;}
if(this._isNumber(data.top)){this.position.top=data.top;}
if(this._isNumber(data.height)){this.size.height=data.height;}
if(this._isNumber(data.width)){this.size.width=data.width;}},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;if(this._isNumber(data.height)){data.width=(data.height*this.aspectRatio);}else if(this._isNumber(data.width)){data.height=(data.width/this.aspectRatio);}
if(a==="sw"){data.left=cpos.left+(csize.width-data.width);data.top=null;}
if(a==="nw"){data.top=cpos.top+(csize.height-data.height);data.left=cpos.left+(csize.width-data.width);}
return data;},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&(o.maxWidth<data.width),ismaxh=this._isNumber(data.height)&&o.maxHeight&&(o.maxHeight<data.height),isminw=this._isNumber(data.width)&&o.minWidth&&(o.minWidth>data.width),isminh=this._isNumber(data.height)&&o.minHeight&&(o.minHeight>data.height),dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);if(isminw){data.width=o.minWidth;}
if(isminh){data.height=o.minHeight;}
if(ismaxw){data.width=o.maxWidth;}
if(ismaxh){data.height=o.maxHeight;}
if(isminw&&cw){data.left=dw-o.minWidth;}
if(ismaxw&&cw){data.left=dw-o.maxWidth;}
if(isminh&&ch){data.top=dh-o.minHeight;}
if(ismaxh&&ch){data.top=dh-o.maxHeight;}
if(!data.width&&!data.height&&!data.left&&data.top){data.top=null;}else if(!data.width&&!data.height&&!data.top&&data.left){data.left=null;}
return data;},_getPaddingPlusBorderDimensions:function(element){var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];for(;i<4;i++){widths[i]=(parseInt(borders[i],10)||0);widths[i]+=(parseInt(paddings[i],10)||0);}
return{height:widths[0]+widths[2],width:widths[1]+widths[3]};},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return;}
var prel,i=0,element=this.helper||this.element;for(;i<this._proportionallyResizeElements.length;i++){prel=this._proportionallyResizeElements[i];if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(prel);}
prel.css({height:(element.height()-this.outerDimensions.height)||0,width:(element.width()-this.outerDimensions.width)||0});}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset();if(this._helper){this.helper=this.helper||$("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex});this.helper.appendTo("body").disableSelection();}else{this.helper=this.element;}},_change:{e:function(event,dx){return{width:this.originalSize.width+dx};},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx};},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy};},s:function(event,dx,dy){return{height:this.originalSize.height+dy};},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]);(n!=="resize"&&this._trigger(n,event,this.ui()));},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition};}});$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:(that.size.width-soffsetw),height:(that.size.height-soffseth)},left=(parseInt(that.element.css("left"),10)+
(that.position.left-that.originalPosition.left))||null,top=(parseInt(that.element.css("top"),10)+
(that.position.top-that.originalPosition.top))||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};if(pr&&pr.length){$(pr[0]).css({width:data.width,height:data.height});}
that._updateCache(data);that._propagate("resize",event);}});}});$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;if(!ce){return;}
that.containerElement=$(ce);if(/document/.test(oc)||oc===document){that.containerOffset={left:0,top:0};that.containerPosition={left:0,top:0};that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight};}else{element=$(ce);p=[];$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name));});that.containerOffset=element.offset();that.containerPosition=element.position();that.containerSize={height:(element.innerHeight()-p[3]),width:(element.innerWidth()-p[1])};co=that.containerOffset;ch=that.containerSize.height;cw=that.containerSize.width;width=(that._hasScroll(ce,"left")?ce.scrollWidth:cw);height=(that._hasScroll(ce)?ce.scrollHeight:ch);that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height};}},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=true;if(ce[0]!==document&&(/static/).test(ce.css("position"))){cop=co;}
if(cp.left<(that._helper?co.left:0)){that.size.width=that.size.width+
(that._helper?(that.position.left-co.left):(that.position.left-cop.left));if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=false;}
that.position.left=o.helper?co.left:0;}
if(cp.top<(that._helper?co.top:0)){that.size.height=that.size.height+
(that._helper?(that.position.top-co.top):that.position.top);if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=false;}
that.position.top=that._helper?co.top:0;}
isParent=that.containerElement.get(0)===that.element.parent().get(0);isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position"));if(isParent&&isOffsetRelative){that.offset.left=that.parentData.left+that.position.left;that.offset.top=that.parentData.top+that.position.top;}else{that.offset.left=that.element.offset().left;that.offset.top=that.element.offset().top;}
woset=Math.abs(that.sizeDiff.width+
(that._helper?that.offset.left-cop.left:(that.offset.left-co.left)));hoset=Math.abs(that.sizeDiff.height+
(that._helper?that.offset.top-cop.top:(that.offset.top-co.top)));if(woset+that.size.width>=that.parentData.width){that.size.width=that.parentData.width-woset;if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=false;}}
if(hoset+that.size.height>=that.parentData.height){that.size.height=that.parentData.height-hoset;if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=false;}}
if(!continueResize){that.position.left=that.prevPosition.left;that.position.top=that.prevPosition.top;that.size.width=that.prevSize.width;that.size.height=that.prevSize.height;}},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;if(that._helper&&!o.animate&&(/relative/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});}
if(that._helper&&!o.animate&&(/static/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});}}});$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options;$(o.alsoResize).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)});});},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:(that.size.height-os.height)||0,width:(that.size.width-os.width)||0,top:(that.position.top-op.top)||0,left:(that.position.left-op.left)||0};$(o.alsoResize).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);if(sum&&sum>=0){style[prop]=sum||null;}});el.css(style);});},stop:function(){$(this).removeData("resizable-alsoresize");}});$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone();that.ghost.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof o.ghost==="string"?o.ghost:"");that.ghost.appendTo(that.helper);},resize:function(){var that=$(this).resizable("instance");if(that.ghost){that.ghost.css({position:"relative",height:that.size.height,width:that.size.width});}},stop:function(){var that=$(this).resizable("instance");if(that.ghost&&that.helper){that.helper.get(0).removeChild(that.ghost.get(0));}}});$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid=typeof o.grid==="number"?[o.grid,o.grid]:o.grid,gridX=(grid[0]||1),gridY=(grid[1]||1),ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&(o.maxWidth<newWidth),isMaxHeight=o.maxHeight&&(o.maxHeight<newHeight),isMinWidth=o.minWidth&&(o.minWidth>newWidth),isMinHeight=o.minHeight&&(o.minHeight>newHeight);o.grid=grid;if(isMinWidth){newWidth+=gridX;}
if(isMinHeight){newHeight+=gridY;}
if(isMaxWidth){newWidth-=gridX;}
if(isMaxHeight){newHeight-=gridY;}
if(/^(se|s|e)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;}else if(/^(ne)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.top=op.top-oy;}else if(/^(sw)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.left=op.left-ox;}else{if(newHeight-gridY<=0||newWidth-gridX<=0){outerDimensions=that._getPaddingPlusBorderDimensions(this);}
if(newHeight-gridY>0){that.size.height=newHeight;that.position.top=op.top-oy;}else{newHeight=gridY-outerDimensions.height;that.size.height=newHeight;that.position.top=op.top+os.height-newHeight;}
if(newWidth-gridX>0){that.size.width=newWidth;that.position.left=op.left-ox;}else{newWidth=gridX-outerDimensions.width;that.size.width=newWidth;that.position.left=op.left+os.width-newWidth;}}}});var resizable=$.ui.resizable;

var dialog=$.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:true,buttons:[],closeOnEscape:true,closeText:"Close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;if(topOffset<0){$(this).css("top",pos.top-topOffset);}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();if(this.options.draggable&&$.fn.draggable){this._makeDraggable();}
if(this.options.resizable&&$.fn.resizable){this._makeResizable();}
this._isOpen=false;this._trackFocus();},_init:function(){if(this.options.autoOpen){this.open();}},_appendTo:function(){var element=this.options.appendTo;if(element&&(element.jquery||element.nodeType)){return $(element);}
return this.document.find(element||"body").eq(0);},_destroy:function(){var next,originalPosition=this.originalPosition;this._untrackInstance();this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(true,true).remove();if(this.originalTitle){this.element.attr("title",this.originalTitle);}
next=originalPosition.parent.children().eq(originalPosition.index);if(next.length&&next[0]!==this.element[0]){next.before(this.element);}else{originalPosition.parent.append(this.element);}},widget:function(){return this.uiDialog;},disable:$.noop,enable:$.noop,close:function(event){var activeElement,that=this;if(!this._isOpen||this._trigger("beforeClose",event)===false){return;}
this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").focus().length){try{activeElement=this.document[0].activeElement;if(activeElement&&activeElement.nodeName.toLowerCase()!=="body"){$(activeElement).blur();}}catch(error){}}
this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event);});},isOpen:function(){return this._isOpen;},moveToTop:function(){this._moveToTop();},_moveToTop:function(event,silent){var moved=false,zIndices=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index");}).get(),zIndexMax=Math.max.apply(null,zIndices);if(zIndexMax>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",zIndexMax+1);moved=true;}
if(moved&&!silent){this._trigger("focus",event);}
return moved;},open:function(){var that=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable();}
return;}
this._isOpen=true;this.opener=$(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1);}
this._show(this.uiDialog,this.options.show,function(){that._focusTabbable();that._trigger("focus");});this._makeFocusTarget();this._trigger("open");},_focusTabbable:function(){var hasFocus=this._focusedElement;if(!hasFocus){hasFocus=this.element.find("[autofocus]");}
if(!hasFocus.length){hasFocus=this.element.find(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialogButtonPane.find(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialogTitlebarClose.filter(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialog;}
hasFocus.eq(0).focus();},_keepFocus:function(event){function checkFocus(){var activeElement=this.document[0].activeElement,isActive=this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement);if(!isActive){this._focusTabbable();}}
event.preventDefault();checkFocus.call(this);this._delay(checkFocus);},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+
this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE){event.preventDefault();this.close(event);return;}
if(event.keyCode!==$.ui.keyCode.TAB||event.isDefaultPrevented()){return;}
var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");if((event.target===last[0]||event.target===this.uiDialog[0])&&!event.shiftKey){this._delay(function(){first.focus();});event.preventDefault();}else if((event.target===first[0]||event.target===this.uiDialog[0])&&event.shiftKey){this._delay(function(){last.focus();});event.preventDefault();}},mousedown:function(event){if(this._moveToTop(event)){this._focusTabbable();}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")});}},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(event){if(!$(event.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.focus();}}});this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:false}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault();this.close(event);}});uiDialogTitle=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(uiDialogTitle);this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")});},_title:function(title){if(!this.options.title){title.html("&#160;");}
title.text(this.options.title);},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons();},_createButtons:function(){var that=this,buttons=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if($.isEmptyObject(buttons)||($.isArray(buttons)&&!buttons.length)){this.uiDialog.removeClass("ui-dialog-buttons");return;}
$.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props;props=$.extend({type:"button"},props);click=props.click;props.click=function(){click.apply(that.element[0],arguments);};buttonOptions={icons:props.icons,text:props.showText};delete props.icons;delete props.showText;$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet);});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog);},_makeDraggable:function(){var that=this,options=this.options;function filteredUi(ui){return{position:ui.position,offset:ui.offset};}
this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging");that._blockFrames();that._trigger("dragStart",event,filteredUi(ui));},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui));},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" "+"top"+(top>=0?"+":"")+top,of:that.window};$(this).removeClass("ui-dialog-dragging");that._unblockFrames();that._trigger("dragStop",event,filteredUi(ui));}});},_makeResizable:function(){var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles=typeof handles==="string"?handles:"n,e,s,w,se,sw,ne,nw";function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size};}
this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing");that._blockFrames();that._trigger("resizeStart",event,filteredUi(ui));},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui));},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height();options.width=that.uiDialog.width();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" "+"top"+(top>=0?"+":"")+top,of:that.window};$(this).removeClass("ui-dialog-resizing");that._unblockFrames();that._trigger("resizeStop",event,filteredUi(ui));}}).css("position",position);},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget();this._focusedElement=$(event.target);}});},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this);},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);if(exists!==-1){instances.splice(exists,1);}},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");if(!instances){instances=[];this.document.data("ui-dialog-instances",instances);}
return instances;},_minHeight:function(){var options=this.options;return options.height==="auto"?options.minHeight:Math.min(options.minHeight,options.height);},_position:function(){var isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show();}
this.uiDialog.position(this.options.position);if(!isVisible){this.uiDialog.hide();}},_setOptions:function(options){var that=this,resize=false,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value);if(key in that.sizeRelatedOptions){resize=true;}
if(key in that.resizableRelatedOptions){resizableOptions[key]=value;}});if(resize){this._size();this._position();}
if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",resizableOptions);}},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;if(key==="dialogClass"){uiDialog.removeClass(this.options.dialogClass).addClass(value);}
if(key==="disabled"){return;}
this._super(key,value);if(key==="appendTo"){this.uiDialog.appendTo(this._appendTo());}
if(key==="buttons"){this._createButtons();}
if(key==="closeText"){this.uiDialogTitlebarClose.button({label:""+value});}
if(key==="draggable"){isDraggable=uiDialog.is(":data(ui-draggable)");if(isDraggable&&!value){uiDialog.draggable("destroy");}
if(!isDraggable&&value){this._makeDraggable();}}
if(key==="position"){this._position();}
if(key==="resizable"){isResizable=uiDialog.is(":data(ui-resizable)");if(isResizable&&!value){uiDialog.resizable("destroy");}
if(isResizable&&typeof value==="string"){uiDialog.resizable("option","handles",value);}
if(!isResizable&&value!==false){this._makeResizable();}}
if(key==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"));}},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(options.minWidth>options.width){options.width=options.minWidth;}
nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight();minContentHeight=Math.max(0,options.minHeight-nonContentHeight);maxContentHeight=typeof options.maxHeight==="number"?Math.max(0,options.maxHeight-nonContentHeight):"none";if(options.height==="auto"){this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"});}else{this.element.height(Math.max(0,options.height-nonContentHeight));}
if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight());}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_allowInteraction:function(event){if($(event.target).closest(".ui-dialog").length){return true;}
return!!$(event.target).closest(".ui-datepicker").length;},_createOverlay:function(){if(!this.options.modal){return;}
var isOpening=true;this._delay(function(){isOpening=false;});if(!this.document.data("ui-dialog-overlays")){this._on(this.document,{focusin:function(event){if(isOpening){return;}
if(!this._allowInteraction(event)){event.preventDefault();this._trackingInstances()[0]._focusTabbable();}}});}
this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1);},_destroyOverlay:function(){if(!this.options.modal){return;}
if(this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;if(!overlays){this.document.unbind("focusin").removeData("ui-dialog-overlays");}else{this.document.data("ui-dialog-overlays",overlays);}
this.overlay.remove();this.overlay=null;}}});

$.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept);};this.proportions=function(){if(arguments.length){proportions=arguments[0];}else{return proportions?proportions:proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};}};this._addToManager(o.scope);o.addClasses&&this.element.addClass("ui-droppable");},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[];$.ui.ddmanager.droppables[scope].push(this);},_splice:function(drop){var i=0;for(;i<drop.length;i++){if(drop[i]===this){drop.splice(i,1);}}},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);this.element.removeClass("ui-droppable ui-droppable-disabled");},_setOption:function(key,value){if(key==="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value);};}else if(key==="scope"){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);this._addToManager(value);}
this._super(key,value);},_activate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass);}
if(draggable){this._trigger("activate",event,this.ui(draggable));}},_deactivate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}
if(draggable){this._trigger("deactivate",event,this.ui(draggable));}},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass);}
this._trigger("over",event,this.ui(draggable));}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}
this._trigger("out",event,this.ui(draggable));}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=false;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return false;}
this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event)){childrenIntersection=true;return false;}});if(childrenIntersection){return false;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}
if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}
this._trigger("drop",event,this.ui(draggable));return this.element;}
return false;},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs};}});$.ui.intersect=(function(){function isOverAxis(x,reference,size){return(x>=reference)&&(x<(reference+size));}
return function(draggable,droppable,toleranceMode,event){if(!droppable.offset){return false;}
var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));default:return false;}};})();$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue;}
for(j=0;j<list.length;j++){if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop;}}
m[i].visible=m[i].element.css("display")!=="none";if(!m[i].visible){continue;}
if(type==="mousedown"){m[i]._activate.call(m[i],event);}
m[i].offset=m[i].element.offset();m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight});}},drop:function(draggable,event){var dropped=false;$.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){if(!this.options){return;}
if(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance,event)){dropped=this._drop.call(this,event)||dropped;}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=true;this.isover=false;this._deactivate.call(this,event);}});return dropped;},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}});},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}
$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return;}
var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);if(!c){return;}
if(this.options.greedy){scope=this.options.scope;parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope;});if(parent.length){parentInstance=$(parent[0]).droppable("instance");parentInstance.greedyChild=(c==="isover");}}
if(parentInstance&&c==="isover"){parentInstance.isover=false;parentInstance.isout=true;parentInstance._out.call(parentInstance,event);}
this[c]=true;this[c==="isout"?"isover":"isout"]=false;this[c==="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c==="isout"){parentInstance.isout=false;parentInstance.isover=true;parentInstance._over.call(parentInstance,event);}});},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}}};var droppable=$.ui.droppable;

var dataSpace="ui-effects-",jQuery=$;$.effects={effect:{}};

(function(jQuery,undefined){var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]];}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1]*2.55,execResult[2]*2.55,execResult[3]*2.55,execResult[4]];}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)];}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)];}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]];}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha);},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:true,max:255},"percent":{max:1},"degrees":{mod:360,floor:true}},support=color.support={},supportElem=jQuery("<p>")[0],colors,each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)";support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;each(spaces,function(spaceName,space){space.cache="_"+spaceName;space.props.alpha={idx:3,type:"percent",def:1};});function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};if(value==null){return(allowEmpty||!prop.def)?null:prop.def;}
value=type.floor?~~value:parseFloat(value);if(isNaN(value)){return prop.def;}
if(type.mod){return(value+type.mod)%type.mod;}
return 0>value?0:type.max<value?type.max:value;}
function stringParse(string){var inst=color(),rgba=inst._rgba=[];string=string.toLowerCase();each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values){parsed=inst[spaceName](values);inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];rgba=inst._rgba=parsed._rgba;return false;}});if(rgba.length){if(rgba.join()==="0,0,0,0"){jQuery.extend(rgba,colors.transparent);}
return inst;}
return colors[string];}
color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined){this._rgba=[null,null,null,null];return this;}
if(red.jquery||red.nodeType){red=jQuery(red).css(green);green=undefined;}
var inst=this,type=jQuery.type(red),rgba=this._rgba=[];if(green!==undefined){red=[red,green,blue,alpha];type="array";}
if(type==="string"){return this.parse(stringParse(red)||colors._default);}
if(type==="array"){each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop);});return this;}
if(type==="object"){if(red instanceof color){each(spaces,function(spaceName,space){if(red[space.cache]){inst[space.cache]=red[space.cache].slice();}});}else{each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if(key==="alpha"||red[key]==null){return;}
inst[cache]=space.to(inst._rgba);}
inst[cache][prop.idx]=clamp(red[key],prop,true);});if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){inst[cache][3]=1;if(space.from){inst._rgba=space.from(inst[cache]);}}});}
return this;}},is:function(compare){var is=color(compare),same=true,inst=this;each(spaces,function(_,space){var localCache,isCache=is[space.cache];if(isCache){localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];each(space.props,function(_,prop){if(isCache[prop.idx]!=null){same=(isCache[prop.idx]===localCache[prop.idx]);return same;}});}
return same;});return same;},_space:function(){var used=[],inst=this;each(spaces,function(spaceName,space){if(inst[space.cache]){used.push(spaceName);}});return used.pop();},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=this.alpha()===0?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();end=end[space.cache];each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};if(endValue===null){return;}
if(startValue===null){result[index]=endValue;}else{if(type.mod){if(endValue-startValue>type.mod/2){startValue+=type.mod;}else if(startValue-endValue>type.mod/2){startValue-=type.mod;}}
result[index]=clamp((endValue-startValue)*distance+startValue,prop);}});return this[spaceName](result);},blend:function(opaque){if(this._rgba[3]===1){return this;}
var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v;}));},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return v==null?(i>2?1:0):v;});if(rgba[3]===1){rgba.pop();prefix="rgb(";}
return prefix+rgba.join()+")";},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){if(v==null){v=i>2?1:0;}
if(i&&i<3){v=Math.round(v*100)+"%";}
return v;});if(hsla[3]===1){hsla.pop();prefix="hsl(";}
return prefix+hsla.join()+")";},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();if(includeAlpha){rgba.push(~~(alpha*255));}
return"#"+jQuery.map(rgba,function(v){v=(v||0).toString(16);return v.length===1?"0"+v:v;}).join("");},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString();}});color.fn.parse.prototype=color.fn;function hue2rgb(p,q,h){h=(h+1)%1;if(h*6<1){return p+(q-p)*h*6;}
if(h*2<1){return q;}
if(h*3<2){return p+(q-p)*((2/3)-h)*6;}
return p;}
spaces.hsla.to=function(rgba){if(rgba[0]==null||rgba[1]==null||rgba[2]==null){return[null,null,null,rgba[3]];}
var r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=add*0.5,h,s;if(min===max){h=0;}else if(r===max){h=(60*(g-b)/diff)+360;}else if(g===max){h=(60*(b-r)/diff)+120;}else{h=(60*(r-g)/diff)+240;}
if(diff===0){s=0;}else if(l<=0.5){s=diff/add;}else{s=diff/(2-add);}
return[Math.round(h)%360,s,l,a==null?1:a];};spaces.hsla.from=function(hsla){if(hsla[0]==null||hsla[1]==null||hsla[2]==null){return[null,null,null,hsla[3]];}
var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=0.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(hue2rgb(p,q,h+(1/3))*255),Math.round(hue2rgb(p,q,h)*255),Math.round(hue2rgb(p,q,h-(1/3))*255),a];};each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]){this[cache]=to(this._rgba);}
if(value===undefined){return this[cache].slice();}
var ret,type=jQuery.type(value),arr=(type==="array"||type==="object")?value:arguments,local=this[cache].slice();each(props,function(key,prop){var val=arr[type==="object"?key:prop.idx];if(val==null){val=local[prop.idx];}
local[prop.idx]=clamp(val,prop);});if(from){ret=color(from(local));ret[cache]=local;return ret;}else{return color(local);}};each(props,function(key,prop){if(color.fn[key]){return;}
color.fn[key]=function(value){var vtype=jQuery.type(value),fn=(key==="alpha"?(this._hsla?"hsla":"rgba"):spaceName),local=this[fn](),cur=local[prop.idx],match;if(vtype==="undefined"){return cur;}
if(vtype==="function"){value=value.call(this,cur);vtype=jQuery.type(value);}
if(value==null&&prop.empty){return this;}
if(vtype==="string"){match=rplusequals.exec(value);if(match){value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1);}}
local[prop.idx]=value;return this[fn](local);};});});color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if(value!=="transparent"&&(jQuery.type(value)!=="string"||(parsed=stringParse(value)))){value=color(parsed||value);if(!support.rgba&&value._rgba[3]!==1){curElem=hook==="backgroundColor"?elem.parentNode:elem;while((backgroundColor===""||backgroundColor==="transparent")&&curElem&&curElem.style){try{backgroundColor=jQuery.css(curElem,"backgroundColor");curElem=curElem.parentNode;}catch(e){}}
value=value.blend(backgroundColor&&backgroundColor!=="transparent"?backgroundColor:"_default");}
value=value.toRgbaString();}
try{elem.style[hook]=value;}catch(e){}}};jQuery.fx.step[hook]=function(fx){if(!fx.colorInit){fx.start=color(fx.elem,hook);fx.end=color(fx.end);fx.colorInit=true;}
jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos));};});};color.hook(stepHooks);jQuery.cssHooks.borderColor={expand:function(value){var expanded={};each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value;});return expanded;}};colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};})(jQuery);(function(){var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){jQuery.style(fx.elem,prop,fx.end);fx.setAttr=true;}};});function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]]){len=style.length;while(len--){key=style[len];if(typeof style[key]==="string"){styles[$.camelCase(key)]=style[key];}}}else{for(key in style){if(typeof style[key]==="string"){styles[key]=style[key];}}}
return styles;}
function styleDifference(oldStyle,newStyle){var diff={},name,value;for(name in newStyle){value=newStyle[name];if(oldStyle[name]!==value){if(!shorthandStyles[name]){if($.fx.step[name]||!isNaN(parseFloat(value))){diff[name]=value;}}}}
return diff;}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var animated=$(this),baseClass=animated.attr("class")||"",applyClassChange,allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)};});applyClassChange=function(){$.each(classAnimationActions,function(i,action){if(value[action]){animated[action+"Class"](value[action]);}});};applyClassChange();allAnimations=allAnimations.map(function(){this.end=getElementStyles(this.el[0]);this.diff=styleDifference(this.start,this.end);return this;});animated.attr("class",baseClass);allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:false,complete:function(){dfd.resolve(styleInfo);}});this.el.animate(this.diff,opts);return dfd.promise();});$.when.apply($,allAnimations.get()).done(function(){applyClassChange();$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"");});});o.complete.call(animated[0]);});});};$.fn.extend({addClass:(function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.addClass),removeClass:(function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.removeClass),toggleClass:(function(orig){return function(classNames,force,speed,easing,callback){if(typeof force==="boolean"||force===undefined){if(!speed){return orig.apply(this,arguments);}else{return $.effects.animateClass.call(this,(force?{add:classNames}:{remove:classNames}),speed,easing,callback);}}else{return $.effects.animateClass.call(this,{toggle:classNames},force,speed,easing);}};})($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback);}});})();(function(){$.extend($.effects,{version:"1.11.4",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data(dataSpace+set[i],element[0].style[set[i]]);}}},restore:function(element,set){var val,i;for(i=0;i<set.length;i++){if(set[i]!==null){val=element.data(dataSpace+set[i]);if(val===undefined){val="";}
element.css(set[i],val);}}},setMode:function(el,mode){if(mode==="toggle"){mode=el.is(":hidden")?"show":"hide";}
return mode;},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height;}
switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width;}
return{x:x,y:y};},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent();}
var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id;}catch(e){active=document.body;}
element.wrap(wrapper);if(element[0]===active||$.contains(element[0],active)){$(active).focus();}
wrapper=element.parent();if(element.css("position")==="static"){wrapper.css({position:"relative"});element.css({position:"relative"});}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto";}});element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"});}
element.css(size);return wrapper.css(props).show();},removeWrapper:function(element){var active=document.activeElement;if(element.parent().is(".ui-effects-wrapper")){element.parent().replaceWith(element);if(element[0]===active||$.contains(element[0],active)){$(active).focus();}}
return element;},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){var unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1];}});return value;}});function _normalizeArguments(effect,options,speed,callback){if($.isPlainObject(effect)){options=effect;effect=effect.effect;}
effect={effect:effect};if(options==null){options={};}
if($.isFunction(options)){callback=options;speed=null;options={};}
if(typeof options==="number"||$.fx.speeds[options]){callback=speed;speed=options;options={};}
if($.isFunction(speed)){callback=speed;speed=null;}
if(options){$.extend(effect,options);}
speed=speed||options.duration;effect.duration=$.fx.off?0:typeof speed==="number"?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default;effect.complete=callback||options.complete;return effect;}
function standardAnimationOption(option){if(!option||typeof option==="number"||$.fx.speeds[option]){return true;}
if(typeof option==="string"&&!$.effects.effect[option]){return true;}
if($.isFunction(option)){return true;}
if(typeof option==="object"&&!option.effect){return true;}
return false;}
$.fn.extend({effect:function(){var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];if($.fx.off||!effectMethod){if(mode){return this[mode](args.duration,args.complete);}else{return this.each(function(){if(args.complete){args.complete.call(this);}});}}
function run(next){var elem=$(this),complete=args.complete,mode=args.mode;function done(){if($.isFunction(complete)){complete.call(elem[0]);}
if($.isFunction(next)){next();}}
if(elem.is(":hidden")?mode==="hide":mode==="show"){elem[mode]();done();}else{effectMethod.call(elem[0],args,done);}}
return queue===false?this.each(run):this.queue(queue||"fx",run);},show:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="show";return this.effect.call(this,args);}};})($.fn.show),hide:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="hide";return this.effect.call(this,args);}};})($.fn.hide),toggle:(function(orig){return function(option){if(standardAnimationOption(option)||typeof option==="boolean"){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="toggle";return this.effect.call(this,args);}};})($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit];}});return val;}});})();(function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2);};});$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2);},Circ:function(p){return 1-Math.sqrt(1-p*p);},Elastic:function(p){return p===0||p===1?p:-Math.pow(2,8*(p-1))*Math.sin(((p-1)*80-7.5)*Math.PI/15);},Back:function(p){return p*p*(3*p-2);},Bounce:function(p){var pow2,bounce=4;while(p<((pow2=Math.pow(2,--bounce))-1)/11){}
return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/22-p,2);}});$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn;$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p);};$.easing["easeInOut"+name]=function(p){return p<0.5?easeIn(p*2)/2:1-easeIn(p*-2+2)/2;};});})();var effect=$.effects;

var effectBlind=$.effects.effect.blind=function(o,done){var el=$(this),rvertical=/up|down|vertical/,rpositivemotion=/up|left|vertical|horizontal/,props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"up",vertical=rvertical.test(direction),ref=vertical?"height":"width",ref2=vertical?"top":"left",motion=rpositivemotion.test(direction),animation={},show=mode==="show",wrapper,distance,margin;if(el.parent().is(".ui-effects-wrapper")){$.effects.save(el.parent(),props);}else{$.effects.save(el,props);}
el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});distance=wrapper[ref]();margin=parseFloat(wrapper.css(ref2))||0;animation[ref]=show?distance:0;if(!motion){el.css(vertical?"bottom":"right",0).css(vertical?"top":"left","auto").css({position:"absolute"});animation[ref2]=show?margin:distance+margin;}
if(show){wrapper.css(ref,0);if(!motion){wrapper.css(ref2,margin+distance);}}
wrapper.animate(animation,{duration:o.duration,easing:o.easing,queue:false,complete:function(){if(mode==="hide"){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();}});};

var effectBounce=$.effects.effect.bounce=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),hide=mode==="hide",show=mode==="show",direction=o.direction||"up",distance=o.distance,times=o.times||5,anims=times*2+(show||hide?1:0),speed=o.duration/anims,easing=o.easing,ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left"),i,upAnim,downAnim,queue=el.queue(),queuelen=queue.length;if(show||hide){props.push("opacity");}
$.effects.save(el,props);el.show();$.effects.createWrapper(el);if(!distance){distance=el[ref==="top"?"outerHeight":"outerWidth"]()/3;}
if(show){downAnim={opacity:1};downAnim[ref]=0;el.css("opacity",0).css(ref,motion?-distance*2:distance*2).animate(downAnim,speed,easing);}
if(hide){distance=distance/Math.pow(2,times-1);}
downAnim={};downAnim[ref]=0;for(i=0;i<times;i++){upAnim={};upAnim[ref]=(motion?"-=":"+=")+distance;el.animate(upAnim,speed,easing).animate(downAnim,speed,easing);distance=hide?distance*2:distance/2;}
if(hide){upAnim={opacity:0};upAnim[ref]=(motion?"-=":"+=")+distance;el.animate(upAnim,speed,easing);}
el.queue(function(){if(hide){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)));}
el.dequeue();};

var effectClip=$.effects.effect.clip=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",direction=o.direction||"vertical",vert=direction==="vertical",size=vert?"height":"width",position=vert?"top":"left",animation={},wrapper,animate,distance;$.effects.save(el,props);el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});animate=(el[0].tagName==="IMG")?wrapper:el;distance=animate[size]();if(show){animate.css(size,0);animate.css(position,distance/2);}
animation[size]=show?distance:0;animation[position]=show?0:distance/2;animate.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(!show){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();}});};

var effectDrop=$.effects.effect.drop=function(o,done){var el=$(this),props=["position","top","bottom","left","right","opacity","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",direction=o.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left")?"pos":"neg",animation={opacity:show?1:0},distance;$.effects.save(el,props);el.show();$.effects.createWrapper(el);distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true)/2;if(show){el.css("opacity",0).css(ref,motion==="pos"?-distance:distance);}
animation[ref]=(show?(motion==="pos"?"+=":"-="):(motion==="pos"?"-=":"+="))+
distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode==="hide"){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();}});};

var effectExplode=$.effects.effect.explode=function(o,done){var rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,cells=rows,el=$(this),mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",offset=el.show().css("visibility","hidden").offset(),width=Math.ceil(el.outerWidth()/cells),height=Math.ceil(el.outerHeight()/rows),pieces=[],i,j,left,top,mx,my;function childComplete(){pieces.push(this);if(pieces.length===rows*cells){animComplete();}}
for(i=0;i<rows;i++){top=offset.top+i*height;my=i-(rows-1)/2;for(j=0;j<cells;j++){left=offset.left+j*width;mx=j-(cells-1)/2;el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},o.duration||500,o.easing,childComplete);}}
function animComplete(){el.css({visibility:"visible"});$(pieces).remove();if(!show){el.hide();}
done();}};

var effectFade=$.effects.effect.fade=function(o,done){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle");el.animate({opacity:mode},{queue:false,duration:o.duration,easing:o.easing,complete:done});};

var effectFold=$.effects.effect.fold=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",hide=mode==="hide",size=o.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!o.horizFirst,widthFirst=show!==horizFirst,ref=widthFirst?["width","height"]:["height","width"],duration=o.duration/2,wrapper,distance,animation1={},animation2={};$.effects.save(el,props);el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});distance=widthFirst?[wrapper.width(),wrapper.height()]:[wrapper.height(),wrapper.width()];if(percent){size=parseInt(percent[1],10)/100*distance[hide?0:1];}
if(show){wrapper.css(horizFirst?{height:0,width:size}:{height:size,width:0});}
animation1[ref[0]]=show?distance[0]:size;animation2[ref[1]]=show?distance[1]:0;wrapper.animate(animation1,duration,o.easing).animate(animation2,duration,o.easing,function(){if(hide){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();});};

var effectHighlight=$.effects.effect.highlight=function(o,done){var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.mode||"show"),animation={backgroundColor:elem.css("backgroundColor")};if(mode==="hide"){animation.opacity=0;}
$.effects.save(elem,props);elem.show().css({backgroundImage:"none",backgroundColor:o.color||"#ffff99"}).animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode==="hide"){elem.hide();}
$.effects.restore(elem,props);done();}});};

var effectSize=$.effects.effect.size=function(o,done){var original,baseline,factor,el=$(this),props0=["position","top","bottom","left","right","width","height","overflow","opacity"],props1=["position","top","bottom","left","right","overflow","opacity"],props2=["width","height","overflow"],cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=$.effects.setMode(el,o.mode||"effect"),restore=o.restore||mode!=="effect",scale=o.scale||"both",origin=o.origin||["middle","center"],position=el.css("position"),props=restore?props0:props1,zero={height:0,width:0,outerHeight:0,outerWidth:0};if(mode==="show"){el.show();}
original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()};if(o.mode==="toggle"&&mode==="show"){el.from=o.to||zero;el.to=o.from||original;}else{el.from=o.from||(mode==="show"?zero:original);el.to=o.to||(mode==="hide"?zero:original);}
factor={from:{y:el.from.height/original.height,x:el.from.width/original.width},to:{y:el.to.height/original.height,x:el.to.width/original.width}};if(scale==="box"||scale==="both"){if(factor.from.y!==factor.to.y){props=props.concat(vProps);el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from);el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to);}
if(factor.from.x!==factor.to.x){props=props.concat(hProps);el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from);el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to);}}
if(scale==="content"||scale==="both"){if(factor.from.y!==factor.to.y){props=props.concat(cProps).concat(props2);el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from);el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to);}}
$.effects.save(el,props);el.show();$.effects.createWrapper(el);el.css("overflow","hidden").css(el.from);if(origin){baseline=$.effects.getBaseline(origin,original);el.from.top=(original.outerHeight-el.outerHeight())*baseline.y;el.from.left=(original.outerWidth-el.outerWidth())*baseline.x;el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y;el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x;}
el.css(el.from);if(scale==="content"||scale==="both"){vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps);hProps=hProps.concat(["marginLeft","marginRight"]);props2=props0.concat(vProps).concat(hProps);el.find("*[width]").each(function(){var child=$(this),c_original={height:child.height(),width:child.width(),outerHeight:child.outerHeight(),outerWidth:child.outerWidth()};if(restore){$.effects.save(child,props2);}
child.from={height:c_original.height*factor.from.y,width:c_original.width*factor.from.x,outerHeight:c_original.outerHeight*factor.from.y,outerWidth:c_original.outerWidth*factor.from.x};child.to={height:c_original.height*factor.to.y,width:c_original.width*factor.to.x,outerHeight:c_original.height*factor.to.y,outerWidth:c_original.width*factor.to.x};if(factor.from.y!==factor.to.y){child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from);child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to);}
if(factor.from.x!==factor.to.x){child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from);child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to);}
child.css(child.from);child.animate(child.to,o.duration,o.easing,function(){if(restore){$.effects.restore(child,props2);}});});}
el.animate(el.to,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(el.to.opacity===0){el.css("opacity",el.from.opacity);}
if(mode==="hide"){el.hide();}
$.effects.restore(el,props);if(!restore){if(position==="static"){el.css({position:"relative",top:el.to.top,left:el.to.left});}else{$.each(["top","left"],function(idx,pos){el.css(pos,function(_,str){var val=parseInt(str,10),toRef=idx?el.to.left:el.to.top;if(str==="auto"){return toRef+"px";}
return val+toRef+"px";});});}}
$.effects.removeWrapper(el);done();}});};

var effectScale=$.effects.effect.scale=function(o,done){var el=$(this),options=$.extend(true,{},o),mode=$.effects.setMode(el,o.mode||"effect"),percent=parseInt(o.percent,10)||(parseInt(o.percent,10)===0?0:(mode==="hide"?0:100)),direction=o.direction||"both",origin=o.origin,original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},factor={y:direction!=="horizontal"?(percent/100):1,x:direction!=="vertical"?(percent/100):1};options.effect="size";options.queue=false;options.complete=done;if(mode!=="effect"){options.origin=origin||["middle","center"];options.restore=true;}
options.from=o.from||(mode==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:original);options.to={height:original.height*factor.y,width:original.width*factor.x,outerHeight:original.outerHeight*factor.y,outerWidth:original.outerWidth*factor.x};if(options.fade){if(mode==="show"){options.from.opacity=0;options.to.opacity=1;}
if(mode==="hide"){options.from.opacity=1;options.to.opacity=0;}}
el.effect(options);};

var effectPuff=$.effects.effect.puff=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"hide"),hide=mode==="hide",percent=parseInt(o.percent,10)||150,factor=percent/100,original={height:elem.height(),width:elem.width(),outerHeight:elem.outerHeight(),outerWidth:elem.outerWidth()};$.extend(o,{effect:"scale",queue:false,fade:true,mode:mode,complete:done,percent:hide?percent:100,from:hide?original:{height:original.height*factor,width:original.width*factor,outerHeight:original.outerHeight*factor,outerWidth:original.outerWidth*factor}});elem.effect(o);};

var effectPulsate=$.effects.effect.pulsate=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"show"),show=mode==="show",hide=mode==="hide",showhide=(show||mode==="hide"),anims=((o.times||5)*2)+(showhide?1:0),duration=o.duration/anims,animateTo=0,queue=elem.queue(),queuelen=queue.length,i;if(show||!elem.is(":visible")){elem.css("opacity",0).show();animateTo=1;}
for(i=1;i<anims;i++){elem.animate({opacity:animateTo},duration,o.easing);animateTo=1-animateTo;}
elem.animate({opacity:animateTo},duration,o.easing);elem.queue(function(){if(hide){elem.hide();}
done();});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)));}
elem.dequeue();};

var effectShake=$.effects.effect.shake=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),direction=o.direction||"left",distance=o.distance||20,times=o.times||3,anims=times*2+1,speed=Math.round(o.duration/anims),ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),animation={},animation1={},animation2={},i,queue=el.queue(),queuelen=queue.length;$.effects.save(el,props);el.show();$.effects.createWrapper(el);animation[ref]=(positiveMotion?"-=":"+=")+distance;animation1[ref]=(positiveMotion?"+=":"-=")+distance*2;animation2[ref]=(positiveMotion?"-=":"+=")+distance*2;el.animate(animation,speed,o.easing);for(i=1;i<times;i++){el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing);}
el.animate(animation1,speed,o.easing).animate(animation,speed/2,o.easing).queue(function(){if(mode==="hide"){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)));}
el.dequeue();};

var effectSlide=$.effects.effect.slide=function(o,done){var el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),show=mode==="show",direction=o.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),distance,animation={};$.effects.save(el,props);el.show();distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true);$.effects.createWrapper(el).css({overflow:"hidden"});if(show){el.css(ref,positiveMotion?(isNaN(distance)?"-"+distance:-distance):distance);}
animation[ref]=(show?(positiveMotion?"+=":"-="):(positiveMotion?"-=":"+="))+
distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode==="hide"){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();}});};

var effectTransfer=$.effects.effect.transfer=function(o,done){var elem=$(this),target=$(o.to),targetFixed=target.css("position")==="fixed",body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove();done();});};

var progressbar=$.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue();},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove();},value:function(newValue){if(newValue===undefined){return this.options.value;}
this.options.value=this._constrainedValue(newValue);this._refreshValue();},_constrainedValue:function(newValue){if(newValue===undefined){newValue=this.options.value;}
this.indeterminate=newValue===false;if(typeof newValue!=="number"){newValue=0;}
return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,newValue));},_setOptions:function(options){var value=options.value;delete options.value;this._super(options);this.options.value=this._constrainedValue(value);this._refreshValue();},_setOption:function(key,value){if(key==="max"){value=Math.max(this.min,value);}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value);}
this._super(key,value);},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min);},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).toggleClass("ui-corner-right",value===this.options.max).width(percentage.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv);}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null;}}
if(this.oldValue!==value){this.oldValue=value;this._trigger("change");}
if(value===this.options.max){this._trigger("complete");}}});

var selectable=$.widget("ui.selectable",$.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var selectees,that=this;this.element.addClass("ui-selectable");this.dragged=false;this.refresh=function(){selectees=$(that.options.filter,that.element[0]);selectees.addClass("ui-selectee");selectees.each(function(){var $this=$(this),pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:false,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")});});};this.refresh();this.selectees=selectees.addClass("ui-selectee");this._mouseInit();this.helper=$("<div class='ui-selectable-helper'></div>");},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy();},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY];if(this.options.disabled){return;}
this.selectees=$(options.filter,this.element[0]);this._trigger("start",event);$(options.appendTo).append(this.helper);this.helper.css({"left":event.pageX,"top":event.pageY,"width":0,"height":0});if(options.autoRefresh){this.refresh();}
this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=true;if(!event.metaKey&&!event.ctrlKey){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;that._trigger("unselecting",event,{unselecting:selectee.element});}});$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee){doSelect=(!event.metaKey&&!event.ctrlKey)||!selectee.$element.hasClass("ui-selected");selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting");selectee.unselecting=!doSelect;selectee.selecting=doSelect;selectee.selected=doSelect;if(doSelect){that._trigger("selecting",event,{selecting:selectee.element});}else{that._trigger("unselecting",event,{unselecting:selectee.element});}
return false;}});},_mouseDrag:function(event){this.dragged=true;if(this.options.disabled){return;}
var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;if(x1>x2){tmp=x2;x2=x1;x1=tmp;}
if(y1>y2){tmp=y2;y2=y1;y1=tmp;}
this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=false;if(!selectee||selectee.element===that.element[0]){return;}
if(options.tolerance==="touch"){hit=(!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1));}else if(options.tolerance==="fit"){hit=(selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2);}
if(hit){if(selectee.selected){selectee.$element.removeClass("ui-selected");selectee.selected=false;}
if(selectee.unselecting){selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false;}
if(!selectee.selecting){selectee.$element.addClass("ui-selecting");selectee.selecting=true;that._trigger("selecting",event,{selecting:selectee.element});}}else{if(selectee.selecting){if((event.metaKey||event.ctrlKey)&&selectee.startselected){selectee.$element.removeClass("ui-selecting");selectee.selecting=false;selectee.$element.addClass("ui-selected");selectee.selected=true;}else{selectee.$element.removeClass("ui-selecting");selectee.selecting=false;if(selectee.startselected){selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;}
that._trigger("unselecting",event,{unselecting:selectee.element});}}
if(selectee.selected){if(!event.metaKey&&!event.ctrlKey&&!selectee.startselected){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;that._trigger("unselecting",event,{unselecting:selectee.element});}}}});return false;},_mouseStop:function(event){var that=this;this.dragged=false;$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false;selectee.startselected=false;that._trigger("unselected",event,{unselected:selectee.element});});$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected");selectee.selecting=false;selectee.selected=true;selectee.startselected=true;that._trigger("selected",event,{selected:selectee.element});});this._trigger("stop",event);this.helper.remove();return false;}});

var selectmenu=$.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"};this._drawButton();this._drawMenu();if(this.options.disabled){this.disable();}},_drawButton:function(){var that=this;this.label=$("label[for='"+this.ids.element+"']").attr("for",this.ids.button);this._on(this.label,{click:function(event){this.button.focus();event.preventDefault();}});this.element.hide();this.button=$("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element);$("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button);this.buttonText=$("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button);this._setText(this.buttonText,this.element.find("option:selected").text());this._resizeButton();this._on(this.button,this._buttonEvents);this.button.one("focusin",function(){if(!that.menuItems){that._refreshMenu();}});this._hoverable(this.button);this._focusable(this.button);},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu});this.menuWrap=$("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo());this.menuInstance=this.menu.menu({role:"listbox",select:function(event,ui){event.preventDefault();that._setSelection();that._select(ui.item.data("ui-selectmenu-item"),event);},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");if(that.focusIndex!=null&&item.index!==that.focusIndex){that._trigger("focus",event,{item:item});if(!that.isOpen){that._select(item,event);}}
that.focusIndex=item.index;that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"));}}).menu("instance");this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all");this.menuInstance._off(this.menu,"mouseleave");this.menuInstance._closeOnDocumentClick=function(){return false;};this.menuInstance._isDivider=function(){return false;};},refresh:function(){this._refreshMenu();this._setText(this.buttonText,this._getSelectedItem().text());if(!this.options.width){this._resizeButton();}},_refreshMenu:function(){this.menu.empty();var item,options=this.element.find("option");if(!options.length){return;}
this._parseOptions(options);this._renderMenu(this.menu,this.items);this.menuInstance.refresh();this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup");item=this._getSelectedItem();this.menuInstance.focus(null,item);this._setAria(item.data("ui-selectmenu-item"));this._setOption("disabled",this.element.prop("disabled"));},open:function(event){if(this.options.disabled){return;}
if(!this.menuItems){this._refreshMenu();}else{this.menu.find(".ui-state-focus").removeClass("ui-state-focus");this.menuInstance.focus(null,this._getSelectedItem());}
this.isOpen=true;this._toggleAttr();this._resizeMenu();this._position();this._on(this.document,this._documentClick);this._trigger("open",event);},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position));},close:function(event){if(!this.isOpen){return;}
this.isOpen=false;this._toggleAttr();this.range=null;this._off(this.document);this._trigger("close",event);},widget:function(){return this.button;},menuWidget:function(){return this.menu;},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){if(item.optgroup!==currentOptgroup){$("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+
(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:item.optgroup}).appendTo(ul);currentOptgroup=item.optgroup;}
that._renderItemData(ul,item);});},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item);},_renderItem:function(ul,item){var li=$("<li>");if(item.disabled){li.addClass("ui-state-disabled");}
this._setText(li,item.label);return li.appendTo(ul);},_setText:function(element,value){if(value){element.text(value);}else{element.html("&#160;");}},_move:function(direction,event){var item,next,filter=".ui-menu-item";if(this.isOpen){item=this.menuItems.eq(this.focusIndex);}else{item=this.menuItems.eq(this.element[0].selectedIndex);filter+=":not(.ui-state-disabled)";}
if(direction==="first"||direction==="last"){next=item[direction==="first"?"prevAll":"nextAll"](filter).eq(-1);}else{next=item[direction+"All"](filter).eq(0);}
if(next.length){this.menuInstance.focus(event,next);}},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex);},_toggle:function(event){this[this.isOpen?"close":"open"](event);},_setSelection:function(){var selection;if(!this.range){return;}
if(window.getSelection){selection=window.getSelection();selection.removeAllRanges();selection.addRange(this.range);}else{this.range.select();}
this.button.focus();},_documentClick:{mousedown:function(event){if(!this.isOpen){return;}
if(!$(event.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length){this.close(event);}}},_buttonEvents:{mousedown:function(){var selection;if(window.getSelection){selection=window.getSelection();if(selection.rangeCount){this.range=selection.getRangeAt(0);}}else{this.range=document.selection.createRange();}},click:function(event){this._setSelection();this._toggle(event);},keydown:function(event){var preventDefault=true;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event);preventDefault=false;break;case $.ui.keyCode.ENTER:if(this.isOpen){this._selectFocusedItem(event);}
break;case $.ui.keyCode.UP:if(event.altKey){this._toggle(event);}else{this._move("prev",event);}
break;case $.ui.keyCode.DOWN:if(event.altKey){this._toggle(event);}else{this._move("next",event);}
break;case $.ui.keyCode.SPACE:if(this.isOpen){this._selectFocusedItem(event);}else{this._toggle(event);}
break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event);preventDefault=false;}
if(preventDefault){event.preventDefault();}}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex);if(!item.hasClass("ui-state-disabled")){this._select(item.data("ui-selectmenu-item"),event);}},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index;this._setText(this.buttonText,item.label);this._setAria(item);this._trigger("select",event,{item:item});if(item.index!==oldIndex){this._trigger("change",event,{item:item});}
this.close(event);},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id});this.menu.attr("aria-activedescendant",id);},_setOption:function(key,value){if(key==="icons"){this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(value.button);}
this._super(key,value);if(key==="appendTo"){this.menuWrap.appendTo(this._appendTo());}
if(key==="disabled"){this.menuInstance.option("disabled",value);this.button.toggleClass("ui-state-disabled",value).attr("aria-disabled",value);this.element.prop("disabled",value);if(value){this.button.attr("tabindex",-1);this.close();}else{this.button.attr("tabindex",0);}}
if(key==="width"){this._resizeButton();}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
if(!element||!element[0]){element=this.element.closest(".ui-front");}
if(!element.length){element=this.document[0].body;}
return element;},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen);this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen);this.menu.attr("aria-hidden",!this.isOpen);},_resizeButton:function(){var width=this.options.width;if(!width){width=this.element.show().outerWidth();this.element.hide();}
this.button.outerWidth(width);},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1));},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")};},_parseOptions:function(options){var data=[];options.each(function(index,item){var option=$(item),optgroup=option.parent("optgroup");data.push({element:option,index:index,value:option.val(),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")});});this.items=data;},_destroy:function(){this.menuWrap.remove();this.button.remove();this.element.show();this.element.removeUniqueId();this.label.attr("for",this.ids.element);}});

var slider=$.widget("ui.slider",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this.element.addClass("ui-slider"+" ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false;},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue();},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",handles=[];handleCount=(options.values&&options.values.length)||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount);}
for(i=existingHandles.length;i<handleCount;i++){handles.push(handle);}
this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i);});},_createRange:function(){var options=this.options,classes="";if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()];}else if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]];}else if($.isArray(options.values)){options.values=options.values.slice(0);}}
if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);classes="ui-slider-range"+" ui-widget-header ui-corner-all";}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({"left":"","bottom":""});}
this.range.addClass(classes+
((options.range==="min"||options.range==="max")?" ui-slider-range-"+options.range:""));}else{if(this.range){this.range.remove();}
this.range=null;}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles);},_destroy:function(){this.handles.remove();if(this.range){this.range.remove();}
this.element.removeClass("ui-slider"+" ui-slider-horizontal"+" ui-slider-vertical"+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._mouseDestroy();},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false;}
this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if((distance>thisDistance)||(distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))){distance=thisDistance;closestHandle=$(this);index=i;}});allowed=this._start(event,index);if(allowed===false){return false;}
this._mouseSliding=true;this._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-(closestHandle.width()/2),top:event.pageY-offset.top-
(closestHandle.height()/2)-
(parseInt(closestHandle.css("borderTopWidth"),10)||0)-
(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+
(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue);}
this._animateOff=true;return true;},_mouseStart:function(){return true;},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false;},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false;},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal";},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0);}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0);}
percentMouse=(pixelMouse/pixelTotal);if(percentMouse>1){percentMouse=1;}
if(percentMouse<0){percentMouse=0;}
if(this.orientation==="vertical"){percentMouse=1-percentMouse;}
valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse);},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values();}
return this._trigger("start",event,uiHash);},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if((this.options.values.length===2&&this.options.range===true)&&((index===0&&newVal>otherVal)||(index===1&&newVal<otherVal))){newVal=otherVal;}
if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal);}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal);}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values();}
this._trigger("stop",event,uiHash);},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values();}
this._lastChangedValue=index;this._trigger("change",event,uiHash);}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return;}
return this._value();},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return;}
if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i);}
this._refreshValue();}else{if(this.options.values&&this.options.values.length){return this._values(index);}else{return this.value();}}}else{return this._values();}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null;}else if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null;}}
if($.isArray(this.options.values)){valsLength=this.options.values.length;}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value);}
this._super(key,value);switch(key){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();this.handles.css(value==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i);}
this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break;}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val;},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val;}else if(this.options.values&&this.options.values.length){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i]);}
return vals;}else{return[];}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin();}
if(val>=this._valueMax()){return this._valueMax();}
var step=(this.options.step>0)?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=(valModStep>0)?step:(-step);}
return parseFloat(alignValue.toFixed(5));},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step,aboveMin=Math.floor((+(max-min).toFixed(this._precision()))/step)*step;max=aboveMin+min;this.max=parseFloat(max.toFixed(this._precision()));},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min));}
return precision;},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1;},_valueMin:function(){return this.options.min;},_valueMax:function(){return this.max;},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=(!this._animateOff)?o.animate:false,_set={};if(this.options.values&&this.options.values.length){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate);}
if(i===1){that.range[animate?"animate":"css"]({width:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:(valPercent)+"%"},o.animate);}
if(i===1){that.range[animate?"animate":"css"]({height:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});}}}
lastValPercent=valPercent;});}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=(valueMax!==valueMin)?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate);}
if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:(100-valPercent)+"%"},{queue:false,duration:o.animate});}
if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate);}
if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:(100-valPercent)+"%"},{queue:false,duration:o.animate});}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;$(event.target).addClass("ui-state-active");allowed=this._start(event,index);if(allowed===false){return;}}
break;}
step=this.options.step;if(this.options.values&&this.options.values.length){curVal=newVal=this.values(index);}else{curVal=newVal=this.value();}
switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+((this._valueMax()-this._valueMin())/this.numPages));break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-((this._valueMax()-this._valueMin())/this.numPages));break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return;}
newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return;}
newVal=this._trimAlignValue(curVal-step);break;}
this._slide(event,index,newVal);},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);$(event.target).removeClass("ui-state-active");}}}});

var sortable=$.widget("ui.sortable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return(x>=reference)&&(x<(reference+size));},_isFloating:function(item){return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"));},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true;},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._setHandleClassName();}},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle");});},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item");}
return this;},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false;}
if(this.options.disabled||this.options.type==="static"){return false;}
this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false;}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target);}
if(!currentItem){return false;}
if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true;}});if(!validHandle){return false;}}
this.currentItem=currentItem;this._removeCurrentsFromItems();return true;},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide();}
this._createPlaceholder();if(o.containment){this._setContainment();}
if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");this.storedCursor=body.css("cursor");body.css("cursor",o.cursor);this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body);}
if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity");}
this.helper.css("opacity",o.opacity);}
if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex");}
this.helper.css("zIndex",o.zIndex);}
if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset();}
this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions();}
if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this));}}
if($.ui.ddmanager){$.ui.ddmanager.current=this;}
if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(event);return true;},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs;}
if(this.options.scroll){if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;}}else{if(event.pageY-this.document.scrollTop()<o.scrollSensitivity){scrolled=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed);}else if(this.window.height()-(event.pageY-this.document.scrollTop())<o.scrollSensitivity){scrolled=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed);}
if(event.pageX-this.document.scrollLeft()<o.scrollSensitivity){scrolled=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed);}else if(this.window.width()-(event.pageX-this.document.scrollLeft())<o.scrollSensitivity){scrolled=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed);}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue;}
if(item.instance!==this.currentContainer){continue;}
if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item);}else{break;}
this._trigger("change",event,this._uiHash());break;}}
this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false;},_mouseStop:function(event,noPropagation){if(!event){return;}
if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event);}
if(this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};if(!axis||axis==="x"){animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft);}
if(!axis||axis==="y"){animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop);}
this.reverting=true;$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event);});}else{this._clear(event,noPropagation);}
return false;},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0]);}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove();}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem);}else{$(this.domPosition.parent).prepend(this.currentItem);}}
return this;},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));}});if(!str.length&&o.key){str.push(o.key+"=");}
return str.join("&");},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"");});return ret;},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),isOverElement=isOverElementHeight&&isOverElementWidth;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement;}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);}},_intersectsWithPointer:function(item){var isOverElementHeight=(this.options.axis==="x")||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(!isOverElement){return false;}
return this.floating?(((horizontalDirection&&horizontalDirection==="right")||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1));},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up");},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left");},refresh:function(event){this._refreshItems(event);this._setHandleClassName();this.refreshPositions();return this;},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i],this.document[0]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);}}}}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function addItems(){items.push(this);}
for(i=queries.length-1;i>=0;i--){queries[i][0].each(addItems);}
return $(items);},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false;}}
return true;});},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i],this.document[0]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst);}}}}
for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0});}}},refreshPositions:function(fast){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):false;if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset();}
var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue;}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight();}
p=t.offset();item.left=p.left;item.top=p.top;}
if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this);}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();}}
return this;},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(nodeName==="tbody"){that._createTrPlaceholder(that.currentItem.find("tr").eq(0),$("<tr>",that.document[0]).appendTo(element));}else if(nodeName==="tr"){that._createTrPlaceholder(that.currentItem,element);}else if(nodeName==="img"){element.attr("src",that.currentItem.attr("src"));}
if(!className){element.css("visibility","hidden");}
return element;},update:function(container,p){if(className&&!o.forcePlaceholderSize){return;}
if(!p.height()){p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10));}
if(!p.width()){p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10));}}};}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder);},_createTrPlaceholder:function(sourceTr,targetTr){var that=this;sourceTr.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(targetTr);});},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue;}
if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue;}
innermostContainer=this.containers[i];innermostIndex=i;}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(!innermostContainer){return;}
if(this.containers.length===1){if(!this.containers[innermostIndex].containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}}else{dist=10000;itemWithLeastDistance=null;floating=innermostContainer.floating||this._isFloating(this.currentItem);posProperty=floating?"left":"top";sizeProperty=floating?"width":"height";axis=floating?"clientX":"clientY";for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue;}
if(this.items[j].item[0]===this.currentItem[0]){continue;}
cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(event[axis]-cur>this.items[j][sizeProperty]/2){nearBottom=true;}
if(Math.abs(event[axis]-cur)<dist){dist=Math.abs(event[axis]-cur);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down";}}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return;}
if(this.currentContainer===this.containers[innermostIndex]){if(!this.currentContainer.containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash());this.currentContainer.containerCache.over=1;}
return;}
itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.currentContainer=this.containers[innermostIndex];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);}
if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};}
if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width());}
if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height());}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this.offsetParent[0]===this.document[0].body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,o.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(o.containment==="document"?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top];}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset();}
if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top;}}
if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh);}});},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem);}
this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]="";}}
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside));});}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash());});}
if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash());});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this));};}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this));};}).call(this,this.currentContainer));}}
function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance));};}
for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push(delayEvent("deactivate",this,this.containers[i]));}
if(this.containers[i].containerCache.over){delayedTriggers.push(delayEvent("out",this,this.containers[i]));this.containers[i].containerCache.over=0;}}
if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove();}
if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity);}
if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);}
this.dragging=false;if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove();}
this.helper=null;}
if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return!this.cancelHelperRemoval;},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel();}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null};}});

function spinner_modifier(fn){return function(){var previous=this.element.val();fn.apply(this,arguments);this._refresh();if(previous!==this.element.val()){this._trigger("change");}};}
var spinner=$.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true);}
this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete");}});},_getCreateOptions:function(){var options={},element=this.element;$.each(["min","max","step"],function(i,option){var value=element.attr(option);if(value!==undefined&&value.length){options[option]=value;}});return options;},_events:{keydown:function(event){if(this._start(event)&&this._keydown(event)){event.preventDefault();}},keyup:"_stop",focus:function(){this.previous=this.element.val();},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return;}
this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",event);}},mousewheel:function(event,delta){if(!delta){return;}
if(!this.spinning&&!this._start(event)){return false;}
this._spin((delta>0?1:-1)*this.options.step,event);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(event);}},100);event.preventDefault();},"mousedown .ui-spinner-button":function(event){var previous;previous=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();function checkFocus(){var isActive=this.element[0]===this.document[0].activeElement;if(!isActive){this.element.focus();this.previous=previous;this._delay(function(){this.previous=previous;});}}
event.preventDefault();checkFocus.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;checkFocus.call(this);});if(this._start(event)===false){return;}
this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event);},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if(!$(event.currentTarget).hasClass("ui-state-active")){return;}
if(this._start(event)===false){return false;}
this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event);},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var uiSpinner=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=uiSpinner.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");if(this.buttons.height()>Math.ceil(uiSpinner.height()*0.5)&&uiSpinner.height()>0){uiSpinner.height(uiSpinner.height());}
if(this.options.disabled){this.disable();}},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:this._repeat(null,1,event);return true;case keyCode.DOWN:this._repeat(null,-1,event);return true;case keyCode.PAGE_UP:this._repeat(null,options.page,event);return true;case keyCode.PAGE_DOWN:this._repeat(null,-options.page,event);return true;}
return false;},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>";},_buttonHtml:function(){return""+"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'>"+"<span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>";},_start:function(event){if(!this.spinning&&this._trigger("start",event)===false){return false;}
if(!this.counter){this.counter=1;}
this.spinning=true;return true;},_repeat:function(i,steps,event){i=i||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,steps,event);},i);this._spin(steps*this.options.step,event);},_spin:function(step,event){var value=this.value()||0;if(!this.counter){this.counter=1;}
value=this._adjustValue(value+step*this._increment(this.counter));if(!this.spinning||this._trigger("spin",event,{value:value})!==false){this._value(value);this.counter++;}},_increment:function(i){var incremental=this.options.incremental;if(incremental){return $.isFunction(incremental)?incremental(i):Math.floor(i*i*i/50000-i*i/500+17*i/200+1);}
return 1;},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min));}
return precision;},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1;},_adjustValue:function(value){var base,aboveMin,options=this.options;base=options.min!==null?options.min:0;aboveMin=value-base;aboveMin=Math.round(aboveMin/options.step)*options.step;value=base+aboveMin;value=parseFloat(value.toFixed(this._precision()));if(options.max!==null&&value>options.max){return options.max;}
if(options.min!==null&&value<options.min){return options.min;}
return value;},_stop:function(event){if(!this.spinning){return;}
clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",event);},_setOption:function(key,value){if(key==="culture"||key==="numberFormat"){var prevValue=this._parse(this.element.val());this.options[key]=value;this.element.val(this._format(prevValue));return;}
if(key==="max"||key==="min"||key==="step"){if(typeof value==="string"){value=this._parse(value);}}
if(key==="icons"){this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(value.up);this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(value.down);}
this._super(key,value);if(key==="disabled"){this.widget().toggleClass("ui-state-disabled",!!value);this.element.prop("disabled",!!value);this.buttons.button(value?"disable":"enable");}},_setOptions:spinner_modifier(function(options){this._super(options);}),_parse:function(val){if(typeof val==="string"&&val!==""){val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val;}
return val===""||isNaN(val)?null:val;},_format:function(value){if(value===""){return"";}
return window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value;},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())});},isValid:function(){var value=this.value();if(value===null){return false;}
return value===this._adjustValue(value);},_value:function(value,allowAny){var parsed;if(value!==""){parsed=this._parse(value);if(parsed!==null){if(!allowAny){parsed=this._adjustValue(parsed);}
value=this._format(parsed);}}
this.element.val(value);this._refresh();},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",false).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element);},stepUp:spinner_modifier(function(steps){this._stepUp(steps);}),_stepUp:function(steps){if(this._start()){this._spin((steps||1)*this.options.step);this._stop();}},stepDown:spinner_modifier(function(steps){this._stepDown(steps);}),_stepDown:function(steps){if(this._start()){this._spin((steps||1)*-this.options.step);this._stop();}},pageUp:spinner_modifier(function(pages){this._stepUp((pages||1)*this.options.page);}),pageDown:spinner_modifier(function(pages){this._stepDown((pages||1)*this.options.page);}),value:function(newVal){if(!arguments.length){return this._parse(this.element.val());}
spinner_modifier(this._value).call(this,newVal);},widget:function(){return this.uiSpinner;}});

var tabs=$.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchor=anchor.cloneNode(false);anchorUrl=anchor.href.replace(rhash,"");locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl);}catch(error){}
try{locationUrl=decodeURIComponent(locationUrl);}catch(error){}
return anchor.hash.length>1&&anchorUrl===locationUrl;};})(),_create:function(){var that=this,options=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible);this._processTabs();options.active=this._initialActive();if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li);}))).sort();}
if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(options.active);}else{this.active=$();}
this._refresh();if(this.active.length){this.load(options.active);}},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);if(active===null){if(locationHash){this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash){active=i;return false;}});}
if(active===null){active=this.tabs.index(this.tabs.filter(".ui-tabs-active"));}
if(active===null||active===-1){active=this.tabs.length?0:false;}}
if(active!==false){active=this.tabs.index(this.tabs.eq(active));if(active===-1){active=collapsible?false:0;}}
if(!collapsible&&active===false&&this.anchors.length){active=0;}
return active;},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)};},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=true;if(this._handlePageNav(event)){return;}
switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=false;selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex);return;case $.ui.keyCode.ENTER:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex===this.options.active?false:selectedIndex);return;default:return;}
event.preventDefault();clearTimeout(this.activating);selectedIndex=this._focusNextTab(selectedIndex,goingForward);if(!event.ctrlKey&&!event.metaKey){focusedTab.attr("aria-selected","false");this.tabs.eq(selectedIndex).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",selectedIndex);},this.delay);}},_panelKeydown:function(event){if(this._handlePageNav(event)){return;}
if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){event.preventDefault();this.active.focus();}},_handlePageNav:function(event){if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true;}
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true;}},_findNextTab:function(index,goingForward){var lastTabIndex=this.tabs.length-1;function constrain(){if(index>lastTabIndex){index=0;}
if(index<0){index=lastTabIndex;}
return index;}
while($.inArray(constrain(),this.options.disabled)!==-1){index=goingForward?index+1:index-1;}
return index;},_focusNextTab:function(index,goingForward){index=this._findNextTab(index,goingForward);this.tabs.eq(index).focus();return index;},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
if(key==="disabled"){this._setupDisabled(value);return;}
this._super(key,value);if(key==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",value);if(!value&&this.options.active===false){this._activate(0);}}
if(key==="event"){this._setupEvents(value);}
if(key==="heightStyle"){this._setupHeightStyle(value);}},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):"";},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab);});this._processTabs();if(options.active===false||!this.anchors.length){options.active=false;this.active=$();}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===options.disabled.length){options.active=false;this.active=$();}else{this._activate(this._findNextTab(Math.max(0,options.active-1),false));}}else{options.active=this.tabs.index(this.active);}
this._refresh();},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0);}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"});}},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(event){if($(this).is(".ui-state-disabled")){event.preventDefault();}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if($(this).closest("li").is(".ui-state-disabled")){this.blur();}});this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return $("a",this)[0];}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");if(that._isLocal(anchor)){selector=anchor.hash;panelId=selector.substring(1);panel=that.element.find(that._sanitizeSelector(selector));}else{panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id;selector="#"+panelId;panel=that.element.find(selector);if(!panel.length){panel=that._createPanel(panelId);panel.insertAfter(that.panels[i-1]||that.tablist);}
panel.attr("aria-live","polite");}
if(panel.length){that.panels=that.panels.add(panel);}
if(originalAriaControls){tab.data("ui-tabs-aria-controls",originalAriaControls);}
tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId});panel.attr("aria-labelledby",anchorId);});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel");if(prevTabs){this._off(prevTabs.not(this.tabs));this._off(prevAnchors.not(this.anchors));this._off(prevPanels.not(this.panels));}},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0);},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true);},_setupDisabled:function(disabled){if($.isArray(disabled)){if(!disabled.length){disabled=false;}else if(disabled.length===this.anchors.length){disabled=true;}}
for(var i=0,li;(li=this.tabs[i]);i++){if(disabled===true||$.inArray(i,disabled)!==-1){$(li).addClass("ui-state-disabled").attr("aria-disabled","true");}else{$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled");}}
this.options.disabled=disabled;},_setupEvents:function(event){var events={};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(event){event.preventDefault();}});this._on(this.anchors,events);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs);},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();if(heightStyle==="fill"){maxHeight=parent.height();maxHeight-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(true);});this.panels.each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height());}).height(maxHeight);}},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=!active.length?$():this._getPanelForTab(active),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||(clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.tabs.index(tab);this.active=clickedIsActive?$():tab;if(this.xhr){this.xhr.abort();}
if(!toHide.length&&!toShow.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.");}
if(toShow.length){this.load(this.tabs.index(tab),event);}
this._toggle(event,eventData);},_toggle:function(event,eventData){var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData);}
function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(toShow.length&&that.options.show){that._show(toShow,that.options.show,complete);}else{toShow.show();complete();}}
if(toHide.length&&this.options.hide){this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");show();});}else{eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");toHide.hide();show();}
toHide.attr("aria-hidden","true");eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){eventData.oldTab.attr("tabIndex",-1);}else if(toShow.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false");eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});},_activate:function(index){var anchor,active=this._findActive(index);if(active[0]===this.active[0]){return;}
if(!active.length){active=this.active;}
anchor=active.find(".ui-tabs-anchor")[0];this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop});},_findActive:function(index){return index===false?$():this.tabs.eq(index);},_getIndex:function(index){if(typeof index==="string"){index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"));}
return index;},_destroy:function(){if(this.xhr){this.xhr.abort();}
this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tablist.unbind(this.eventNamespace);this.tabs.add(this.panels).each(function(){if($.data(this,"ui-tabs-destroy")){$(this).remove();}else{$(this).removeClass("ui-state-default ui-state-active ui-state-disabled "+"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role");}});this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");if(prev){li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls");}else{li.removeAttr("aria-controls");}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","");}},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return;}
if(index===undefined){disabled=false;}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null;});}else{disabled=$.map(this.tabs,function(li,num){return num!==index?num:null;});}}
this._setupDisabled(disabled);},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return;}
if(index===undefined){disabled=true;}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return;}
if($.isArray(disabled)){disabled=$.merge([index],disabled).sort();}else{disabled=[index];}}
this._setupDisabled(disabled);},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel},complete=function(jqXHR,status){if(status==="abort"){that.panels.stop(false,true);}
tab.removeClass("ui-tabs-loading");panel.removeAttr("aria-busy");if(jqXHR===that.xhr){delete that.xhr;}};if(this._isLocal(anchor[0])){return;}
this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));if(this.xhr&&this.xhr.statusText!=="canceled"){tab.addClass("ui-tabs-loading");panel.attr("aria-busy","true");this.xhr.done(function(response,status,jqXHR){setTimeout(function(){panel.html(response);that._trigger("load",event,eventData);complete(jqXHR,status);},1);}).fail(function(jqXHR,status){setTimeout(function(){complete(jqXHR,status);},1);});}},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData));}};},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id));}});

var tooltip=$.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html();},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,tooltipClass:null,track:false,close:null,open:null},_addDescribedBy:function(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id);elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")));},_removeDescribedBy:function(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);if(index!==-1){describedby.splice(index,1);}
elem.removeData("ui-tooltip-id");describedby=$.trim(describedby.join(" "));if(describedby){elem.attr("aria-describedby",describedby);}else{elem.removeAttr("aria-describedby");}},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};if(this.options.disabled){this._disable();}
this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body);},_setOption:function(key,value){var that=this;if(key==="disabled"){this[value?"_disable":"_enable"]();this.options[key]=value;return;}
this._super(key,value);if(key==="content"){$.each(this.tooltips,function(id,tooltipData){that._updateContent(tooltipData.element);});}},_disable:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur");event.target=event.currentTarget=tooltipData.element[0];that.close(event,true);});this.element.find(this.options.items).addBack().each(function(){var element=$(this);if(element.is("[title]")){element.data("ui-tooltip-title",element.attr("title")).removeAttr("title");}});},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var element=$(this);if(element.data("ui-tooltip-title")){element.attr("title",element.data("ui-tooltip-title"));}});},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);if(!target.length||target.data("ui-tooltip-id")){return;}
if(target.attr("title")){target.data("ui-tooltip-title",target.attr("title"));}
target.data("ui-tooltip-open",true);if(event&&event.type==="mouseover"){target.parents().each(function(){var parent=$(this),blurEvent;if(parent.data("ui-tooltip-open")){blurEvent=$.Event("blur");blurEvent.target=blurEvent.currentTarget=this;that.close(blurEvent,true);}
if(parent.attr("title")){parent.uniqueId();that.parents[this.id]={element:this,title:parent.attr("title")};parent.attr("title","");}});}
this._registerCloseHandlers(event,target);this._updateContent(target,event);},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;if(typeof contentOption==="string"){return this._open(event,target,contentOption);}
content=contentOption.call(target[0],function(response){that._delay(function(){if(!target.data("ui-tooltip-open")){return;}
if(event){event.type=eventType;}
this._open(event,target,response);});});if(content){this._open(event,target,content);}},_open:function(event,target,content){var tooltipData,tooltip,delayedShow,a11yContent,positionOption=$.extend({},this.options.position);if(!content){return;}
tooltipData=this._find(target);if(tooltipData){tooltipData.tooltip.find(".ui-tooltip-content").html(content);return;}
if(target.is("[title]")){if(event&&event.type==="mouseover"){target.attr("title","");}else{target.removeAttr("title");}}
tooltipData=this._tooltip(target);tooltip=tooltipData.tooltip;this._addDescribedBy(target,tooltip.attr("id"));tooltip.find(".ui-tooltip-content").html(content);this.liveRegion.children().hide();if(content.clone){a11yContent=content.clone();a11yContent.removeAttr("id").find("[id]").removeAttr("id");}else{a11yContent=content;}
$("<div>").html(a11yContent).appendTo(this.liveRegion);function position(event){positionOption.of=event;if(tooltip.is(":hidden")){return;}
tooltip.position(positionOption);}
if(this.options.track&&event&&/^mouse/.test(event.type)){this._on(this.document,{mousemove:position});position(event);}else{tooltip.position($.extend({of:target},this.options.position));}
tooltip.hide();this._show(tooltip,this.options.show);if(this.options.show&&this.options.show.delay){delayedShow=this.delayedShow=setInterval(function(){if(tooltip.is(":visible")){position(positionOption.of);clearInterval(delayedShow);}},$.fx.interval);}
this._trigger("open",event,{tooltip:tooltip});},_registerCloseHandlers:function(event,target){var events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0];this.close(fakeEvent,true);}}};if(target[0]!==this.element[0]){events.remove=function(){this._removeTooltip(this._find(target).tooltip);};}
if(!event||event.type==="mouseover"){events.mouseleave="close";}
if(!event||event.type==="focusin"){events.focusout="close";}
this._on(true,target,events);},close:function(event){var tooltip,that=this,target=$(event?event.currentTarget:this.element),tooltipData=this._find(target);if(!tooltipData){target.removeData("ui-tooltip-open");return;}
tooltip=tooltipData.tooltip;if(tooltipData.closing){return;}
clearInterval(this.delayedShow);if(target.data("ui-tooltip-title")&&!target.attr("title")){target.attr("title",target.data("ui-tooltip-title"));}
this._removeDescribedBy(target);tooltipData.hiding=true;tooltip.stop(true);this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this));});target.removeData("ui-tooltip-open");this._off(target,"mouseleave focusout keyup");if(target[0]!==this.element[0]){this._off(target,"remove");}
this._off(this.document,"mousemove");if(event&&event.type==="mouseleave"){$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title);delete that.parents[id];});}
tooltipData.closing=true;this._trigger("close",event,{tooltip:tooltip});if(!tooltipData.hiding){tooltipData.closing=false;}},_tooltip:function(element){var tooltip=$("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+
(this.options.tooltipClass||"")),id=tooltip.uniqueId().attr("id");$("<div>").addClass("ui-tooltip-content").appendTo(tooltip);tooltip.appendTo(this.document[0].body);return this.tooltips[id]={element:element,tooltip:tooltip};},_find:function(target){var id=target.data("ui-tooltip-id");return id?this.tooltips[id]:null;},_removeTooltip:function(tooltip){tooltip.remove();delete this.tooltips[tooltip.attr("id")];},_destroy:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur"),element=tooltipData.element;event.target=event.currentTarget=element[0];that.close(event,true);$("#"+id).remove();if(element.data("ui-tooltip-title")){if(!element.attr("title")){element.attr("title",element.data("ui-tooltip-title"));}
element.removeData("ui-tooltip-title");}});this.liveRegion.remove();}});}));;

!function(a){"function"==typeof define&&define.amd?define("inputmask",["inputmask.dependencyLib"],a):"object"==typeof exports?module.exports=a(require("./inputmask.dependencyLib")):a(window.dependencyLib||jQuery)}(function(a){function b(d,e){return this instanceof b?(a.isPlainObject(d)?e=d:(e=e||{},e.alias=d),this.el=void 0,this.opts=a.extend(!0,{},this.defaults,e),this.maskset=void 0,this.noMasksCache=e&&void 0!==e.definitions,this.userOptions=e||{},this.events={},this.dataAttribute="data-inputmask",this.isRTL=this.opts.numericInput,void c(this.opts.alias,e,this.opts)):new b(d,e)}function c(b,d,e){var f=e.aliases[b];return f?(f.alias&&c(f.alias,void 0,e),a.extend(!0,e,f),a.extend(!0,e,d),!0):(null===e.mask&&(e.mask=b),!1)}function d(c,d){function e(c,e,f){if(null!==c&&""!==c){if(1===c.length&&f.greedy===!1&&0!==f.repeat&&(f.placeholder=""),f.repeat>0||"*"===f.repeat||"+"===f.repeat){var g="*"===f.repeat?0:"+"===f.repeat?1:f.repeat;c=f.groupmarker.start+c+f.groupmarker.end+f.quantifiermarker.start+g+","+f.repeat+f.quantifiermarker.end}var h;return void 0===b.prototype.masksCache[c]||d===!0?(h={mask:c,maskToken:b.prototype.analyseMask(c,f),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:e,maskLength:void 0},d!==!0&&(b.prototype.masksCache[f.numericInput?c.split("").reverse().join(""):c]=h,h=a.extend(!0,{},b.prototype.masksCache[f.numericInput?c.split("").reverse().join(""):c]))):h=a.extend(!0,{},b.prototype.masksCache[f.numericInput?c.split("").reverse().join(""):c]),h}}var f;if(a.isFunction(c.mask)&&(c.mask=c.mask(c)),a.isArray(c.mask)){if(c.mask.length>1){c.keepStatic=null===c.keepStatic||c.keepStatic;var g=c.groupmarker.start;return a.each(c.numericInput?c.mask.reverse():c.mask,function(b,d){g.length>1&&(g+=c.groupmarker.end+c.alternatormarker+c.groupmarker.start),g+=void 0===d.mask||a.isFunction(d.mask)?d:d.mask}),g+=c.groupmarker.end,e(g,c.mask,c)}c.mask=c.mask.pop()}return c.mask&&(f=void 0===c.mask.mask||a.isFunction(c.mask.mask)?e(c.mask,c.mask,c):e(c.mask.mask,c.mask,c)),f}function e(c,d,f){function k(a,b,c){b=b||0;var d,e,g,h=[],i=0,j=n();S=void 0!==V?V.maxLength:void 0,S===-1&&(S=void 0);do a===!0&&l().validPositions[i]?(g=l().validPositions[i],e=g.match,d=g.locator.slice(),h.push(c===!0?g.input:c===!1?e.nativeDef:F(i,e))):(g=q(i,d,i-1),e=g.match,d=g.locator.slice(),(f.jitMasking===!1||i<j||Number.isFinite(f.jitMasking)&&f.jitMasking>i)&&h.push(c===!1?e.nativeDef:F(i,e))),i++;while((void 0===S||i<S)&&(null!==e.fn||""!==e.def)||b>i);return""===h[h.length-1]&&h.pop(),l().maskLength=i+1,h}function l(){return d}function m(a){var b=l();b.buffer=void 0,a!==!0&&(b._buffer=void 0,b.validPositions={},b.p=0)}function n(a,b,c){var d=-1,e=-1,f=c||l().validPositions;void 0===a&&(a=-1);for(var g in f){var h=parseInt(g);f[h]&&(b||null!==f[h].match.fn)&&(h<=a&&(d=h),h>=a&&(e=h))}return d!==-1&&a-d>1||e<a?d:e}function o(b,c,d,e){function g(a){var b=l().validPositions[a];if(void 0!==b&&null===b.match.fn){var c=l().validPositions[a-1],d=l().validPositions[a+1];return void 0!==c&&void 0!==d}return!1}var h,i=b,j=a.extend(!0,{},l().validPositions),k=!1;for(l().p=b,h=c-1;h>=i;h--)void 0!==l().validPositions[h]&&(d!==!0&&(!l().validPositions[h].match.optionality&&g(h)||f.canClearPosition(l(),h,n(),e,f)===!1)||delete l().validPositions[h]);for(m(!0),h=i+1;h<=n();){for(;void 0!==l().validPositions[i];)i++;var o=l().validPositions[i];if(h<i&&(h=i+1),void 0===l().validPositions[h]&&A(h)||void 0!==o)h++;else{var p=q(h);k===!1&&j[i]&&j[i].match.def===p.match.def?(l().validPositions[i]=a.extend(!0,{},j[i]),l().validPositions[i].input=p.input,delete l().validPositions[h],h++):s(i,p.match.def)?z(i,p.input||F(h),!0)!==!1&&(delete l().validPositions[h],h++,k=!0):A(h)||(h++,i--),i++}}m(!0)}function p(a,b){for(var c,d=a,e=n(),g=l().validPositions[e]||t(0)[0],h=void 0!==g.alternation?g.locator[g.alternation].toString().split(","):[],i=0;i<d.length&&(c=d[i],!(c.match&&(f.greedy&&c.match.optionalQuantifier!==!0||(c.match.optionality===!1||c.match.newBlockMarker===!1)&&c.match.optionalQuantifier!==!0)&&(void 0===g.alternation||g.alternation!==c.alternation||void 0!==c.locator[g.alternation]&&y(c.locator[g.alternation].toString().split(","),h)))||b===!0&&(null!==c.match.fn||/[0-9a-bA-Z]/.test(c.match.def)));i++);return c}function q(a,b,c){return l().validPositions[a]||p(t(a,b?b.slice():b,c))}function r(a){return l().validPositions[a]?l().validPositions[a]:t(a)[0]}function s(a,b){for(var c=!1,d=t(a),e=0;e<d.length;e++)if(d[e].match&&d[e].match.def===b){c=!0;break}return c}function t(b,c,d){function e(c,d,g,h){function j(g,h,m){function p(b,c){var d=0===a.inArray(b,c.matches);return d||a.each(c.matches,function(a,e){if(e.isQuantifier===!0&&(d=p(b,c.matches[a-1])))return!1}),d}function r(b,c,d){var e,f;return(l().tests[b]||l().validPositions[b])&&a.each(l().tests[b]||[l().validPositions[b]],function(a,b){var g=void 0!==d?d:b.alternation,h=void 0!==b.locator[g]?b.locator[g].toString().indexOf(c):-1;(void 0===f||h<f)&&h!==-1&&(e=b,f=h)}),e?e.locator.slice((void 0!==d?d:e.alternation)+1):void 0!==d?r(b,c):void 0}function s(a,c){return null===a.match.fn&&null!==c.match.fn&&c.match.fn.test(a.match.def,l(),b,!1,f,!1)}if(k>1e4)throw"Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+l().mask;if(k===b&&void 0===g.matches)return n.push({match:g,locator:h.reverse(),cd:q}),!0;if(void 0!==g.matches){if(g.isGroup&&m!==g){if(g=j(c.matches[a.inArray(g,c.matches)+1],h))return!0}else if(g.isOptional){var t=g;if(g=e(g,d,h,m)){if(i=n[n.length-1].match,!p(i,t))return!0;o=!0,k=b}}else if(g.isAlternator){var u,v=g,w=[],x=n.slice(),y=h.length,z=d.length>0?d.shift():-1;if(z===-1||"string"==typeof z){var A,B=k,C=d.slice(),D=[];if("string"==typeof z)D=z.split(",");else for(A=0;A<v.matches.length;A++)D.push(A);for(var E=0;E<D.length;E++){if(A=parseInt(D[E]),n=[],d=r(k,A,y)||C.slice(),g=j(v.matches[A]||c.matches[A],[A].concat(h),m)||g,g!==!0&&void 0!==g&&D[D.length-1]<v.matches.length){var F=a.inArray(g,c.matches)+1;c.matches.length>F&&(g=j(c.matches[F],[F].concat(h.slice(1,h.length)),m),g&&(D.push(F.toString()),a.each(n,function(a,b){b.alternation=h.length-1})))}u=n.slice(),k=B,n=[];for(var G=0;G<u.length;G++){var H=u[G],I=!1;H.alternation=H.alternation||y;for(var J=0;J<w.length;J++){var K=w[J];if(("string"!=typeof z||a.inArray(H.locator[H.alternation].toString(),D)!==-1)&&(H.match.def===K.match.def||s(H,K))){I=H.match.nativeDef===K.match.nativeDef,H.alternation==K.alternation&&K.locator[K.alternation].toString().indexOf(H.locator[H.alternation])===-1&&(K.locator[K.alternation]=K.locator[K.alternation]+","+H.locator[H.alternation],K.alternation=H.alternation,null==H.match.fn&&(K.na=K.na||H.locator[H.alternation].toString(),K.na.indexOf(H.locator[H.alternation])===-1&&(K.na=K.na+","+H.locator[H.alternation])));break}}I||w.push(H)}}"string"==typeof z&&(w=a.map(w,function(b,c){if(isFinite(c)){var d,e=b.alternation,f=b.locator[e].toString().split(",");b.locator[e]=void 0,b.alternation=void 0;for(var g=0;g<f.length;g++)d=a.inArray(f[g],D)!==-1,d&&(void 0!==b.locator[e]?(b.locator[e]+=",",b.locator[e]+=f[g]):b.locator[e]=parseInt(f[g]),b.alternation=e);if(void 0!==b.locator[e])return b}})),n=x.concat(w),k=b,o=n.length>0,d=C.slice()}else g=j(v.matches[z]||c.matches[z],[z].concat(h),m);if(g)return!0}else if(g.isQuantifier&&m!==c.matches[a.inArray(g,c.matches)-1])for(var L=g,M=d.length>0?d.shift():0;M<(isNaN(L.quantifier.max)?M+1:L.quantifier.max)&&k<=b;M++){var N=c.matches[a.inArray(L,c.matches)-1];if(g=j(N,[M].concat(h),N)){if(i=n[n.length-1].match,i.optionalQuantifier=M>L.quantifier.min-1,p(i,N)){if(M>L.quantifier.min-1){o=!0,k=b;break}return!0}return!0}}else if(g=e(g,d,h,m))return!0}else k++}for(var m=d.length>0?d.shift():0;m<c.matches.length;m++)if(c.matches[m].isQuantifier!==!0){var p=j(c.matches[m],[m].concat(g),h);if(p&&k===b)return p;if(k>b)break}}function g(b){var c=[];return a.isArray(b)||(b=[b]),b.length>0&&(void 0===b[0].alternation?(c=p(b.slice()).locator.slice(),0===c.length&&(c=b[0].locator.slice())):a.each(b,function(a,b){if(""!==b.def)if(0===c.length)c=b.locator.slice();else for(var d=0;d<c.length;d++)b.locator[d]&&c[d].toString().indexOf(b.locator[d])===-1&&(c[d]+=","+b.locator[d])})),c}function h(a){return f.keepStatic&&b>0&&a.length>1+(""===a[a.length-1].match.def?1:0)&&a[0].match.optionality!==!0&&a[0].match.optionalQuantifier!==!0&&null===a[0].match.fn&&!/[0-9a-bA-Z]/.test(a[0].match.def)?[p(a)]:a}var i,j=l().maskToken,k=c?d:0,m=c?c.slice():[0],n=[],o=!1,q=c?c.join(""):"";if(b>-1){if(void 0===c){for(var r,s=b-1;void 0===(r=l().validPositions[s]||l().tests[s])&&s>-1;)s--;void 0!==r&&s>-1&&(m=g(r),q=m.join(""),k=s)}if(l().tests[b]&&l().tests[b][0].cd===q)return h(l().tests[b]);for(var t=m.shift();t<j.length;t++){var u=e(j[t],m,[t]);if(u&&k===b||k>b)break}}return(0===n.length||o)&&n.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:"",placeholder:""},locator:[],cd:q}),void 0!==c&&l().tests[b]?h(a.extend(!0,[],n)):(l().tests[b]=a.extend(!0,[],n),h(l().tests[b]))}function u(){return void 0===l()._buffer&&(l()._buffer=k(!1,1),void 0===l().buffer&&l()._buffer.slice()),l()._buffer}function v(a){return void 0!==l().buffer&&a!==!0||(l().buffer=k(!0,n(),!0)),l().buffer}function w(a,b,c){var d;if(a===!0)m(),a=0,b=c.length;else for(d=a;d<b;d++)delete l().validPositions[d];for(d=a;d<b;d++)m(!0),c[d]!==f.skipOptionalPartCharacter&&z(d,c[d],!0,!0)}function x(a,c,d){switch(f.casing||c.casing){case"upper":a=a.toUpperCase();break;case"lower":a=a.toLowerCase();break;case"title":var e=l().validPositions[d-1];a=0===d||e&&e.input===String.fromCharCode(b.keyCode.SPACE)?a.toUpperCase():a.toLowerCase()}return a}function y(b,c){for(var d=f.greedy?c:c.slice(0,1),e=!1,g=0;g<b.length;g++)if(a.inArray(b[g],d)!==-1){e=!0;break}return e}function z(c,d,e,g,h){function i(a){var b=W?a.begin-a.end>1||a.begin-a.end===1&&f.insertMode:a.end-a.begin>1||a.end-a.begin===1&&f.insertMode;return b&&0===a.begin&&a.end===l().maskLength?"full":b}function j(b,d,e){var h=!1;return a.each(t(b),function(j,k){for(var p=k.match,q=d?1:0,r="",s=p.cardinality;s>q;s--)r+=D(b-(s-1));if(d&&(r+=d),v(!0),h=null!=p.fn?p.fn.test(r,l(),b,e,f,i(c)):(d===p.def||d===f.skipOptionalPartCharacter)&&""!==p.def&&{c:p.placeholder||p.def,pos:b},h!==!1){var t=void 0!==h.c?h.c:d;t=t===f.skipOptionalPartCharacter&&null===p.fn?p.placeholder||p.def:t;var y=b,A=v();if(void 0!==h.remove&&(a.isArray(h.remove)||(h.remove=[h.remove]),a.each(h.remove.sort(function(a,b){return b-a}),function(a,b){o(b,b+1,!0)})),void 0!==h.insert&&(a.isArray(h.insert)||(h.insert=[h.insert]),a.each(h.insert.sort(function(a,b){return a-b}),function(a,b){z(b.pos,b.c,!0,g)})),h.refreshFromBuffer){var B=h.refreshFromBuffer;if(e=!0,w(B===!0?B:B.start,B.end,A),void 0===h.pos&&void 0===h.c)return h.pos=n(),!1;if(y=void 0!==h.pos?h.pos:b,y!==b)return h=a.extend(h,z(y,t,!0,g)),!1}else if(h!==!0&&void 0!==h.pos&&h.pos!==b&&(y=h.pos,w(b,y,v().slice()),y!==b))return h=a.extend(h,z(y,t,!0)),!1;return(h===!0||void 0!==h.pos||void 0!==h.c)&&(j>0&&m(!0),u(y,a.extend({},k,{input:x(t,p,y)}),g,i(c))||(h=!1),!1)}}),h}function k(b,c,d){var e,h,i,j,k,o,p,q,r=a.extend(!0,{},l().validPositions),s=!1,u=n();for(j=l().validPositions[u];u>=0;u--)if(i=l().validPositions[u],i&&void 0!==i.alternation){if(e=u,h=l().validPositions[e].alternation,j.locator[i.alternation]!==i.locator[i.alternation])break;j=i}if(void 0!==h){q=parseInt(e);var v=void 0!==j.locator[j.alternation||h]?j.locator[j.alternation||h]:p[0];v.length>0&&(v=v.split(",")[0]);var w=l().validPositions[q],x=l().validPositions[q-1];a.each(t(q,x?x.locator:void 0,q-1),function(e,i){p=i.locator[h]?i.locator[h].toString().split(","):[];for(var j=0;j<p.length;j++){var t=[],u=0,x=0,y=!1;if(v<p[j]&&(void 0===i.na||a.inArray(p[j],i.na.split(","))===-1)){l().validPositions[q]=a.extend(!0,{},i);var A=l().validPositions[q].locator;for(l().validPositions[q].locator[h]=parseInt(p[j]),null==i.match.fn?(w.input!==i.match.def&&(y=!0,w.generatedInput!==!0&&t.push(w.input)),x++,l().validPositions[q].generatedInput=!/[0-9a-bA-Z]/.test(i.match.def),l().validPositions[q].input=i.match.def):l().validPositions[q].input=w.input,k=q+1;k<n(void 0,!0)+1;k++)o=l().validPositions[k],o&&o.generatedInput!==!0&&/[0-9a-bA-Z]/.test(o.input)?t.push(o.input):k<b&&u++,delete l().validPositions[k];for(y&&t[0]===i.match.def&&t.shift(),m(!0),s=!0;t.length>0;){var B=t.shift();if(B!==f.skipOptionalPartCharacter&&!(s=z(n(void 0,!0)+1,B,!1,g,!0)))break}if(s){l().validPositions[q].locator=A;var C=n(b)+1;for(k=q+1;k<n()+1;k++)o=l().validPositions[k],(void 0===o||null==o.match.fn)&&k<b+(x-u)&&x++;b+=x-u,s=z(b>C?C:b,c,d,g,!0)}if(s)return!1;m(),l().validPositions=a.extend(!0,{},r)}}})}return s}function r(b,c){var d=l().validPositions[c];if(d)for(var e=d.locator,f=e.length,g=b;g<c;g++)if(void 0===l().validPositions[g]&&!A(g,!0)){var h=t(g),i=h[0],j=-1;a.each(h,function(a,b){for(var c=0;c<f&&(void 0!==b.locator[c]&&y(b.locator[c].toString().split(","),e[c].toString().split(",")));c++)j<c&&(j=c,i=b)}),u(g,a.extend({},i,{input:i.match.placeholder||i.match.def}),!0)}}function u(b,c,d,e){if(e||f.insertMode&&void 0!==l().validPositions[b]&&void 0===d){var g,h=a.extend(!0,{},l().validPositions),i=n(void 0,!0);for(g=b;g<=i;g++)delete l().validPositions[g];l().validPositions[b]=a.extend(!0,{},c);var j,k=!0,o=l().validPositions,p=!1,q=l().maskLength;for(g=j=b;g<=i;g++){var r=h[g];if(void 0!==r&&(r.generatedInput!==!0||null===r.match.fn))for(var t=j;t<l().maskLength&&(null===r.match.fn&&o[g]&&(o[g].match.optionalQuantifier===!0||o[g].match.optionality===!0)||null!=r.match.fn);){if(t++,p===!1&&h[t]&&h[t].match.def===r.match.def)l().validPositions[t]=a.extend(!0,{},h[t]),l().validPositions[t].input=r.input,C(t),j=t,k=!0;else if(s(t,r.match.def)){var u=z(t,r.input,!0,!0);k=u!==!1,j=u.caret||u.insert?n():t,p=!0}else k=r.generatedInput===!0;if(l().maskLength<q&&(l().maskLength=q),k)break}if(!k)break}if(!k)return l().validPositions=a.extend(!0,{},h),m(!0),!1}else l().validPositions[b]=a.extend(!0,{},c);return m(!0),!0}function C(b){for(var c=b-1;c>-1&&!l().validPositions[c];c--);var d,e;for(c++;c<b;c++)void 0===l().validPositions[c]&&(f.jitMasking===!1||f.jitMasking>c)&&(e=t(c,q(c-1).locator,c-1).slice(),""===e[e.length-1].match.def&&e.pop(),d=p(e),d&&(d.match.def===f.radixPointDefinitionSymbol||!A(c,!0)||a.inArray(f.radixPoint,v())<c&&d.match.fn&&d.match.fn.test(F(c),l(),c,!1,f))&&(G=j(c,d.match.placeholder||(null==d.match.fn?d.match.def:""!==F(c)?F(c):v()[c]),!0),G!==!1&&(l().validPositions[G.pos||c].generatedInput=!0)))}e=e===!0;var E=c;void 0!==c.begin&&(E=W&&!i(c)?c.end:c.begin);var G=!1,H=a.extend(!0,{},l().validPositions);if(C(E),i(c)&&(M(void 0,b.keyCode.DELETE,c),E=l().p),E<l().maskLength&&(G=j(E,d,e),(!e||g===!0)&&G===!1)){var I=l().validPositions[E];if(!I||null!==I.match.fn||I.match.def!==d&&d!==f.skipOptionalPartCharacter){if((f.insertMode||void 0===l().validPositions[B(E)])&&!A(E,!0)){var J=t(E).slice();""===J[J.length-1].match.def&&J.pop();var K=p(J,!0);K&&null===K.match.fn&&(K=K.match.placeholder||K.match.def,j(E,K,e),l().validPositions[E].generatedInput=!0);for(var L=E+1,N=B(E);L<=N;L++)if(G=j(L,d,e),G!==!1){r(E,void 0!==G.pos?G.pos:L),E=L;break}}}else G={caret:B(E)}}return G===!1&&f.keepStatic&&!e&&h!==!0&&(G=k(E,d,e)),G===!0&&(G={pos:E}),a.isFunction(f.postValidation)&&G!==!1&&!e&&g!==!0&&(G=!!f.postValidation(v(!0),G,f)&&G),void 0===G.pos&&(G.pos=E),G===!1&&(m(!0),l().validPositions=a.extend(!0,{},H)),G}function A(a,b){var c;if(b?(c=q(a).match,""===c.def&&(c=r(a).match)):c=r(a).match,null!=c.fn)return c.fn;if(b!==!0&&a>-1){var d=t(a);return d.length>1+(""===d[d.length-1].match.def?1:0)}return!1}function B(a,b){var c=l().maskLength;if(a>=c)return c;for(var d=a;++d<c&&(b===!0&&(r(d).match.newBlockMarker!==!0||!A(d))||b!==!0&&!A(d)););return d}function C(a,b){var c,d=a;if(d<=0)return 0;for(;--d>0&&(b===!0&&r(d).match.newBlockMarker!==!0||b!==!0&&!A(d)&&(c=t(d),c.length<2||2===c.length&&""===c[1].match.def)););return d}function D(a){return void 0===l().validPositions[a]?F(a):l().validPositions[a].input}function E(b,c,d,e,g){if(e&&a.isFunction(f.onBeforeWrite)){var h=f.onBeforeWrite(e,c,d,f);if(h){if(h.refreshFromBuffer){var i=h.refreshFromBuffer;w(i===!0?i:i.start,i.end,h.buffer||c),c=v(!0)}void 0!==d&&(d=void 0!==h.caret?h.caret:d)}}b.inputmask._valueSet(c.join("")),void 0===d||void 0!==e&&"blur"===e.type?O(b,c,d):I(b,d),g===!0&&(Y=!0,a(b).trigger("input"))}function F(a,b){if(b=b||r(a).match,void 0!==b.placeholder)return b.placeholder;if(null===b.fn){if(a>-1&&void 0===l().validPositions[a]){var c,d=t(a),e=[];if(d.length>1+(""===d[d.length-1].match.def?1:0))for(var g=0;g<d.length;g++)if(d[g].match.optionality!==!0&&d[g].match.optionalQuantifier!==!0&&(null===d[g].match.fn||void 0===c||d[g].match.fn.test(c.match.def,l(),a,!0,f)!==!1)&&(e.push(d[g]),null===d[g].match.fn&&(c=d[g]),e.length>1&&/[0-9a-bA-Z]/.test(e[0].match.def)))return f.placeholder.charAt(a%f.placeholder.length)}return b.def}return f.placeholder.charAt(a%f.placeholder.length)}function G(c,d,e,g,h,i){function j(){var a=!1,b=u().slice(p,B(p)).join("").indexOf(o);if(b!==-1&&!A(p)){a=!0;for(var c=u().slice(p,p+b),d=0;d<c.length;d++)if(" "!==c[d]){a=!1;break}}return a}var k=g.slice(),o="",p=0,r=void 0;if(m(),l().p=B(-1),!e)if(f.autoUnmask!==!0){var s=u().slice(0,B(-1)).join(""),t=k.join("").match(new RegExp("^"+b.escapeRegex(s),"g"));t&&t.length>0&&(k.splice(0,t.length*s.length),p=B(p))}else p=B(p);if(a.each(k,function(b,d){if(void 0!==d){var g=new a.Event("keypress");g.which=d.charCodeAt(0),o+=d;var h=n(void 0,!0),i=l().validPositions[h],k=q(h+1,i?i.locator.slice():void 0,h);if(!j()||e||f.autoUnmask){var s=e?b:null==k.match.fn&&k.match.optionality&&h+1<l().p?h+1:l().p;r=aa.keypressEvent.call(c,g,!0,!1,e,s),p=s+1,o=""}else r=aa.keypressEvent.call(c,g,!0,!1,!0,h+1);if(!e&&a.isFunction(f.onBeforeWrite)&&(r=f.onBeforeWrite(g,v(),r.forwardPosition,f),r&&r.refreshFromBuffer)){var t=r.refreshFromBuffer;w(t===!0?t:t.start,t.end,r.buffer),m(!0),r.caret&&(l().p=r.caret)}}}),d){var x=void 0,y=n();document.activeElement===c&&(h||r)&&(x=I(c).begin,h&&r===!1&&(x=B(n(x))),r&&i!==!0&&(x<y+1||y===-1)&&(x=f.numericInput&&void 0===r.caret?C(r.forwardPosition):r.forwardPosition)),E(c,v(),x,h||new a.Event("checkval"))}}function H(b){if(b&&void 0===b.inputmask)return b.value;var c=[],d=l().validPositions;for(var e in d)d[e].match&&null!=d[e].match.fn&&c.push(d[e].input);var g=0===c.length?"":(W?c.reverse():c).join("");if(a.isFunction(f.onUnMask)){var h=(W?v().slice().reverse():v()).join("");g=f.onUnMask(h,g,f)||g}return g}function I(a,b,c,d){function e(a){if(d!==!0&&W&&"number"==typeof a&&(!f.greedy||""!==f.placeholder)){var b=v().join("").length;a=b-a}return a}var h;if("number"!=typeof b)return a.setSelectionRange?(b=a.selectionStart,c=a.selectionEnd):window.getSelection?(h=window.getSelection().getRangeAt(0),h.commonAncestorContainer.parentNode!==a&&h.commonAncestorContainer!==a||(b=h.startOffset,c=h.endOffset)):document.selection&&document.selection.createRange&&(h=document.selection.createRange(),b=0-h.duplicate().moveStart("character",-a.inputmask._valueGet().length),c=b+h.text.length),{begin:e(b),end:e(c)};b=e(b),c=e(c),c="number"==typeof c?c:b;var i=parseInt(((a.ownerDocument.defaultView||window).getComputedStyle?(a.ownerDocument.defaultView||window).getComputedStyle(a,null):a.currentStyle).fontSize)*c;if(a.scrollLeft=i>a.scrollWidth?i:0,g||f.insertMode!==!1||b!==c||c++,a.setSelectionRange)a.selectionStart=b,a.selectionEnd=c;else if(window.getSelection){if(h=document.createRange(),void 0===a.firstChild||null===a.firstChild){var j=document.createTextNode("");a.appendChild(j)}h.setStart(a.firstChild,b<a.inputmask._valueGet().length?b:a.inputmask._valueGet().length),h.setEnd(a.firstChild,c<a.inputmask._valueGet().length?c:a.inputmask._valueGet().length),h.collapse(!0);var k=window.getSelection();k.removeAllRanges(),k.addRange(h)}else a.createTextRange&&(h=a.createTextRange(),h.collapse(!0),h.moveEnd("character",c),h.moveStart("character",b),h.select());O(a,void 0,{begin:b,end:c})}function J(b){var c,d,e=v(),f=e.length,g=n(),h={},i=l().validPositions[g],j=void 0!==i?i.locator.slice():void 0;for(c=g+1;c<e.length;c++)d=q(c,j,c-1),j=d.locator.slice(),h[c]=a.extend(!0,{},d);var k=i&&void 0!==i.alternation?i.locator[i.alternation]:void 0;for(c=f-1;c>g&&(d=h[c],(d.match.optionality||d.match.optionalQuantifier||k&&(k!==h[c].locator[i.alternation]&&null!=d.match.fn||null===d.match.fn&&d.locator[i.alternation]&&y(d.locator[i.alternation].toString().split(","),k.toString().split(","))&&""!==t(c)[0].def))&&e[c]===F(c,d.match));c--)f--;return b?{l:f,def:h[f]?h[f].match:void 0}:f}function K(a){for(var b=J(),c=a.length-1;c>b&&!A(c);c--);return a.splice(b,c+1-b),a}function L(b){if(a.isFunction(f.isComplete))return f.isComplete(b,f);if("*"!==f.repeat){var c=!1,d=J(!0),e=C(d.l);if(void 0===d.def||d.def.newBlockMarker||d.def.optionality||d.def.optionalQuantifier){c=!0;for(var g=0;g<=e;g++){var h=q(g).match;if(null!==h.fn&&void 0===l().validPositions[g]&&h.optionality!==!0&&h.optionalQuantifier!==!0||null===h.fn&&b[g]!==F(g,h)){c=!1;break}}}return c}}function M(c,d,e,g){function h(){if(f.keepStatic){for(var b=[],d=n(-1,!0),e=a.extend(!0,{},l().validPositions),g=l().validPositions[d];d>=0;d--){var h=l().validPositions[d];if(h){if(h.generatedInput!==!0&&/[0-9a-bA-Z]/.test(h.input)&&b.push(h.input),delete l().validPositions[d],void 0!==h.alternation&&h.locator[h.alternation]!==g.locator[h.alternation])break;g=h}}if(d>-1)for(l().p=B(n(-1,!0));b.length>0;){var i=new a.Event("keypress");i.which=b.pop().charCodeAt(0),aa.keypressEvent.call(c,i,!0,!1,!1,l().p)}else l().validPositions=a.extend(!0,{},e)}}if((f.numericInput||W)&&(d===b.keyCode.BACKSPACE?d=b.keyCode.DELETE:d===b.keyCode.DELETE&&(d=b.keyCode.BACKSPACE),W)){var i=e.end;e.end=e.begin,e.begin=i}d===b.keyCode.BACKSPACE&&(e.end-e.begin<1||f.insertMode===!1)?(e.begin=C(e.begin),void 0===l().validPositions[e.begin]||l().validPositions[e.begin].input!==f.groupSeparator&&l().validPositions[e.begin].input!==f.radixPoint||e.begin--):d===b.keyCode.DELETE&&e.begin===e.end&&(e.end=A(e.end,!0)?e.end+1:B(e.end)+1,void 0===l().validPositions[e.begin]||l().validPositions[e.begin].input!==f.groupSeparator&&l().validPositions[e.begin].input!==f.radixPoint||e.end++),o(e.begin,e.end,!1,g),g!==!0&&h();var j=n(e.begin,!0);j<e.begin?l().p=B(j):g!==!0&&(l().p=e.begin)}function N(b){function c(a){var c,d=document.createElement("span");for(var e in g)isNaN(e)&&e.indexOf("font")!==-1&&(d.style[e]=g[e]);d.style.textTransform=g.textTransform,d.style.letterSpacing=g.letterSpacing,d.style.position="absolute",d.style.height="auto",d.style.width="auto",d.style.visibility="hidden",d.style.whiteSpace="nowrap",document.body.appendChild(d);var f,h=b.inputmask._valueGet(),i=0;for(c=0,f=h.length;c<=f;c++){if(d.innerHTML+=h.charAt(c)||"_",d.offsetWidth>=a){var j=a-i,k=d.offsetWidth-a;d.innerHTML=h.charAt(c),j-=d.offsetWidth/3,c=j<k?c-1:c;break}i=d.offsetWidth}return document.body.removeChild(d),c}function d(){T.style.position="absolute",T.style.top=e.top+"px",T.style.left=e.left+"px",T.style.width=parseInt(b.offsetWidth)-parseInt(g.paddingLeft)-parseInt(g.paddingRight)-parseInt(g.borderLeftWidth)-parseInt(g.borderRightWidth)+"px",T.style.height=parseInt(b.offsetHeight)-parseInt(g.paddingTop)-parseInt(g.paddingBottom)-parseInt(g.borderTopWidth)-parseInt(g.borderBottomWidth)+"px",T.style.lineHeight=T.style.height,T.style.zIndex=isNaN(g.zIndex)?-1:g.zIndex-1,T.style.webkitAppearance="textfield",T.style.mozAppearance="textfield",T.style.Appearance="textfield"}var e=a(b).position(),g=(b.ownerDocument.defaultView||window).getComputedStyle(b,null);b.parentNode;T=document.createElement("div"),document.body.appendChild(T);for(var h in g)isNaN(h)&&"cssText"!==h&&h.indexOf("webkit")==-1&&(T.style[h]=g[h]);b.style.backgroundColor="transparent",b.style.color="transparent",b.style.webkitAppearance="caret",b.style.mozAppearance="caret",b.style.Appearance="caret",d(),a(window).on("resize",function(c){e=a(b).position(),g=(b.ownerDocument.defaultView||window).getComputedStyle(b,null),d()}),a(b).on("click",function(a){return I(b,c(a.clientX)),aa.clickEvent.call(this,[a])}),a(b).on("keydown",function(a){a.shiftKey||f.insertMode===!1||setTimeout(function(){O(b)},0)})}function O(a,b,c){function d(){g||null!==i.fn&&void 0!==j.input?g&&null!==i.fn&&void 0!==j.input&&(g=!1,e+="</span>"):(g=!0,e+="<span class='im-static''>")}if(void 0!==T){b=b||v(),void 0===c?c=I(a):void 0===c.begin&&(c={begin:c,end:c});var e="",g=!1;if(""!=b){var h,i,j,k=0,m=n();do k===c.begin&&document.activeElement===a&&(e+="<span class='im-caret' style='border-right-width: 1px;border-right-style: solid;'></span>"),l().validPositions[k]?(j=l().validPositions[k],i=j.match,h=j.locator.slice(),d(),e+=j.input):(j=q(k,h,k-1),i=j.match,h=j.locator.slice(),(f.jitMasking===!1||k<m||Number.isFinite(f.jitMasking)&&f.jitMasking>k)&&(d(),e+=F(k,i))),k++;while((void 0===S||k<S)&&(null!==i.fn||""!==i.def)||m>k)}T.innerHTML=e}}function P(b){function c(b,c){function d(b){function d(b){if(a.valHooks&&(void 0===a.valHooks[b]||a.valHooks[b].inputmaskpatch!==!0)){var d=a.valHooks[b]&&a.valHooks[b].get?a.valHooks[b].get:function(a){return a.value},e=a.valHooks[b]&&a.valHooks[b].set?a.valHooks[b].set:function(a,b){return a.value=b,a};a.valHooks[b]={get:function(a){if(a.inputmask){if(a.inputmask.opts.autoUnmask)return a.inputmask.unmaskedvalue();var b=d(a);return n(void 0,void 0,a.inputmask.maskset.validPositions)!==-1||c.nullable!==!0?b:""}return d(a)},set:function(b,c){var d,f=a(b);return d=e(b,c),b.inputmask&&f.trigger("setvalue"),d},inputmaskpatch:!0}}}function e(){return this.inputmask?this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():n()!==-1||c.nullable!==!0?document.activeElement===this&&c.clearMaskOnLostFocus?(W?K(v().slice()).reverse():K(v().slice())).join(""):h.call(this):"":h.call(this)}function f(b){i.call(this,b),this.inputmask&&a(this).trigger("setvalue")}function g(b){_.on(b,"mouseenter",function(b){var c=a(this),d=this,e=d.inputmask._valueGet();e!==v().join("")&&c.trigger("setvalue")})}var h,i;if(!b.inputmask.__valueGet){if(c.noValuePatching!==!0){if(Object.getOwnPropertyDescriptor){"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(a){return a.__proto__}:function(a){return a.constructor.prototype});var j=Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(b),"value"):void 0;j&&j.get&&j.set?(h=j.get,i=j.set,Object.defineProperty(b,"value",{get:e,set:f,configurable:!0})):"INPUT"!==b.tagName&&(h=function(){return this.textContent},i=function(a){this.textContent=a},Object.defineProperty(b,"value",{get:e,set:f,configurable:!0}))}else document.__lookupGetter__&&b.__lookupGetter__("value")&&(h=b.__lookupGetter__("value"),i=b.__lookupSetter__("value"),b.__defineGetter__("value",e),b.__defineSetter__("value",f));b.inputmask.__valueGet=h,b.inputmask.__valueSet=i}b.inputmask._valueGet=function(a){return W&&a!==!0?h.call(this.el).split("").reverse().join(""):h.call(this.el)},b.inputmask._valueSet=function(a,b){i.call(this.el,null===a||void 0===a?"":b!==!0&&W?a.split("").reverse().join(""):a)},void 0===h&&(h=function(){return this.value},i=function(a){this.value=a},d(b.type),g(b))}}var e=b.getAttribute("type"),f="INPUT"===b.tagName&&a.inArray(e,c.supportsInputType)!==-1||b.isContentEditable||"TEXTAREA"===b.tagName;if(!f)if("INPUT"===b.tagName){var g=document.createElement("input");g.setAttribute("type",e),f="text"===g.type,g=null}else f="partial";return f!==!1&&d(b),f}var d=c(b,f);if(d!==!1&&(V=b,R=a(V),("rtl"===V.dir||f.rightAlign)&&(V.style.textAlign="right"),("rtl"===V.dir||f.numericInput)&&(V.dir="ltr",V.removeAttribute("dir"),V.inputmask.isRTL=!0,W=!0),f.colorMask===!0&&N(V),j&&(V.hasOwnProperty("inputmode")&&(V.inputmode=f.inputmode,V.setAttribute("inputmode",f.inputmode)),"rtfm"===f.androidHack&&(f.colorMask!==!0&&N(V),V.type="password")),_.off(V),d===!0&&(_.on(V,"submit",aa.submitEvent),_.on(V,"reset",aa.resetEvent),_.on(V,"mouseenter",aa.mouseenterEvent),_.on(V,"blur",aa.blurEvent),_.on(V,"focus",aa.focusEvent),_.on(V,"mouseleave",aa.mouseleaveEvent),f.colorMask!==!0&&_.on(V,"click",aa.clickEvent),_.on(V,"dblclick",aa.dblclickEvent),_.on(V,"paste",aa.pasteEvent),_.on(V,"dragdrop",aa.pasteEvent),_.on(V,"drop",aa.pasteEvent),_.on(V,"cut",aa.cutEvent),_.on(V,"complete",f.oncomplete),_.on(V,"incomplete",f.onincomplete),_.on(V,"cleared",f.oncleared),f.inputEventOnly!==!0&&(_.on(V,"keydown",aa.keydownEvent),_.on(V,"keypress",aa.keypressEvent)),_.on(V,"compositionstart",a.noop),_.on(V,"compositionupdate",a.noop),_.on(V,"compositionend",a.noop),_.on(V,"keyup",a.noop),_.on(V,"input",aa.inputFallBackEvent)),_.on(V,"setvalue",aa.setValueEvent),u(),""!==V.inputmask._valueGet()||f.clearMaskOnLostFocus===!1||document.activeElement===V)){var e=a.isFunction(f.onBeforeMask)?f.onBeforeMask(V.inputmask._valueGet(),f)||V.inputmask._valueGet():V.inputmask._valueGet();G(V,!0,!1,e.split(""));var g=v().slice();Q=g.join(""),L(g)===!1&&f.clearIncomplete&&m(),f.clearMaskOnLostFocus&&document.activeElement!==V&&(n()===-1?g=[]:K(g)),E(V,g),document.activeElement===V&&I(V,B(n()))}}d=d||this.maskset,f=f||this.opts;var Q,R,S,T,U,V=this.el,W=this.isRTL,X=!1,Y=!1,Z=!1,$=!1,_={on:function(c,d,e){var g=function(c){if(void 0===this.inputmask&&"FORM"!==this.nodeName){var d=a.data(this,"_inputmask_opts");d?new b(d).mask(this):_.off(this)}else{if("setvalue"===c.type||!(this.disabled||this.readOnly&&!("keydown"===c.type&&c.ctrlKey&&67===c.keyCode||f.tabThrough===!1&&c.keyCode===b.keyCode.TAB))){switch(c.type){case"input":if(Y===!0)return Y=!1,c.preventDefault();break;case"keydown":X=!1,Y=!1;break;case"keypress":if(X===!0)return c.preventDefault();X=!0;break;case"click":if(h||i){var g=this,j=arguments;return setTimeout(function(){e.apply(g,j)},0),!1}}var k=e.apply(this,arguments);return k===!1&&(c.preventDefault(),c.stopPropagation()),k}c.preventDefault()}};c.inputmask.events[d]=c.inputmask.events[d]||[],c.inputmask.events[d].push(g),a.inArray(d,["submit","reset"])!==-1?null!=c.form&&a(c.form).on(d,g):a(c).on(d,g)},off:function(b,c){if(b.inputmask&&b.inputmask.events){var d;c?(d=[],d[c]=b.inputmask.events[c]):d=b.inputmask.events,a.each(d,function(c,d){for(;d.length>0;){var e=d.pop();a.inArray(c,["submit","reset"])!==-1?null!=b.form&&a(b.form).off(c,e):a(b).off(c,e)}delete b.inputmask.events[c]})}}},aa={keydownEvent:function(c){function d(a){var b=document.createElement("input"),c="on"+a,d=c in b;return d||(b.setAttribute(c,"return;"),d="function"==typeof b[c]),b=null,d}var e=this,g=a(e),h=c.keyCode,j=I(e);if(h===b.keyCode.BACKSPACE||h===b.keyCode.DELETE||i&&h===b.keyCode.BACKSPACE_SAFARI||c.ctrlKey&&h===b.keyCode.X&&!d("cut"))c.preventDefault(),M(e,h,j),E(e,v(!0),l().p,c,e.inputmask._valueGet()!==v().join("")),e.inputmask._valueGet()===u().join("")?g.trigger("cleared"):L(v())===!0&&g.trigger("complete");else if(h===b.keyCode.END||h===b.keyCode.PAGE_DOWN){c.preventDefault();var k=B(n());f.insertMode||k!==l().maskLength||c.shiftKey||k--,I(e,c.shiftKey?j.begin:k,k,!0)}else h===b.keyCode.HOME&&!c.shiftKey||h===b.keyCode.PAGE_UP?(c.preventDefault(),I(e,0,c.shiftKey?j.begin:0,!0)):(f.undoOnEscape&&h===b.keyCode.ESCAPE||90===h&&c.ctrlKey)&&c.altKey!==!0?(G(e,!0,!1,Q.split("")),g.trigger("click")):h!==b.keyCode.INSERT||c.shiftKey||c.ctrlKey?f.tabThrough===!0&&h===b.keyCode.TAB?(c.shiftKey===!0?(null===r(j.begin).match.fn&&(j.begin=B(j.begin)),j.end=C(j.begin,!0),j.begin=C(j.end,!0)):(j.begin=B(j.begin,!0),j.end=B(j.begin,!0),j.end<l().maskLength&&j.end--),j.begin<l().maskLength&&(c.preventDefault(),I(e,j.begin,j.end))):c.shiftKey||f.insertMode===!1&&(h===b.keyCode.RIGHT?setTimeout(function(){var a=I(e);I(e,a.begin)},0):h===b.keyCode.LEFT&&setTimeout(function(){var a=I(e);I(e,W?a.begin+1:a.begin-1)},0)):(f.insertMode=!f.insertMode,I(e,f.insertMode||j.begin!==l().maskLength?j.begin:j.begin-1));f.onKeyDown.call(this,c,v(),I(e).begin,f),Z=a.inArray(h,f.ignorables)!==-1},keypressEvent:function(c,d,e,g,h){var i=this,j=a(i),k=c.which||c.charCode||c.keyCode;if(!(d===!0||c.ctrlKey&&c.altKey)&&(c.ctrlKey||c.metaKey||Z))return k===b.keyCode.ENTER&&Q!==v().join("")&&(Q=v().join(""),setTimeout(function(){j.trigger("change")},0)),!0;if(k){46===k&&c.shiftKey===!1&&","===f.radixPoint&&(k=44);var n,o=d?{begin:h,end:h}:I(i),p=String.fromCharCode(k);l().writeOutBuffer=!0;var q=z(o,p,g);if(q!==!1&&(m(!0),n=void 0!==q.caret?q.caret:d?q.pos+1:B(q.pos),l().p=n),e!==!1){var r=this;if(setTimeout(function(){f.onKeyValidation.call(r,k,q,f)},0),l().writeOutBuffer&&q!==!1){var s=v();E(i,s,f.numericInput&&void 0===q.caret?C(n):n,c,d!==!0),d!==!0&&setTimeout(function(){L(s)===!0&&j.trigger("complete")},0)}}if(c.preventDefault(),d)return q.forwardPosition=n,q}},pasteEvent:function(b){var c,d=this,e=b.originalEvent||b,g=a(d),h=d.inputmask._valueGet(!0),i=I(d);W&&(c=i.end,i.end=i.begin,i.begin=c);var j=h.substr(0,i.begin),k=h.substr(i.end,h.length);if(j===(W?u().reverse():u()).slice(0,i.begin).join("")&&(j=""),k===(W?u().reverse():u()).slice(i.end).join("")&&(k=""),W&&(c=j,j=k,k=c),window.clipboardData&&window.clipboardData.getData)h=j+window.clipboardData.getData("Text")+k;else{if(!e.clipboardData||!e.clipboardData.getData)return!0;h=j+e.clipboardData.getData("text/plain")+k}var l=h;if(a.isFunction(f.onBeforePaste)){if(l=f.onBeforePaste(h,f),l===!1)return b.preventDefault();l||(l=h)}return G(d,!1,!1,W?l.split("").reverse():l.toString().split("")),E(d,v(),B(n()),b,Q!==v().join("")),L(v())===!0&&g.trigger("complete"),b.preventDefault()},inputFallBackEvent:function(c){var d=this,e=d.inputmask._valueGet();if(v().join("")!==e){var f=I(d);if(e=e.replace(new RegExp("("+b.escapeRegex(u().join(""))+")*"),""),h){var g=e.replace(v().join(""),"");if(1===g.length){var i=new a.Event("keypress");return i.which=g.charCodeAt(0),aa.keypressEvent.call(d,i,!0,!0,!1,l().validPositions[f.begin-1]?f.begin:f.begin-1),!1}}if(f.begin>e.length&&(I(d,e.length),f=I(d)),v().length-e.length!==1||e.charAt(f.begin)===v()[f.begin]||e.charAt(f.begin+1)===v()[f.begin]||A(f.begin)){for(var j=n()+1,k=u().join("");null===e.match(b.escapeRegex(k)+"$");)k=k.slice(1);e=e.replace(k,""),e=e.split(""),G(d,!0,!1,e,c,f.begin<j),L(v())===!0&&a(d).trigger("complete")}else c.keyCode=b.keyCode.BACKSPACE,aa.keydownEvent.call(d,c);c.preventDefault()}},setValueEvent:function(b){var c=this,d=c.inputmask._valueGet();G(c,!0,!1,(a.isFunction(f.onBeforeMask)?f.onBeforeMask(d,f)||d:d).split("")),Q=v().join(""),(f.clearMaskOnLostFocus||f.clearIncomplete)&&c.inputmask._valueGet()===u().join("")&&c.inputmask._valueSet("")},focusEvent:function(a){var b=this,c=b.inputmask._valueGet();f.showMaskOnFocus&&(!f.showMaskOnHover||f.showMaskOnHover&&""===c)&&(b.inputmask._valueGet()!==v().join("")?E(b,v(),B(n())):$===!1&&I(b,B(n()))),f.positionCaretOnTab===!0&&aa.clickEvent.apply(b,[a,!0]),Q=v().join("")},mouseleaveEvent:function(a){var b=this;if($=!1,f.clearMaskOnLostFocus&&document.activeElement!==b){var c=v().slice(),d=b.inputmask._valueGet();d!==b.getAttribute("placeholder")&&""!==d&&(n()===-1&&d===u().join("")?c=[]:K(c),E(b,c))}},clickEvent:function(b,c){function d(b){if(""!==f.radixPoint){var c=l().validPositions;if(void 0===c[b]||c[b].input===F(b)){if(b<B(-1))return!0;var d=a.inArray(f.radixPoint,v());if(d!==-1){for(var e in c)if(d<e&&c[e].input!==F(e))return!1;return!0}}}return!1}var e=this;setTimeout(function(){if(document.activeElement===e){var b=I(e);if(c&&(b.begin=b.end),b.begin===b.end)switch(f.positionCaretOnClick){case"none":break;case"radixFocus":if(d(b.begin)){var g=a.inArray(f.radixPoint,v().join(""));I(e,f.numericInput?B(g):g);break}default:var h=b.begin,i=n(h,!0),j=B(i);if(h<j)I(e,A(h)||A(h-1)?h:B(h));else{var k=F(j);(""!==k&&v()[j]!==k&&r(j).match.optionalQuantifier!==!0||!A(j)&&r(j).match.def===k)&&(j=B(j)),I(e,j)}}}},0)},dblclickEvent:function(a){var b=this;setTimeout(function(){I(b,0,B(n()))},0)},cutEvent:function(c){var d=this,e=a(d),f=I(d),g=c.originalEvent||c,h=window.clipboardData||g.clipboardData,i=W?v().slice(f.end,f.begin):v().slice(f.begin,f.end);h.setData("text",W?i.reverse().join(""):i.join("")),document.execCommand&&document.execCommand("copy"),M(d,b.keyCode.DELETE,f),E(d,v(),l().p,c,Q!==v().join("")),d.inputmask._valueGet()===u().join("")&&e.trigger("cleared")},blurEvent:function(b){var c=a(this),d=this;if(d.inputmask){var e=d.inputmask._valueGet(),g=v().slice();Q!==g.join("")&&setTimeout(function(){c.trigger("change"),Q=g.join("")},0),""!==e&&(f.clearMaskOnLostFocus&&(n()===-1&&e===u().join("")?g=[]:K(g)),L(g)===!1&&(setTimeout(function(){c.trigger("incomplete")},0),f.clearIncomplete&&(m(),g=f.clearMaskOnLostFocus?[]:u().slice())),E(d,g,void 0,b))}},mouseenterEvent:function(a){var b=this;$=!0,document.activeElement!==b&&f.showMaskOnHover&&b.inputmask._valueGet()!==v().join("")&&E(b,v())},submitEvent:function(a){Q!==v().join("")&&R.trigger("change"),f.clearMaskOnLostFocus&&n()===-1&&V.inputmask._valueGet&&V.inputmask._valueGet()===u().join("")&&V.inputmask._valueSet(""),f.removeMaskOnSubmit&&(V.inputmask._valueSet(V.inputmask.unmaskedvalue(),!0),setTimeout(function(){E(V,v())},0))},resetEvent:function(a){setTimeout(function(){R.trigger("setvalue")},0)}};if(void 0!==c)switch(c.action){case"isComplete":return V=c.el,L(v());case"unmaskedvalue":return void 0!==V&&void 0===c.value||(U=c.value,U=(a.isFunction(f.onBeforeMask)?f.onBeforeMask(U,f)||U:U).split(""),G(void 0,!1,!1,W?U.reverse():U),a.isFunction(f.onBeforeWrite)&&f.onBeforeWrite(void 0,v(),0,f)),H(V);case"mask":P(V);break;case"format":return U=(a.isFunction(f.onBeforeMask)?f.onBeforeMask(c.value,f)||c.value:c.value).split(""),G(void 0,!1,!1,W?U.reverse():U),a.isFunction(f.onBeforeWrite)&&f.onBeforeWrite(void 0,v(),0,f),c.metadata?{value:W?v().slice().reverse().join(""):v().join(""),metadata:e.call(this,{action:"getmetadata"},d,f)}:W?v().slice().reverse().join(""):v().join("");case"isValid":c.value?(U=c.value.split(""),G(void 0,!1,!0,W?U.reverse():U)):c.value=v().join("");for(var ba=v(),ca=J(),da=ba.length-1;da>ca&&!A(da);da--);return ba.splice(ca,da+1-ca),L(ba)&&c.value===v().join("");case"getemptymask":return u().join("");case"remove":if(V){R=a(V),V.inputmask._valueSet(H(V)),_.off(V);var ea;Object.getOwnPropertyDescriptor&&Object.getPrototypeOf?(ea=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(V),"value"),ea&&V.inputmask.__valueGet&&Object.defineProperty(V,"value",{get:V.inputmask.__valueGet,set:V.inputmask.__valueSet,configurable:!0})):document.__lookupGetter__&&V.__lookupGetter__("value")&&V.inputmask.__valueGet&&(V.__defineGetter__("value",V.inputmask.__valueGet),V.__defineSetter__("value",V.inputmask.__valueSet)),V.inputmask=void 0}return V;case"getmetadata":if(a.isArray(d.metadata)){var fa=k(!0,0,!1).join("");return a.each(d.metadata,function(a,b){if(b.mask===fa)return fa=b,!1}),fa}return d.metadata}}var f=navigator.userAgent,g=/mobile/i.test(f),h=/iemobile/i.test(f),i=/iphone/i.test(f)&&!h,j=/android/i.test(f)&&!h;return b.prototype={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:a.noop,onincomplete:a.noop,oncleared:a.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},alias:null,onKeyDown:a.noop,onBeforeMask:null,onBeforePaste:function(b,c){return a.isFunction(c.onBeforeMask)?c.onBeforeMask(b,c):b},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:a.noop,skipOptionalPartCharacter:" ",numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",radixPointDefinitionSymbol:void 0,groupSeparator:"",keepStatic:null,positionCaretOnTab:!0,tabThrough:!1,supportsInputType:["text","tel","password"],definitions:{9:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:null,canClearPosition:a.noop,postValidation:null,staticDefinitionSymbol:void 0,jitMasking:!1,nullable:!0,inputEventOnly:!1,noValuePatching:!1,positionCaretOnClick:"lvp",casing:null,inputmode:"verbatim",colorMask:!1,androidHack:!1},masksCache:{},mask:function(f){function g(b,d,e,f){function g(a,c){c=void 0!==c?c:b.getAttribute(f+"-"+a),null!==c&&("string"==typeof c&&(0===a.indexOf("on")?c=window[c]:"false"===c?c=!1:"true"===c&&(c=!0)),e[a]=c)}var h,i,j,k,l=b.getAttribute(f);if(l&&""!==l&&(l=l.replace(new RegExp("'","g"),'"'),i=JSON.parse("{"+l+"}")),i){j=void 0;for(k in i)if("alias"===k.toLowerCase()){j=i[k];break}}g("alias",j),e.alias&&c(e.alias,e,d);for(h in d){if(i){j=void 0;for(k in i)if(k.toLowerCase()===h.toLowerCase()){j=i[k];break}}g(h,j)}return a.extend(!0,d,e),d}var h=this;return"string"==typeof f&&(f=document.getElementById(f)||document.querySelectorAll(f)),f=f.nodeName?[f]:f,a.each(f,function(c,f){var i=a.extend(!0,{},h.opts);g(f,i,a.extend(!0,{},h.userOptions),h.dataAttribute);var j=d(i,h.noMasksCache);void 0!==j&&(void 0!==f.inputmask&&f.inputmask.remove(),f.inputmask=new b,f.inputmask.opts=i,f.inputmask.noMasksCache=h.noMasksCache,f.inputmask.userOptions=a.extend(!0,{},h.userOptions),f.inputmask.el=f,f.inputmask.maskset=j,a.data(f,"_inputmask_opts",i),e.call(f.inputmask,{action:"mask"}))}),f&&f[0]?f[0].inputmask||this:this},option:function(b,c){return"string"==typeof b?this.opts[b]:"object"==typeof b?(a.extend(this.userOptions,b),this.el&&c!==!0&&this.mask(this.el),this):void 0},unmaskedvalue:function(a){return this.maskset=this.maskset||d(this.opts,this.noMasksCache),e.call(this,{action:"unmaskedvalue",value:a})},remove:function(){return e.call(this,{action:"remove"})},getemptymask:function(){return this.maskset=this.maskset||d(this.opts,this.noMasksCache),e.call(this,{action:"getemptymask"})},hasMaskedValue:function(){return!this.opts.autoUnmask},isComplete:function(){return this.maskset=this.maskset||d(this.opts,this.noMasksCache),e.call(this,{action:"isComplete"})},getmetadata:function(){return this.maskset=this.maskset||d(this.opts,this.noMasksCache),e.call(this,{action:"getmetadata"})},isValid:function(a){return this.maskset=this.maskset||d(this.opts,this.noMasksCache),e.call(this,{action:"isValid",value:a})},format:function(a,b){return this.maskset=this.maskset||d(this.opts,this.noMasksCache),e.call(this,{action:"format",value:a,metadata:b})},analyseMask:function(b,c){function d(a,b,c,d){this.matches=[],this.openGroup=a||!1,this.isGroup=a||!1,this.isOptional=b||!1,this.isQuantifier=c||!1,this.isAlternator=d||!1,this.quantifier={min:1,max:1}}function e(b,d,e){var f=c.definitions[d];e=void 0!==e?e:b.matches.length;var g=b.matches[e-1];if(f&&!q){f.placeholder=a.isFunction(f.placeholder)?f.placeholder(c):f.placeholder;for(var h=f.prevalidator,i=h?h.length:0,j=1;j<f.cardinality;j++){var k=i>=j?h[j-1]:[],l=k.validator,m=k.cardinality;b.matches.splice(e++,0,{fn:l?"string"==typeof l?new RegExp(l):new function(){this.test=l}:new RegExp("."),cardinality:m?m:1,optionality:b.isOptional,newBlockMarker:void 0===g||g.def!==(f.definitionSymbol||d),casing:f.casing,def:f.definitionSymbol||d,placeholder:f.placeholder,nativeDef:d}),g=b.matches[e-1]}b.matches.splice(e++,0,{fn:f.validator?"string"==typeof f.validator?new RegExp(f.validator):new function(){this.test=f.validator}:new RegExp("."),cardinality:f.cardinality,optionality:b.isOptional,newBlockMarker:void 0===g||g.def!==(f.definitionSymbol||d),casing:f.casing,def:f.definitionSymbol||d,placeholder:f.placeholder,nativeDef:d})}else b.matches.splice(e++,0,{fn:null,cardinality:0,optionality:b.isOptional,newBlockMarker:void 0===g||g.def!==d,casing:null,def:c.staticDefinitionSymbol||d,placeholder:void 0!==c.staticDefinitionSymbol?d:void 0,nativeDef:d}),q=!1}function f(b){b&&b.matches&&a.each(b.matches,function(a,d){var g=b.matches[a+1];(void 0===g||void 0===g.matches||g.isQuantifier===!1)&&d&&d.isGroup&&(d.isGroup=!1,e(d,c.groupmarker.start,0),d.openGroup!==!0&&e(d,c.groupmarker.end)),f(d)})}function g(){if(s.length>0){if(l=s[s.length-1],e(l,j),l.isAlternator){m=s.pop();for(var a=0;a<m.matches.length;a++)m.matches[a].isGroup=!1;s.length>0?(l=s[s.length-1],l.matches.push(m)):r.matches.push(m)}}else e(r,j)}function h(a){function b(a){return a===c.optionalmarker.start?a=c.optionalmarker.end:a===c.optionalmarker.end?a=c.optionalmarker.start:a===c.groupmarker.start?a=c.groupmarker.end:a===c.groupmarker.end&&(a=c.groupmarker.start),a}a.matches=a.matches.reverse();for(var d in a.matches){var e=parseInt(d);if(a.matches[d].isQuantifier&&a.matches[e+1]&&a.matches[e+1].isGroup){var f=a.matches[d];a.matches.splice(d,1),a.matches.splice(e+1,0,f)}void 0!==a.matches[d].matches?a.matches[d]=h(a.matches[d]):a.matches[d]=b(a.matches[d])}return a}for(var i,j,k,l,m,n,o,p=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})|[^.?*+^${[]()|\\]+|./g,q=!1,r=new d,s=[],t=[];i=p.exec(b);)if(j=i[0],q)g();else switch(j.charAt(0)){case c.escapeChar:q=!0;break;case c.optionalmarker.end:case c.groupmarker.end:if(k=s.pop(),k.openGroup=!1,void 0!==k)if(s.length>0){if(l=s[s.length-1],l.matches.push(k),l.isAlternator){m=s.pop();for(var u=0;u<m.matches.length;u++)m.matches[u].isGroup=!1;s.length>0?(l=s[s.length-1],l.matches.push(m)):r.matches.push(m)}}else r.matches.push(k);else g();break;case c.optionalmarker.start:s.push(new d((!1),(!0)));break;case c.groupmarker.start:s.push(new d((!0)));break;case c.quantifiermarker.start:var v=new d((!1),(!1),(!0));j=j.replace(/[{}]/g,"");var w=j.split(","),x=isNaN(w[0])?w[0]:parseInt(w[0]),y=1===w.length?x:isNaN(w[1])?w[1]:parseInt(w[1]);if("*"!==y&&"+"!==y||(x="*"===y?0:1),v.quantifier={min:x,max:y},s.length>0){var z=s[s.length-1].matches;i=z.pop(),i.isGroup||(o=new d((!0)),o.matches.push(i),i=o),z.push(i),z.push(v)}else i=r.matches.pop(),i.isGroup||(o=new d((!0)),o.matches.push(i),i=o),r.matches.push(i),r.matches.push(v);break;case c.alternatormarker:s.length>0?(l=s[s.length-1],n=l.matches.pop()):n=r.matches.pop(),n.isAlternator?s.push(n):(m=new d((!1),(!1),(!1),(!0)),m.matches.push(n),s.push(m));break;default:g()}for(;s.length>0;)k=s.pop(),r.matches.push(k);return r.matches.length>0&&(f(r),t.push(r)),c.numericInput&&h(t[0]),t}},b.extendDefaults=function(c){a.extend(!0,b.prototype.defaults,c)},b.extendDefinitions=function(c){a.extend(!0,b.prototype.defaults.definitions,c)},b.extendAliases=function(c){a.extend(!0,b.prototype.defaults.aliases,c)},b.format=function(a,c,d){return b(c).format(a,d)},b.unmask=function(a,c){return b(c).unmaskedvalue(a)},b.isValid=function(a,c){return b(c).isValid(a)},b.remove=function(b){a.each(b,function(a,b){b.inputmask&&b.inputmask.remove()})},b.escapeRegex=function(a){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"];return a.replace(new RegExp("(\\"+b.join("|\\")+")","gim"),"\\$1")},b.keyCode={ALT:18,BACKSPACE:8,BACKSPACE_SAFARI:127,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91,X:88},window.Inputmask=b,b});;

!function(a){"function"==typeof define&&define.amd?define(["inputmask.dependencyLib","inputmask"],a):"object"==typeof exports?module.exports=a(require("./inputmask.dependencyLib"),require("./inputmask")):a(window.dependencyLib||jQuery,window.Inputmask)}(function(a,b){return b.extendAliases({numeric:{mask:function(a){function c(b){for(var c="",d=0;d<b.length;d++)c+=a.definitions[b.charAt(d)]||a.optionalmarker.start===b.charAt(d)||a.optionalmarker.end===b.charAt(d)||a.quantifiermarker.start===b.charAt(d)||a.quantifiermarker.end===b.charAt(d)||a.groupmarker.start===b.charAt(d)||a.groupmarker.end===b.charAt(d)||a.alternatormarker===b.charAt(d)?"\\"+b.charAt(d):b.charAt(d);return c}if(0!==a.repeat&&isNaN(a.integerDigits)&&(a.integerDigits=a.repeat),a.repeat=0,a.groupSeparator===a.radixPoint&&("."===a.radixPoint?a.groupSeparator=",":","===a.radixPoint?a.groupSeparator=".":a.groupSeparator="")," "===a.groupSeparator&&(a.skipOptionalPartCharacter=void 0),a.autoGroup=a.autoGroup&&""!==a.groupSeparator,a.autoGroup&&("string"==typeof a.groupSize&&isFinite(a.groupSize)&&(a.groupSize=parseInt(a.groupSize)),isFinite(a.integerDigits))){var d=Math.floor(a.integerDigits/a.groupSize),e=a.integerDigits%a.groupSize;a.integerDigits=parseInt(a.integerDigits)+(0===e?d-1:d),a.integerDigits<1&&(a.integerDigits="*")}a.placeholder.length>1&&(a.placeholder=a.placeholder.charAt(0)),"radixFocus"===a.positionCaretOnClick&&""===a.placeholder&&a.integerOptional===!1&&(a.positionCaretOnClick="lvp"),a.definitions[";"]=a.definitions["~"],a.definitions[";"].definitionSymbol="~",a.numericInput===!0&&(a.positionCaretOnClick="radixFocus"===a.positionCaretOnClick?"lvp":a.positionCaretOnClick,a.digitsOptional=!1,isNaN(a.digits)&&(a.digits=2),a.decimalProtect=!1);var f="[+]";if(f+=c(a.prefix),f+=a.integerOptional===!0?"~{1,"+a.integerDigits+"}":"~{"+a.integerDigits+"}",void 0!==a.digits){a.decimalProtect&&(a.radixPointDefinitionSymbol=":");var g=a.digits.toString().split(",");isFinite(g[0]&&g[1]&&isFinite(g[1]))?f+=(a.decimalProtect?":":a.radixPoint)+";{"+a.digits+"}":(isNaN(a.digits)||parseInt(a.digits)>0)&&(f+=a.digitsOptional?"["+(a.decimalProtect?":":a.radixPoint)+";{1,"+a.digits+"}]":(a.decimalProtect?":":a.radixPoint)+";{"+a.digits+"}")}return f+=c(a.suffix),f+="[-]",a.greedy=!1,null!==a.min&&(a.min=a.min.toString().replace(new RegExp(b.escapeRegex(a.groupSeparator),"g"),""),","===a.radixPoint&&(a.min=a.min.replace(a.radixPoint,"."))),null!==a.max&&(a.max=a.max.toString().replace(new RegExp(b.escapeRegex(a.groupSeparator),"g"),""),","===a.radixPoint&&(a.max=a.max.replace(a.radixPoint,"."))),f},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,radixPoint:".",positionCaretOnClick:"radixFocus",groupSize:3,groupSeparator:"",autoGroup:!1,allowPlus:!0,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",integerOptional:!0,prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:null,max:null,step:1,insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,inputmode:"numeric",postFormat:function(c,d,e){e.numericInput===!0&&(c=c.reverse(),isFinite(d)&&(d=c.join("").length-d-1));var f,g;d=d>=c.length?c.length-1:d<0?0:d;var h=c[d],i=c.slice();h===e.groupSeparator&&(i.splice(d--,1),h=i[d]);var j=i.join("").match(new RegExp("^"+b.escapeRegex(e.negationSymbol.front)));j=null!==j&&1===j.length,d>(j?e.negationSymbol.front.length:0)+e.prefix.length&&d<i.length-e.suffix.length&&(i[d]="!");var k=i.join(""),l=i.join();if(j&&(k=k.replace(new RegExp("^"+b.escapeRegex(e.negationSymbol.front)),""),k=k.replace(new RegExp(b.escapeRegex(e.negationSymbol.back)+"$"),"")),k=k.replace(new RegExp(b.escapeRegex(e.suffix)+"$"),""),k=k.replace(new RegExp("^"+b.escapeRegex(e.prefix)),""),k.length>0&&e.autoGroup||k.indexOf(e.groupSeparator)!==-1){var m=b.escapeRegex(e.groupSeparator);k=k.replace(new RegExp(m,"g"),"");var n=k.split(h===e.radixPoint?"!":e.radixPoint);if(k=""===e.radixPoint?k:n[0],h!==e.negationSymbol.front&&(k=k.replace("!","?")),k.length>e.groupSize)for(var o=new RegExp("([-+]?[\\d?]+)([\\d?]{"+e.groupSize+"})");o.test(k)&&""!==e.groupSeparator;)k=k.replace(o,"$1"+e.groupSeparator+"$2"),k=k.replace(e.groupSeparator+e.groupSeparator,e.groupSeparator);k=k.replace("?","!"),""!==e.radixPoint&&n.length>1&&(k+=(h===e.radixPoint?"!":e.radixPoint)+n[1])}k=e.prefix+k+e.suffix,j&&(k=e.negationSymbol.front+k+e.negationSymbol.back);var p=l!==k.split("").join(),q=a.inArray("!",k);if(q===-1&&(q=d),p){for(c.length=k.length,f=0,g=k.length;f<g;f++)c[f]=k.charAt(f);c[q]=h}return q=e.numericInput&&isFinite(d)?c.join("").length-q-1:q,e.numericInput&&(c=c.reverse(),a.inArray(e.radixPoint,c)<q&&c.join("").length-e.suffix.length!==q&&(q-=1)),{pos:q,refreshFromBuffer:p,buffer:c,isNegative:j}},onBeforeWrite:function(c,d,e,f){var g;if(c&&("blur"===c.type||"checkval"===c.type||"keydown"===c.type)){var h=f.numericInput?d.slice().reverse().join(""):d.join(""),i=h.replace(f.prefix,"");i=i.replace(f.suffix,""),i=i.replace(new RegExp(b.escapeRegex(f.groupSeparator),"g"),""),","===f.radixPoint&&(i=i.replace(f.radixPoint,"."));var j=i.match(new RegExp("[-"+b.escapeRegex(f.negationSymbol.front)+"]","g"));if(j=null!==j&&1===j.length,i=i.replace(new RegExp("[-"+b.escapeRegex(f.negationSymbol.front)+"]","g"),""),i=i.replace(new RegExp(b.escapeRegex(f.negationSymbol.back)+"$"),""),isNaN(f.placeholder)&&(i=i.replace(new RegExp(b.escapeRegex(f.placeholder),"g"),"")),i=i===f.negationSymbol.front?i+"0":i,""!==i&&isFinite(i)){var k=parseFloat(i),l=j?k*-1:k;if(null!==f.min&&isFinite(f.min)&&l<parseFloat(f.min)?(k=Math.abs(f.min),j=f.min<0,h=void 0):null!==f.max&&isFinite(f.max)&&l>parseFloat(f.max)&&(k=Math.abs(f.max),j=f.max<0,h=void 0),i=k.toString().replace(".",f.radixPoint).split(""),isFinite(f.digits)){var m=a.inArray(f.radixPoint,i),n=a.inArray(f.radixPoint,h);m===-1&&(i.push(f.radixPoint),m=i.length-1);for(var o=1;o<=f.digits;o++)f.digitsOptional||void 0!==i[m+o]&&i[m+o]!==f.placeholder.charAt(0)?n!==-1&&void 0!==h[n+o]&&(i[m+o]=i[m+o]||h[n+o]):i[m+o]="0";i[i.length-1]===f.radixPoint&&delete i[i.length-1]}if(k.toString()!==i&&k.toString()+"."!==i||j)return i=(f.prefix+i.join("")).split(""),!j||0===k&&"blur"===c.type||(i.unshift(f.negationSymbol.front),i.push(f.negationSymbol.back)),f.numericInput&&(i=i.reverse()),g=f.postFormat(i,f.numericInput?e:e-1,f),g.buffer&&(g.refreshFromBuffer=g.buffer.join("")!==d.join("")),g}}if(f.autoGroup)return g=f.postFormat(d,f.numericInput?e:e-1,f),g.caret=e<(g.isNegative?f.negationSymbol.front.length:0)+f.prefix.length||e>g.buffer.length-(g.isNegative?f.negationSymbol.back.length:0)?g.pos:g.pos+1,g},regex:{integerPart:function(a){return new RegExp("["+b.escapeRegex(a.negationSymbol.front)+"+]?\\d+")},integerNPart:function(a){return new RegExp("[\\d"+b.escapeRegex(a.groupSeparator)+b.escapeRegex(a.placeholder.charAt(0))+"]+")}},signHandler:function(a,b,c,d,e){if(!d&&e.allowMinus&&"-"===a||e.allowPlus&&"+"===a){var f=b.buffer.join("").match(e.regex.integerPart(e));if(f&&f[0].length>0)return b.buffer[f.index]===("-"===a?"+":e.negationSymbol.front)?"-"===a?""!==e.negationSymbol.back?{pos:0,c:e.negationSymbol.front,remove:0,caret:c,insert:{pos:b.buffer.length-1,c:e.negationSymbol.back}}:{pos:0,c:e.negationSymbol.front,remove:0,caret:c}:""!==e.negationSymbol.back?{pos:0,c:"+",remove:[0,b.buffer.length-1],caret:c}:{pos:0,c:"+",remove:0,caret:c}:b.buffer[0]===("-"===a?e.negationSymbol.front:"+")?"-"===a&&""!==e.negationSymbol.back?{remove:[0,b.buffer.length-1],caret:c-1}:{remove:0,caret:c-1}:"-"===a?""!==e.negationSymbol.back?{pos:0,c:e.negationSymbol.front,caret:c+1,insert:{pos:b.buffer.length,c:e.negationSymbol.back}}:{pos:0,c:e.negationSymbol.front,caret:c+1}:{pos:0,c:a,caret:c+1}}return!1},radixHandler:function(b,c,d,e,f){if(!e&&f.numericInput!==!0&&b===f.radixPoint&&void 0!==f.digits&&(isNaN(f.digits)||parseInt(f.digits)>0)){var g=a.inArray(f.radixPoint,c.buffer),h=c.buffer.join("").match(f.regex.integerPart(f));if(g!==-1&&c.validPositions[g])return c.validPositions[g-1]?{caret:g+1}:{pos:h.index,c:h[0],caret:g+1};if(!h||"0"===h[0]&&h.index+1!==d)return c.buffer[h?h.index:d]="0",{pos:(h?h.index:d)+1,c:f.radixPoint}}return!1},leadingZeroHandler:function(b,c,d,e,f,g){if(!e){var h=c.buffer.slice("");if(h.splice(0,f.prefix.length),h.splice(h.length-f.suffix.length,f.suffix.length),f.numericInput===!0){var h=h.reverse(),i=h[0];if("0"===i&&void 0===c.validPositions[d-1])return{pos:d,remove:h.length-1}}else{d-=f.prefix.length;var j=a.inArray(f.radixPoint,h),k=h.slice(0,j!==-1?j:void 0).join("").match(f.regex.integerNPart(f));if(k&&(j===-1||d<=j)){var l=j===-1?0:parseInt(h.slice(j+1).join(""));if(0===k[0].indexOf(""!==f.placeholder?f.placeholder.charAt(0):"0")&&(k.index+1===d||g!==!0&&0===l))return c.buffer.splice(k.index+f.prefix.length,1),{pos:k.index+f.prefix.length,remove:k.index+f.prefix.length};if("0"===b&&d<=k.index&&k[0]!==f.groupSeparator)return!1}}}return!0},definitions:{"~":{validator:function(c,d,e,f,g,h){var i=g.signHandler(c,d,e,f,g);if(!i&&(i=g.radixHandler(c,d,e,f,g),!i&&(i=f?new RegExp("[0-9"+b.escapeRegex(g.groupSeparator)+"]").test(c):new RegExp("[0-9]").test(c),i===!0&&(i=g.leadingZeroHandler(c,d,e,f,g,h),i===!0)))){var j=a.inArray(g.radixPoint,d.buffer);i=j!==-1&&(g.digitsOptional===!1||d.validPositions[e])&&g.numericInput!==!0&&e>j&&!f?{pos:e,remove:e}:{pos:e}}return i},cardinality:1},"+":{validator:function(a,b,c,d,e){var f=e.signHandler(a,b,c,d,e);return!f&&(d&&e.allowMinus&&a===e.negationSymbol.front||e.allowMinus&&"-"===a||e.allowPlus&&"+"===a)&&(f=!(!d&&"-"===a)||(""!==e.negationSymbol.back?{pos:c,c:"-"===a?e.negationSymbol.front:"+",caret:c+1,insert:{pos:b.buffer.length,c:e.negationSymbol.back}}:{pos:c,c:"-"===a?e.negationSymbol.front:"+",caret:c+1})),f},cardinality:1,placeholder:""},"-":{validator:function(a,b,c,d,e){var f=e.signHandler(a,b,c,d,e);return!f&&d&&e.allowMinus&&a===e.negationSymbol.back&&(f=!0),f},cardinality:1,placeholder:""},":":{validator:function(a,c,d,e,f){var g=f.signHandler(a,c,d,e,f);if(!g){var h="["+b.escapeRegex(f.radixPoint)+"]";g=new RegExp(h).test(a),g&&c.validPositions[d]&&c.validPositions[d].match.placeholder===f.radixPoint&&(g={caret:d+1})}return g},cardinality:1,placeholder:function(a){return a.radixPoint}}},onUnMask:function(a,c,d){if(""===c&&d.nullable===!0)return c;var e=a.replace(d.prefix,"");return e=e.replace(d.suffix,""),e=e.replace(new RegExp(b.escapeRegex(d.groupSeparator),"g"),""),d.unmaskAsNumber?(""!==d.radixPoint&&e.indexOf(d.radixPoint)!==-1&&(e=e.replace(b.escapeRegex.call(this,d.radixPoint),".")),Number(e)):e},isComplete:function(a,c){var d=a.join(""),e=a.slice();if(c.postFormat(e,0,c),e.join("")!==d)return!1;var f=d.replace(c.prefix,"");return f=f.replace(c.suffix,""),f=f.replace(new RegExp(b.escapeRegex(c.groupSeparator),"g"),""),","===c.radixPoint&&(f=f.replace(b.escapeRegex(c.radixPoint),".")),isFinite(f)},onBeforeMask:function(a,c){if(c.numericInput===!0&&(a=a.split("").reverse().join("")),""!==c.radixPoint&&isFinite(a)){var d=a.split("."),e=""!==c.groupSeparator?parseInt(c.groupSize):0;2===d.length&&(d[0].length>e||d[1].length>e)&&(a=a.toString().replace(".",c.radixPoint))}var f=a.match(/,/g),g=a.match(/\./g);if(g&&f?g.length>f.length?(a=a.replace(/\./g,""),a=a.replace(",",c.radixPoint)):f.length>g.length?(a=a.replace(/,/g,""),a=a.replace(".",c.radixPoint)):a=a.indexOf(".")<a.indexOf(",")?a.replace(/\./g,""):a=a.replace(/,/g,""):a=a.replace(new RegExp(b.escapeRegex(c.groupSeparator),"g"),""),0===c.digits&&(a.indexOf(".")!==-1?a=a.substring(0,a.indexOf(".")):a.indexOf(",")!==-1&&(a=a.substring(0,a.indexOf(",")))),""!==c.radixPoint&&isFinite(c.digits)&&a.indexOf(c.radixPoint)!==-1){var h=a.split(c.radixPoint),i=h[1].match(new RegExp("\\d*"))[0];if(parseInt(c.digits)<i.toString().length){var j=Math.pow(10,parseInt(c.digits));a=a.replace(b.escapeRegex(c.radixPoint),"."),a=Math.round(parseFloat(a)*j)/j,a=a.toString().replace(".",c.radixPoint)}}return c.numericInput===!0&&(a=a.split("").reverse().join("")),a.toString()},canClearPosition:function(a,b,c,d,e){var f=a.validPositions[b].input,g=f!==e.radixPoint||null!==a.validPositions[b].match.fn&&e.decimalProtect===!1||isFinite(f)||b===c||f===e.groupSeparator||f===e.negationSymbol.front||f===e.negationSymbol.back;return g},onKeyDown:function(c,d,e,f){var g=a(this);if(c.ctrlKey)switch(c.keyCode){case b.keyCode.UP:g.val(parseFloat(this.inputmask.unmaskedvalue())+parseInt(f.step)),g.trigger("setvalue");break;case b.keyCode.DOWN:g.val(parseFloat(this.inputmask.unmaskedvalue())-parseInt(f.step)),g.trigger("setvalue")}}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:0,radixPoint:""},percentage:{alias:"numeric",digits:2,radixPoint:".",placeholder:"0",autoGroup:!1,min:0,max:100,suffix:" %",allowPlus:!1,allowMinus:!1}}),b});;

!function(a){"function"==typeof define&&define.amd?define(["inputmask.dependencyLib","inputmask"],a):"object"==typeof exports?module.exports=a(require("./inputmask.dependencyLib"),require("./inputmask")):a(window.dependencyLib||jQuery,window.Inputmask)}(function(a,b){function c(a,b){var c=(a.mask||a).replace(/#/g,"9").replace(/\)/,"9").replace(/[+()#-]/g,""),d=(b.mask||b).replace(/#/g,"9").replace(/\)/,"9").replace(/[+()#-]/g,""),e=(a.mask||a).split("#")[0],f=(b.mask||b).split("#")[0];return 0===f.indexOf(e)?-1:0===e.indexOf(f)?1:c.localeCompare(d)}var d=b.prototype.analyseMask;return b.prototype.analyseMask=function(b,c){function e(a,c,d){c=c||"",d=d||g,""!==c&&(d[c]={});for(var f="",h=d[c]||d,i=a.length-1;i>=0;i--)b=a[i].mask||a[i],f=b.substr(0,1),h[f]=h[f]||[],h[f].unshift(b.substr(1)),a.splice(i,1);for(var j in h)h[j].length>500&&e(h[j].slice(),j,h)}function f(b){var d="",e=[];for(var g in b)a.isArray(b[g])?1===b[g].length?e.push(g+b[g]):e.push(g+c.groupmarker.start+b[g].join(c.groupmarker.end+c.alternatormarker+c.groupmarker.start)+c.groupmarker.end):e.push(g+f(b[g]));return d+=1===e.length?e[0]:c.groupmarker.start+e.join(c.groupmarker.end+c.alternatormarker+c.groupmarker.start)+c.groupmarker.end}var g={};c.phoneCodes&&c.phoneCodes.length>1e3&&(b=b.substr(1,b.length-2),e(b.split(c.groupmarker.end+c.alternatormarker+c.groupmarker.start)),b=f(g));var h=d.call(this,b,c);return h},b.extendAliases({abstractphone:{groupmarker:{start:"<",end:">"},countrycode:"",phoneCodes:[],mask:function(a){return a.definitions={"#":a.definitions[9]},a.phoneCodes.sort(c)},keepStatic:!0,onBeforeMask:function(a,b){var c=a.replace(/^0{1,2}/,"").replace(/[\s]/g,"");return(c.indexOf(b.countrycode)>1||c.indexOf(b.countrycode)===-1)&&(c="+"+b.countrycode+c),c},onUnMask:function(a,b,c){return b},inputmode:"tel"}}),b});;

!function(a){"function"==typeof define&&define.amd?define(["jquery","inputmask"],a):"object"==typeof exports?module.exports=a(require("jquery"),require("./inputmask")):a(jQuery,window.Inputmask)}(function(a,b){return void 0===a.fn.inputmask&&(a.fn.inputmask=function(c,d){var e,f=this[0];if(void 0===d&&(d={}),"string"==typeof c)switch(c){case"unmaskedvalue":return f&&f.inputmask?f.inputmask.unmaskedvalue():a(f).val();case"remove":return this.each(function(){this.inputmask&&this.inputmask.remove()});case"getemptymask":return f&&f.inputmask?f.inputmask.getemptymask():"";case"hasMaskedValue":return!(!f||!f.inputmask)&&f.inputmask.hasMaskedValue();case"isComplete":return!f||!f.inputmask||f.inputmask.isComplete();case"getmetadata":return f&&f.inputmask?f.inputmask.getmetadata():void 0;case"setvalue":a(f).val(d),f&&void 0===f.inputmask&&a(f).triggerHandler("setvalue");break;case"option":if("string"!=typeof d)return this.each(function(){if(void 0!==this.inputmask)return this.inputmask.option(d)});if(f&&void 0!==f.inputmask)return f.inputmask.option(d);break;default:return d.alias=c,e=new b(d),this.each(function(){e.mask(this)})}else{if("object"==typeof c)return e=new b(c),void 0===c.mask&&void 0===c.alias?this.each(function(){return void 0!==this.inputmask?this.inputmask.option(c):void e.mask(this)}):this.each(function(){e.mask(this)});if(void 0===c)return this.each(function(){e=new b(d),e.mask(this)})}}),a.fn.inputmask});;jQuery(document).ready(function(){applyInputMaskForPhoneInput();});function applyInputMaskForPhoneInput(){jQuery('input.phone-number, input.telephone-number').inputmask({mask:["(#99)999-99-99","8(#99)999-99-99","38(#99)999-99-99","+38(#99)999-99-99"],showMaskOnHover:false,showMaskOnFocus:false,definitions:{"#":{validator:"[0]",cardinality:1}}});};var allo=allo||new function(){};var j=jQuery;allo.current_deeplink=null;allo.category_list_deeplink=null;allo.openApplicationFlag=true;allo.mobileBanner=new function(){var _mobileTypes={0:'desktop',1:'android',2:'ios'};var _deviceTypeNow=_mobileTypes[0];this.dayHiddenTopBanner=365;this.urlAppStore=null;var popupCookieData={name:'popup_mobile_app',data:1,days:90};var _bannerPopup=null;var bannerData={config:null,data:null,deeplinking:null};this.setConfig=function(stringJSON){if(stringJSON){var device=this.getDeviceType();var confObj=j.parseJSON(stringJSON);if(confObj[device]['config']){bannerData.config=confObj[device]['config'];bannerData.data=confObj[device]['data'];bannerData.deeplinking={app_timeout:confObj['deeplinking']['deeplink_timeout']};}}};this.setupBanner=function(){var bannerConfig=this.getConfig().config;if(bannerConfig){var storeData=null;if(bannerConfig.type=='android'){storeData={android:bannerConfig.app_title};}else if(bannerConfig.type=='ios'){storeData={ios:bannerConfig.app_title};}
new SmartBanner({daysHidden:-1,daysReminder:-1,appStoreLanguage:'ru',title:bannerConfig.app_name,store:storeData,button:bannerConfig.app_button,deeplinking:bannerData.deeplinking});}};this.getPopup=function(){return _bannerPopup;};this.setupPopup=function(popupId){if(popupId){var popup=this.getPopup();var popupObj=j('#'+popupId);var template=new EJS(allo.templates.tpl['banner_popup']);popupObj[0].innerHTML=template.render(bannerData.data);if(popup==null){_bannerPopup=new Lightbox($(popupId));}
setTimeout(allo.mobileBanner.openPopup,1000);}};this.prepareBlockHeadToUse=function(){if(bannerData.config['app_active']){var blockHead=j('head');var id=bannerData.config['app_id'];var icon=bannerData.config['app_icon'];if(_deviceTypeNow==_mobileTypes[1]){blockHead.append('<meta name="google-play-app" content="app-id='+id+'">');blockHead.append('<link rel="android-touch-icon" href="'+icon+'"/>');}else if(_deviceTypeNow==_mobileTypes[2]){blockHead.append('<meta name="apple-itunes-app" content="app-id='+id+'">');blockHead.append('<link rel="apple-touch-icon" href="'+icon+'">');}}};this.openPopup=function(){if(checkCookiePopupExist()){allo.mobileBanner.getPopup().open();allo.mobileBanner.createCookie();}};this.closePopup=function(){var popup=this.getPopup();if(popup!=null&&popup.bgFade){popup.bgFade.click();}};this.getConfig=function(){return bannerData;};this.createCookie=function(){var cookieData=popupCookieData;this.insertCookieToServer(cookieData.name,cookieData.data,cookieData.days);};this.insertCookieToServer=function(name,value,days){var cookieProvider=new CookieProvider();if(!name||!value||!days){return;}
var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var nameValue=name+"="+encodeURI(value);var expires="; expires="+date.toGMTString();var path="; path=/";var domain="; domain="+cookieProvider.getDomain(document.location.hostname).domain;document.cookie=nameValue+expires+domain+path;};this.clickDownloadApp=function(){if(this.urlAppStore!=null){location.href=this.urlAppStore;}};this.getDeviceType=function(){var cookieProvider=new CookieProvider();var cookieValue=cookieProvider.readCookie('detect_mobile_type');if(cookieValue!=''&&cookieValue!=null){_deviceTypeNow=_mobileTypes[cookieValue];}
return _deviceTypeNow;};var checkCookiePopupExist=function(){var cookieProvider=new CookieProvider();var cookieData=popupCookieData;var result=true;if(cookieProvider.readCookie(cookieData.name)==1){result=false;}
return result;};};;(function(u){"object"===typeof exports&&"undefined"!==typeof module?module.exports=u():"function"===typeof define&&define.amd?define([],u):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).SmartBanner=u()})(function(){return function c(f,h,e){function b(d,v){if(!h[d]){if(!f[d]){var g="function"==typeof require&&require;if(!v&&g)return g(d,!0);if(a)return a(d,!0);g=Error("Cannot find module '"+d+"'");throw g.code="MODULE_NOT_FOUND",g;}
g=h[d]={exports:{}};f[d][0].call(g.exports,function(a){var e=f[d][1][a];return b(e?e:a)},g,g.exports,c,f,h,e)}
return h[d].exports}
for(var a="function"==typeof require&&require,d=0;d<e.length;d++)b(e[d]);return b}({1:[function(c,f,h){var e=c("xtend/mutable"),b=c("component-query"),a=c("get-doc"),d=c("cookie-cutter"),g=c("ua-parser-js"),v=(navigator.language||navigator.userLanguage||navigator.browserLanguage).slice(-2)||"us",p=a&&a.documentElement,l={ios:{appMeta:"apple-itunes-app",iconRels:["apple-touch-icon-precomposed","apple-touch-icon"],getStoreLink:function(){return"https://itunes.apple.com/"+this.options.appStoreLanguage+"/app/"+this.appId}},android:{appMeta:"google-play-app",iconRels:["android-touch-icon","apple-touch-icon-precomposed","apple-touch-icon"],getStoreLink:function(){return"http://play.google.com/store/apps/details?id="+this.appId}},windows:{appMeta:"msApplication-ID",iconRels:["windows-touch-icon","apple-touch-icon-precomposed","apple-touch-icon"],getStoreLink:function(){return"http://www.windowsphone.com/s?appid="+
this.appId}}};c=function(a){var b=g(navigator.userAgent);this.options=e({},{daysHidden:15,daysReminder:90,appStoreLanguage:v,button:"OPEN",store:{ios:"On the App Store",android:"In Google Play",windows:"In the Windows Store"},price:{ios:"FREE",android:"FREE",windows:"FREE"},theme:"",icon:"",force:""},a||{});this.options.force?this.type=this.options.force:"Windows Phone"===b.os.name||"Windows Mobile"===b.os.name?this.type="windows":"iOS"===b.os.name?this.type="ios":"Android"===b.os.name&&(this.type="android");a=!this.type;var b="ios"===this.type&&"Mobile Safari"===b.browser.name&&6<=Number(b.os.version),m=navigator.standalone,r=d.get("smartbanner-closed"),w=d.get("smartbanner-installed");a||r||(e(this,l[this.type]),this.parseAppId()&&(this.create(),this.show()))};c.prototype={constructor:c,create:function(){var d=this.getStoreLink(),e=this.options.store[this.type],m;if(this.options.icon)m=this.options.icon;else for(var r=0;r<this.iconRels.length;r++){var g=b('link[rel="'+this.iconRels[r]+'"]');if(g){m=g.getAttribute("href");break}}
var html=null;var q=a.createElement("div");q.className="smartbanner smartbanner-"+(this.options.theme||this.type);var deepLink=allo.current_deeplink;if(deepLink==''){html='<div class="smartbanner-container"><span class="smartbanner-close"></span><span class="smartbanner-icon" style="background-image: url('+m+')"></span><div class="smartbanner-info"><div class="smartbanner-title">'+this.options.title+"</div><span class='price-app'>"+e+'</span></div><a href="'+
d+'" class="smartbanner-button"><span class="smartbanner-button-text">'+this.options.button+"</span></a></div>";}else{html='<div class="smartbanner-container">'+'<span class="smartbanner-close"></span>'+'<span class="smartbanner-icon" style="background-image: url('+m+')"></span>'+'<div class="smartbanner-info"><div class="smartbanner-title">'+this.options.title+"</div><span class='price-app'>"+e+'</span></div>'+'<a href="javascript:;" data-deeplink="'+deepLink+'" class="smartbanner-button"><span class="smartbanner-button-text">'+this.options.button+"</span></a></div>";}
q.innerHTML=html;allo.mobileBanner.urlAppStore=d;var beforeElement=document.getElementsByClassName('wrapper')[0];a.body?a.body.insertBefore(q,beforeElement):a&&a.addEventListener("DOMContentLoaded",function(){a.body.insertBefore(q,beforeElement)});b(".smartbanner-button",q).addEventListener("click",this.showApplication.bind(this),!1);b(".smartbanner-close",q).addEventListener("click",this.close.bind(this),!1)},hide:function(){p.classList.remove("smartbanner-show")},show:function(){p.classList.add("smartbanner-show")},close:function(){this.hide();d.set("smartbanner-closed","true",{path:"/",expires:new Date(Number(new Date)+864E5*allo.mobileBanner.dayHiddenTopBanner)})},install:function(){this.hide();d.set("smartbanner-installed","true",{path:"/",expires:new Date(Number(new Date)+864E5*this.options.daysReminder)})},parseAppId:function(){var a=b('meta[name="'+this.appMeta+'"]');if(a)return this.appId="windows"===this.type?a.getAttribute("content"):/app-id=([^\s,]+)/.exec(a.getAttribute("content"))[1]},showApplication:function(e){var marketLink=this.getStoreLink(),delay=this.options.deeplinking.app_timeout;var w=window.open(allo.current_deeplink,'allomobile');w.onunload=function(){allo.openApplicationFlag=false;};setTimeout(function(){if(allo.openApplicationFlag){w.close();window.location=marketLink;}else{w.close();}},delay);}};f.exports=c},{"component-query":2,"cookie-cutter":3,"get-doc":4,"ua-parser-js":6,"xtend/mutable":7}],2:[function(c,f,h){function e(b,a){return a.querySelector(b)}
h=f.exports=function(b,a){a=a||document;return e(b,a)};h.all=function(b,a){a=a||document;return a.querySelectorAll(b)};h.engine=function(b){if(!b.one)throw Error(".one callback required");if(!b.all)throw Error(".all callback required");e=b.one;h.all=b.all;return h}},{}],3:[function(c,f,h){h=f.exports=function(e){e||(e={});"string"===typeof e&&(e={cookie:e});void 0===e.cookie&&(e.cookie="");return{get:function(b){for(var a=e.cookie.split(/;\s*/),d=0;d<a.length;d++){var g=a[d].split("=");if(unescape(g[0])===b)return unescape(g[1])}},set:function(b,a,d){d||(d={});b=escape(b)+"="+escape(a);d.expires&&(b+="; expires="+d.expires);d.path&&(b+="; path="+escape(d.path));return e.cookie=b}}};"undefined"!==typeof document&&(c=h(document),h.get=c.get,h.set=c.set)},{}],4:[function(c,f,h){c=c("has-dom");f.exports=c()?document:null},{"has-dom":5}],5:[function(c,f,h){f.exports=function(){return"undefined"!==typeof window&&"undefined"!==typeof document&&"function"===typeof document.createElement}},{}],6:[function(c,f,h){(function(e,b){var a={extend:function(a,b){var d={},m;for(m in a)d[m]=b[m]&&0===b[m].length%2?b[m].concat(a[m]):a[m];return d},has:function(a,b){return"string"===typeof a?-1!==b.toLowerCase().indexOf(a.toLowerCase()):!1},lowerize:function(a){return a.toLowerCase()},major:function(a){return"string"===typeof a?a.split(".")[0]:b},trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},d=function(){for(var a,d=0,e,g,c,k,h,f,l=arguments;d<l.length&&!h;){var p=l[d],n=l[d+1];if("undefined"===typeof a)for(c in a={},n)n.hasOwnProperty(c)&&(k=n[c],"object"===typeof k?a[k[0]]=b:a[k]=b);for(e=g=0;e<p.length&&!h;)if(h=p[e++].exec(this.getUA()))for(c=0;c<n.length;c++)f=h[++g],k=n[c],"object"===typeof k&&0<k.length?2==k.length?a[k[0]]="function"==typeof k[1]?k[1].call(this,f):k[1]:3==k.length?a[k[0]]="function"!==typeof k[1]||k[1].exec&&k[1].test?f?f.replace(k[1],k[2]):b:f?k[1].call(this,f,k[2]):b:4==k.length&&(a[k[0]]=f?k[3].call(this,f.replace(k[1],k[2])):b):a[k]=f?f:b;d+=2}
return a},g=function(d,e){for(var c in e)if("object"===typeof e[c]&&0<e[c].length)for(var g=0;g<e[c].length;g++){if(a.has(e[c][g],d))return"?"===c?b:c}else if(a.has(e[c],d))return"?"===c?b:c;return d},c={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},p={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/(OPiOS)[\/\s]+([\w\.]+)/i],[["name","Opera Mini"],"version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],["name","version"],[/(MicroMessenger)\/([\w\.]+)/i],[["name","WeChat"],"version"],[/(qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/JUC.+(ucweb)[\/\s]?([\w\.]+)/i],[["name","UCBrowser"],"version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/fxios\/([\w\.-]+)/i],["version",["name","Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",g,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",a.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",a.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",a.lowerize]]],device:[[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[["vendor",a.trim],["model",a.trim],["type","smarttv"]],[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],["model","vendor",["type","tablet"]],[/applecoremedia\/[\w\.]+ \((ipad)/],["model",["vendor","Apple"],["type","tablet"]],[/(apple\s{0,1}tv)/i],[["model","Apple TV"],["vendor","Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],["vendor","model",["type","tablet"]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],["model",["vendor","Amazon"],["type","tablet"]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[["model",g,{"Fire Phone":["SD","KF"]}],["vendor","Amazon"],["type","mobile"]],[/\((ip[honed|\s\w*]+);.+(apple)/i],["model","vendor",["type","mobile"]],[/\((ip[honed|\s\w*]+);/i],["model",["vendor","Apple"],["type","mobile"]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],["vendor","model",["type","mobile"]],[/\(bb10;\s(\w+)/i],["model",["vendor","BlackBerry"],["type","mobile"]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],["model",["vendor","Asus"],["type","tablet"]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[["vendor","Sony"],["model","Xperia Tablet"],["type","tablet"]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[["vendor","Sony"],["model","Xperia Phone"],["type","mobile"]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],["vendor","model",["type","console"]],[/android.+;\s(shield)\sbuild/i],["model",["vendor","Nvidia"],["type","console"]],[/(playstation\s[34portablevi]+)/i],["model",["vendor","Sony"],["type","console"]],[/(sprint\s(\w+))/i],[["vendor",g,{HTC:"APA",Sprint:"Sprint"}],["model",g,{"Evo Shift 4G":"7373KT"}],["type","mobile"]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],["vendor","model",["type","tablet"]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],["vendor",["model",/_/g," "],["type","mobile"]],[/(nexus\s9)/i],["model",["vendor","HTC"],["type","tablet"]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],["model",["vendor","Microsoft"],["type","console"]],[/(kin\.[onetw]{3})/i],[["model",/\./g," "],["vendor","Microsoft"],["type","mobile"]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s[6])/i],["model",["vendor","Motorola"],["type","mobile"]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],["model",["vendor","Motorola"],["type","tablet"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[["vendor","Samsung"],"model",["type","tablet"]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[["vendor","Samsung"],"model",["type","mobile"]],[/hbbtv.+maple;(\d+)/i],[["model",/^/,"SmartTV"],["vendor","Samsung"],["type","smarttv"]],[/\(dtv[\);].+(aquos)/i],["model",["vendor","Sharp"],["type","smarttv"]],[/sie-(\w+)*/i],["model",["vendor","Siemens"],["type","mobile"]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[["vendor","Nokia"],"model",["type","mobile"]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],["model",["vendor","Acer"],["type","tablet"]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[["vendor","LG"],"model",["type","tablet"]],[/(lg) netcast\.tv/i],["vendor","model",["type","smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],["model",["vendor","LG"],["type","mobile"]],[/android.+(ideatab[a-z0-9\-\s]+)/i],["model",["vendor","Lenovo"],["type","tablet"]],[/linux;.+((jolla));/i],["vendor","model",["type","mobile"]],[/((pebble))app\/[\d\.]+\s/i],["vendor","model",["type","wearable"]],[/android.+;\s(glass)\s\d/i],["model",["vendor","Google"],["type","wearable"]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[["model",/_/g," "],["vendor","Xiaomi"],["type","mobile"]],[/\s(tablet)[;\/]/i,/\s(mobile)[;\/]/i],[["type",a.lowerize],"vendor","model"]],engine:[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],os:[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",g,c]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",g,c]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]]},l=function(b,c){if(!(this instanceof l))return(new l(b,c)).getResult();var g=b||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),f=c?a.extend(p,c):p;this.getBrowser=function(){var b=d.apply(this,f.browser);b.major=a.major(b.version);return b};this.getCPU=function(){return d.apply(this,f.cpu)};this.getDevice=function(){return d.apply(this,f.device)};this.getEngine=function(){return d.apply(this,f.engine)};this.getOS=function(){return d.apply(this,f.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}};this.getUA=function(){return g};this.setUA=function(a){g=a;return this};return this};l.VERSION="0.7.11";l.BROWSER={NAME:"name",MAJOR:"major",VERSION:"version"};l.CPU={ARCHITECTURE:"architecture"};l.DEVICE={MODEL:"model",VENDOR:"vendor",TYPE:"type",CONSOLE:"console",MOBILE:"mobile",SMARTTV:"smarttv",TABLET:"tablet",WEARABLE:"wearable",EMBEDDED:"embedded"};l.ENGINE={NAME:"name",VERSION:"version"};l.OS={NAME:"name",VERSION:"version"};"undefined"!==typeof h?("undefined"!==typeof f&&f.exports&&(h=f.exports=l),h.UAParser=l):e.UAParser=l;var n=e.jQuery||e.Zepto;if("undefined"!==typeof n){var t=new l;n.ua=t.getResult();n.ua.get=function(){return t.getUA()};n.ua.set=function(a){t.setUA(a);a=t.getResult();for(var b in a)n.ua[b]=a[b]}}})("object"===typeof window?window:this)},{}],7:[function(c,f,h){f.exports=function(b){for(var a=1;a<arguments.length;a++){var d=arguments[a],c;for(c in d)e.call(d,c)&&(b[c]=d[c])}
return b};var e=Object.prototype.hasOwnProperty},{}]},{},[1])(1)});;;(function($,window,document,undefined){var drag,state,e;drag={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,offsetX:0,offsetY:0,distance:null,startTime:0,endTime:0,updatedX:0,targetEl:null};state={isTouch:false,isScrolling:false,isSwiping:false,direction:false,inMotion:false};e={_onDragStart:null,_onDragMove:null,_onDragEnd:null,_transitionEnd:null,_resizer:null,_responsiveCall:null,_goToLoop:null,_checkVisibile:null};function Owl(element,options){this.settings=null;this.options=$.extend({},Owl.Defaults,options);this.$element=$(element);this.drag=$.extend({},drag);this.state=$.extend({},state);this.e=$.extend({},e);this._plugins={};this._supress={};this._current=null;this._speed=null;this._coordinates=[];this._breakpoint=null;this._width=null;this._items=[];this._clones=[];this._mergers=[];this._invalidated={};this._pipe=[];this.processduration=0;$.each(Owl.Plugins,$.proxy(function(key,plugin){this._plugins[key[0].toLowerCase()+key.slice(1)]=new plugin(this);},this));$.each(Owl.Pipe,$.proxy(function(priority,worker){this._pipe.push({'filter':worker.filter,'run':$.proxy(worker.run,this)});},this));this.setup();this.initialize();}
Owl.Defaults={items:3,loop:false,center:false,mouseDrag:true,touchDrag:true,pullDrag:true,freeDrag:false,margin:0,stagePadding:0,merge:false,mergeFit:true,autoWidth:false,startPosition:0,rtl:false,smartSpeed:250,fluidSpeed:false,dragEndSpeed:false,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:window,responsiveClass:false,fallbackEasing:'swing',info:false,nestedItemSelector:false,itemElement:'div',stageElement:'div',themeClass:'owl-theme',baseClass:'owl-carousel',itemClass:'owl-item',centerClass:'center',activeClass:'active'};Owl.Width={Default:'default',Inner:'inner',Outer:'outer'};Owl.Plugins={};Owl.Pipe=[{filter:['width','items','settings'],run:function(cache){cache.current=this._items&&this._items[this.relative(this._current)];}},{filter:['items','settings'],run:function(){var cached=this._clones,clones=this.$stage.children('.cloned');if(clones.length!==cached.length||(!this.settings.loop&&cached.length>0)){this.$stage.children('.cloned').remove();this._clones=[];}}},{filter:['items','settings'],run:function(){var i,n,clones=this._clones,items=this._items,delta=this.settings.loop?clones.length-Math.max(this.settings.items*2,4):0;for(i=0,n=Math.abs(delta/2);i<n;i++){if(delta>0){this.$stage.children().eq(items.length+clones.length-1).remove();clones.pop();this.$stage.children().eq(0).remove();clones.pop();}else{clones.push(clones.length/2);this.$stage.append(items[clones[clones.length-1]].clone().addClass('cloned'));clones.push(items.length-1-(clones.length-1)/2);this.$stage.prepend(items[clones[clones.length-1]].clone().addClass('cloned'));}}}},{filter:['width','items','settings'],run:function(){var rtl=(this.settings.rtl?1:-1),width=(this.width()/this.settings.items).toFixed(3),coordinate=0,merge,i,n;this._coordinates=[];for(i=0,n=this._clones.length+this._items.length;i<n;i++){merge=this._mergers[this.relative(i)];merge=(this.settings.mergeFit&&Math.min(merge,this.settings.items))||merge;coordinate+=(this.settings.autoWidth?this._items[this.relative(i)].width()+this.settings.margin:width*merge)*rtl;this._coordinates.push(coordinate);}}},{filter:['width','items','settings'],run:function(){if(this.$element.hasClass('super-attribute-select')){var i,n,width=(this.width()/this.settings.items).toFixed(3),css={'width':Math.abs(this._coordinates[this._coordinates.length-1])+this.settings.stagePadding*2+18,'padding-left':this.settings.stagePadding||'','padding-right':this.settings.stagePadding||''};}else{var i,n,width=(this.width()/this.settings.items).toFixed(3),css={'width':Math.abs(this._coordinates[this._coordinates.length-1])+this.settings.stagePadding*2+11,'padding-left':this.settings.stagePadding||'','padding-right':this.settings.stagePadding||''};}
this.$stage.css(css);css={'width':this.settings.autoWidth?'auto':width-this.settings.margin};css[this.settings.rtl?'margin-left':'margin-right']=this.settings.margin;if(!this.settings.autoWidth&&$.grep(this._mergers,function(v){return v>1}).length>0){for(i=0,n=this._coordinates.length;i<n;i++){css.width=Math.abs(this._coordinates[i])-Math.abs(this._coordinates[i-1]||0)-this.settings.margin;this.$stage.children().eq(i).css(css);}}else{this.$stage.children().css(css);}}},{filter:['width','items','settings'],run:function(cache){cache.current&&this.reset(this.$stage.children().index(cache.current));}},{filter:['position'],run:function(){this.animate(this.coordinates(this._current));}},{filter:['width','position','items','settings'],run:function(){var rtl=this.settings.rtl?1:-1,padding=this.settings.stagePadding*2,begin=this.coordinates(this.current())+padding,end=begin+this.width()*rtl,inner,outer,matches=[],i,n;for(i=0,n=this._coordinates.length;i<n;i++){inner=this._coordinates[i-1]||0;outer=Math.abs(this._coordinates[i])+padding*rtl;if((this.op(inner,'<=',begin)&&(this.op(inner,'>',end)))||(this.op(outer,'<',begin)&&this.op(outer,'>',end))){matches.push(i);}}
this.$stage.children('.'+this.settings.activeClass).removeClass(this.settings.activeClass);this.$stage.children(':eq('+matches.join('), :eq(')+')').addClass(this.settings.activeClass);if(this.settings.center){this.$stage.children('.'+this.settings.centerClass).removeClass(this.settings.centerClass);this.$stage.children().eq(this.current()).addClass(this.settings.centerClass);}}}];Owl.prototype.initialize=function(){this.trigger('initialize');this.$element.addClass(this.settings.baseClass).addClass(this.settings.themeClass).toggleClass('owl-rtl',this.settings.rtl);this.browserSupport();if(this.settings.autoWidth&&this.state.imagesLoaded!==true){var imgs,nestedSelector,width;imgs=this.$element.find('img');nestedSelector=this.settings.nestedItemSelector?'.'+this.settings.nestedItemSelector:undefined;width=this.$element.children(nestedSelector).width();if(imgs.length&&width<=0){this.preloadAutoWidthImages(imgs);return false;}}
this.$element.addClass('owl-loading');this.$stage=$('<'+this.settings.stageElement+' class="owl-stage"/>').wrap('<div class="owl-stage-outer">');this.$element.append(this.$stage.parent());this.replace(this.$element.children().not(this.$stage.parent()));this._width=this.$element.width();this.refresh();this.$element.removeClass('owl-loading').addClass('owl-loaded');this.eventsCall();this.internalEvents();this.addTriggerableEvents();this.trigger('initialized');};Owl.prototype.setup=function(){var viewport=this.viewport(),overwrites=this.options.responsive,match=-1,settings=null;if(!overwrites){settings=$.extend({},this.options);}else{$.each(overwrites,function(breakpoint){if(breakpoint<=viewport&&breakpoint>match){match=Number(breakpoint);}});settings=$.extend({},this.options,overwrites[match]);delete settings.responsive;if(settings.responsiveClass){this.$element.attr('class',function(i,c){return c.replace(/\b owl-responsive-\S+/g,'');}).addClass('owl-responsive-'+match);}}
if(this.settings===null||this._breakpoint!==match){this.trigger('change',{property:{name:'settings',value:settings}});this._breakpoint=match;this.settings=settings;this.invalidate('settings');this.trigger('changed',{property:{name:'settings',value:this.settings}});}};Owl.prototype.optionsLogic=function(){this.$element.toggleClass('owl-center',this.settings.center);if(this.settings.loop&&this._items.length<this.settings.items){this.settings.loop=false;}
if(this.settings.autoWidth){this.settings.stagePadding=false;this.settings.merge=false;}};Owl.prototype.prepare=function(item){var event=this.trigger('prepare',{content:item});if(!event.data){event.data=$('<'+this.settings.itemElement+'/>').addClass(this.settings.itemClass).append(item)}
this.trigger('prepared',{content:event.data});return event.data;};Owl.prototype.update=function(){var i=0,n=this._pipe.length,filter=$.proxy(function(p){return this[p]},this._invalidated),cache={};while(i<n){if(this._invalidated.all||$.grep(this._pipe[i].filter,filter).length>0){this._pipe[i].run(cache);}
i++;}
this._invalidated={};};Owl.prototype.width=function(dimension){dimension=dimension||Owl.Width.Default;switch(dimension){case Owl.Width.Inner:case Owl.Width.Outer:return this._width;default:return this._width-this.settings.stagePadding*2+this.settings.margin;}};Owl.prototype.refresh=function(){if(this._items.length===0){return false;}
var start=new Date().getTime();this.trigger('refresh');this.setup();this.optionsLogic();this.$stage.addClass('owl-refresh');this.update();this.$stage.removeClass('owl-refresh');this.state.orientation=window.orientation;this.watchVisibility();this.trigger('refreshed');};Owl.prototype.eventsCall=function(){this.e._onDragStart=$.proxy(function(e){this.onDragStart(e);},this);this.e._onDragMove=$.proxy(function(e){this.onDragMove(e);},this);this.e._onDragEnd=$.proxy(function(e){this.onDragEnd(e);},this);this.e._onResize=$.proxy(function(e){this.onResize(e);},this);this.e._transitionEnd=$.proxy(function(e){this.transitionEnd(e);},this);this.e._preventClick=$.proxy(function(e){this.preventClick(e);},this);};Owl.prototype.onThrottledResize=function(){window.clearTimeout(this.resizeTimer);this.resizeTimer=window.setTimeout(this.e._onResize,this.settings.responsiveRefreshRate);};Owl.prototype.onResize=function(){if(!this._items.length){return false;}
if(this._width===this.$element.width()){return false;}
if(this.trigger('resize').isDefaultPrevented()){return false;}
this._width=this.$element.width();this.invalidate('width');this.refresh();this.trigger('resized');};Owl.prototype.eventsRouter=function(event){var type=event.type;if(type==="mousedown"||type==="touchstart"){this.onDragStart(event);}else if(type==="mousemove"||type==="touchmove"){this.onDragMove(event);}else if(type==="mouseup"||type==="touchend"){this.onDragEnd(event);}else if(type==="touchcancel"){this.onDragEnd(event);}};Owl.prototype.internalEvents=function(){var isTouch=isTouchSupport(),isTouchIE=isTouchSupportIE();if(this.settings.mouseDrag){this.$stage.on('mousedown',$.proxy(function(event){this.eventsRouter(event)},this));this.$stage.on('dragstart',function(){return false});this.$stage.get(0).onselectstart=function(){return false};}else{this.$element.addClass('owl-text-select-on');}
if(this.settings.touchDrag&&!isTouchIE){this.$stage.on('touchstart touchcancel',$.proxy(function(event){this.eventsRouter(event)},this));}
if(this.transitionEndVendor){this.on(this.$stage.get(0),this.transitionEndVendor,this.e._transitionEnd,false);}
if(this.settings.responsive!==false){this.on(window,'resize',$.proxy(this.onThrottledResize,this));}};Owl.prototype.onDragStart=function(event){var ev,isTouchEvent,pageX,pageY,animatedPos;ev=event.originalEvent||event||window.event;if(ev.which===3||this.state.isTouch){return false;}
if(ev.type==='mousedown'){this.$stage.addClass('owl-grab');}
this.trigger('drag');this.drag.startTime=new Date().getTime();this.speed(0);this.state.isTouch=true;this.state.isScrolling=false;this.state.isSwiping=false;this.drag.distance=0;pageX=getTouches(ev).x;pageY=getTouches(ev).y;this.drag.offsetX=this.$stage.position().left;this.drag.offsetY=this.$stage.position().top;if(this.settings.rtl){this.drag.offsetX=this.$stage.position().left+this.$stage.width()-this.width()
+this.settings.margin;}
if(this.state.inMotion&&this.support3d){animatedPos=this.getTransformProperty();this.drag.offsetX=animatedPos;this.animate(animatedPos);this.state.inMotion=true;}else if(this.state.inMotion&&!this.support3d){this.state.inMotion=false;return false;}
this.drag.startX=pageX-this.drag.offsetX;this.drag.startY=pageY-this.drag.offsetY;this.drag.start=pageX-this.drag.startX;this.drag.targetEl=ev.target||ev.srcElement;this.drag.updatedX=this.drag.start;if(this.drag.targetEl.tagName==="IMG"||this.drag.targetEl.tagName==="A"){this.drag.targetEl.draggable=false;}
$(document).on('mousemove.owl.dragEvents mouseup.owl.dragEvents touchmove.owl.dragEvents touchend.owl.dragEvents',$.proxy(function(event){this.eventsRouter(event)},this));};Owl.prototype.onDragMove=function(event){var ev,isTouchEvent,pageX,pageY,minValue,maxValue,pull;if(!this.state.isTouch){return;}
if(this.state.isScrolling){return;}
ev=event.originalEvent||event||window.event;pageX=getTouches(ev).x;pageY=getTouches(ev).y;this.drag.currentX=pageX-this.drag.startX;this.drag.currentY=pageY-this.drag.startY;this.drag.distance=this.drag.currentX-this.drag.offsetX;if(this.drag.distance<0){this.state.direction=this.settings.rtl?'right':'left';}else if(this.drag.distance>0){this.state.direction=this.settings.rtl?'left':'right';}
if(this.settings.loop){if(this.op(this.drag.currentX,'>',this.coordinates(this.minimum()))&&this.state.direction==='right'){this.drag.currentX-=(this.settings.center&&this.coordinates(0))-this.coordinates(this._items.length);}else if(this.op(this.drag.currentX,'<',this.coordinates(this.maximum()))&&this.state.direction==='left'){this.drag.currentX+=(this.settings.center&&this.coordinates(0))-this.coordinates(this._items.length);}}else{minValue=this.settings.rtl?this.coordinates(this.maximum()):this.coordinates(this.minimum());maxValue=this.settings.rtl?this.coordinates(this.minimum()):this.coordinates(this.maximum());pull=this.settings.pullDrag?this.drag.distance/5:0;this.drag.currentX=Math.max(Math.min(this.drag.currentX,minValue+pull),maxValue+pull);}
if((this.drag.distance>8||this.drag.distance<-8)){if(ev.preventDefault!==undefined){ev.preventDefault();}else{ev.returnValue=false;}
this.state.isSwiping=true;}
this.drag.updatedX=this.drag.currentX;if((this.drag.currentY>16||this.drag.currentY<-16)&&this.state.isSwiping===false){this.state.isScrolling=true;this.drag.updatedX=this.drag.start;}
this.animate(this.drag.updatedX);};Owl.prototype.onDragEnd=function(event){var compareTimes,distanceAbs,closest;if(!this.state.isTouch){return;}
if(event.type==='mouseup'){this.$stage.removeClass('owl-grab');}
this.trigger('dragged');this.drag.targetEl.removeAttribute("draggable");this.state.isTouch=false;this.state.isScrolling=false;this.state.isSwiping=false;if(this.drag.distance===0&&this.state.inMotion!==true){this.state.inMotion=false;return false;}
this.drag.endTime=new Date().getTime();compareTimes=this.drag.endTime-this.drag.startTime;distanceAbs=Math.abs(this.drag.distance);if(distanceAbs>3||compareTimes>300){this.removeClick(this.drag.targetEl);}
closest=this.closest(this.drag.updatedX);this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed);this.current(closest);this.invalidate('position');this.update();if(!this.settings.pullDrag&&this.drag.updatedX===this.coordinates(closest)){this.transitionEnd();}
this.drag.distance=0;$(document).off('.owl.dragEvents');};Owl.prototype.removeClick=function(target){this.drag.targetEl=target;$(target).on('click.preventClick',this.e._preventClick);window.setTimeout(function(){$(target).off('click.preventClick');},300);};Owl.prototype.preventClick=function(ev){if(ev.preventDefault){ev.preventDefault();}else{ev.returnValue=false;}
if(ev.stopPropagation){ev.stopPropagation();}
$(ev.target).off('click.preventClick');};Owl.prototype.getTransformProperty=function(){var transform,matrix3d;transform=window.getComputedStyle(this.$stage.get(0),null).getPropertyValue(this.vendorName+'transform');transform=transform.replace(/matrix(3d)?\(|\)/g,'').split(',');matrix3d=transform.length===16;return matrix3d!==true?transform[4]:transform[12];};Owl.prototype.closest=function(coordinate){var position=-1,pull=30,width=this.width(),coordinates=this.coordinates();if(!this.settings.freeDrag){$.each(coordinates,$.proxy(function(index,value){if(coordinate>value-pull&&coordinate<value+pull){position=index;}else if(this.op(coordinate,'<',value)&&this.op(coordinate,'>',coordinates[index+1]||value-width)){position=this.state.direction==='left'?index+1:index;}
return position===-1;},this));}
if(!this.settings.loop){if(this.op(coordinate,'>',coordinates[this.minimum()])){position=coordinate=this.minimum();}else if(this.op(coordinate,'<',coordinates[this.maximum()])){position=coordinate=this.maximum();}}
return position;};Owl.prototype.animate=function(coordinate){this.trigger('translate');this.state.inMotion=this.speed()>0;coordinate=coordinate*1-16;if(this.support3d){this.$stage.css({transform:'translate3d('+coordinate+'px'+',0px, 0px)',transition:(this.speed()/1000)+'s'});}else if(this.state.isTouch){this.$stage.css({left:coordinate+'px'});}else{this.$stage.animate({left:coordinate},this.speed()/1000,this.settings.fallbackEasing,$.proxy(function(){if(this.state.inMotion){this.transitionEnd();}},this));}};Owl.prototype.current=function(position){if(position===undefined){return this._current;}
if(this._items.length===0){return undefined;}
position=this.normalize(position);if(this._current!==position){var event=this.trigger('change',{property:{name:'position',value:position}});if(event.data!==undefined){position=this.normalize(event.data);}
this._current=position;this.invalidate('position');this.trigger('changed',{property:{name:'position',value:this._current}});}
return this._current;};Owl.prototype.invalidate=function(part){this._invalidated[part]=true;}
Owl.prototype.reset=function(position){position=this.normalize(position);if(position===undefined){return;}
this._speed=0;this._current=position;this.suppress(['translate','translated']);this.animate(this.coordinates(position));this.release(['translate','translated']);};Owl.prototype.normalize=function(position,relative){var n=(relative?this._items.length:this._items.length+this._clones.length);if(!$.isNumeric(position)||n<1){return undefined;}
if(this._clones.length){position=((position%n)+n)%n;}else{position=Math.max(this.minimum(relative),Math.min(this.maximum(relative),position));}
return position;};Owl.prototype.relative=function(position){position=this.normalize(position);position=position-this._clones.length/2;return this.normalize(position,true);};Owl.prototype.maximum=function(relative){var maximum,width,i=0,coordinate,settings=this.settings;if(relative){return this._items.length-1;}
if(!settings.loop&&settings.center){maximum=this._items.length-1;}else if(!settings.loop&&!settings.center){maximum=this._items.length-settings.items;}else if(settings.loop||settings.center){maximum=this._items.length+settings.items;}else if(settings.autoWidth||settings.merge){revert=settings.rtl?1:-1;width=this.$stage.width()-this.$element.width();while(coordinate=this.coordinates(i)){if(coordinate*revert>=width){break;}
maximum=++i;}}else{throw'Can not detect maximum absolute position.'}
return maximum;};Owl.prototype.minimum=function(relative){if(relative){return 0;}
return this._clones.length/2;};Owl.prototype.items=function(position){if(position===undefined){return this._items.slice();}
position=this.normalize(position,true);return this._items[position];};Owl.prototype.mergers=function(position){if(position===undefined){return this._mergers.slice();}
position=this.normalize(position,true);return this._mergers[position];};Owl.prototype.clones=function(position){var odd=this._clones.length/2,even=odd+this._items.length,map=function(index){return index%2===0?even+index/2:odd-(index+1)/2};if(position===undefined){return $.map(this._clones,function(v,i){return map(i)});}
return $.map(this._clones,function(v,i){return v===position?map(i):null});};Owl.prototype.speed=function(speed){if(speed!==undefined){this._speed=speed;}
return this._speed;};Owl.prototype.coordinates=function(position){var coordinate=null;if(position===undefined){return $.map(this._coordinates,$.proxy(function(coordinate,index){return this.coordinates(index);},this));}
if(this.settings.center){coordinate=this._coordinates[position];coordinate+=(this.width()-coordinate+(this._coordinates[position-1]||0))/2*(this.settings.rtl?-1:1);}else{coordinate=this._coordinates[position-1]||0;}
return coordinate;};Owl.prototype.duration=function(from,to,factor){return Math.min(Math.max(Math.abs(to-from),1),6)*Math.abs((factor||this.settings.smartSpeed));};Owl.prototype.to=function(position,speed){if(this.processduration==0){this.processduration=1;if(this.settings.loop){var distance=position-this.relative(this.current()),revert=this.current(),before=this.current(),after=this.current()+distance,direction=before-after<0?true:false,items=this._clones.length+this._items.length;if(after<this.settings.items&&direction===false){revert=before+this._items.length;this.reset(revert);}else if(after>=items-this.settings.items&&direction===true){revert=before-this._items.length;this.reset(revert);}
window.clearTimeout(this.e._goToLoop);this.e._goToLoop=window.setTimeout($.proxy(function(){this.speed(this.duration(this.current(),revert+distance,speed));this.current(revert+distance);this.update();},this),30);}else{this.speed(this.duration(this.current(),position,speed));this.current(position);this.update();}}};Owl.prototype.next=function(speed){speed=speed||false;this.to(this.relative(this.current())+1,speed);};Owl.prototype.prev=function(speed){speed=speed||false;this.to(this.relative(this.current())-1,speed);};Owl.prototype.transitionEnd=function(event){this.processduration=0;if(event!==undefined){event.stopPropagation();if((event.target||event.srcElement||event.originalTarget)!==this.$stage.get(0)){return false;}}
this.state.inMotion=false;this.trigger('translated');};Owl.prototype.viewport=function(){var width;if(this.options.responsiveBaseElement!==window){width=$(this.options.responsiveBaseElement).width();}else if(window.innerWidth){width=window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){width=document.documentElement.clientWidth;}else{throw'Can not detect viewport width.';}
return width;};Owl.prototype.replace=function(content){this.$stage.empty();this._items=[];if(content){content=(content instanceof jQuery)?content:$(content);}
if(this.settings.nestedItemSelector){content=content.find('.'+this.settings.nestedItemSelector);}
content.filter(function(){return this.nodeType===1;}).each($.proxy(function(index,item){item=this.prepare(item);this.$stage.append(item);this._items.push(item);this._mergers.push(item.find('[data-merge]').andSelf('[data-merge]').attr('data-merge')*1||1);},this));this.reset($.isNumeric(this.settings.startPosition)?this.settings.startPosition:0);this.invalidate('items');};Owl.prototype.add=function(content,position){position=position===undefined?this._items.length:this.normalize(position,true);this.trigger('add',{content:content,position:position});if(this._items.length===0||position===this._items.length){this.$stage.append(content);this._items.push(content);this._mergers.push(content.find('[data-merge]').andSelf('[data-merge]').attr('data-merge')*1||1);}else{this._items[position].before(content);this._items.splice(position,0,content);this._mergers.splice(position,0,content.find('[data-merge]').andSelf('[data-merge]').attr('data-merge')*1||1);}
this.invalidate('items');this.trigger('added',{content:content,position:position});};Owl.prototype.remove=function(position){position=this.normalize(position,true);if(position===undefined){return;}
this.trigger('remove',{content:this._items[position],position:position});this._items[position].remove();this._items.splice(position,1);this._mergers.splice(position,1);this.invalidate('items');this.trigger('removed',{content:null,position:position});};Owl.prototype.addTriggerableEvents=function(){var handler=$.proxy(function(callback,event){return $.proxy(function(e){if(e.relatedTarget!==this){this.suppress([event]);callback.apply(this,[].slice.call(arguments,1));this.release([event]);}},this);},this);$.each({'next':this.next,'prev':this.prev,'to':this.to,'destroy':this.destroy,'refresh':this.refresh,'replace':this.replace,'add':this.add,'remove':this.remove},$.proxy(function(event,callback){this.$element.on(event+'.owl.carousel',handler(callback,event+'.owl.carousel'));},this));};Owl.prototype.watchVisibility=function(){if(!isElVisible(this.$element.get(0))){this.$element.addClass('owl-hidden');window.clearInterval(this.e._checkVisibile);this.e._checkVisibile=window.setInterval($.proxy(checkVisible,this),500);}
function isElVisible(el){return el.offsetWidth>0&&el.offsetHeight>0;}
function checkVisible(){if(isElVisible(this.$element.get(0))){this.$element.removeClass('owl-hidden');this.refresh();window.clearInterval(this.e._checkVisibile);}}};Owl.prototype.preloadAutoWidthImages=function(imgs){var loaded,that,$el,img;loaded=0;that=this;imgs.each(function(i,el){$el=$(el);img=new Image();img.onload=function(){loaded++;$el.attr('src',img.src);$el.css('opacity',1);if(loaded>=imgs.length){that.state.imagesLoaded=true;that.initialize();}};img.src=$el.attr('src')||$el.attr('data-src')||$el.attr('data-src-retina');});};Owl.prototype.destroy=function(){if(this.$element.hasClass(this.settings.themeClass)){this.$element.removeClass(this.settings.themeClass);}
if(this.settings.responsive!==false){$(window).off('resize.owl.carousel');}
if(this.transitionEndVendor){this.off(this.$stage.get(0),this.transitionEndVendor,this.e._transitionEnd);}
for(var i in this._plugins){this._plugins[i].destroy();}
if(this.settings.mouseDrag||this.settings.touchDrag){this.$stage.off('mousedown touchstart touchcancel');$(document).off('.owl.dragEvents');this.$stage.get(0).onselectstart=function(){};this.$stage.off('dragstart',function(){return false});}
this.$element.off('.owl');this.$stage.children('.cloned').remove();this.e=null;this.$element.removeData('owlCarousel');this.$stage.children().contents().unwrap();this.$stage.children().unwrap();this.$stage.unwrap();};Owl.prototype.op=function(a,o,b){var rtl=this.settings.rtl;switch(o){case'<':return rtl?a>b:a<b;case'>':return rtl?a<b:a>b;case'>=':return rtl?a<=b:a>=b;case'<=':return rtl?a>=b:a<=b;default:break;}};Owl.prototype.on=function(element,event,listener,capture){if(element.addEventListener){element.addEventListener(event,listener,capture);}else if(element.attachEvent){element.attachEvent('on'+event,listener);}};Owl.prototype.off=function(element,event,listener,capture){if(element.removeEventListener){element.removeEventListener(event,listener,capture);}else if(element.detachEvent){element.detachEvent('on'+event,listener);}};Owl.prototype.trigger=function(name,data,namespace){var status={item:{count:this._items.length,index:this.current()}},handler=$.camelCase($.grep(['on',name,namespace],function(v){return v}).join('-').toLowerCase()),event=$.Event([name,'owl',namespace||'carousel'].join('.').toLowerCase(),$.extend({relatedTarget:this},status,data));if(!this._supress[name]){$.each(this._plugins,function(name,plugin){if(plugin.onTrigger){plugin.onTrigger(event);}});this.$element.trigger(event);if(this.settings&&typeof this.settings[handler]==='function'){this.settings[handler].apply(this,event);}}
return event;};Owl.prototype.suppress=function(events){$.each(events,$.proxy(function(index,event){this._supress[event]=true;},this));}
Owl.prototype.release=function(events){$.each(events,$.proxy(function(index,event){delete this._supress[event];},this));}
Owl.prototype.browserSupport=function(){this.support3d=isPerspective();if(this.support3d){this.transformVendor=isTransform();var endVendors=['transitionend','webkitTransitionEnd','transitionend','oTransitionEnd'];this.transitionEndVendor=endVendors[isTransition()];this.vendorName=this.transformVendor.replace(/Transform/i,'');this.vendorName=this.vendorName!==''?'-'+this.vendorName.toLowerCase()+'-':'';}
this.state.orientation=window.orientation;};function getTouches(event){if(event.touches!==undefined){return{x:event.touches[0].pageX,y:event.touches[0].pageY};}
if(event.touches===undefined){if(event.pageX!==undefined){return{x:event.pageX,y:event.pageY};}
if(event.pageX===undefined){return{x:event.clientX,y:event.clientY};}}}
function isStyleSupported(array){var p,s,fake=document.createElement('div'),list=array;for(p in list){s=list[p];if(typeof fake.style[s]!=='undefined'){fake=null;return[s,p];}}
return[false];}
function isTransition(){return isStyleSupported(['transition','WebkitTransition','MozTransition','OTransition'])[1];}
function isTransform(){return isStyleSupported(['transform','WebkitTransform','MozTransform','OTransform','msTransform'])[0];}
function isPerspective(){return isStyleSupported(['perspective','webkitPerspective','MozPerspective','OPerspective','MsPerspective'])[0];}
function isTouchSupport(){return'ontouchstart'in window||!!(navigator.msMaxTouchPoints);}
function isTouchSupportIE(){return window.navigator.msPointerEnabled;}
$.fn.owlCarousel=function(options){return this.each(function(){if(!$(this).data('owlCarousel')){$(this).data('owlCarousel',new Owl(this,options));}});};$.fn.owlCarousel.Constructor=Owl;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){var Lazy=function(carousel){this._core=carousel;this._loaded=[];this._handlers={'initialized.owl.carousel change.owl.carousel':$.proxy(function(e){if(!e.namespace){return;}
if(!this._core.settings||!this._core.settings.lazyLoad){return;}
if((e.property&&e.property.name=='position')||e.type=='initialized'){var settings=this._core.settings,n=(settings.center&&Math.ceil(settings.items/2)||settings.items),i=((settings.center&&n*-1)||0),position=((e.property&&e.property.value)||this._core.current())+i,clones=this._core.clones().length,load=$.proxy(function(i,v){this.load(v)},this);while(i++<n){this.load(clones/2+this._core.relative(position));clones&&$.each(this._core.clones(this._core.relative(position++)),load);}}},this)};this._core.options=$.extend({},Lazy.Defaults,this._core.options);this._core.$element.on(this._handlers);}
Lazy.Defaults={lazyLoad:false}
Lazy.prototype.load=function(position){var $item=this._core.$stage.children().eq(position),$elements=$item&&$item.find('.owl-lazy');if(!$elements||$.inArray($item.get(0),this._loaded)>-1){return;}
$elements.each($.proxy(function(index,element){var $element=$(element),image,url=(window.devicePixelRatio>1&&$element.attr('data-src-retina'))||$element.attr('data-src');this._core.trigger('load',{element:$element,url:url},'lazy');if($element.is('img')){$element.one('load.owl.lazy',$.proxy(function(){$element.css('opacity',1);this._core.trigger('loaded',{element:$element,url:url},'lazy');},this)).attr('src',url);}else{image=new Image();image.onload=$.proxy(function(){$element.css({'background-image':'url('+url+')','opacity':'1'});this._core.trigger('loaded',{element:$element,url:url},'lazy');},this);image.src=url;}},this));this._loaded.push($item.get(0));}
Lazy.prototype.destroy=function(){var handler,property;for(handler in this.handlers){this._core.$element.off(handler,this.handlers[handler]);}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}}
$.fn.owlCarousel.Constructor.Plugins.Lazy=Lazy;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){var AutoHeight=function(carousel){this._core=carousel;this._handlers={'initialized.owl.carousel':$.proxy(function(){if(this._core.settings.autoHeight){this.update();}},this),'changed.owl.carousel':$.proxy(function(e){if(this._core.settings.autoHeight&&e.property.name=='position'){this.update();}},this),'loaded.owl.lazy':$.proxy(function(e){if(this._core.settings.autoHeight&&e.element.closest('.'+this._core.settings.itemClass)===this._core.$stage.children().eq(this._core.current())){this.update();}},this)};this._core.options=$.extend({},AutoHeight.Defaults,this._core.options);this._core.$element.on(this._handlers);};AutoHeight.Defaults={autoHeight:false,autoHeightClass:'owl-height'};AutoHeight.prototype.update=function(){this._core.$stage.parent().height(this._core.$stage.children().eq(this._core.current()).height()).addClass(this._core.settings.autoHeightClass);};AutoHeight.prototype.destroy=function(){var handler,property;for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler]);}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}};$.fn.owlCarousel.Constructor.Plugins.AutoHeight=AutoHeight;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){var Video=function(carousel){this._core=carousel;this._videos={};this._playing=null;this._fullscreen=false;this._handlers={'resize.owl.carousel':$.proxy(function(e){if(this._core.settings.video&&!this.isInFullScreen()){e.preventDefault();}},this),'refresh.owl.carousel changed.owl.carousel':$.proxy(function(e){if(this._playing){this.stop();}},this),'prepared.owl.carousel':$.proxy(function(e){var $element=$(e.content).find('.owl-video');if($element.length){$element.css('display','none');this.fetch($element,$(e.content));}},this)};this._core.options=$.extend({},Video.Defaults,this._core.options);this._core.$element.on(this._handlers);this._core.$element.on('click.owl.video','.owl-video-play-icon',$.proxy(function(e){this.play(e);},this));};Video.Defaults={video:false,videoHeight:false,videoWidth:false};Video.prototype.fetch=function(target,item){var type=target.attr('data-vimeo-id')?'vimeo':'youtube',id=target.attr('data-vimeo-id')||target.attr('data-youtube-id'),width=target.attr('data-width')||this._core.settings.videoWidth,height=target.attr('data-height')||this._core.settings.videoHeight,url=target.attr('href');if(url){id=url.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/);if(id[3].indexOf('youtu')>-1){type='youtube';}else if(id[3].indexOf('vimeo')>-1){type='vimeo';}else{throw new Error('Video URL not supported.');}
id=id[6];}else{throw new Error('Missing video URL.');}
this._videos[url]={type:type,id:id,width:width,height:height};item.attr('data-video',url);this.thumbnail(target,this._videos[url]);};Video.prototype.thumbnail=function(target,video){var tnLink,icon,path,dimensions=video.width&&video.height?'style="width:'+video.width+'px;height:'+video.height+'px;"':'',customTn=target.find('img'),srcType='src',lazyClass='',settings=this._core.settings,create=function(path){icon='<div class="owl-video-play-icon"></div>';if(settings.lazyLoad){tnLink='<div class="owl-video-tn '+lazyClass+'" '+srcType+'="'+path+'"></div>';}else{tnLink='<div class="owl-video-tn" style="opacity:1;background-image:url('+path+')"></div>';}
target.after(tnLink);target.after(icon);};target.wrap('<div class="owl-video-wrapper"'+dimensions+'></div>');if(this._core.settings.lazyLoad){srcType='data-src';lazyClass='owl-lazy';}
if(customTn.length){create(customTn.attr(srcType));customTn.remove();return false;}
if(video.type==='youtube'){path="http://img.youtube.com/vi/"+video.id+"/hqdefault.jpg";create(path);}else if(video.type==='vimeo'){$.ajax({type:'GET',url:'http://vimeo.com/api/v2/video/'+video.id+'.json',jsonp:'callback',dataType:'jsonp',success:function(data){path=data[0].thumbnail_large;create(path);}});}};Video.prototype.stop=function(){this._core.trigger('stop',null,'video');this._playing.find('.owl-video-frame').remove();this._playing.removeClass('owl-video-playing');this._playing=null;};Video.prototype.play=function(ev){this._core.trigger('play',null,'video');if(this._playing){this.stop();}
var target=$(ev.target||ev.srcElement),item=target.closest('.'+this._core.settings.itemClass),video=this._videos[item.attr('data-video')],width=video.width||'100%',height=video.height||this._core.$stage.height(),html,wrap;if(video.type==='youtube'){html='<iframe width="'+width+'" height="'+height+'" src="http://www.youtube.com/embed/'
+video.id+'?autoplay=1&v='+video.id+'" frameborder="0" allowfullscreen></iframe>';}else if(video.type==='vimeo'){html='<iframe src="http://player.vimeo.com/video/'+video.id+'?autoplay=1" width="'+width
+'" height="'+height
+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';}
item.addClass('owl-video-playing');this._playing=item;wrap=$('<div style="height:'+height+'px; width:'+width+'px" class="owl-video-frame">'
+html+'</div>');target.after(wrap);};Video.prototype.isInFullScreen=function(){var element=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;if(element&&$(element).parent().hasClass('owl-video-frame')){this._core.speed(0);this._fullscreen=true;}
if(element&&this._fullscreen&&this._playing){return false;}
if(this._fullscreen){this._fullscreen=false;return false;}
if(this._playing){if(this._core.state.orientation!==window.orientation){this._core.state.orientation=window.orientation;return false;}}
return true;};Video.prototype.destroy=function(){var handler,property;this._core.$element.off('click.owl.video');for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler]);}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}};$.fn.owlCarousel.Constructor.Plugins.Video=Video;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){var Animate=function(scope){this.core=scope;this.core.options=$.extend({},Animate.Defaults,this.core.options);this.swapping=true;this.previous=undefined;this.next=undefined;this.handlers={'change.owl.carousel':$.proxy(function(e){if(e.property.name=='position'){this.previous=this.core.current();this.next=e.property.value;}},this),'drag.owl.carousel dragged.owl.carousel translated.owl.carousel':$.proxy(function(e){this.swapping=e.type=='translated';},this),'translate.owl.carousel':$.proxy(function(e){if(this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)){this.swap();}},this)};this.core.$element.on(this.handlers);};Animate.Defaults={animateOut:false,animateIn:false};Animate.prototype.swap=function(){if(this.core.settings.items!==1||!this.core.support3d){return;}
this.core.speed(0);var left,clear=$.proxy(this.clear,this),previous=this.core.$stage.children().eq(this.previous),next=this.core.$stage.children().eq(this.next),incoming=this.core.settings.animateIn,outgoing=this.core.settings.animateOut;if(this.core.current()===this.previous){return;}
if(outgoing){left=this.core.coordinates(this.previous)-this.core.coordinates(this.next);previous.css({'left':left+'px'}).addClass('animated owl-animated-out').addClass(outgoing).one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend',clear);}
if(incoming){next.addClass('animated owl-animated-in').addClass(incoming).one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend',clear);}};Animate.prototype.clear=function(e){$(e.target).css({'left':''}).removeClass('animated owl-animated-out owl-animated-in').removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut);this.core.transitionEnd();}
Animate.prototype.destroy=function(){var handler,property;for(handler in this.handlers){this.core.$element.off(handler,this.handlers[handler]);}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}};$.fn.owlCarousel.Constructor.Plugins.Animate=Animate;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){var Autoplay=function(scope){this.core=scope;this.core.options=$.extend({},Autoplay.Defaults,this.core.options);this.handlers={'translated.owl.carousel refreshed.owl.carousel':$.proxy(function(){this.autoplay();},this),'play.owl.autoplay':$.proxy(function(e,t,s){this.play(t,s);},this),'stop.owl.autoplay':$.proxy(function(){this.stop();},this),'mouseover.owl.autoplay':$.proxy(function(){if(this.core.settings.autoplayHoverPause){this.pause();}},this),'mouseleave.owl.autoplay':$.proxy(function(){if(this.core.settings.autoplayHoverPause){this.autoplay();}},this)};this.core.$element.on(this.handlers);};Autoplay.Defaults={autoplay:false,autoplayTimeout:5000,autoplayHoverPause:false,autoplaySpeed:false};Autoplay.prototype.autoplay=function(){if(this.core.settings.autoplay&&!this.core.state.videoPlay){window.clearInterval(this.interval);this.interval=window.setInterval($.proxy(function(){this.play();},this),this.core.settings.autoplayTimeout);}else{window.clearInterval(this.interval);}};Autoplay.prototype.play=function(timeout,speed){if(document.hidden===true){return;}
if(this.core.state.isTouch||this.core.state.isScrolling||this.core.state.isSwiping||this.core.state.inMotion){return;}
if(this.core.settings.autoplay===false){window.clearInterval(this.interval);return;}
this.core.next(this.core.settings.autoplaySpeed);};Autoplay.prototype.stop=function(){window.clearInterval(this.interval);};Autoplay.prototype.pause=function(){window.clearInterval(this.interval);};Autoplay.prototype.destroy=function(){var handler,property;window.clearInterval(this.interval);for(handler in this.handlers){this.core.$element.off(handler,this.handlers[handler]);}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}};$.fn.owlCarousel.Constructor.Plugins.autoplay=Autoplay;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){'use strict';var Navigation=function(carousel){this._core=carousel;this._initialized=false;this._pages=[];this._controls={};this._templates=[];this.$element=this._core.$element;this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to};this._handlers={'prepared.owl.carousel':$.proxy(function(e){if(this._core.settings.dotsData){this._templates.push($(e.content).find('[data-dot]').andSelf('[data-dot]').attr('data-dot'));}},this),'add.owl.carousel':$.proxy(function(e){if(this._core.settings.dotsData){this._templates.splice(e.position,0,$(e.content).find('[data-dot]').andSelf('[data-dot]').attr('data-dot'));}},this),'remove.owl.carousel prepared.owl.carousel':$.proxy(function(e){if(this._core.settings.dotsData){this._templates.splice(e.position,1);}},this),'change.owl.carousel':$.proxy(function(e){if(e.property.name=='position'){if(!this._core.state.revert&&!this._core.settings.loop&&this._core.settings.navRewind){var current=this._core.current(),maximum=this._core.maximum(),minimum=this._core.minimum();e.data=e.property.value>maximum?current>=maximum?minimum:maximum:e.property.value<minimum?maximum:e.property.value;}}},this),'changed.owl.carousel':$.proxy(function(e){if(e.property.name=='position'){this.draw();}},this),'refreshed.owl.carousel':$.proxy(function(){if(!this._initialized){this.initialize();this._initialized=true;}
this._core.trigger('refresh',null,'navigation');this.update();this.draw();this._core.trigger('refreshed',null,'navigation');},this)};this._core.options=$.extend({},Navigation.Defaults,this._core.options);this.$element.on(this._handlers);}
Navigation.Defaults={nav:false,navRewind:true,navText:['prev','next'],navSpeed:false,navElement:'div',navContainer:false,navContainerClass:'owl-nav',navClass:['owl-prev','owl-next'],slideBy:1,dotClass:'owl-dot',dotsClass:'owl-dots',dots:true,dotsEach:false,dotData:false,dotsSpeed:false,dotsContainer:false,controlsClass:'owl-controls'}
Navigation.prototype.initialize=function(){var $container,override,options=this._core.settings;if(!options.dotsData){this._templates=[$('<div>').addClass(options.dotClass).append($('<span>')).prop('outerHTML')];}
if(!options.navContainer||!options.dotsContainer){this._controls.$container=$('<div>').addClass(options.controlsClass).appendTo(this.$element);}
this._controls.$indicators=options.dotsContainer?$(options.dotsContainer):$('<div>').hide().addClass(options.dotsClass).appendTo(this._controls.$container);this._controls.$indicators.on('click','div',$.proxy(function(e){var index=$(e.target).parent().is(this._controls.$indicators)?$(e.target).index():$(e.target).parent().index();e.preventDefault();this.to(index,options.dotsSpeed);},this));$container=options.navContainer?$(options.navContainer):$('<div>').addClass(options.navContainerClass).prependTo(this._controls.$container);this._controls.$next=$('<'+options.navElement+'>');this._controls.$previous=this._controls.$next.clone();this._controls.$previous.addClass(options.navClass[0]).html(options.navText[0]).hide().prependTo($container).on('click',$.proxy(function(e){this.prev(options.navSpeed);},this));this._controls.$next.addClass(options.navClass[1]).html(options.navText[1]).hide().appendTo($container).on('click',$.proxy(function(e){this.next(options.navSpeed);},this));for(override in this._overrides){this._core[override]=$.proxy(this[override],this);}}
Navigation.prototype.destroy=function(){var handler,control,property,override;for(handler in this._handlers){this.$element.off(handler,this._handlers[handler]);}
for(control in this._controls){this._controls[control].remove();}
for(override in this.overides){this._core[override]=this._overrides[override];}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}}
Navigation.prototype.update=function(){var i,j,k,options=this._core.settings,lower=this._core.clones().length/2,upper=lower+this._core.items().length,size=options.center||options.autoWidth||options.dotData?1:options.dotsEach||options.items;if(options.slideBy!=='page'){options.slideBy=Math.min(options.slideBy,options.items);}
if(options.dots||options.slideBy=='page'){this._pages=[];for(i=lower,j=0,k=0;i<upper;i++){if(j>=size||j===0){this._pages.push({start:i-lower,end:i-lower+size-1});j=0,++k;}
j+=this._core.mergers(this._core.relative(i));}}}
Navigation.prototype.draw=function(){var difference,i,html='',options=this._core.settings,$items=this._core.$stage.children(),index=this._core.relative(this._core.current());if(options.nav&&!options.loop&&!options.navRewind){this._controls.$previous.toggleClass('disabled',index<=0);this._controls.$next.toggleClass('disabled',index>=this._core.maximum());}
this._controls.$previous.toggle(options.nav);this._controls.$next.toggle(options.nav);if(options.dots){difference=this._pages.length-this._controls.$indicators.children().length;if(options.dotData&&difference!==0){for(i=0;i<this._controls.$indicators.children().length;i++){html+=this._templates[this._core.relative(i)];}
this._controls.$indicators.html(html);}else if(difference>0){html=new Array(difference+1).join(this._templates[0]);this._controls.$indicators.append(html);}else if(difference<0){this._controls.$indicators.children().slice(difference).remove();}
this._controls.$indicators.find('.active').removeClass('active');this._controls.$indicators.children().eq($.inArray(this.current(),this._pages)).addClass('active');}
this._controls.$indicators.toggle(options.dots);}
Navigation.prototype.onTrigger=function(event){var settings=this._core.settings;event.page={index:$.inArray(this.current(),this._pages),count:this._pages.length,size:settings&&(settings.center||settings.autoWidth||settings.dotData?1:settings.dotsEach||settings.items)};}
Navigation.prototype.current=function(){var index=this._core.relative(this._core.current());return $.grep(this._pages,function(o){return o.start<=index&&o.end>=index;}).pop();}
Navigation.prototype.getPosition=function(successor){var position,length,options=this._core.settings;if(options.slideBy=='page'){position=$.inArray(this.current(),this._pages);length=this._pages.length;successor?++position:--position;position=this._pages[((position%length)+length)%length].start;}else{position=this._core.relative(this._core.current());length=this._core.items().length;successor?position+=options.slideBy:position-=options.slideBy;}
return position;}
Navigation.prototype.next=function(speed){$.proxy(this._overrides.to,this._core)(this.getPosition(true),speed);}
Navigation.prototype.prev=function(speed){$.proxy(this._overrides.to,this._core)(this.getPosition(false),speed);}
Navigation.prototype.to=function(position,speed,standard){var length;if(!standard){length=this._pages.length;$.proxy(this._overrides.to,this._core)(this._pages[((position%length)+length)%length].start,speed);}else{$.proxy(this._overrides.to,this._core)(position,speed);}}
$.fn.owlCarousel.Constructor.Plugins.Navigation=Navigation;})(window.Zepto||window.jQuery,window,document);;(function($,window,document,undefined){'use strict';var Hash=function(carousel){this._core=carousel;this._hashes={};this.$element=this._core.$element;this._handlers={'initialized.owl.carousel':$.proxy(function(){if(this._core.settings.startPosition=='URLHash'){$(window).trigger('hashchange.owl.navigation');}},this),'prepared.owl.carousel':$.proxy(function(e){var hash=$(e.content).find('[data-hash]').andSelf('[data-hash]').attr('data-hash');this._hashes[hash]=e.content;},this)};this._core.options=$.extend({},Hash.Defaults,this._core.options);this.$element.on(this._handlers);$(window).on('hashchange.owl.navigation',$.proxy(function(){var hash=window.location.hash.substring(1),items=this._core.$stage.children(),position=this._hashes[hash]&&items.index(this._hashes[hash])||0;if(!hash){return false;}},this));}
Hash.Defaults={URLhashListener:false}
Hash.prototype.destroy=function(){var handler,property;$(window).off('hashchange.owl.navigation');for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler]);}
for(property in Object.getOwnPropertyNames(this)){typeof this[property]!='function'&&(this[property]=null);}}
$.fn.owlCarousel.Constructor.Plugins.Hash=Hash;})(window.Zepto||window.jQuery,window,document);;otherProducts=Class.create();otherProducts.labelsForTooltip=new Array();otherProducts.created=false;otherProducts.openTooltip=function(element){var valueOption=jQuery(element).closest('li').data('valueid');var attribute=jQuery(element).closest('ul').data('attribute');var label='';if(typeof(otherProducts.labelsForTooltip[attribute])!='undefined'){label=otherProducts.labelsForTooltip[attribute][valueOption];}
if(label!=''){var toolTip=jQuery(element).parents('ul').parents('div.additional').find('.arrow-tooltip');var message=toolTip.children('.vote-message').html(label);if(jQuery(element).find(".availableontt-label").get(0)){jQuery(toolTip).addClass("arrow-tooltip-ontt");}else{jQuery(toolTip).removeClass("arrow-tooltip-ontt");}
toolTip.show();var left=jQuery(element).offset()['left'];var top=jQuery(element).offset()['top'];var elementWidth=jQuery(element).outerWidth();var toolTipWidth=toolTip.outerWidth();left=left*1-toolTipWidth*1/2+elementWidth*1/2;top=top*1+37;toolTip.offset({left:left,top:top});}};otherProducts.closeTooltip=function(element){jQuery(element).parents('ul').parents('div.additional').find('.arrow-tooltip').hide()};otherProducts.createCarousel=function(element,startPosition){if(element&&element.offsetWidth>0){jQuery(element).owlCarousel({margin:1,loop:true,autoWidth:true,nav:true,navText:['',''],slideBy:8,center:true,items:10,startPosition:startPosition});}};otherProducts.displayProductsData=function(options){var otherColorsElement=$('other-colors');if(otherColorsElement){var child=otherColorsElement.firstElementChild;if(child&&otherProducts.created==false){var currentProductId=options.current_product_id;var simpleProducts=options.simpleProducts;var currentProductConfig=options.simpleProducts[currentProductId];var attributes=options.attributes;var currentProductAttributes=currentProductConfig.attributes;var otherColorsHeaders=$('other-colors').select('h3');otherColorsHeaders.each(function(header){var attributeId=header.dataset.attribute;var attributeOptions=attributes[attributeId];var attrTextElem=header.select('.attr-text').first();var currentOptionValue=currentProductAttributes[attributeId];var label='';if(currentOptionValue){if(attributeOptions[currentOptionValue]){if(attributeOptions[currentOptionValue]['store_label']){label=attributeOptions[currentOptionValue]['store_label'];}else{label=attributeOptions[currentOptionValue]['default_label'];}}}
attrTextElem.update(label);});var attributeLists=$('other-colors').select('.ConfigProductParam');attributeLists.each(function(attributeList){var valueItems=attributeList.select('li');var attributeId=attributeList.dataset.attribute;var attributeOptions=attributes[attributeId];var colorParamsShow=attributeOptions['colorParamsShow'];var startPosition=0;var currentPosition=0;valueItems.each(function(attributeValue){var currentProduct=false;var valueId=attributeValue.dataset.valueid;var labelForToolTip='';var newClass='';if(currentProductAttributes[attributeId]==valueId){currentProduct=true;newClass='configurablecolorcurrent';if(!colorParamsShow){newClass+=' activeconfigcurrent';}
startPosition=currentPosition;}else{newClass='configurablecolor';}
attributeValue.addClassName(newClass);currentPosition++;var currentOptionProducts=attributeOptions[valueId]['option_products'];attributeLists.each(function(otherAttributeList){var otherAttributeId=otherAttributeList.dataset.attribute;if(otherAttributeId!=attributeId){var tempArray=Array();var currenProductOption=currentProductAttributes[otherAttributeId];var otherOptionProducts=attributes[otherAttributeId][currenProductOption]['option_products'];for(var i=0;i<currentOptionProducts.length;i++){if(otherOptionProducts.indexOf(currentOptionProducts[i])!=-1){tempArray.push(currentOptionProducts[i]);}}
currentOptionProducts=tempArray;}});var url='';var disabled=true;var availableOnttLabel='';if(currentOptionProducts.length>0){for(var i=0;i<currentOptionProducts.length;i++){var productId=currentOptionProducts[i];var isSalable=simpleProducts[productId]['is_salable']*1;if(isSalable){disabled=false;if(!currentProduct){if(isSalable!=2){if(attributeOptions[valueId]['store_label']){labelForToolTip=attributeOptions[valueId]['store_label'];}else{labelForToolTip=attributeOptions[valueId]['default_label'];}
labelForToolTip+=' '+simpleProducts[productId]['price'];}else{availableOnttLabel=attributeValue.select('div.availableontt-label')[0];if(availableOnttLabel!=undefined)
availableOnttLabel.setStyle({display:'inline-block'});labelForToolTip=options.availableOnTT;}}else{availableOnttLabel=attributeValue.select('div.availableontt-label')[0];if(isSalable==2&&availableOnttLabel!=undefined){availableOnttLabel.setStyle({display:'inline-block'});}}}
if(!currentProduct){url=simpleProducts[productId]['url'];}}};if(attributeValue.hasClassName('textconfigurable')&&attributeValue.hasClassName('configurablecolorcurrent')&&attributeValue.hasClassName('activeconfigcurrent')){disabled=false;}
if(disabled){var notAvailableImage=attributeValue.select('img.net-tovara');if(notAvailableImage.length>0){notAvailableImage.first().style.display='block';}
if(attributeValue.hasClassName('textconfigurable')){attributeValue.addClassName('noactiveconfig');}
if(!currentProduct){labelForToolTip=options.notInStock;}}
if(typeof(otherProducts.labelsForTooltip[attributeId])=='undefined'){otherProducts.labelsForTooltip[attributeId]=new Array();}
otherProducts.labelsForTooltip[attributeId][valueId]=labelForToolTip;var a=attributeValue.select('a.simple-url');if(a.length>0&&url.length>0){a=a.first();a.href=url;}});if(valueItems.length>9&&colorParamsShow){otherProducts.createCarousel(attributeList,startPosition);}});otherProducts.created=true;}}};;var Base=function(){};Base.extend=function(_instance,_static){"use strict";var extend=Base.prototype.extend;Base._prototyping=true;var proto=new this();extend.call(proto,_instance);proto.base=function(){};delete Base._prototyping;var constructor=proto.constructor;var klass=proto.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==klass){this._constructing=true;constructor.apply(this,arguments);delete this._constructing;}else if(arguments[0]!==null){return(arguments[0].extend||extend).call(arguments[0],proto);}}};klass.ancestor=this;klass.extend=this.extend;klass.forEach=this.forEach;klass.implement=this.implement;klass.prototype=proto;klass.toString=this.toString;klass.valueOf=function(type){return(type=="object")?klass:constructor.valueOf();};extend.call(klass,_static);if(typeof klass.init=="function")klass.init();return klass;};Base.prototype={extend:function(source,value){if(arguments.length>1){var ancestor=this[source];if(ancestor&&(typeof value=="function")&&(!ancestor.valueOf||ancestor.valueOf()!=value.valueOf())&&/\bbase\b/.test(value)){var method=value.valueOf();value=function(){var previous=this.base||Base.prototype.base;this.base=ancestor;var returnValue=method.apply(this,arguments);this.base=previous;return returnValue;};value.valueOf=function(type){return(type=="object")?value:method;};value.toString=Base.toString;}
this[source]=value;}else if(source){var extend=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){extend=this.extend||extend;}
var proto={toSource:null};var hidden=["constructor","toString","valueOf"];var i=Base._prototyping?0:1;while(key=hidden[i++]){if(source[key]!=proto[key]){extend.call(this,key,source[key]);}}
for(var key in source){if(!proto[key])extend.call(this,key,source[key]);}}
return this;}};Base=Base.extend({constructor:function(){this.extend(arguments[0]);}},{ancestor:Object,version:"1.1",forEach:function(object,block,context){for(var key in object){if(this.prototype[key]===undefined){block.call(context,object[key],key,object);}}},implement:function(){for(var i=0;i<arguments.length;i++){if(typeof arguments[i]=="function"){arguments[i](this.prototype);}else{this.prototype.extend(arguments[i]);}}
return this;},toString:function(){return String(this.valueOf());}});var FlipClock;(function($){"use strict";FlipClock=function(obj,digit,options){if(digit instanceof Object&&digit instanceof Date===false){options=digit;digit=0;}
return new FlipClock.Factory(obj,digit,options);};FlipClock.Lang={};FlipClock.Base=Base.extend({buildDate:'2014-12-12',version:'0.7.7',constructor:function(_default,options){if(typeof _default!=="object"){_default={};}
if(typeof options!=="object"){options={};}
this.setOptions($.extend(true,{},_default,options));},callback:function(method){if(typeof method==="function"){var args=[];for(var x=1;x<=arguments.length;x++){if(arguments[x]){args.push(arguments[x]);}}
method.apply(this,args);}},log:function(str){if(window.console&&console.log){console.log(str);}},getOption:function(index){if(this[index]){return this[index];}
return false;},getOptions:function(){return this;},setOption:function(index,value){this[index]=value;},setOptions:function(options){for(var key in options){if(typeof options[key]!=="undefined"){this.setOption(key,options[key]);}}}});}(jQuery));(function($){"use strict";FlipClock.Face=FlipClock.Base.extend({autoStart:true,dividers:[],factory:false,lists:[],constructor:function(factory,options){this.dividers=[];this.lists=[];this.base(options);this.factory=factory;},build:function(){if(this.autoStart){this.start();}},createDivider:function(label,css,excludeDots){if(typeof css=="boolean"||!css){excludeDots=css;css=label;}
var dots=['<span class="'+this.factory.classes.dot+' top"></span>','<span class="'+this.factory.classes.dot+' bottom"></span>'].join('');if(excludeDots){dots='';}
label=this.factory.localize(label);var html=['<span class="'+this.factory.classes.divider+' '+(css?css:'').toLowerCase()+'">','<span class="'+this.factory.classes.label+'">'+(label?label:'')+'</span>',dots,'</span>'];var $html=$(html.join(''));this.dividers.push($html);return $html;},createList:function(digit,options){if(typeof digit==="object"){options=digit;digit=0;}
var obj=new FlipClock.List(this.factory,digit,options);this.lists.push(obj);return obj;},reset:function(){this.factory.time=new FlipClock.Time(this.factory,this.factory.original?Math.round(this.factory.original):0,{minimumDigits:this.factory.minimumDigits});this.flip(this.factory.original,false);},appendDigitToClock:function(obj){obj.$el.append(false);},addDigit:function(digit){var obj=this.createList(digit,{classes:{active:this.factory.classes.active,before:this.factory.classes.before,flip:this.factory.classes.flip}});this.appendDigitToClock(obj);},start:function(){},stop:function(){},autoIncrement:function(){if(!this.factory.countdown){this.increment();}
else{this.decrement();}},increment:function(){this.factory.time.addSecond();},decrement:function(){if(this.factory.time.getTimeSeconds()==0){this.factory.stop()}
else{this.factory.time.subSecond();}},flip:function(time,doNotAddPlayClass){var t=this;$.each(time,function(i,digit){var list=t.lists[i];if(list){if(!doNotAddPlayClass&&digit!=list.digit){list.play();}
list.select(digit);}
else{t.addDigit(digit);}});}});}(jQuery));(function($){"use strict";FlipClock.Factory=FlipClock.Base.extend({animationRate:1000,autoStart:true,callbacks:{destroy:false,create:false,init:false,interval:false,start:false,stop:false,reset:false},classes:{active:'flip-clock-active',before:'flip-clock-before',divider:'flip-clock-divider',dot:'flip-clock-dot',label:'flip-clock-label',flip:'flip',play:'play',wrapper:'flip-clock-wrapper'},clockFace:'HourlyCounter',countdown:false,defaultClockFace:'HourlyCounter',defaultLanguage:'english',$el:false,face:true,lang:false,language:'english',minimumDigits:0,original:false,running:false,time:false,timer:false,$wrapper:false,constructor:function(obj,digit,options){if(!options){options={};}
this.lists=[];this.running=false;this.base(options);this.$el=$(obj).addClass(this.classes.wrapper);this.$wrapper=this.$el;this.original=(digit instanceof Date)?digit:(digit?Math.round(digit):0);this.time=new FlipClock.Time(this,this.original,{minimumDigits:this.minimumDigits,animationRate:this.animationRate});this.timer=new FlipClock.Timer(this,options);this.loadLanguage(this.language);this.loadClockFace(this.clockFace,options);if(this.autoStart){this.start();}},loadClockFace:function(name,options){var face,suffix='Face',hasStopped=false;name=name.ucfirst()+suffix;if(this.face.stop){this.stop();hasStopped=true;}
this.$el.html('');this.time.minimumDigits=this.minimumDigits;if(FlipClock[name]){face=new FlipClock[name](this,options);}
else{face=new FlipClock[this.defaultClockFace+suffix](this,options);}
face.build();this.face=face
if(hasStopped){this.start();}
return this.face;},loadLanguage:function(name){var lang;if(FlipClock.Lang[name.ucfirst()]){lang=FlipClock.Lang[name.ucfirst()];}
else if(FlipClock.Lang[name]){lang=FlipClock.Lang[name];}
else{lang=FlipClock.Lang[this.defaultLanguage];}
return this.lang=lang;},localize:function(index,obj){var lang=this.lang;if(!index){return null;}
var lindex=index.toLowerCase();if(typeof obj=="object"){lang=obj;}
if(lang&&lang[lindex]){return lang[lindex];}
return index;},start:function(callback){var t=this;if(!t.running&&(!t.countdown||t.countdown&&t.time.time>0)){t.face.start(t.time);t.timer.start(function(){t.flip();if(typeof callback==="function"){callback();}});}
else{t.log('Trying to start timer when countdown already at 0');}},stop:function(callback){this.face.stop();this.timer.stop(callback);for(var x in this.lists){if(this.lists.hasOwnProperty(x)){this.lists[x].stop();}}},reset:function(callback){this.timer.reset(callback);this.face.reset();},setTime:function(time){this.time.time=time;this.flip(true);},getTime:function(time){return this.time;},setCountdown:function(value){var running=this.running;this.countdown=value?true:false;if(running){this.stop();this.start();}},flip:function(doNotAddPlayClass){this.face.flip(false,doNotAddPlayClass);}});}(jQuery));(function($){"use strict";FlipClock.List=FlipClock.Base.extend({digit:0,classes:{active:'flip-clock-active',before:'flip-clock-before',flip:'flip'},factory:false,$el:false,$obj:false,items:[],lastDigit:0,constructor:function(factory,digit,options){this.factory=factory;this.digit=digit;this.lastDigit=digit;this.$el=this.createList();this.$obj=this.$el;if(digit>0){this.select(digit);}
this.factory.$el.append(this.$el);},select:function(digit){if(typeof digit==="undefined"){digit=this.digit;}
else{this.digit=digit;}
if(this.digit!=this.lastDigit){var $delete=this.$el.find('.'+this.classes.before).removeClass(this.classes.before);this.$el.find('.'+this.classes.active).removeClass(this.classes.active).addClass(this.classes.before);this.appendListItem(this.classes.active,this.digit);$delete.remove();this.lastDigit=this.digit;}},play:function(){this.$el.addClass(this.factory.classes.play);},stop:function(){var t=this;setTimeout(function(){t.$el.removeClass(t.factory.classes.play);},this.factory.timer.interval);},createListItem:function(css,value){return['<li class="'+(css?css:'')+'">','<a href="#">','<div class="up">','<div class="shadow"></div>','<div class="inn">'+(value?value:'')+'</div>','</div>','<div class="down">','<div class="shadow"></div>','<div class="inn">'+(value?value:'')+'</div>','</div>','</a>','</li>'].join('');},appendListItem:function(css,value){var html=this.createListItem(css,value);this.$el.append(html);},createList:function(){var lastDigit=this.getPrevDigit()?this.getPrevDigit():this.digit;var html=$(['<ul class="'+this.classes.flip+' '+(this.factory.running?this.factory.classes.play:'')+'">',this.createListItem(this.classes.before,lastDigit),this.createListItem(this.classes.active,this.digit),'</ul>'].join(''));return html;},getNextDigit:function(){return this.digit==9?0:this.digit+1;},getPrevDigit:function(){return this.digit==0?9:this.digit-1;}});}(jQuery));(function($){"use strict";String.prototype.ucfirst=function(){return this.substr(0,1).toUpperCase()+this.substr(1);};$.fn.FlipClock=function(digit,options){return new FlipClock($(this),digit,options);};$.fn.flipClock=function(digit,options){return $.fn.FlipClock(digit,options);};}(jQuery));(function($){"use strict";FlipClock.Time=FlipClock.Base.extend({time:0,factory:false,minimumDigits:0,constructor:function(factory,time,options){if(typeof options!="object"){options={};}
if(!options.minimumDigits){options.minimumDigits=factory.minimumDigits;}
this.base(options);this.factory=factory;if(time){this.time=time;}},convertDigitsToArray:function(str){var data=[];str=str.toString();for(var x=0;x<str.length;x++){if(str[x].match(/^\d*$/g)){data.push(str[x]);}}
return data;},digit:function(i){var timeStr=this.toString();var length=timeStr.length;if(timeStr[length-i]){return timeStr[length-i];}
return false;},digitize:function(obj){var data=[];$.each(obj,function(i,value){value=value.toString();if(value.length==1){value='0'+value;}
for(var x=0;x<value.length;x++){data.push(value.charAt(x));}});if(data.length>this.minimumDigits){this.minimumDigits=data.length;}
if(this.minimumDigits>data.length){for(var x=data.length;x<this.minimumDigits;x++){data.unshift('0');}}
return data;},getDateObject:function(){if(this.time instanceof Date){return this.time;}
return new Date((new Date()).getTime()+this.getTimeSeconds()*1000);},getDayCounter:function(includeSeconds){var digits=[this.getDays(),this.getHours(true),this.getMinutes(true)];if(includeSeconds){digits.push(this.getSeconds(true));}
return this.digitize(digits);},getDays:function(mod){var days=this.getTimeSeconds()/60/60/24;if(mod){days=days%7;}
return Math.floor(days);},getHourCounter:function(){var obj=this.digitize([this.getHours(),this.getMinutes(true),this.getSeconds(true)]);return obj;},getHourly:function(){return this.getHourCounter();},getHours:function(mod){var hours=this.getTimeSeconds()/60/60;if(mod){hours=hours%24;}
return Math.floor(hours);},getMilitaryTime:function(date,showSeconds){if(typeof showSeconds==="undefined"){showSeconds=true;}
if(!date){date=this.getDateObject();}
var data=[date.getHours(),date.getMinutes()];if(showSeconds===true){data.push(date.getSeconds());}
return this.digitize(data);},getMinutes:function(mod){var minutes=this.getTimeSeconds()/60;if(mod){minutes=minutes%60;}
return Math.floor(minutes);},getMinuteCounter:function(){var obj=this.digitize([this.getMinutes(),this.getSeconds(true)]);return obj;},getTimeSeconds:function(date){if(!date){date=new Date();}
if(this.time instanceof Date){if(this.factory.countdown){return Math.max(this.time.getTime()/1000-date.getTime()/1000,0);}else{return date.getTime()/1000-this.time.getTime()/1000;}}else{return this.time;}},getTime:function(date,showSeconds){if(typeof showSeconds==="undefined"){showSeconds=true;}
if(!date){date=this.getDateObject();}
console.log(date);var hours=date.getHours();var merid=hours>12?'PM':'AM';var data=[hours>12?hours-12:(hours===0?12:hours),date.getMinutes()];if(showSeconds===true){data.push(date.getSeconds());}
return this.digitize(data);},getSeconds:function(mod){var seconds=this.getTimeSeconds();if(mod){if(seconds==60){seconds=0;}
else{seconds=seconds%60;}}
return Math.ceil(seconds);},getWeeks:function(mod){var weeks=this.getTimeSeconds()/60/60/24/7;if(mod){weeks=weeks%52;}
return Math.floor(weeks);},removeLeadingZeros:function(totalDigits,digits){var total=0;var newArray=[];$.each(digits,function(i,digit){if(i<totalDigits){total+=parseInt(digits[i],10);}
else{newArray.push(digits[i]);}});if(total===0){return newArray;}
return digits;},addSeconds:function(x){if(this.time instanceof Date){this.time.setSeconds(this.time.getSeconds()+x);}
else{this.time+=x;}},addSecond:function(){this.addSeconds(1);},subSeconds:function(x){if(this.time instanceof Date){this.time.setSeconds(this.time.getSeconds()-x);}
else{this.time-=x;}},subSecond:function(){this.subSeconds(1);},toString:function(){return this.getTimeSeconds().toString();}});}(jQuery));(function($){"use strict";FlipClock.Timer=FlipClock.Base.extend({callbacks:{destroy:false,create:false,init:false,interval:false,start:false,stop:false,reset:false},count:0,factory:false,interval:1000,animationRate:1000,constructor:function(factory,options){this.base(options);this.factory=factory;this.callback(this.callbacks.init);this.callback(this.callbacks.create);},getElapsed:function(){return this.count*this.interval;},getElapsedTime:function(){return new Date(this.time+this.getElapsed());},reset:function(callback){clearInterval(this.timer);this.count=0;this._setInterval(callback);this.callback(this.callbacks.reset);},start:function(callback){this.factory.running=true;this._createTimer(callback);this.callback(this.callbacks.start);},stop:function(callback){this.factory.running=false;this._clearInterval(callback);this.callback(this.callbacks.stop);this.callback(callback);},_clearInterval:function(){clearInterval(this.timer);},_createTimer:function(callback){this._setInterval(callback);},_destroyTimer:function(callback){this._clearInterval();this.timer=false;this.callback(callback);this.callback(this.callbacks.destroy);},_interval:function(callback){this.callback(this.callbacks.interval);this.callback(callback);this.count++;},_setInterval:function(callback){var t=this;t._interval(callback);t.timer=setInterval(function(){t._interval(callback);},this.interval);}});}(jQuery));(function($){FlipClock.TwentyFourHourClockFace=FlipClock.Face.extend({constructor:function(factory,options){this.base(factory,options);},build:function(time){var t=this;var children=this.factory.$el.find('ul');if(!this.factory.time.time){this.factory.original=new Date();this.factory.time=new FlipClock.Time(this.factory,this.factory.original);}
var time=time?time:this.factory.time.getMilitaryTime(false,this.showSeconds);if(time.length>children.length){$.each(time,function(i,digit){t.createList(digit);});}
this.createDivider();this.createDivider();$(this.dividers[0]).insertBefore(this.lists[this.lists.length-2].$el);$(this.dividers[1]).insertBefore(this.lists[this.lists.length-4].$el);this.base();},flip:function(time,doNotAddPlayClass){this.autoIncrement();time=time?time:this.factory.time.getMilitaryTime(false,this.showSeconds);this.base(time,doNotAddPlayClass);}});}(jQuery));(function($){FlipClock.CounterFace=FlipClock.Face.extend({shouldAutoIncrement:false,constructor:function(factory,options){if(typeof options!="object"){options={};}
factory.autoStart=options.autoStart?true:false;if(options.autoStart){this.shouldAutoIncrement=true;}
factory.increment=function(){factory.countdown=false;factory.setTime(factory.getTime().getTimeSeconds()+1);};factory.decrement=function(){factory.countdown=true;var time=factory.getTime().getTimeSeconds();if(time>0){factory.setTime(time-1);}};factory.setValue=function(digits){factory.setTime(digits);};factory.setCounter=function(digits){factory.setTime(digits);};this.base(factory,options);},build:function(){var t=this;var children=this.factory.$el.find('ul');var time=this.factory.getTime().digitize([this.factory.getTime().time]);if(time.length>children.length){$.each(time,function(i,digit){var list=t.createList(digit);list.select(digit);});}
$.each(this.lists,function(i,list){list.play();});this.base();},flip:function(time,doNotAddPlayClass){if(this.shouldAutoIncrement){this.autoIncrement();}
if(!time){time=this.factory.getTime().digitize([this.factory.getTime().time]);}
this.base(time,doNotAddPlayClass);},reset:function(){this.factory.time=new FlipClock.Time(this.factory,this.factory.original?Math.round(this.factory.original):0);this.flip();}});}(jQuery));(function($){FlipClock.DailyCounterFace=FlipClock.Face.extend({showSeconds:true,constructor:function(factory,options){this.base(factory,options);},build:function(time){var t=this;var children=this.factory.$el.find('ul');var offset=0;time=time?time:this.factory.time.getDayCounter(this.showSeconds);if(time.length>children.length){$.each(time,function(i,digit){t.createList(digit);});}
if(this.showSeconds){$(this.createDivider('Seconds')).insertBefore(this.lists[this.lists.length-2].$el);}
else
{offset=2;}
$(this.createDivider('Minutes')).insertBefore(this.lists[this.lists.length-4+offset].$el);$(this.createDivider('Hours')).insertBefore(this.lists[this.lists.length-6+offset].$el);$(this.createDivider('Days',true)).insertBefore(this.lists[0].$el);this.base();},flip:function(time,doNotAddPlayClass){if(!time){time=this.factory.time.getDayCounter(this.showSeconds);}
this.autoIncrement();this.base(time,doNotAddPlayClass);}});}(jQuery));(function($){FlipClock.HourlyCounterFace=FlipClock.Face.extend({constructor:function(factory,options){this.base(factory,options);},build:function(excludeHours,time){var t=this;var children=this.factory.$el.find('ul');time=time?time:this.factory.time.getHourCounter();if(time.length>children.length){$.each(time,function(i,digit){t.createList(digit);});}
$(this.createDivider('Seconds')).insertBefore(this.lists[this.lists.length-2].$el);$(this.createDivider('Minutes')).insertBefore(this.lists[this.lists.length-4].$el);if(!excludeHours){$(this.createDivider('Hours',true)).insertBefore(this.lists[0].$el);}
this.base();},flip:function(time,doNotAddPlayClass){if(!time){time=this.factory.time.getHourCounter();}
this.autoIncrement();this.base(time,doNotAddPlayClass);},appendDigitToClock:function(obj){this.base(obj);this.dividers[0].insertAfter(this.dividers[0].next());}});}(jQuery));(function($){FlipClock.MinuteCounterFace=FlipClock.HourlyCounterFace.extend({clearExcessDigits:false,constructor:function(factory,options){this.base(factory,options);},build:function(){this.base(true,this.factory.time.getMinuteCounter());},flip:function(time,doNotAddPlayClass){if(!time){time=this.factory.time.getMinuteCounter();}
this.base(time,doNotAddPlayClass);}});}(jQuery));(function($){FlipClock.TwelveHourClockFace=FlipClock.TwentyFourHourClockFace.extend({meridium:false,meridiumText:'AM',build:function(){var t=this;var time=this.factory.time.getTime(false,this.showSeconds);this.base(time);this.meridiumText=this.getMeridium();this.meridium=$(['<ul class="flip-clock-meridium">','<li>','<a href="#">'+this.meridiumText+'</a>','</li>','</ul>'].join(''));this.meridium.insertAfter(this.lists[this.lists.length-1].$el);},flip:function(time,doNotAddPlayClass){if(this.meridiumText!=this.getMeridium()){this.meridiumText=this.getMeridium();this.meridium.find('a').html(this.meridiumText);}
this.base(this.factory.time.getTime(false,this.showSeconds),doNotAddPlayClass);},getMeridium:function(){return new Date().getHours()>=12?'PM':'AM';},isPM:function(){return this.getMeridium()=='PM'?true:false;},isAM:function(){return this.getMeridium()=='AM'?true:false;}});}(jQuery));(function($){FlipClock.Lang.Arabic={'years':'','months':'','days':'','hours':'','minutes':'','seconds':''};FlipClock.Lang['ar']=FlipClock.Lang.Arabic;FlipClock.Lang['ar-ar']=FlipClock.Lang.Arabic;FlipClock.Lang['arabic']=FlipClock.Lang.Arabic;}(jQuery));(function($){FlipClock.Lang.Danish={'years':'r','months':'Mneder','days':'Dage','hours':'Timer','minutes':'Minutter','seconds':'Sekunder'};FlipClock.Lang['da']=FlipClock.Lang.Danish;FlipClock.Lang['da-dk']=FlipClock.Lang.Danish;FlipClock.Lang['danish']=FlipClock.Lang.Danish;}(jQuery));(function($){FlipClock.Lang.German={'years':'Jahre','months':'Monate','days':'Tage','hours':'Stunden','minutes':'Minuten','seconds':'Sekunden'};FlipClock.Lang['de']=FlipClock.Lang.German;FlipClock.Lang['de-de']=FlipClock.Lang.German;FlipClock.Lang['german']=FlipClock.Lang.German;}(jQuery));(function($){FlipClock.Lang.English={'years':'Years','months':'Months','days':'Days','hours':'Hours','minutes':'Minutes','seconds':'Seconds'};FlipClock.Lang['en']=FlipClock.Lang.English;FlipClock.Lang['en-us']=FlipClock.Lang.English;FlipClock.Lang['english']=FlipClock.Lang.English;}(jQuery));(function($){FlipClock.Lang.Spanish={'years':'A&#241;os','months':'Meses','days':'D&#205;as','hours':'Horas','minutes':'Minutos','seconds':'Segundo'};FlipClock.Lang['es']=FlipClock.Lang.Spanish;FlipClock.Lang['es-es']=FlipClock.Lang.Spanish;FlipClock.Lang['spanish']=FlipClock.Lang.Spanish;}(jQuery));(function($){FlipClock.Lang.Finnish={'years':'Vuotta','months':'Kuukautta','days':'Piv','hours':'Tuntia','minutes':'Minuuttia','seconds':'Sekuntia'};FlipClock.Lang['fi']=FlipClock.Lang.Finnish;FlipClock.Lang['fi-fi']=FlipClock.Lang.Finnish;FlipClock.Lang['finnish']=FlipClock.Lang.Finnish;}(jQuery));(function($){FlipClock.Lang.French={'years':'Ans','months':'Mois','days':'Jours','hours':'Heures','minutes':'Minutes','seconds':'Secondes'};FlipClock.Lang['fr']=FlipClock.Lang.French;FlipClock.Lang['fr-ca']=FlipClock.Lang.French;FlipClock.Lang['french']=FlipClock.Lang.French;}(jQuery));(function($){FlipClock.Lang.Italian={'years':'Anni','months':'Mesi','days':'Giorni','hours':'Ore','minutes':'Minuti','seconds':'Secondi'};FlipClock.Lang['it']=FlipClock.Lang.Italian;FlipClock.Lang['it-it']=FlipClock.Lang.Italian;FlipClock.Lang['italian']=FlipClock.Lang.Italian;}(jQuery));(function($){FlipClock.Lang.Latvian={'years':'Gadi','months':'Mnei','days':'Dienas','hours':'Stundas','minutes':'Mintes','seconds':'Sekundes'};FlipClock.Lang['lv']=FlipClock.Lang.Latvian;FlipClock.Lang['lv-lv']=FlipClock.Lang.Latvian;FlipClock.Lang['latvian']=FlipClock.Lang.Latvian;}(jQuery));(function($){FlipClock.Lang.Dutch={'years':'Jaren','months':'Maanden','days':'Dagen','hours':'Uren','minutes':'Minuten','seconds':'Seconden'};FlipClock.Lang['nl']=FlipClock.Lang.Dutch;FlipClock.Lang['nl-be']=FlipClock.Lang.Dutch;FlipClock.Lang['dutch']=FlipClock.Lang.Dutch;}(jQuery));(function($){FlipClock.Lang.Norwegian={'years':'r','months':'Mneder','days':'Dager','hours':'Timer','minutes':'Minutter','seconds':'Sekunder'};FlipClock.Lang['no']=FlipClock.Lang.Norwegian;FlipClock.Lang['nb']=FlipClock.Lang.Norwegian;FlipClock.Lang['no-nb']=FlipClock.Lang.Norwegian;FlipClock.Lang['norwegian']=FlipClock.Lang.Norwegian;}(jQuery));(function($){FlipClock.Lang.Portuguese={'years':'Anos','months':'Meses','days':'Dias','hours':'Horas','minutes':'Minutos','seconds':'Segundos'};FlipClock.Lang['pt']=FlipClock.Lang.Portuguese;FlipClock.Lang['pt-br']=FlipClock.Lang.Portuguese;FlipClock.Lang['portuguese']=FlipClock.Lang.Portuguese;}(jQuery));(function($){FlipClock.Lang.Russian={'years':'','months':'','days':'','hours':'','minutes':'','seconds':''};FlipClock.Lang['ru']=FlipClock.Lang.Russian;FlipClock.Lang['ru-ru']=FlipClock.Lang.Russian;FlipClock.Lang['russian']=FlipClock.Lang.Russian;}(jQuery));(function($){FlipClock.Lang.Swedish={'years':'r','months':'Mnader','days':'Dagar','hours':'Timmar','minutes':'Minuter','seconds':'Sekunder'};FlipClock.Lang['sv']=FlipClock.Lang.Swedish;FlipClock.Lang['sv-se']=FlipClock.Lang.Swedish;FlipClock.Lang['swedish']=FlipClock.Lang.Swedish;}(jQuery));(function($){FlipClock.Lang.Chinese={'years':'','months':'','days':'','hours':'','minutes':'','seconds':''};FlipClock.Lang['zh']=FlipClock.Lang.Chinese;FlipClock.Lang['zh-cn']=FlipClock.Lang.Chinese;FlipClock.Lang['chinese']=FlipClock.Lang.Chinese;}(jQuery));;var CarouselVertical=Class.create(UI.CarouselLazyImage,{initialize:function($super,element,options){$super(element,options);this.element.down('.container').style.height='';},prepareContainer:function($super){$super();this.element.down(this.options.container).style.width='';this.element.style.width='';}});var PackageSlider=Class.create({initialize:function(container,options){this.options=options;this.container=container;this.accessories=this._prepareGroup('.accessory-group');this.actions=this._prepareGroup('.action-group');this.prices=this._prepareGroup('.price-group');this._prepareCategory();this._prepareGroupHashTable();var group=this.groupHashTable[this.categories.items[0].id]
this.switchCategory(group.category);this.switchGroupAccessories(group.accessory);this.switchGroupActions(group.action);this.switchGroupPrice(group.price);this.state=group;var url=location+'';var hash=url.substring(url.indexOf("#package-slide-")+15);if(!isNaN(hash)){if(this.options.main_product){this.showPackage(this.options.main_product+'_'+hash,true);document.observe("dom:loaded",function(){$('package-slide').scrollTo();});}}else{if(this.options.main_product&&this.options.suite_default){this.showPackage(this.options.main_product+'_'+this.options.suite_default,true);}}},_prepareGroup:function(selector){var groups=[];this.container.select(selector).each(function(html){var group={};group.html=html;groups.push(group);}.bind(this));return groups;},_prepareGroupHashTable:function(){var groupHashTable=[];this.groupHashTable=groupHashTable;this.categories.items.each(function(category){var searchItem=function(items,selector){var res=false;items.each(function(group){var categoryID=group.html.getAttribute('data-category-id');if(categoryID==category.id){res=group;res.category=category;res.items=this._prepareGroup(selector);return false;}}.bind(this));return res;}.bind(this);var accessory=searchItem(this.accessories,'#category-accessory-'+category.id+' li');accessory.getSelectAccessory=function(){var index=this.carousel.currentIndex();if(isNaN(index)){index=0;}
var packageID=this.carousel.elements[index].getAttribute('data-package-id');return packageID;};var action=searchItem(this.actions,'#category-action-'+category.id+' .action');var price=searchItem(this.prices,'#category-price-'+category.id+' .price-cont');var prepareItems=function(group){var ht=[];group.items.each(function(item){item.id=item.html.getAttribute('data-package-id');ht[item.id]=item;});var current=group.items[0].id;group.getItemByAccessoryId=function(id){return ht[id];};group.getCurrentItem=function(){if(!current)
return null;return ht[current];};group.setCurrentItem=function(item){current=item.id;}}
prepareItems(accessory);prepareItems(action);prepareItems(price);accessory.action=action;accessory.price=price;action.accessory=accessory;price.accessory=accessory;groupHashTable[category.id]={category:category,accessory:accessory,action:action,price:price};}.bind(this));},_prepareCategoryLi:function(item){var span=item.html.down('span');span.setStyle({'paddingTop':'0px','display':'block'});var liHeight=item.html.getHeight()
var spanHeight=span.getHeight();var paddingTop=(liHeight-spanHeight)/2;span.setStyle({'paddingTop':parseInt(paddingTop)+'px','display':'block'});},_prepareCategory:function(){var categoryGroup=this._prepareGroup('.categories').first();categoryGroup.items=this._prepareGroup('.categories li');categoryGroup.items.each(function(category){category.id=category.html.getAttribute('data-category-id');category.html.observe('click',this._observeCategoryClick.bind(this));}.bind(this));var carouselID=categoryGroup.html.id;if(!carouselID)
throw new Error('ID for carousel container does not set');categoryGroup.items.each(function(item){this._prepareCategoryLi(item);}.bind(this));var carousel=new CarouselVertical(carouselID,{direction:'vertical'});categoryGroup.carousel=carousel;this.categories=categoryGroup;},switchGroupAccessories:function(accessory){if(this.state){this.state.accessory.html.hide();}
accessory.html.setStyle({'display':'block'});if(!accessory.carousel){if(!accessory.html.id)
throw Error('ID for accessory group does not found');accessory.carousel=new UI.CarouselLazyImage(accessory.html.id);accessory.html.observe('carousel:scroll:ended',this._observeAccessoryChange.bind(this));}
this.switchActions(accessory.action);this.switchPrices(accessory.price);if(this.options.afterSwitchGroupAccessories)
this.options.afterSwitchGroupAccessories();},switchGroupActions:function(action){if(this.state){this.state.action.html.hide();}
action.html.setStyle({'display':'block'});},switchActions:function(action){if(!action.accessory.carousel){action.items[0].html.setStyle({'display':'block'});return;}
var newAccessoryID=action.accessory.getSelectAccessory();var actionItem=null;if(this.state){actionItem=this.state.action.getCurrentItem();if(actionItem)
actionItem.html.hide();}
actionItem=action.getItemByAccessoryId(newAccessoryID);actionItem.html.setStyle({'display':'block'});action.setCurrentItem(actionItem);},switchGroupPrice:function(price){if(this.state){this.state.price.html.hide();}
price.html.setStyle({'display':'block'})},switchPrices:function(price){if(!price.accessory.carousel){price.items[0].html.setStyle({'display':'block'});return;}
var newPackageID=price.accessory.getSelectAccessory();var labelCSS='discount-label-';var priceItem=null;if(this.state){priceItem=this.state.price.getCurrentItem();if(priceItem){priceItem.html.hide();var label=$(labelCSS+priceItem.id);if(label)
label.hide();}}
priceItem=price.getItemByAccessoryId(newPackageID);priceItem.html.setStyle({'display':'block'});var label=$(labelCSS+newPackageID);if(label)
label.setStyle({'display':'block'});price.setCurrentItem(priceItem);},_switchGroup:function(group){this.switchCategory(group.category);this.switchGroupAccessories(group.accessory);this.switchGroupActions(group.action);this.switchGroupPrice(group.price)
this.state=group;},_observeCategoryClick:function(e){var element=e.element().up('li')
var categoryID=element.getAttribute('data-category-id');var group=this.groupHashTable[categoryID];this._switchGroup(group);},_observeAccessoryChange:function(e,a,j){var group=this.groupHashTable[this.state.category.id];this.switchActions(group.action);this.switchPrices(group.price);},switchCategory:function(category){if(this.state){this.state.category.html.removeClassName('active');this._prepareCategoryLi(this.state.category);}
category.html.addClassName('active');this._prepareCategoryLi(category);},showPackage:function(suiteUniqe,force){var arr=suiteUniqe.split('_');if(arr.length!=2)return;var mainProductID=arr[0];var suiteID=arr[1];if(!mainProductID||!suiteID)return;if(this.state){}
var aGroup,aItem,index=false;this.accessories.each(function(accessoryGroup){accessoryGroup.items.each(function(accessory,i){if(accessory.id==suiteID){aGroup=accessoryGroup;aItem=accessory;index=i;return false;}});});if(aItem&&aGroup){var group=this.groupHashTable[aGroup.category.id];this._switchGroup(group);aGroup.carousel.scrollTo(index,force);var catIndex=this.categories.items.indexOf(aGroup.category)
this.categories.carousel.scrollTo(catIndex,force);}}});;function addProductAndGoToCheckout(product_id,eventUrl,checkoutUrl,ts)
{if(product_id){jQuery.ajax({url:BASE_URL+'j2tajaxcheckout/index/cart/?ts='+ts,data:"product="+product_id+"&eventaction=1",type:"POST",success:function(response){if(checkoutUrl){location.href=checkoutUrl;}else if(eventUrl){location.href=eventUrl;}},error:function(response){if(eventUrl){location.href=eventUrl;}}});}else{location.href=eventUrl;}};navigationLoadInProccess=false;var ProductTabs=Class.create({initialize:function(container,tabWrapper){this.tabs=this.getTabs(container,tabWrapper);this.prepareTabsWidth(this.tabs);this.observeTabs(this.tabs);this.container=container;container.removeClassName('loading');},getTabs:function(container,tabWrapper){var tabs=[];container.select('a').each(function(th){var tabObj={};tabObj.tab=th;tabObj.tabContainer=th.up('.'+tabWrapper);tabObj.active=false;tabObj.loaded=false;tabObj.tabContent=$(th.id+'_content');tabObj.tabLink=th;tabObj.header=$('product-title-h1').innerHTML;if(th.onclick&&th.onclick().url){tabObj.tabUrl=th.onclick().url;}
if(th.onclick&&th.onclick().name){tabObj.tabName=th.onclick().name;}
if(tabObj.tabContainer.hasClassName('active')){tabObj.active=true;tabObj.loaded=true;this.currentTab=tabObj;}
tabs.push(tabObj);}.bind(this));return tabs;},prepareTabsWidth:function(tabs){tabs.each(function(th){th.tabLink.style.width=th.tabLink.getWidth()+2+'px';});},observeTabs:function(tabs){tabs.each(function(th){th.tab.observe('click',function(e){e.stop();if(!th.active){this.switchTab(this.currentTab,th);}}.bind(this));}.bind(this));},switchTab:function(oldTab,newTab,callBack){oldTab.tabContainer.removeClassName('active');oldTab.active=false;oldTab.tabContent.hide();var isLoad=newTab.loaded;if(!newTab.loaded){newTab.tabContent.addClassName('loading');this.loadTab(newTab,callBack);}
newTab.tabContent.show();window.scroll(0,0);this.currentTab=newTab;newTab.tabContainer.addClassName('active');newTab.active=true;$('product-title-h1').innerHTML=newTab.header;if(isLoad&&callBack)
callBack(oldTab,newTab);Event.fire(this.container,'productTabs:switchTab',true);},switchByName:function(tabName,callBack){var newTab=this.tabs.find(function(th){if(th.tabName==tabName)
return th;});this.switchTab(this.currentTab,newTab,callBack);return true;},loadTab:function(tab,callBack){var tab=tab;if(tab.tabUrl){new Ajax.Request(tab.tabUrl,{method:'get',onComplete:function(resp){$('product-title-h1').innerHTML=resp.responseJSON.title;tab.tabContent.update(resp.responseJSON.output);tab.tabContent.removeClassName('loading');var overlay=$('advanced-navigation-overlay');if(overlay){overlay.setStyle({'display':'none'});}
var buyButtons=tab.tabContent.select('.btn-cart');cartController.observeLinks(buyButtons);tab.loaded=true;tab.header=resp.responseJSON.title;document.fire('productTabs:tabLoaded');zoomer.set('image','.zoomImageMediaTab-'.concat(tab.tabName)).ready();if(callBack)
callBack();}.bind(this)});}else{alert('There is no tab url');}},updateTab:function(url){this.currentTab.tabUrl=url;var feedbacks=jQuery('.reviews-block');feedbacks[0].scrollTo();setNavigationUrl(url);this.loadTab(this.currentTab);},updateTabWithCallback:function(url,callback){this.currentTab.tabUrl=url;this.currentTab.tabContent.update();this.loadTab(this.currentTab,callback);}});function setNavigationUrl(url){is_ajax=typeof(is_ajax)!='undefined'?is_ajax:true;if(navigationLoadInProccess){return false;}
navigationLoadInProccess=true;var overlay=$('advanced-navigation-overlay');if(!overlay){overlay=$(document.createElement('div'));overlay.id='advanced-navigation-overlay';document.body.appendChild(overlay);}
var element=$$('.reviews-block')[0];var offsets=element.cumulativeOffset();var toolbar=$$('.toolbar-bottom')[0];var height=element.offsetHeight+toolbar.offsetHeight;overlay.setStyle({'top':offsets[1]+'px','left':offsets[0]+'px','width':element.offsetWidth+'px','height':height+'px','position':'absolute','display':'block','zIndex':'1000'});new Ajax.Request(url,{method:'get',onSuccess:function(transport){transport.responseText.evalJSON();$('product-title-h1').innerHTML=transport.responseJSON.title;navigationLoadInProccess=false;}});return true;};ratings_store=[];window.createRatings=function(id,form,ratingId,ratingSelectId){var idRating=(form)?form.id+'-'+id:id;if(ratings_store[idRating]==undefined){ratingId=(ratingId)?ratingId:'#reviewRatings';ratingSelectId=(ratingSelectId)?ratingSelectId:'#ratingSelect';if(form.select(ratingId)[0]){var reviews=new Reviews(form.select(ratingId)[0],0,{noAjax:true,select:form.select(ratingSelectId)[0]});ratings_store[idRating]=reviews;}}
return ratings_store[idRating];};window.attachRatings=function(form,objForm){var result=[];$(form).select("div[id^='reviewRatings-']").each(function(element){var r=window.createRatings(element.id,form,'#'+element.id,'#'+element.id.replace('reviewRatings','ratingSelect'));if(objForm){if(!objForm.ratings)objForm.ratings=[];objForm.ratings[element.id]=r;}});return result;};window.toggle_form=function(id,id_sender){$(id).toggleClassName('display-none');$(id_sender).toggleClassName('display-none');if(window.calBlocksHeight){window.calBlocksHeight();}};window.toggleBlockHeight=function(block,sender){var dataHeight=jQuery(block).attr("data-height");if(dataHeight){jQuery(block).css("height",dataHeight);jQuery(block).removeAttr("data-height");}
else{var height=jQuery(block).css("height");jQuery(block).css("height","auto");jQuery(block).attr("data-height",height);}}
InlineForm=Class.create({initialize:function(_form){this.form=_form
this.bnClose=jQuery(this.form).find('#close-button').first();jQuery(this.bnClose).on('click',function(e){this.form.hide();if(window.calBlocksHeight)
window.calBlocksHeight();}.bind(this));}});;Reviews=Class.create({initialize:function(container,startRating,parameters){this.container=container;var ratingBox=container.down('.rating-box');var rating=container.down('.rating');this.startRating=startRating*20+'%';var maskContainer=container.down('.masks');var masks=this.createMask(container,maskContainer);this.observeMasks(masks,rating,container,parameters);this.parameters=parameters;parameters.select.observe('change',function(e){$(e.target).select("option[value='"+e.target.value+"']");});},createMask:function(container,maskContainer){var masks=[];var ratingSize=container.down('.rating-box').getDimensions();ratingSize.width=Math.floor(ratingSize.width/5)+'px';ratingSize.height+='px';for(var i=1;i<=5;i++){var mask=new Element('div',{'class':'rating-mask'});mask.widthValue=20*i+'%';mask.value=i;mask.style.width=ratingSize.width;mask.style.height=ratingSize.height;maskContainer.appendChild(mask);if(Prototype.Browser.IE){mask.addClassName('rating-mask');}
masks.push(mask);}
return masks;},observeMasks:function(masks,rating,container,ajaxParams){masks.each(function(th){th.observe('mouseover',function(e){rating.style.width=th.widthValue;if(this.onStarMouseOver){this.onStarMouseOver(th.widthValue,parseInt(th.widthValue)/20);}}.bind(this));container.down('.rating-box').down('.masks').observe('mouseleave',function(e){if(this.onStarMouseLeave){this.onStarMouseLeave(parseInt(this.startRating)/20,parseInt(th.widthValue)/20);}}.bind(this));th.observe('click',function(e){if(!ajaxParams.noAjax){this.stopObserve(masks,container);new Ajax.Request(ajaxParams.url,{method:'post',parameters:{rating:th.value,product_id:ajaxParams.id},onComplete:function(resp){var r=resp.responseText.evalJSON();if(r.error){alert(r.messages);}
else{if(this.onStarClicked){this.onStarClicked(th.value);}}}});}else{var select=ajaxParams.select;var options=select.select('option');var optToSelect=this.findOption(options,th.value);select.value=optToSelect.value;this.startRating=th.value*20+'%';if(this.onStarClicked){this.onStarClicked(th.value);}}}.bind(this));}.bind(this));container.observe('mouseout',function(e){rating.style.width=this.startRating;}.bind(this));},stopObserve:function(masks,container){masks.each(function(th){th.stopObserving('mouseover');th.stopObserving('click');});container.stopObserving('mouseout');container.addClassName('disabled');},setRating:function(value){var rating=this.container.down('.rating');this.startRating=value*20+'%';rating.style.width=this.startRating;var select=$('ratingSelect');var options=select.select('option');var optToSelect=this.findOption(options,value);select.value=optToSelect.value;},findOption:function(options,estimate){var found=null;for(i=0;i<options.length;i++){if(options[i].text==estimate){found=options[i];break;}}
return found;}});;function voteReview(url,reviewId,mark,elem){var login=allo.session.data.customer.customer.islogged;if(login==false){allo.showLogin(elem);return;}
new Ajax.Request(url,{parameters:{method:'post',reviewId:reviewId,raiting:mark},onSuccess:function(transport){$$('.review-vote-'+reviewId).forEach(function(e,i,a){e.update(transport.responseText);});}});}
function voteAnswer(url,answerId,mark,elem){var login=allo.session.data.customer.customer.islogged;if(login==false){allo.showLogin(elem);return;}
new Ajax.Request(url,{parameters:{method:'post',answerId:answerId,raiting:mark},onSuccess:function(transport){$$('.answer-vote-'+answerId).forEach(function(e,i,a){e.update(transport.responseText);});}});};!function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory("object"==typeof exports?require("jquery"):jQuery);}(function($){var caretTimeoutId,ua=navigator.userAgent,iPhone=/iphone/i.test(ua),chrome=/chrome/i.test(ua),android=/android/i.test(ua);$.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},$.fn.extend({caret:function(begin,end){var range;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof begin?(end="number"==typeof end?end:begin,this.each(function(){this.setSelectionRange?this.setSelectionRange(begin,end):this.createTextRange&&(range=this.createTextRange(),range.collapse(!0),range.moveEnd("character",end),range.moveStart("character",begin),range.select());})):(this[0].setSelectionRange?(begin=this[0].selectionStart,end=this[0].selectionEnd):document.selection&&document.selection.createRange&&(range=document.selection.createRange(),begin=0-range.duplicate().moveStart("character",-1e5),end=begin+range.text.length),{begin:begin,end:end});},unmask:function(){return this.trigger("unmask");},mask:function(mask,settings){var input,defs,tests,partialPosition,firstNonMaskPos,lastRequiredNonMaskPos,len,oldVal;if(!mask&&this.length>0){input=$(this[0]);var fn=input.data($.mask.dataName);return fn?fn():void 0;}
return settings=$.extend({autoclear:$.mask.autoclear,placeholder:$.mask.placeholder,completed:null},settings),defs=$.mask.definitions,tests=[],partialPosition=len=mask.length,firstNonMaskPos=null,$.each(mask.split(""),function(i,c){"?"==c?(len--,partialPosition=i):defs[c]?(tests.push(new RegExp(defs[c])),null===firstNonMaskPos&&(firstNonMaskPos=tests.length-1),partialPosition>i&&(lastRequiredNonMaskPos=tests.length-1)):tests.push(null);}),this.trigger("unmask").each(function(){function tryFireCompleted(){if(settings.completed){for(var i=firstNonMaskPos;lastRequiredNonMaskPos>=i;i++)if(tests[i]&&buffer[i]===getPlaceholder(i))return;settings.completed.call(input);}}
function getPlaceholder(i){return settings.placeholder.charAt(i<settings.placeholder.length?i:0);}
function seekNext(pos){for(;++pos<len&&!tests[pos];);return pos;}
function seekPrev(pos){for(;--pos>=0&&!tests[pos];);return pos;}
function shiftL(begin,end){var i,j;if(!(0>begin)){for(i=begin,j=seekNext(end);len>i;i++)if(tests[i]){if(!(len>j&&tests[i].test(buffer[j])))break;buffer[i]=buffer[j],buffer[j]=getPlaceholder(j),j=seekNext(j);}
writeBuffer(),input.caret(Math.max(firstNonMaskPos,begin));}}
function shiftR(pos){var i,c,j,t;for(i=pos,c=getPlaceholder(pos);len>i;i++)if(tests[i]){if(j=seekNext(i),t=buffer[i],buffer[i]=c,!(len>j&&tests[j].test(t)))break;c=t;}}
function androidInputEvent(){var curVal=input.val(),pos=input.caret();if(oldVal&&oldVal.length&&oldVal.length>curVal.length){for(checkVal(!0);pos.begin>0&&!tests[pos.begin-1];)pos.begin--;if(0===pos.begin)for(;pos.begin<firstNonMaskPos&&!tests[pos.begin];)pos.begin++;input.caret(pos.begin,pos.begin);}else{for(checkVal(!0);pos.begin<len&&!tests[pos.begin];)pos.begin++;input.caret(pos.begin,pos.begin);}
tryFireCompleted();}
function blurEvent(){checkVal(),input.val()!=focusText&&input.change();}
function keydownEvent(e){if(!input.prop("readonly")){var pos,begin,end,k=e.which||e.keyCode;oldVal=input.val(),8===k||46===k||iPhone&&127===k?(pos=input.caret(),begin=pos.begin,end=pos.end,end-begin===0&&(begin=46!==k?seekPrev(begin):end=seekNext(begin-1),end=46===k?seekNext(end):end),clearBuffer(begin,end),shiftL(begin,end-1),e.preventDefault()):13===k?blurEvent.call(this,e):27===k&&(input.val(focusText),input.caret(0,checkVal()),e.preventDefault());}}
function keypressEvent(e){if(!input.prop("readonly")){var p,c,next,k=e.which||e.keyCode,pos=input.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||32>k)&&k&&13!==k){if(pos.end-pos.begin!==0&&(clearBuffer(pos.begin,pos.end),shiftL(pos.begin,pos.end-1)),p=seekNext(pos.begin-1),len>p&&(c=String.fromCharCode(k),tests[p].test(c))){if(shiftR(p),buffer[p]=c,writeBuffer(),next=seekNext(p),android){var proxy=function(){$.proxy($.fn.caret,input,next)();};setTimeout(proxy,0);}else input.caret(next);pos.begin<=lastRequiredNonMaskPos&&tryFireCompleted();}
e.preventDefault();}}}
function clearBuffer(start,end){var i;for(i=start;end>i&&len>i;i++)tests[i]&&(buffer[i]=getPlaceholder(i));}
function writeBuffer(){input.val(buffer.join(""));}
function checkVal(allow){var i,c,pos,test=input.val(),lastMatch=-1;for(i=0,pos=0;len>i;i++)if(tests[i]){for(buffer[i]=getPlaceholder(i);pos++<test.length;)if(c=test.charAt(pos-1),tests[i].test(c)){buffer[i]=c,lastMatch=i;break;}
if(pos>test.length){clearBuffer(i+1,len);break;}}else buffer[i]===test.charAt(pos)&&pos++,partialPosition>i&&(lastMatch=i);return allow?writeBuffer():partialPosition>lastMatch+1?settings.autoclear||buffer.join("")===defaultBuffer?(input.val()&&input.val(""),clearBuffer(0,len)):writeBuffer():(writeBuffer(),input.val(input.val().substring(0,lastMatch+1))),partialPosition?i:firstNonMaskPos;}
var input=$(this),buffer=$.map(mask.split(""),function(c,i){return"?"!=c?defs[c]?getPlaceholder(i):c:void 0;}),defaultBuffer=buffer.join(""),focusText=input.val();input.data($.mask.dataName,function(){return $.map(buffer,function(c,i){return tests[i]&&c!=getPlaceholder(i)?c:null;}).join("");}),input.one("unmask",function(){input.off(".mask").removeData($.mask.dataName);}).on("focus.mask",function(){if(!input.prop("readonly")){clearTimeout(caretTimeoutId);var pos;focusText=input.val(),pos=checkVal(),caretTimeoutId=setTimeout(function(){input.get(0)===document.activeElement&&(writeBuffer(),pos==mask.replace("?","").length?input.caret(0,pos):input.caret(pos));},10);}}).on("blur.mask",blurEvent).on("keydown.mask",keydownEvent).on("keypress.mask",keypressEvent).on("input.mask paste.mask",function(){input.prop("readonly")||setTimeout(function(){var pos=checkVal(!0);input.caret(pos),tryFireCompleted();},0);}),chrome&&android&&input.off("input.mask").on("input.mask",androidInputEvent),checkVal();});}});});;