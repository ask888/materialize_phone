(function(b,a){function h(c){a.pushNotifications?a.pushNotifications.getUserToken(c):c(null)}function k(c,e,d){h(function(a){if(a)try{d||(d=[]),l(d)||d.push({name:"pushToken",value:a})}catch(b){}a=JSON.stringify({params:d,eventTypeKey:c,keyValue:e});g(a)})}function l(c){try{var e=!1;c.forEach(function(c){c.name&&"pushToken"===c.name&&(e=!0)});return e}catch(a){return!1}}function g(c){var a=new XMLHttpRequest;a.onerror=function(){};a.open("POST","https://esputnik.com/api/v1/event",!0);a.withCredentials=!0;
a.setRequestHeader("Authorization","Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiI0NTI0ZWZhYTJkYzI2MGRmYTM4YTE1NDBlMWE3YmE0ZmQzYTM3YTBiM2MxNjgyYjMwOWE3NDE3NmRlY2Q0ZjAyMmJlM2JmN2E0OGJlYmIyOTMwMGU3MWZlZjgyYzk2NWU1MWIzYjUwNDRmMjIzM2ZiZTY3MjM5YzU3MjU3Yjk0OWE3YzJiMzI2NzIyYzNiMDViNzZiYjEyMmI1ODQ0MzE2MDM4ZWUyOTE5YzFmNjAxMyJ9.sQKLDi-gwHHwPcXM9ASebf8KplBu4ifOex9qU2m1nmslpPZt8Ryac59ND8gi7ahPCloOx18l__0vBljEUO7YAw");a.setRequestHeader("Content-Type","application/json");a.send(c)}b.esSdkObj?a=b.esSdkObj:b.esSdkObj=a;a.pushOn=function(){a.pushNotifications?a.pushNotifications.init():console.log("Push module unavailable")};a.sendEvent=function(a,e,d){k(a,e,d)};a.getPushToken=h})(this,this.esSdkObj||{});
var ha=function(x,n){function y(){try{!g.b||g.b&&c.main.IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS?M():g.b&&!c.main.IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS?N.J():b.error("[registerController()] NO ACTIONS !!!")}catch(a){b.log("[registerController()] handle error ",a)}}function D(){b.log("[init()] Started..");c.main.USE_CLIENT_PROXY_FOR_SPECIAL_HTTPS&&(b.log("[setupUrlFiles()] Starting"),c.urls.APP_MANIFEST_URL_HTTPS="/push/resource/"+c.main.APPLICATION_ID+c.urls.APP_MANIFEST_URL_HTTPS,
c.urls.SERVICE_WORKER_URL_HTTPS="/push"+c.urls.SERVICE_WORKER_URL_HTTPS,b.log("[setupUrlFiles()] OK:",c.urls.APP_MANIFEST_URL_HTTPS,c.urls.SERVICE_WORKER_URL_HTTPS));b.log("[injectManifest()] Started..");var a=document.createElement("link");a.rel="manifest";a.href=c.urls.APP_MANIFEST_URL_HTTPS;document.head.appendChild(a);b.log("[injectManifest()] OK");g.platform=t.v();g.userAgent=t.B();g.b=t.b();g.isSupported=t.I();g.c=t.H();b.log("[init()] Environment: ",g);b.log("")}function O(){b.log("[checkSubscriptionInGCM()] Started.. ");
navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){b.log("[checkSubscriptionInGCM()] OK, subscription =",a);a?(a=E(a),p.f(a)):F()})["catch"](function(a){b.error("[checkSubscriptionInGCM()] FAIL: ",a)})})}function F(){b.log("[subscribe()] Started...");if("safari"===g.userAgent.name.toLowerCase()){var a=window.i.h.permission(SAFARI_WEBSITE_PUSHID);if("granted"===a.permission){p.f(a.M);return}}navigator.serviceWorker.ready.then(function(a){a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){b.log("[subscribe()] OK, subscribe =",
a);a=E(a);p.f(a)})["catch"](function(a){b.warn("[subscribe()] FAIL: ",a)})})}function E(a){b.log("[parseSubscriptionEndpoint()] Started... ");a=a.subscriptionId?a.subscriptionId:a.endpoint;b.log("[parseSubscriptionEndpoint()] OK, subscriptionEndpoint = ",a);return a}function P(a){b.log("Safari permissions: ");b.log(a);"default"===a.permission?window.i.h.requestPermission(SAFARI-SERVICE-URL,c.main.APNS_WEBSITE_PUSHID,{K:APNS_APP_ID},checkSafariPermission):"denied"===a.permission?b.log("User refused push notifications"):
"granted"===a.permission&&(b.log("User allow push notifications"),F())}function z(){var a=document.getElementById("ScMail");return a?a.innerHTML.trim():null}function Q(a,b){h.get("Email",function(d){d.target.result?b(a,d.target.result.value):b(a,null)},function(){b(a,null)})}function R(a,e){var d=z();d&&e!==d&&p.j(a,"5",d,function(a,e){try{a&&e&&h.a({key:"Email",value:d})}catch(c){b.error("[bind()] ",c)}})}function S(){var a="",b=!1,d=null,f=unescape(G("__utmz"));if(""!=f&&(f=f.split("."),4<=f.length)){f=
f[4].split("|");for(i=0;i<f.length;i++)0<=f[i].indexOf("utmcsr=")&&-1!=f[i].substring(f[i].indexOf("=")+1).indexOf("eSputnik")&&(b=!0),0<=f[i].indexOf("utmcct=")&&(d=f[i].substring(f[i].indexOf("=")+1));b&&d&&(a=d)}return a}function T(){var a=q.g("es-utm-content");0===a%1||(a="");return a}function U(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var d=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?d:d&3|8).toString(16)})}function M(){b.log("[showCustomPopOverDialogController()] Starting...");
u.G(h,V);try{W(function(a,e){a&&X(function(a){try{a||Y(function(a){try{if(a){var d=new Date(e),r=new Date;r.getTime()-d.getTime()>864E5*c.subscription.timeBlockPopover&&u.m()}else{var r=new Date;(!e||r.getTime()-e.getTime()>1E3*c.subscription.timeoutIgnorePopover)&&u.m()}}catch(Z){b.error("check before iframe",Z)}})}catch(f){b.error("check before iframe",f)}})})}catch(a){b.error("check before iframe",a)}}function W(a){h.get("userPrompted",function(e){var d=null;void 0===e.target.result?b.log("New visitor, try to subscribe ..."):
void 0!==e.target.result.value&&(d=new Date(e.target.result.value.date));a(!0,d)},function(){a(!1,null)})}function Y(a){h.get("refused",function(b){a(b.target.result)},function(e){b.log("Failed to retrieve refused key, error: "+e.target.errorCode);a(null)})}function X(a){h.get("SID",function(b){a(b.target.result)},function(e){b.log("Failed to retrieve ID key, error: "+e.target.errorCode);a(null)})}function V(){try{b.log("Subscription denied"),h.a({key:"refused",value:(new Date).toString()})}catch(a){}}
function H(a,b,d){var f=new Date;f.setTime(f.getTime()+864E5*d);document.cookie=a+"="+b+"; path=/;"+("expires="+f.toUTCString())}function G(a){var b="";a+="=";for(var d=document.cookie.split(";"),f=0;f<d.length;f++){for(var c=d[f];" "==c.charAt(0);)c=c.substring(1);0==c.indexOf(a)&&(b=c.substring(a.length,c.length))}return b}function I(a,e){function d(a,e,d){b.log("[sendResultCallback()] save to indexedDb..");b.log("[sendResultCallback()]",a,e,d);try{a&&d?(b.log("[sendResultCallback()] Starting save token to indexedDb:",
d.token),h.a({key:"SID",value:{sid:d.token,bnd:e}}),d.bindings?(b.log("[sendResultCallback()] Starting save to indexedDb:",d.bindings),d.bindings.forEach(function(a){1==a.type?h.a({key:"Contacts",value:a.value}):2==a.type?H("es-bind-id",a.value,1095):3==a.type?h.a({key:"sw-md5",value:{hash:a.value,date:(new Date).toString()}}):5==a.type&&h.a({key:"Email",value:a.value})})):b.warn("[sendResultCallback()] return, data.bindings = ",d.bindings)):b.warn("[sendResultCallback()] return, subscription not saved")}catch(c){b.error("[syncSubscription()]",
c)}}b.log("[syncSubscription()]",a,e);h.get("SID",function(c){try{if(!c.target.result)J(a,e,d);else if(c.target.result.value!==a){var k=c.target.result.value;b.warn("[[syncSubscription()]] old data in indexedDB",k,a);K(k,a,0,d)}}catch(r){b.error("[syncSubscription()]",r)}},function(){b.error("Failed to get SID data")})}function J(a,e,d){b.log("[sendSubscriptionToService()]",a,e);try{var f=new XMLHttpRequest;f.onreadystatechange=function(){try{4==f.readyState&&(200==f.status?d(!0,!0,JSON.parse(f.responseText)):
409==f.status?d(!0,!0,JSON.parse(f.responseText)):(b.warn("Bad Response status = ",f),d(!1,!1,null)))}catch(a){b.error("[sendSubscriptionToService()]",a)}};f.open("PUT",c.main.notificationsService+"/v1/subscribe/",!0);f.setRequestHeader("Content-Type","application/json");e={};e.domainId=c.main.APPLICATION_ID;e.endpoint=a;e.userAgent=g.userAgent.name;e.userAgentVersion=g.userAgent.version;e.userAgentLanguage=window.navigator.V||window.navigator.language;e.OS=g.platform;e.subscriptionPage=window.location.href;
e.binding=aa();f.send(JSON.stringify(e))}catch(k){b.error("[sendSubscriptionToService()]",k)}}function aa(){var a={};""!=l?(a.type="1",a.value=l):z()?(a.type="5",a.value=z()):""!=m&&(a.type="2",a.value=m);return a}function L(a,e,d,f){b.log("[sendBindRequestToService()] Starting...");try{var k=new XMLHttpRequest;k.onreadystatechange=function(){try{4===k.readyState&&(200==k.status?f(!0,k.responseText):f(!1,null))}catch(a){b.error("[sendBindRequestToService()]",a)}};k.open("PUT",c.main.notificationsService+
"/v1/bind/",!0);k.setRequestHeader("Content-Type","application/json");k.send(JSON.stringify({token:a,type:e,value:d}))}catch(r){b.error("[sendBindRequestToService()]",r)}}function K(a,e,d,c){b.log("Send updated subscription to server:"+e);b.log("Old subscription:"+a);c(!0,null)}function ba(a){h.get("validation",function(c){try{var d=c.target.result;c=null;null!=d&&(c=new Date(d.value));a(c)}catch(f){b.log("Error: ",f)}})}function ca(a){ba(function(b){var d;if(d=null!=b)d=(new Date).getTime()-b.getTime()<
c.validation.validationPeriod;if(d)return a(!1);a(!0)})}function da(a,e,d){try{ca(function(f){if(f){var k=new XMLHttpRequest;k.onreadystatechange=function(){try{4==k.readyState&&200==k.status&&(A="true"===k.responseText?!0:!1,b.log("Is token valid: "+A),A?d():ea(a,e),h.a({key:"validation",value:(new Date).toString()}))}catch(c){b.log("Failed to update service worker: "+c)}};null!=a&&(k.open("GET",c.main.notificationsService+"/v1/subscription/validate?value="+a,!0),k.setRequestHeader("Content-Type",
"application/json"),k.send())}else d()})}catch(f){b.log("Error: "+f)}}function ea(a,e){var d=new XMLHttpRequest;d.onreadystatechange=function(){try{4==d.readyState&&200==d.status&&(b.log("Token is set to inactive"),h.remove("SID",function(){b.log("SID key is removed from storage");e()},function(a){b.log("Failed to remove subscription info from storage: "+a.target.errorCode)}))}catch(a){b.log("Failed to deactivate token: "+a)}};d.open("PUT",c.main.notificationsService+"/v1/subscription/"+a+"/inactive",
!0);d.setRequestHeader("Content-Type","application/json");d.send()}x.esSdkObj||(x.esSdkObj={});x.esSdkObj.pushNotifications=n;var c={main:{targetDomain:"http://allo.ua/",proxyDomain:"https://push.allo.ua",APPLICATION_ID:"89744734-C8BA-4346-BB66-77BDB9C64A47",notificationsService:"https://push.esputnik.com",APNS_WEBSITE_PUSHID:"1",IS_SHOW_SPECIAL_FOR_HTTPS:false,USE_CLIENT_PROXY_FOR_SPECIAL_HTTPS:false,IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS:!1},
subscription:{timeSuccessShow:0,timeoutIgnorePopover:0,timeBlockPopover:14,SHOW_PROMPT_DELAY:0,promptMode:1,subscriptionPromptAcceptBtnText:"Разрешить",subscriptionPromptDeclineBtnText:"Запретить",subscriptionPromptText:"Кликните &quot;Разрешить&quot; чтобы получать уведомления от https://allo.ua/",subscriptionPopoverType:2},
validation:{validationPeriod:86400000,isValidationEnabled:false,validationWindowWidth:500,validationWindowHeight:300},updates:{tokenDataUpdatePeriod:604800000},urls:{APP_MANIFEST_URL_HTTPS:"/manifest.json",SERVICE_WORKER_URL_HTTPS:"/sw.js"},logging:{IS_LOGGER_ENABLED:"false"}},l="",m="",A=!1,fa={onPageLoad:1,byElementClick:2},B={"default":1,topPanel:2,bottomPanel:3},
g={platform:null,userAgent:null,isSupported:!1,b:!1,c:!1},N={P:y,J:function(){b.log("[registerServiceWorker()] Started...");if("safari"===g.userAgent.name.toLowerCase()){var a=window.i.h.permission(SAFARI_WEBSITE_PUSHID);P(a)}else"serviceWorker"in navigator&&navigator.serviceWorker.register(c.urls.SERVICE_WORKER_URL_HTTPS,{scope:"./"}).then(function(a){b.log("[registerServiceWorker()] sw registered for scope: ",a.scope);b.log("[registerServiceWorker()] OK:",a);b.log("");O()})["catch"](function(a){b.error("[registerServiceWorker()] FAIL:",
a)})}},ga={bind:function(){b.log("[bind()] Starting...");(l=T())&&""!=l||(l=S());m=q.g("es-bind-id");b.log("[bind()] userId =",l);b.log("[bind()] uuid =",m);var a=!1;""===l&&""===m&&(m=U(),a=!0);h.get("SID",function(e){function d(){p.j(k,"1",l,function(a,c){try{a&&c&&h.a({key:"Contacts",value:c})}catch(d){b.error("[bind()] ",d)}})}function f(){h.get("Contacts",function(a){try{if(a.target.result){var c=a.target.result.value;""!==l&&l!=c&&d()}else""!==l?d():Q(k,R)}catch(e){b.log("[bind()] ",e)}});a&&
L(k,"2",m,function(a,c){b.log("    [sendBindRequestToService()] [save cookie callback] Starting");try{a&&c?(m=c,q.l("es-bind-id",c,1095)):q.u("es-bind-id")}catch(d){b.error("[sendBindRequestToService()] [save cookie callback] ",d)}})}b.log("[bind()] Starting...");b.log("[bind()]  Check SID in DB: ",e.target.result);if(e.target.result){var k=e.target.result.value.sid;c.validation.isValidationEnabled&&!g.b?(b.log("validate"),da(k,y,f)):(b.log("validation disabled"),f())}else b.log("[bind()] No SID in DB, try to register"),
y()},function(){b.log("Failed to get data")});b.log("[bind()] Finish");b.log("")}},q={g:G,l:H,u:function(){document.cookie=name+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},p={S:J,j:L,T:K,f:I,R:function(){b.log("Try Register User Visit");h.get("SID",function(a){b.log("Check SID in DB: ",a.target.result);a.target.result?(b.log("Register User Visit"),a=a.target.result.value.sid,esSdkObj.N("user_visited_site",a,[{name:"sid",value:a}])):b.log("No SID in DB")})}},b={log:function(){console&&b.isEnabled()&&
console.log.apply(console,arguments)},warn:function(){console&&b.isEnabled()&&console.warn.apply(console,arguments)},error:function(){console&&b.isEnabled()&&console.error.apply(console,arguments)},isEnabled:function(){return/true/.test(c.logging.IS_LOGGER_ENABLED)}},t={O:D,B:function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],f=b.match(/(edge(?=\/))\/?\s*(\d+)/i)||[];return"Edge"===f[1]?{name:f[1],version:f[2]}:/trident/i.test(c[1])?
(a=/\brv[ :]+(\d+)/g.exec(b)||[],{name:"IE",version:a[1]||""}):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!=a)?{name:"Opera",version:a[1]}:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),{name:c[0],version:c[1]})},v:function(){var a="";"Windows FreeBSD Android iPhone Linux Mac".split(" ").forEach(function(b){-1!=navigator.userAgent.indexOf(b)&&(a=b)});return a},b:function(){var a=window.location.protocol;return c.main.IS_SHOW_SPECIAL_FOR_HTTPS&&
"https:"===a?!0:!1},I:function(){if("iOS"===g.platform||"Android"===g.platform)return!1;if("chrome"===g.userAgent.name.toLowerCase()&&42<=parseFloat(g.userAgent.version)||"firefox"===g.userAgent.name.toLowerCase()&&44<=parseFloat(g.userAgent.version))return!0;if("safari"===g.userAgent.name.toLowerCase())return!1},H:function(){var a=window.location.href;-1===c.main.targetDomain.indexOf("://www.")&&(a=a.replace("://www.","://"));return 0===a.indexOf(c.main.targetDomain)}},C={F:D,s:function(){b.log("[checkData()] Started..");
g.isSupported||b.warn("[checkData()] FAIL, Environment is not supported:",g);g.c||b.warn("[checkData()] FAIL,this  is not target domain",g);b.log("[checkData()] Ok");b.log("")},o:function(a){var c=null;b.log("[init()] check utm labels:",window.location.search);window.location.search.replace(/^\?/,"").split("&").forEach(function(d){d=d.split("=");a==d[0]&&(c=d[1],b.log("[init()] contactId from url =",c),0===c%1&&q.l("es-utm-content",c,1095))})}};n.init=function(){try{var a=function(){try{C.F(),C.s(),
g.isSupported&&g.c&&(C.o("utm_content"),ga.bind())}catch(a){b.log("[main()] handle error ",a)}};b.log("Configuration: ");b.log("Target Domain: ",c.main.targetDomain);b.log("Proxy Domain: ",c.main.proxyDomain);b.log("Application ID: ",c.main.APPLICATION_ID);b.log("Notifications Service: ",c.main.notificationsService);b.log("Apple Push Notification Website Push ID: ",c.main.APNS_WEBSITE_PUSHID);b.log("Show Subscription IFrame Result [s]: ",c.subscription.timeSuccessShow);b.log("Timeout on ignore prompt: ",
c.subscription.timeoutIgnorePopover);b.log("Timeout on block prompt: ",c.subscription.timeBlockPopover);b.log("Validation period: ",c.validation.validationPeriod);b.log("Is Validation Enabled: ",c.validation.isValidationEnabled);b.log("Validation Window Width: ",c.validation.validationWindowWidth);b.log("Validation Window Height: ",c.validation.validationWindowHeight);b.log("Token Data Update Period: ",c.updates.tokenDataUpdatePeriod);b.log("Is show special for Https: ",c.main.IS_SHOW_SPECIAL_FOR_HTTPS);
b.log("Use client proxy for special Https: ",c.main.USE_CLIENT_PROXY_FOR_SPECIAL_HTTPS);b.log("App Manifest URL: ",c.urls.APP_MANIFEST_URL_HTTPS);b.log("Service Worker URL: ",c.urls.SERVICE_WORKER_URL_HTTPS);b.log("Show IFrame for Https: ",c.main.IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS);b.log("Show Prompt Delay: ",c.subscription.SHOW_PROMPT_DELAY);b.log("Is logger enabled: ",c.logging.IS_LOGGER_ENABLED);c.subscription.promptMode===fa.onPageLoad?setTimeout(a,1E3*c.subscription.SHOW_PROMPT_DELAY):
document.addEventListener("click",function(c){-1<c.target.className.split(" ").indexOf("es-push-prompt-init")&&(b.log("init subscription by click"),a())},!1)}catch(e){b.log("[init] handle error ",e)}};n.getUserToken=function(a){h.get("SID",function(b){var c=null;b.target.result&&(c=b.target.result.value.sid);a(c)})};var h=function(){function a(a,c){try{var e=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open("es-push-integration",1);e.onsuccess=function(b){try{d=
b.target.result,a()}catch(c){}};e.onerror=function(a){try{b.log("DB opening error: "+a.target.errorCode),c()}catch(d){}};e.onupgradeneeded=function(a){try{a.target.result.createObjectStore("integration-data",{keyPath:"key"})}catch(b){}}}catch(g){}}function c(f){try{d?f():a(function(){f()},function(){b.log("DB init failed")})}catch(e){b.log("Error occurred: "+e)}}var d=null;return{a:function(a,b,g){c(function(){var c=d.transaction(["integration-data"],"readwrite").objectStore("integration-data").put(a);
c.onsuccess=b;c.onerror=g})},remove:function(a,b,g){c(function(){var c=d.transaction(["integration-data"],"readwrite").objectStore("integration-data")["delete"](a);c.onsuccess=b;c.onerror=g})},get:function(a,b,g){c(function(){var c=d.transaction(["integration-data"],"readonly").objectStore("integration-data").get(a);c.onsuccess=b;c.onerror=g})}}}(),u=function(){function a(){var a=document.getElementsByTagName("head")[0],e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.href=
c.main.notificationsService+"/resource/"+c.main.APPLICATION_ID+"/es-subscription-prompt-style.css";a.appendChild(e);window.addEventListener("message",function(a){try{if(0==a.origin.indexOf(c.main.proxyDomain))if("pong"==a.data)clearInterval(p),d();else if("SYNC"==a.data)n.a({key:"synced",value:(new Date).toString()});else{var e=1E3*c.subscription.timeSuccessShow;if("refused"==a.data)t();else if(0===a.data.indexOf("SID|")){var f=a.data.split("|");2==f.length&&I(f[1])}setTimeout(function(){try{null!=
v&&v.close()}catch(a){b.error("iframe: ",a)}},e)}}catch(g){b.error("iframe: ",g)}},!1)}function e(){try{var a="push-notification-popover",e="push-notification-prompt-buttons";c.subscription.subscriptionPopoverType===B.topPanel?(a="push-notification-popover-top",e="push-notification-prompt-inline-buttons"):c.subscription.subscriptionPopoverType===B.bottomPanel&&(a="push-notification-popover-bottom",e="push-notification-prompt-inline-buttons");var g=document.createElement("div");g.setAttribute("class",
"push-notification-prompt "+a);var k=document.createElement("div");k.setAttribute("class","push-notification-prompt-message");var h=document.createElement("div"),l=document.createElement("img");l.setAttribute("class","push-notification-bell-icon");l.setAttribute("width","14");l.setAttribute("height","14");l.setAttribute("src",c.main.notificationsService+"/img/subscription-notify-icon.svg");h.appendChild(l);h.setAttribute("class","push-notification-prompt-message-text");var m=document.createElement("div");
m.setAttribute("class",e);var n=document.createElement("button");n.setAttribute("class","push-notification-prompt-btn push-notification-accept-btn");n.setAttribute("type","button");n.onclick=f;n.innerHTML=c.subscription.subscriptionPromptAcceptBtnText;var p=document.createElement("button");p.setAttribute("class","push-notification-prompt-btn push-notification-disallow-btn");p.setAttribute("type","button");p.onclick=function(){t();d()};p.innerHTML=c.subscription.subscriptionPromptDeclineBtnText;m.appendChild(p);
m.appendChild(n);k.appendChild(h);if(c.subscription.subscriptionPopoverType===B["default"]){k.appendChild(m);var q=document.createElement("div");q.setAttribute("class","push-prompt-text");q.innerHTML=c.subscription.subscriptionPromptText;h.appendChild(q)}else h.innerHTML+=c.subscription.subscriptionPromptText,h.appendChild(m);g.appendChild(k);var r=document.createElement("span");r.setAttribute("class","close-prompt");r.onclick=function(){d()};k.appendChild(r);g.style.visibility="hidden";return g}catch(u){return b.error("iframe: ",
u),null}}function d(){try{null!=w&&(w.style.visibility="hidden")}catch(a){b.error("iframe: ",a)}}function f(){try{v=window.open(c.main.proxyDomain+"/subscription/"+c.main.APPLICATION_ID,"_blank","scrollbars=yes, width=500, height=500, top="+(h()/2-250+m())+", left="+(g()/2-250+l())),window.focus&&v.focus(),p=setInterval(function(){try{v.postMessage("ping",c.main.proxyDomain),v.postMessage("callFrom|"+window.location.href,c.main.proxyDomain)}catch(a){d()}},100)}catch(a){b.error("iframe: ",a)}}function g(){return window.innerWidth?
window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width}function h(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height}function l(){return void 0!==window.screenLeft?window.screenLeft:screen.left}function m(){return void 0!==window.screenTop?window.screenTop:screen.top}var v=null,t=null,w=null,p=null,q=null,n=null;return{G:function(c,d){try{b.log("UI Module Init."),
a(),w=e(),null!=w&&document.body.appendChild(w),n=c,t=d}catch(f){b.error("iframe: ",f)}},m:function(){try{n.a({key:"userPrompted",value:{date:(new Date).toString()}}),w.style.visibility="visible"}catch(a){b.error("iframe: ",a)}},U:function(){try{var a=u.D(),d=u.C(),e=a/2-c.validation.validationWindowWidth/2+u.w(),f=d/2-c.validation.validationWindowHeight/2+u.A();q=window.open(c.main.proxyDomain+"/resource/update-frame/"+c.main.APPLICATION_ID,"_blank","location=no, scrollbars=no, width="+c.validation.validationWindowWidth+
", height="+c.validation.validationWindowHeight+", top="+f+", left="+e);q.blur();window.focus()}catch(g){b.log("Error: "+g)}},L:d,D:g,C:h,w:l,A:m}}();return n}(this,ha||{});
(function(b,a){function h(){for(var a=b[g].q;0<a.length;)k(a)}function k(a){try{if(0!=a.length){var e=a.shift(),d=e[0];a=[];for(var b=1;b<e.length;b++)a.push(e[b]);l(d,a)}}catch(g){}}function l(c,b){for(f in a)if(a.hasOwnProperty(f)){var d=a[f];if(f===c){d.apply(this,b);break}}}var g=b.esSdk;b[g]?(b[g].q.push=function(){var a=Array.prototype.push.apply(this,arguments);k(b[g].q);return a},h()):console.log("Using SDK synchronously")}(this,this.esSdkObj));
